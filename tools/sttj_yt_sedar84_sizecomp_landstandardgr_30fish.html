<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Katherine Godwin">

<title>sttj_yt_sedar84_sizecomp_landstdgearname</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/clipboard/clipboard.min.js"></script>
<script src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/quarto.js"></script>
<script src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/popper.min.js"></script>
<script src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/anchor.min.js"></script>
<link href="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#yellowtail-snapper-sttj" id="toc-yellowtail-snapper-sttj" class="nav-link active" data-scroll-target="#yellowtail-snapper-sttj">Yellowtail Snapper STTJ</a>
  <ul>
  <li><a href="#control-settings-and-exploratory-frequency-tables" id="toc-control-settings-and-exploratory-frequency-tables" class="nav-link" data-scroll-target="#control-settings-and-exploratory-frequency-tables">Control Settings and Exploratory Frequency Tables</a>
  <ul class="collapse">
  <li><a href="#filter-to-commercial-samples" id="toc-filter-to-commercial-samples" class="nav-link" data-scroll-target="#filter-to-commercial-samples">Filter to Commercial samples</a></li>
  <li><a href="#extract-marfin-samples-look-at-island-distribution" id="toc-extract-marfin-samples-look-at-island-distribution" class="nav-link" data-scroll-target="#extract-marfin-samples-look-at-island-distribution">Extract marfin samples, look at island distribution</a></li>
  <li><a href="#add-gear-groupings-no-length-length-conversions-available" id="toc-add-gear-groupings-no-length-length-conversions-available" class="nav-link" data-scroll-target="#add-gear-groupings-no-length-length-conversions-available">Add gear groupings, NO length-length conversions available</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#filtration-level-investigation" id="toc-filtration-level-investigation" class="nav-link" data-scroll-target="#filtration-level-investigation">Filtration level investigation</a>
  <ul>
  <li><a href="#unique-trip-id-vs-gear-by-year-investigation" id="toc-unique-trip-id-vs-gear-by-year-investigation" class="nav-link" data-scroll-target="#unique-trip-id-vs-gear-by-year-investigation">Unique trip ID vs gear by year investigation</a>
  <ul class="collapse">
  <li><a href="#how-many-unique-trip-ids-per-year" id="toc-how-many-unique-trip-ids-per-year" class="nav-link" data-scroll-target="#how-many-unique-trip-ids-per-year">How many unique trip IDâ€™s per year?</a></li>
  </ul></li>
  <li><a href="#unique-length-records-per-gear-per-year" id="toc-unique-length-records-per-gear-per-year" class="nav-link" data-scroll-target="#unique-length-records-per-gear-per-year">Unique length records per gear per year</a>
  <ul class="collapse">
  <li><a href="#how-many-length-records-per-gear-per-year" id="toc-how-many-length-records-per-gear-per-year" class="nav-link" data-scroll-target="#how-many-length-records-per-gear-per-year">How many length records per gear per year?</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#glm-analysis" id="toc-glm-analysis" class="nav-link" data-scroll-target="#glm-analysis">GLM analysis</a>
  <ul>
  <li><a href="#hook-and-line" id="toc-hook-and-line" class="nav-link" data-scroll-target="#hook-and-line">Hook and Line</a></li>
  <li><a href="#net" id="toc-net" class="nav-link" data-scroll-target="#net">Net</a></li>
  <li><a href="#trap" id="toc-trap" class="nav-link" data-scroll-target="#trap">Trap</a></li>
  </ul></li>
  <li><a href="#gear-density-plots" id="toc-gear-density-plots" class="nav-link" data-scroll-target="#gear-density-plots">Gear Density Plots</a>
  <ul>
  <li><a href="#aggregated-density-plots" id="toc-aggregated-density-plots" class="nav-link" data-scroll-target="#aggregated-density-plots">Aggregated density plots</a></li>
  <li><a href="#gear-grouping-investigation" id="toc-gear-grouping-investigation" class="nav-link" data-scroll-target="#gear-grouping-investigation">Gear grouping investigation</a></li>
  <li><a href="#break-at-2005" id="toc-break-at-2005" class="nav-link" data-scroll-target="#break-at-2005">Break at 2005</a></li>
  <li><a href="#annual-density-plots" id="toc-annual-density-plots" class="nav-link" data-scroll-target="#annual-density-plots">Annual Density plots</a></li>
  </ul></li>
  <li><a href="#stacked-bar-charts" id="toc-stacked-bar-charts" class="nav-link" data-scroll-target="#stacked-bar-charts">Stacked bar charts</a>
  <ul>
  <li><a href="#visual-representation-of-gear-distribution-within-groupings" id="toc-visual-representation-of-gear-distribution-within-groupings" class="nav-link" data-scroll-target="#visual-representation-of-gear-distribution-within-groupings">Visual representation of gear distribution within groupings</a></li>
  </ul></li>
  <li><a href="#gear-distribution-across-time-by-gear-groupings" id="toc-gear-distribution-across-time-by-gear-groupings" class="nav-link" data-scroll-target="#gear-distribution-across-time-by-gear-groupings">Gear distribution across time by gear groupings</a>
  <ul>
  <li><a href="#all-gears-over-time" id="toc-all-gears-over-time" class="nav-link" data-scroll-target="#all-gears-over-time">All gears over time</a></li>
  <li><a href="#hook-and-line-gear-distribution-over-time-by-year" id="toc-hook-and-line-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#hook-and-line-gear-distribution-over-time-by-year">Hook and Line Gear Distribution Over Time by Year</a></li>
  <li><a href="#trap-gear-distribution-over-time-by-year" id="toc-trap-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#trap-gear-distribution-over-time-by-year">Trap Gear Distribution Over Time by Year</a></li>
  <li><a href="#diving-gear-distribution-over-time-by-year---no-gear-grouping" id="toc-diving-gear-distribution-over-time-by-year---no-gear-grouping" class="nav-link" data-scroll-target="#diving-gear-distribution-over-time-by-year---no-gear-grouping">Diving Gear Distribution Over Time by Year - NO GEAR GROUPING</a></li>
  <li><a href="#net-gear-distribution-over-time-by-year" id="toc-net-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#net-gear-distribution-over-time-by-year">Net Gear Distribution Over Time by Year</a></li>
  <li><a href="#spear-gear-distribution-over-time-by-year---no-grouping" id="toc-spear-gear-distribution-over-time-by-year---no-grouping" class="nav-link" data-scroll-target="#spear-gear-distribution-over-time-by-year---no-grouping">Spear Gear Distribution Over Time by Year - NO GROUPING</a></li>
  <li><a href="#other-gear-distribution-over-time-by-year" id="toc-other-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#other-gear-distribution-over-time-by-year">Other Gear Distribution Over Time by Year</a></li>
  </ul></li>
  <li><a href="#cummulative-density-plots" id="toc-cummulative-density-plots" class="nav-link" data-scroll-target="#cummulative-density-plots">Cummulative Density Plots</a>
  <ul>
  <li><a href="#aggregated-cdf" id="toc-aggregated-cdf" class="nav-link" data-scroll-target="#aggregated-cdf">Aggregated CDF</a></li>
  <li><a href="#management-periods" id="toc-management-periods" class="nav-link" data-scroll-target="#management-periods">Management periods*</a></li>
  <li><a href="#annual-cdf" id="toc-annual-cdf" class="nav-link" data-scroll-target="#annual-cdf">Annual CDF</a></li>
  </ul></li>
  <li><a href="#island-density-plots" id="toc-island-density-plots" class="nav-link" data-scroll-target="#island-density-plots">Island Density Plots</a>
  <ul>
  <li><a href="#aggregated-density-plots-1" id="toc-aggregated-density-plots-1" class="nav-link" data-scroll-target="#aggregated-density-plots-1">Aggregated density plots</a></li>
  <li><a href="#management-periods-1" id="toc-management-periods-1" class="nav-link" data-scroll-target="#management-periods-1">Management periods*</a></li>
  <li><a href="#annual-density-plots-1" id="toc-annual-density-plots-1" class="nav-link" data-scroll-target="#annual-density-plots-1">Annual Density plots</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">sttj_yt_sedar84_sizecomp_landstdgearname</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Katherine Godwin </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>This script will be expanding upon the length-comp script c1_nominal_len_comps.Rmd created by Molly Stevens.</p>
<section id="yellowtail-snapper-sttj" class="level1 page-columns page-full">
<h1>Yellowtail Snapper STTJ</h1>
<div class="cell column-page">

</div>
<section id="control-settings-and-exploratory-frequency-tables" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="control-settings-and-exploratory-frequency-tables">Control Settings and Exploratory Frequency Tables</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="st">"YTS"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>region <span class="ot">&lt;-</span> <span class="st">"PUERTO RICO - USVI"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>county <span class="ot">&lt;-</span> <span class="st">"ST THOMAS/ST JOHN"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>bin_size <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>len_type <span class="ot">&lt;-</span> <span class="st">"FORK LENGTH"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LENGTH_TYPE1, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    FORK LENGTH       NO LENGTH STANDARD LENGTH    TOTAL LENGTH            &lt;NA&gt; 
          19888              14              67              56               0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LENGTH_TYPE2, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 FORK LENGTH    NO LENGTH TOTAL LENGTH         &lt;NA&gt; 
           1        19948           76            0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(sttj_yt<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 166</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(sttj_yt<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 796</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tip_range  <span class="ot">&lt;-</span> sttj_yt[<span class="fu">with</span>(sttj_yt,<span class="fu">order</span>(<span class="sc">-</span>LENGTH1_MM)),]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tip_range<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 796 690 660 650 650 645 645 640 632 628 620 610 600 600 595 595 590 590 588
[20] 585 585 585 585 585 585</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tip_range2 <span class="ot">&lt;-</span> sttj_yt[<span class="fu">with</span>(sttj_yt,<span class="fu">order</span>(LENGTH1_MM)),]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>tip_range2<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 166 183 183 185 190 190 190 190 191 192 192 194 195 196 198 200 203 203 204
[20] 204 205 205 205 206 206</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">##range currently set to not drop any obs (centimeters)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>min_size <span class="ot">&lt;-</span> <span class="dv">14</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>max_size <span class="ot">&lt;-</span> <span class="dv">80</span>   </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(sttj_yt<span class="sc">$</span>YEAR,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1983"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>min_year <span class="ot">&lt;-</span> <span class="dv">1983</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>max_year <span class="ot">&lt;-</span> <span class="dv">2022</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>break_year <span class="ot">&lt;-</span> <span class="dv">2005</span> <span class="co"># this is an optional value to denote a change in management. inclusive on the upper bound. can be set to NA if not relevant.  2005 trap specifications were updated and many closures went into place</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  TABLES START HERE </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
YELLOWTAIL SNAPPER,OCYURUS CHR                           &lt;NA&gt; 
                         20025                              0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
         BY HAND; DIVING GEAR                      DIP NETS 
                            1                           109 
      ENCIRCLING NETS (PURSE)  ENTANGLING NETS (GILL) UNSPC 
                          363                            48 
             GILL NETS; OTHER                  GRABS; HOOKS 
                           20                             1 
                  HAUL SEINES                 HOOKS; SPONGE 
                          556                            38 
                   LINES HAND     LINES LONG SET WITH HOOKS 
                        15276                             4 
        LINES LONG; REEF FISH       LINES POWER TROLL OTHER 
                          109                           544 
                    NOT CODED      POTS AND TRAPS; BOX TRAP 
                           27                             6 
          POTS AND TRAPS; CMB          POTS AND TRAPS; FISH 
                           78                          2155 
POTS AND TRAPS; SPINY LOBSTER   REEL; ELECTRIC OR HYDRAULIC 
                           64                           139 
                 ROD AND REEL ROD AND REEL; ELECTRIC (HAND) 
                          361                           124 
                       SPEARS                SPEARS; DIVING 
                            1                             1 
                         &lt;NA&gt; 
                            0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, sttj_yt<span class="sc">$</span>STATE_LANDED, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                               
                                VIRGIN ISLANDS  &lt;NA&gt;
  BY HAND; DIVING GEAR                       1     0
  DIP NETS                                 109     0
  ENCIRCLING NETS (PURSE)                  363     0
  ENTANGLING NETS (GILL) UNSPC              48     0
  GILL NETS; OTHER                          20     0
  GRABS; HOOKS                               1     0
  HAUL SEINES                              556     0
  HOOKS; SPONGE                             38     0
  LINES HAND                             15276     0
  LINES LONG SET WITH HOOKS                  4     0
  LINES LONG; REEF FISH                    109     0
  LINES POWER TROLL OTHER                  544     0
  NOT CODED                                 27     0
  POTS AND TRAPS; BOX TRAP                   6     0
  POTS AND TRAPS; CMB                       78     0
  POTS AND TRAPS; FISH                    2155     0
  POTS AND TRAPS; SPINY LOBSTER             64     0
  REEL; ELECTRIC OR HYDRAULIC              139     0
  ROD AND REEL                             361     0
  ROD AND REEL; ELECTRIC (HAND)            124     0
  SPEARS                                     1     0
  SPEARS; DIVING                             1     0
  &lt;NA&gt;                                       0     0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>FISHING_MODE, sttj_yt<span class="sc">$</span>INT_TYPE, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             FISHERMAN SAMPLE UNKNOWN USVI MARFIN REEFFISH SAMPLING
  COMMERCIAL            13306      29                          5164
  &lt;NA&gt;                      0       0                             0
            
             USVI MRAG BYCATCH STUDY  &lt;NA&gt;
  COMMERCIAL                    1526     0
  &lt;NA&gt;                             0     0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># marfin &lt;- sttj_yt%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#             filter(INT_TYPE == "USVI MARFIN REEFFISH SAMPLING")</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>YEAR,sttj_yt<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       YELLOWTAIL SNAPPER,OCYURUS CHR &lt;NA&gt;
  1983                            162    0
  1984                            639    0
  1985                           1021    0
  1986                            144    0
  1987                             12    0
  1988                             70    0
  1991                              4    0
  1992                            284    0
  1993                            335    0
  1994                            175    0
  1995                            221    0
  1996                            188    0
  2002                             69    0
  2003                              3    0
  2004                              6    0
  2005                            358    0
  2006                           1168    0
  2008                              7    0
  2009                           1189    0
  2010                           2605    0
  2011                           1927    0
  2012                           1034    0
  2013                            221    0
  2014                             49    0
  2015                             17    0
  2016                            852    0
  2017                           1589    0
  2018                           1730    0
  2019                           2061    0
  2020                            173    0
  2021                            371    0
  2022                            516    0
  2023                            825    0
  &lt;NA&gt;                              0    0</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>COUNTY_LANDED,sttj_yt<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            VIRGIN ISLANDS  &lt;NA&gt;
  ST JOHN              109     0
  ST THOMAS          19916     0
  &lt;NA&gt;                   0     0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>YEAR,sttj_yt<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       VIRGIN ISLANDS &lt;NA&gt;
  1983            162    0
  1984            639    0
  1985           1021    0
  1986            144    0
  1987             12    0
  1988             70    0
  1991              4    0
  1992            284    0
  1993            335    0
  1994            175    0
  1995            221    0
  1996            188    0
  2002             69    0
  2003              3    0
  2004              6    0
  2005            358    0
  2006           1168    0
  2008              7    0
  2009           1189    0
  2010           2605    0
  2011           1927    0
  2012           1034    0
  2013            221    0
  2014             49    0
  2015             17    0
  2016            852    0
  2017           1589    0
  2018           1730    0
  2019           2061    0
  2020            173    0
  2021            371    0
  2022            516    0
  2023            825    0
  &lt;NA&gt;              0    0</code></pre>
</div>
</div>
<section id="filter-to-commercial-samples" class="level4">
<h4 class="anchored" data-anchor-id="filter-to-commercial-samples">Filter to Commercial samples</h4>
<p>Length composition after filtering to commercial records</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>           
            ST JOHN ST THOMAS  &lt;NA&gt;
  ST JOHN       109         0     0
  ST THOMAS       0     19902     0
  &lt;NA&gt;            0         0     0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      
       ST JOHN ST THOMAS &lt;NA&gt;
  1983       0       149    0
  1984      12       627    0
  1985       1      1020    0
  1986       0       144    0
  1987       0        12    0
  1988       0        70    0
  1991       0         4    0
  1992       0       284    0
  1993       0       335    0
  1994       0       175    0
  1995       0       221    0
  1996       0       188    0
  2002       0        69    0
  2003       0         3    0
  2004       0         6    0
  2005       0       358    0
  2006       0      1168    0
  2008       4         3    0
  2009      10      1178    0
  2010      58      2547    0
  2011      21      1906    0
  2012       0      1034    0
  2013       0       221    0
  2014       0        49    0
  2015       0        17    0
  2016       3       849    0
  2017       0      1589    0
  2018       0      1730    0
  2019       0      2061    0
  2020       0       173    0
  2021       0       371    0
  2022       0       516    0
  2023       0       825    0
  &lt;NA&gt;       0         0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    FORK LENGTH STANDARD LENGTH    TOTAL LENGTH            &lt;NA&gt; 
          19888              67              56               0 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
         BY HAND; DIVING GEAR                      DIP NETS 
                            1                           109 
      ENCIRCLING NETS (PURSE)  ENTANGLING NETS (GILL) UNSPC 
                          363                            48 
             GILL NETS; OTHER                  GRABS; HOOKS 
                           20                             1 
                  HAUL SEINES                 HOOKS; SPONGE 
                          556                            38 
                   LINES HAND     LINES LONG SET WITH HOOKS 
                        15276                             4 
        LINES LONG; REEF FISH       LINES POWER TROLL OTHER 
                          109                           544 
                    NOT CODED      POTS AND TRAPS; BOX TRAP 
                           27                             6 
          POTS AND TRAPS; CMB          POTS AND TRAPS; FISH 
                           78                          2155 
POTS AND TRAPS; SPINY LOBSTER   REEL; ELECTRIC OR HYDRAULIC 
                           64                           139 
                 ROD AND REEL ROD AND REEL; ELECTRIC (HAND) 
                          361                           124 
                       SPEARS                SPEARS; DIVING 
                            1                             1 
                         &lt;NA&gt; 
                            0 </code></pre>
</div>
</div>
</section>
<section id="extract-marfin-samples-look-at-island-distribution" class="level4">
<h4 class="anchored" data-anchor-id="extract-marfin-samples-look-at-island-distribution">Extract marfin samples, look at island distribution</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      
       ST JOHN ST THOMAS &lt;NA&gt;
  2008       4         3    0
  2009       9       861    0
  2010       9      1433    0
  2011      21      1833    0
  2012       0       991    0
  &lt;NA&gt;       0         0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                               
                                ST JOHN ST THOMAS &lt;NA&gt;
  LINES HAND                         21      4610    0
  NOT CODED                           0        13    0
  POTS AND TRAPS; CMB                10        28    0
  POTS AND TRAPS; FISH               12       460    0
  POTS AND TRAPS; SPINY LOBSTER       0         4    0
  ROD AND REEL                        0         6    0
  &lt;NA&gt;                                0         0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>, ,  = ST JOHN

                               
                                2008 2009 2010 2011 2012 &lt;NA&gt;
  LINES HAND                       0    0    0   21    0    0
  NOT CODED                        0    0    0    0    0    0
  POTS AND TRAPS; CMB              4    6    0    0    0    0
  POTS AND TRAPS; FISH             0    3    9    0    0    0
  POTS AND TRAPS; SPINY LOBSTER    0    0    0    0    0    0
  ROD AND REEL                     0    0    0    0    0    0
  &lt;NA&gt;                             0    0    0    0    0    0

, ,  = ST THOMAS

                               
                                2008 2009 2010 2011 2012 &lt;NA&gt;
  LINES HAND                       0  761 1309 1690  850    0
  NOT CODED                        0    0    0   13    0    0
  POTS AND TRAPS; CMB              0   21    6    1    0    0
  POTS AND TRAPS; FISH             3   79  118  125  135    0
  POTS AND TRAPS; SPINY LOBSTER    0    0    0    4    0    0
  ROD AND REEL                     0    0    0    0    6    0
  &lt;NA&gt;                             0    0    0    0    0    0

, ,  = NA

                               
                                2008 2009 2010 2011 2012 &lt;NA&gt;
  LINES HAND                       0    0    0    0    0    0
  NOT CODED                        0    0    0    0    0    0
  POTS AND TRAPS; CMB              0    0    0    0    0    0
  POTS AND TRAPS; FISH             0    0    0    0    0    0
  POTS AND TRAPS; SPINY LOBSTER    0    0    0    0    0    0
  ROD AND REEL                     0    0    0    0    0    0
  &lt;NA&gt;                             0    0    0    0    0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      
       FORK LENGTH STANDARD LENGTH TOTAL LENGTH &lt;NA&gt;
  1983         149               0            0    0
  1984         639               0            0    0
  1985        1021               0            0    0
  1986         144               0            0    0
  1987          12               0            0    0
  1988           4              66            0    0
  1991           4               0            0    0
  1992         283               1            0    0
  1993         335               0            0    0
  1994         175               0            0    0
  1995         221               0            0    0
  1996         188               0            0    0
  2002          69               0            0    0
  2003           3               0            0    0
  2004           6               0            0    0
  2005         358               0            0    0
  2006        1168               0            0    0
  2008           7               0            0    0
  2009        1188               0            0    0
  2010        2605               0            0    0
  2011        1927               0            0    0
  2012        1034               0            0    0
  2013         221               0            0    0
  2014          49               0            0    0
  2015          12               0            5    0
  2016         801               0           51    0
  2017        1589               0            0    0
  2018        1730               0            0    0
  2019        2061               0            0    0
  2020         173               0            0    0
  2021         371               0            0    0
  2022         516               0            0    0
  2023         825               0            0    0
  &lt;NA&gt;           0               0            0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>           
            VIRGIN ISLANDS
  ST JOHN              109
  ST THOMAS          19902</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                               
                                CAST NETS ENCIRCLING NETS (PURSE) HOOKS, SPONGE
  BY HAND; DIVING GEAR                  0                       0             0
  DIP NETS                              0                       0             0
  ENCIRCLING NETS (PURSE)               0                      30             0
  ENTANGLING NETS (GILL) UNSPC          0                       0             0
  GILL NETS; OTHER                      0                       0             0
  GRABS; HOOKS                          0                       0             0
  HAUL SEINES                           0                       0             0
  HOOKS; SPONGE                         0                       0             0
  LINES HAND                            0                       0             0
  LINES LONG SET WITH HOOKS             0                       0             0
  LINES LONG; REEF FISH                 0                       0             0
  LINES POWER TROLL OTHER               0                       0             0
  NOT CODED                             0                       0             0
  POTS AND TRAPS; BOX TRAP              0                       0             0
  POTS AND TRAPS; CMB                   0                       0             0
  POTS AND TRAPS; FISH                  0                      14            42
  POTS AND TRAPS; SPINY LOBSTER         0                       0             0
  REEL; ELECTRIC OR HYDRAULIC           0                       0             0
  ROD AND REEL                         15                       0             0
  ROD AND REEL; ELECTRIC (HAND)         0                       0             0
  SPEARS                                0                       0             0
  SPEARS; DIVING                        0                       0             0
                               
                                LINES HAND LINES LONG, REEF FISH
  BY HAND; DIVING GEAR                   0                     0
  DIP NETS                               0                     0
  ENCIRCLING NETS (PURSE)                0                     0
  ENTANGLING NETS (GILL) UNSPC           0                     0
  GILL NETS; OTHER                       0                     0
  GRABS; HOOKS                           0                     0
  HAUL SEINES                            0                     0
  HOOKS; SPONGE                          0                     0
  LINES HAND                           458                     8
  LINES LONG SET WITH HOOKS              0                     0
  LINES LONG; REEF FISH                  0                     1
  LINES POWER TROLL OTHER                0                     0
  NOT CODED                              0                     0
  POTS AND TRAPS; BOX TRAP               0                     0
  POTS AND TRAPS; CMB                    0                     0
  POTS AND TRAPS; FISH                  70                     8
  POTS AND TRAPS; SPINY LOBSTER          0                     0
  REEL; ELECTRIC OR HYDRAULIC            0                     0
  ROD AND REEL                          17                     0
  ROD AND REEL; ELECTRIC (HAND)          0                     0
  SPEARS                                 0                     0
  SPEARS; DIVING                         0                     0
                               
                                LINES POWER TROLL OTHER NOT CODED
  BY HAND; DIVING GEAR                                0         0
  DIP NETS                                            0         0
  ENCIRCLING NETS (PURSE)                             0         0
  ENTANGLING NETS (GILL) UNSPC                        0         0
  GILL NETS; OTHER                                    0         0
  GRABS; HOOKS                                        0         0
  HAUL SEINES                                         0         0
  HOOKS; SPONGE                                       0         0
  LINES HAND                                          0         0
  LINES LONG SET WITH HOOKS                           0         0
  LINES LONG; REEF FISH                               0         0
  LINES POWER TROLL OTHER                           192         0
  NOT CODED                                           0        13
  POTS AND TRAPS; BOX TRAP                            0         0
  POTS AND TRAPS; CMB                                 0         0
  POTS AND TRAPS; FISH                               73         0
  POTS AND TRAPS; SPINY LOBSTER                       0         0
  REEL; ELECTRIC OR HYDRAULIC                         0         0
  ROD AND REEL                                        0         0
  ROD AND REEL; ELECTRIC (HAND)                       0         0
  SPEARS                                              0         0
  SPEARS; DIVING                                      0         0
                               
                                POTS AND TRAPS, FISH
  BY HAND; DIVING GEAR                             0
  DIP NETS                                         0
  ENCIRCLING NETS (PURSE)                          0
  ENTANGLING NETS (GILL) UNSPC                     0
  GILL NETS; OTHER                                 0
  GRABS; HOOKS                                     0
  HAUL SEINES                                      0
  HOOKS; SPONGE                                    0
  LINES HAND                                      26
  LINES LONG SET WITH HOOKS                        0
  LINES LONG; REEF FISH                            0
  LINES POWER TROLL OTHER                          0
  NOT CODED                                        0
  POTS AND TRAPS; BOX TRAP                         0
  POTS AND TRAPS; CMB                              6
  POTS AND TRAPS; FISH                           110
  POTS AND TRAPS; SPINY LOBSTER                    0
  REEL; ELECTRIC OR HYDRAULIC                      0
  ROD AND REEL                                     0
  ROD AND REEL; ELECTRIC (HAND)                    0
  SPEARS                                           0
  SPEARS; DIVING                                   0
                               
                                POTS AND TRAPS, SPINY LOBSTER
  BY HAND; DIVING GEAR                                      0
  DIP NETS                                                  0
  ENCIRCLING NETS (PURSE)                                   0
  ENTANGLING NETS (GILL) UNSPC                              0
  GILL NETS; OTHER                                          0
  GRABS; HOOKS                                              0
  HAUL SEINES                                               0
  HOOKS; SPONGE                                             0
  LINES HAND                                                0
  LINES LONG SET WITH HOOKS                                 0
  LINES LONG; REEF FISH                                     0
  LINES POWER TROLL OTHER                                   0
  NOT CODED                                                 0
  POTS AND TRAPS; BOX TRAP                                  0
  POTS AND TRAPS; CMB                                       7
  POTS AND TRAPS; FISH                                     66
  POTS AND TRAPS; SPINY LOBSTER                            19
  REEL; ELECTRIC OR HYDRAULIC                               0
  ROD AND REEL                                              0
  ROD AND REEL; ELECTRIC (HAND)                             0
  SPEARS                                                    0
  SPEARS; DIVING                                            0
                               
                                REEL, ELECTRIC OR HYDRAULIC ROD AND REEL
  BY HAND; DIVING GEAR                                    0            0
  DIP NETS                                                0            0
  ENCIRCLING NETS (PURSE)                                 0            0
  ENTANGLING NETS (GILL) UNSPC                            0            0
  GILL NETS; OTHER                                        0            0
  GRABS; HOOKS                                            0            0
  HAUL SEINES                                             0            0
  HOOKS; SPONGE                                           0            0
  LINES HAND                                              0            5
  LINES LONG SET WITH HOOKS                               0            0
  LINES LONG; REEF FISH                                   0            0
  LINES POWER TROLL OTHER                                 0            0
  NOT CODED                                               0            0
  POTS AND TRAPS; BOX TRAP                                0            0
  POTS AND TRAPS; CMB                                     0            0
  POTS AND TRAPS; FISH                                    1            0
  POTS AND TRAPS; SPINY LOBSTER                           0            0
  REEL; ELECTRIC OR HYDRAULIC                             0            0
  ROD AND REEL                                            0            2
  ROD AND REEL; ELECTRIC (HAND)                           0            0
  SPEARS                                                  0            0
  SPEARS; DIVING                                          0            0</code></pre>
</div>
</div>
</section>
<section id="add-gear-groupings-no-length-length-conversions-available" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="add-gear-groupings-no-length-length-conversions-available">Add gear groupings, NO length-length conversions available</h4>
<div class="cell column-page">
<div class="cell-output cell-output-stdout">
<pre><code>                               
                                Hook and Line   Net Other  Trap  &lt;NA&gt;
  BY HAND; DIVING GEAR                      0     0     1     0     0
  DIP NETS                                  0     0   109     0     0
  ENCIRCLING NETS (PURSE)                   0   363     0     0     0
  ENTANGLING NETS (GILL) UNSPC              0    48     0     0     0
  GILL NETS; OTHER                          0    20     0     0     0
  GRABS; HOOKS                              0     0     1     0     0
  HAUL SEINES                               0   556     0     0     0
  HOOKS; SPONGE                             0     0    38     0     0
  LINES HAND                            15276     0     0     0     0
  LINES LONG SET WITH HOOKS                 0     0     4     0     0
  LINES LONG; REEF FISH                     0     0   109     0     0
  LINES POWER TROLL OTHER                 544     0     0     0     0
  NOT CODED                                 0     0    20     0     0
  POTS AND TRAPS; BOX TRAP                  0     0     0     6     0
  POTS AND TRAPS; CMB                       0     0     0    78     0
  POTS AND TRAPS; FISH                      0     0     0  2148     0
  POTS AND TRAPS; SPINY LOBSTER             0     0     0    64     0
  REEL; ELECTRIC OR HYDRAULIC             139     0     0     0     0
  ROD AND REEL                            361     0     0     0     0
  ROD AND REEL; ELECTRIC (HAND)           124     0     0     0     0
  SPEARS                                    0     0     1     0     0
  SPEARS; DIVING                            0     0     1     0     0
  &lt;NA&gt;                                      0     0     0     0     0</code></pre>
</div>
</div>
<div class="cell column-page">

</div>
</section>
</section>
</section>
<section id="filtration-level-investigation" class="level1">
<h1>Filtration level investigation</h1>
<section id="unique-trip-id-vs-gear-by-year-investigation" class="level2">
<h2 class="anchored" data-anchor-id="unique-trip-id-vs-gear-by-year-investigation">Unique trip ID vs gear by year investigation</h2>
<section id="how-many-unique-trip-ids-per-year" class="level4">
<h4 class="anchored" data-anchor-id="how-many-unique-trip-ids-per-year">How many unique trip IDâ€™s per year?</h4>
<p>Group by year, count unique trip idâ€™s</p>
<p>When we remove data from years with less than 10 unique trip IDâ€™s, we are left with 24 years of data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_tripcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR n_distinct(ID)
1  1983              8
2  1984             71
3  1985             70
4  1986             16
5  1987              7
6  1988              1
7  1991              2
8  1992             23
9  1993             36
10 1994             11
11 1995             12
12 1996             10
13 2002             10
14 2003              2
15 2004              4
16 2005             12
17 2006             28
18 2008              3
19 2009             54
20 2010            137
21 2011            106
22 2012             64
23 2013             20
24 2014              3
25 2015              1
26 2016             53
27 2017             72
28 2018             65
29 2019             62
30 2020             11
31 2021             21
32 2022             25
33 2023             42</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>length_data_trip30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(ID) <span class="sc">&gt;=</span> <span class="dv">10</span>)<span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_trip30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR n_distinct(ID)
1  1984             71
2  1985             70
3  1986             16
4  1992             23
5  1993             36
6  1994             11
7  1995             12
8  1996             10
9  2002             10
10 2005             12
11 2006             28
12 2009             54
13 2010            137
14 2011            106
15 2012             64
16 2013             20
17 2016             53
18 2017             72
19 2018             65
20 2019             62
21 2020             11
22 2021             21
23 2022             25
24 2023             42</code></pre>
</div>
</div>
</section>
</section>
<section id="unique-length-records-per-gear-per-year" class="level2">
<h2 class="anchored" data-anchor-id="unique-length-records-per-gear-per-year">Unique length records per gear per year</h2>
<section id="how-many-length-records-per-gear-per-year" class="level3">
<h3 class="anchored" data-anchor-id="how-many-length-records-per-gear-per-year">How many length records per gear per year?</h3>
<p>Group by year, count occurrences of each gear</p>
<p>There are years when individual gears occur less than 30 times but when grouped, the gear groups exceed 30 occurrences per year. Do we want to rely on gear groups with larger than 30 occurrences per year or individual gears with more than 30 occurrences?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur each year</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>length_data_gearcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gearcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    YEAR       LAND_STANDARD_GEAR_NAME count
1   1983                    LINES HAND   102
2   1983                     NOT CODED     2
3   1983          POTS AND TRAPS; FISH    45
4   1984                      DIP NETS   109
5   1984                  GRABS; HOOKS     1
6   1984                 HOOKS; SPONGE    38
7   1984                    LINES HAND   273
8   1984          POTS AND TRAPS; FISH   214
9   1984 POTS AND TRAPS; SPINY LOBSTER     6
10  1985  ENTANGLING NETS (GILL) UNSPC    48
11  1985                    LINES HAND   181
12  1985         LINES LONG; REEF FISH   109
13  1985       LINES POWER TROLL OTHER   464
14  1985           POTS AND TRAPS; CMB    15
15  1985          POTS AND TRAPS; FISH   204
16  1986       LINES POWER TROLL OTHER    80
17  1986          POTS AND TRAPS; FISH    64
18  1987          POTS AND TRAPS; FISH    12
19  1988          POTS AND TRAPS; FISH     4
20  1991          POTS AND TRAPS; FISH     4
21  1992       ENCIRCLING NETS (PURSE)   127
22  1992                    LINES HAND   110
23  1992          POTS AND TRAPS; FISH    46
24  1993       ENCIRCLING NETS (PURSE)   126
25  1993                    LINES HAND   151
26  1993           POTS AND TRAPS; CMB     1
27  1993          POTS AND TRAPS; FISH    57
28  1994       ENCIRCLING NETS (PURSE)     1
29  1994                    LINES HAND   152
30  1994          POTS AND TRAPS; FISH    19
31  1994 POTS AND TRAPS; SPINY LOBSTER     3
32  1995       ENCIRCLING NETS (PURSE)    13
33  1995                    LINES HAND   172
34  1995           POTS AND TRAPS; CMB     3
35  1995          POTS AND TRAPS; FISH    26
36  1995 POTS AND TRAPS; SPINY LOBSTER     7
37  1996                    LINES HAND   182
38  1996          POTS AND TRAPS; FISH     6
39  2002                    LINES HAND    37
40  2002           POTS AND TRAPS; CMB     8
41  2002          POTS AND TRAPS; FISH    24
42  2003          POTS AND TRAPS; FISH     3
43  2004      POTS AND TRAPS; BOX TRAP     6
44  2005                    LINES HAND   335
45  2005          POTS AND TRAPS; FISH     8
46  2005 POTS AND TRAPS; SPINY LOBSTER    15
47  2006                   HAUL SEINES   182
48  2006                    LINES HAND   944
49  2006     LINES LONG SET WITH HOOKS     4
50  2006           POTS AND TRAPS; CMB     7
51  2006          POTS AND TRAPS; FISH    31
52  2008           POTS AND TRAPS; CMB     4
53  2008          POTS AND TRAPS; FISH     3
54  2009       ENCIRCLING NETS (PURSE)    30
55  2009                    LINES HAND   962
56  2009           POTS AND TRAPS; CMB    30
57  2009          POTS AND TRAPS; FISH   166
58  2010       ENCIRCLING NETS (PURSE)    66
59  2010                   HAUL SEINES   292
60  2010                    LINES HAND  2033
61  2010           POTS AND TRAPS; CMB     6
62  2010          POTS AND TRAPS; FISH   189
63  2010                  ROD AND REEL    18
64  2010                        SPEARS     1
65  2011                   HAUL SEINES     1
66  2011                    LINES HAND  1765
67  2011                     NOT CODED    13
68  2011           POTS AND TRAPS; CMB     1
69  2011          POTS AND TRAPS; FISH   130
70  2011 POTS AND TRAPS; SPINY LOBSTER     4
71  2011                  ROD AND REEL    13
72  2012                   HAUL SEINES     3
73  2012                    LINES HAND   888
74  2012          POTS AND TRAPS; FISH   137
75  2012                  ROD AND REEL     6
76  2013                    LINES HAND   197
77  2013          POTS AND TRAPS; FISH    20
78  2013 POTS AND TRAPS; SPINY LOBSTER     4
79  2014                    LINES HAND    47
80  2014          POTS AND TRAPS; FISH     2
81  2015          POTS AND TRAPS; FISH    12
82  2016                    LINES HAND   653
83  2016          POTS AND TRAPS; FISH    92
84  2016 POTS AND TRAPS; SPINY LOBSTER     1
85  2016   REEL; ELECTRIC OR HYDRAULIC     6
86  2016                  ROD AND REEL    49
87  2017                   HAUL SEINES    69
88  2017                    LINES HAND  1292
89  2017          POTS AND TRAPS; FISH   210
90  2017 POTS AND TRAPS; SPINY LOBSTER     1
91  2017                  ROD AND REEL    17
92  2018                   HAUL SEINES     7
93  2018                    LINES HAND  1616
94  2018           POTS AND TRAPS; CMB     2
95  2018          POTS AND TRAPS; FISH   102
96  2018                  ROD AND REEL     3
97  2019                   HAUL SEINES     2
98  2019                    LINES HAND  1865
99  2019          POTS AND TRAPS; FISH   136
100 2019                  ROD AND REEL    38
101 2019 ROD AND REEL; ELECTRIC (HAND)    20
102 2020                    LINES HAND   149
103 2020           POTS AND TRAPS; CMB     1
104 2020          POTS AND TRAPS; FISH    19
105 2020                  ROD AND REEL     4
106 2021          BY HAND; DIVING GEAR     1
107 2021                    LINES HAND   260
108 2021          POTS AND TRAPS; FISH     5
109 2021   REEL; ELECTRIC OR HYDRAULIC    48
110 2021                  ROD AND REEL    57
111 2022                    LINES HAND   386
112 2022          POTS AND TRAPS; FISH    43
113 2022 POTS AND TRAPS; SPINY LOBSTER     2
114 2022   REEL; ELECTRIC OR HYDRAULIC    85
115 2023                    LINES HAND   492
116 2023          POTS AND TRAPS; FISH    51
117 2023 POTS AND TRAPS; SPINY LOBSTER    21
118 2023                  ROD AND REEL   156
119 2023 ROD AND REEL; ELECTRIC (HAND)   104
120 2023                SPEARS; DIVING     1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur 30 or more times each year</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>length_data_gear30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR       LAND_STANDARD_GEAR_NAME count
1  1983                    LINES HAND   102
2  1983          POTS AND TRAPS; FISH    45
3  1984                      DIP NETS   109
4  1984                 HOOKS; SPONGE    38
5  1984                    LINES HAND   273
6  1984          POTS AND TRAPS; FISH   214
7  1985  ENTANGLING NETS (GILL) UNSPC    48
8  1985                    LINES HAND   181
9  1985         LINES LONG; REEF FISH   109
10 1985       LINES POWER TROLL OTHER   464
11 1985          POTS AND TRAPS; FISH   204
12 1986       LINES POWER TROLL OTHER    80
13 1986          POTS AND TRAPS; FISH    64
14 1992       ENCIRCLING NETS (PURSE)   127
15 1992                    LINES HAND   110
16 1992          POTS AND TRAPS; FISH    46
17 1993       ENCIRCLING NETS (PURSE)   126
18 1993                    LINES HAND   151
19 1993          POTS AND TRAPS; FISH    57
20 1994                    LINES HAND   152
21 1995                    LINES HAND   172
22 1996                    LINES HAND   182
23 2002                    LINES HAND    37
24 2005                    LINES HAND   335
25 2006                   HAUL SEINES   182
26 2006                    LINES HAND   944
27 2006          POTS AND TRAPS; FISH    31
28 2009       ENCIRCLING NETS (PURSE)    30
29 2009                    LINES HAND   962
30 2009           POTS AND TRAPS; CMB    30
31 2009          POTS AND TRAPS; FISH   166
32 2010       ENCIRCLING NETS (PURSE)    66
33 2010                   HAUL SEINES   292
34 2010                    LINES HAND  2033
35 2010          POTS AND TRAPS; FISH   189
36 2011                    LINES HAND  1765
37 2011          POTS AND TRAPS; FISH   130
38 2012                    LINES HAND   888
39 2012          POTS AND TRAPS; FISH   137
40 2013                    LINES HAND   197
41 2014                    LINES HAND    47
42 2016                    LINES HAND   653
43 2016          POTS AND TRAPS; FISH    92
44 2016                  ROD AND REEL    49
45 2017                   HAUL SEINES    69
46 2017                    LINES HAND  1292
47 2017          POTS AND TRAPS; FISH   210
48 2018                    LINES HAND  1616
49 2018          POTS AND TRAPS; FISH   102
50 2019                    LINES HAND  1865
51 2019          POTS AND TRAPS; FISH   136
52 2019                  ROD AND REEL    38
53 2020                    LINES HAND   149
54 2021                    LINES HAND   260
55 2021   REEL; ELECTRIC OR HYDRAULIC    48
56 2021                  ROD AND REEL    57
57 2022                    LINES HAND   386
58 2022          POTS AND TRAPS; FISH    43
59 2022   REEL; ELECTRIC OR HYDRAULIC    85
60 2023                    LINES HAND   492
61 2023          POTS AND TRAPS; FISH    51
62 2023                  ROD AND REEL   156
63 2023 ROD AND REEL; ELECTRIC (HAND)   104</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group gears that occur 30 or more times per year by gear grouping </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>length_data_geartogether30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geartogether30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR          gear count
1  1983 Hook and Line   102
2  1983          Trap    45
3  1984 Hook and Line   273
4  1984         Other   147
5  1984          Trap   214
6  1985 Hook and Line   645
7  1985           Net    48
8  1985         Other   109
9  1985          Trap   204
10 1986 Hook and Line    80
11 1986          Trap    64
12 1992 Hook and Line   110
13 1992           Net   127
14 1992          Trap    46
15 1993 Hook and Line   151
16 1993           Net   126
17 1993          Trap    57
18 1994 Hook and Line   152
19 1995 Hook and Line   172
20 1996 Hook and Line   182
21 2002 Hook and Line    37
22 2005 Hook and Line   335
23 2006 Hook and Line   944
24 2006           Net   182
25 2006          Trap    31
26 2009 Hook and Line   962
27 2009           Net    30
28 2009          Trap   196
29 2010 Hook and Line  2033
30 2010           Net   358
31 2010          Trap   189
32 2011 Hook and Line  1765
33 2011          Trap   130
34 2012 Hook and Line   888
35 2012          Trap   137
36 2013 Hook and Line   197
37 2014 Hook and Line    47
38 2016 Hook and Line   702
39 2016          Trap    92
40 2017 Hook and Line  1292
41 2017           Net    69
42 2017          Trap   210
43 2018 Hook and Line  1616
44 2018          Trap   102
45 2019 Hook and Line  1903
46 2019          Trap   136
47 2020 Hook and Line   149
48 2021 Hook and Line   365
49 2022 Hook and Line   471
50 2022          Trap    43
51 2023 Hook and Line   752
52 2023          Trap    51</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by specific gear per year</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 26 years of data available </span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geartogether30<span class="sc">$</span>YEAR, length_data_geartogether30<span class="sc">$</span>gear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       Hook and Line Net Other Trap
  1983             1   0     0    1
  1984             1   0     1    1
  1985             1   1     1    1
  1986             1   0     0    1
  1992             1   1     0    1
  1993             1   1     0    1
  1994             1   0     0    0
  1995             1   0     0    0
  1996             1   0     0    0
  2002             1   0     0    0
  2005             1   0     0    0
  2006             1   1     0    1
  2009             1   1     0    1
  2010             1   1     0    1
  2011             1   0     0    1
  2012             1   0     0    1
  2013             1   0     0    0
  2014             1   0     0    0
  2016             1   0     0    1
  2017             1   1     0    1
  2018             1   0     0    1
  2019             1   0     0    1
  2020             1   0     0    0
  2021             1   0     0    0
  2022             1   0     0    1
  2023             1   0     0    1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur each year</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>length_data_geargroupcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroupcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR          gear count
1  1983 Hook and Line   102
2  1983         Other     2
3  1983          Trap    45
4  1984 Hook and Line   273
5  1984         Other   148
6  1984          Trap   220
7  1985 Hook and Line   645
8  1985           Net    48
9  1985         Other   109
10 1985          Trap   219
11 1986 Hook and Line    80
12 1986          Trap    64
13 1987          Trap    12
14 1988          Trap     4
15 1991          Trap     4
16 1992 Hook and Line   110
17 1992           Net   127
18 1992          Trap    46
19 1993 Hook and Line   151
20 1993           Net   126
21 1993          Trap    58
22 1994 Hook and Line   152
23 1994           Net     1
24 1994          Trap    22
25 1995 Hook and Line   172
26 1995           Net    13
27 1995          Trap    36
28 1996 Hook and Line   182
29 1996          Trap     6
30 2002 Hook and Line    37
31 2002          Trap    32
32 2003          Trap     3
33 2004          Trap     6
34 2005 Hook and Line   335
35 2005          Trap    23
36 2006 Hook and Line   944
37 2006           Net   182
38 2006         Other     4
39 2006          Trap    38
40 2008          Trap     7
41 2009 Hook and Line   962
42 2009           Net    30
43 2009          Trap   196
44 2010 Hook and Line  2051
45 2010           Net   358
46 2010         Other     1
47 2010          Trap   195
48 2011 Hook and Line  1778
49 2011           Net     1
50 2011         Other    13
51 2011          Trap   135
52 2012 Hook and Line   894
53 2012           Net     3
54 2012          Trap   137
55 2013 Hook and Line   197
56 2013          Trap    24
57 2014 Hook and Line    47
58 2014          Trap     2
59 2015          Trap    12
60 2016 Hook and Line   708
61 2016          Trap    93
62 2017 Hook and Line  1309
63 2017           Net    69
64 2017          Trap   211
65 2018 Hook and Line  1619
66 2018           Net     7
67 2018          Trap   104
68 2019 Hook and Line  1923
69 2019           Net     2
70 2019          Trap   136
71 2020 Hook and Line   153
72 2020          Trap    20
73 2021 Hook and Line   365
74 2021         Other     1
75 2021          Trap     5
76 2022 Hook and Line   471
77 2022          Trap    45
78 2023 Hook and Line   752
79 2023         Other     1
80 2023          Trap    72</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur 30 or more times each year</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>length_data_geargroup30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR          gear count
1  1983 Hook and Line   102
2  1983          Trap    45
3  1984 Hook and Line   273
4  1984         Other   148
5  1984          Trap   220
6  1985 Hook and Line   645
7  1985           Net    48
8  1985         Other   109
9  1985          Trap   219
10 1986 Hook and Line    80
11 1986          Trap    64
12 1992 Hook and Line   110
13 1992           Net   127
14 1992          Trap    46
15 1993 Hook and Line   151
16 1993           Net   126
17 1993          Trap    58
18 1994 Hook and Line   152
19 1995 Hook and Line   172
20 1995          Trap    36
21 1996 Hook and Line   182
22 2002 Hook and Line    37
23 2002          Trap    32
24 2005 Hook and Line   335
25 2006 Hook and Line   944
26 2006           Net   182
27 2006          Trap    38
28 2009 Hook and Line   962
29 2009           Net    30
30 2009          Trap   196
31 2010 Hook and Line  2051
32 2010           Net   358
33 2010          Trap   195
34 2011 Hook and Line  1778
35 2011          Trap   135
36 2012 Hook and Line   894
37 2012          Trap   137
38 2013 Hook and Line   197
39 2014 Hook and Line    47
40 2016 Hook and Line   708
41 2016          Trap    93
42 2017 Hook and Line  1309
43 2017           Net    69
44 2017          Trap   211
45 2018 Hook and Line  1619
46 2018          Trap   104
47 2019 Hook and Line  1923
48 2019          Trap   136
49 2020 Hook and Line   153
50 2021 Hook and Line   365
51 2022 Hook and Line   471
52 2022          Trap    45
53 2023 Hook and Line   752
54 2023          Trap    72</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by gear grouping per year</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 26 years of data available </span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geargroup30<span class="sc">$</span>YEAR, length_data_geargroup30<span class="sc">$</span>gear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       Hook and Line Net Other Trap
  1983             1   0     0    1
  1984             1   0     1    1
  1985             1   1     1    1
  1986             1   0     0    1
  1992             1   1     0    1
  1993             1   1     0    1
  1994             1   0     0    0
  1995             1   0     0    1
  1996             1   0     0    0
  2002             1   0     0    1
  2005             1   0     0    0
  2006             1   1     0    1
  2009             1   1     0    1
  2010             1   1     0    1
  2011             1   0     0    1
  2012             1   0     0    1
  2013             1   0     0    0
  2014             1   0     0    0
  2016             1   0     0    1
  2017             1   1     0    1
  2018             1   0     0    1
  2019             1   0     0    1
  2020             1   0     0    0
  2021             1   0     0    0
  2022             1   0     0    1
  2023             1   0     0    1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by individual gears </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>length_data_gear29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear29)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR       LAND_STANDARD_GEAR_NAME count
1  1983                     NOT CODED     2
2  1984                  GRABS; HOOKS     1
3  1984 POTS AND TRAPS; SPINY LOBSTER     6
4  1985           POTS AND TRAPS; CMB    15
5  1987          POTS AND TRAPS; FISH    12
6  1988          POTS AND TRAPS; FISH     4
7  1991          POTS AND TRAPS; FISH     4
8  1993           POTS AND TRAPS; CMB     1
9  1994       ENCIRCLING NETS (PURSE)     1
10 1994          POTS AND TRAPS; FISH    19
11 1994 POTS AND TRAPS; SPINY LOBSTER     3
12 1995       ENCIRCLING NETS (PURSE)    13
13 1995           POTS AND TRAPS; CMB     3
14 1995          POTS AND TRAPS; FISH    26
15 1995 POTS AND TRAPS; SPINY LOBSTER     7
16 1996          POTS AND TRAPS; FISH     6
17 2002           POTS AND TRAPS; CMB     8
18 2002          POTS AND TRAPS; FISH    24
19 2003          POTS AND TRAPS; FISH     3
20 2004      POTS AND TRAPS; BOX TRAP     6
21 2005          POTS AND TRAPS; FISH     8
22 2005 POTS AND TRAPS; SPINY LOBSTER    15
23 2006     LINES LONG SET WITH HOOKS     4
24 2006           POTS AND TRAPS; CMB     7
25 2008           POTS AND TRAPS; CMB     4
26 2008          POTS AND TRAPS; FISH     3
27 2010           POTS AND TRAPS; CMB     6
28 2010                  ROD AND REEL    18
29 2010                        SPEARS     1
30 2011                   HAUL SEINES     1
31 2011                     NOT CODED    13
32 2011           POTS AND TRAPS; CMB     1
33 2011 POTS AND TRAPS; SPINY LOBSTER     4
34 2011                  ROD AND REEL    13
35 2012                   HAUL SEINES     3
36 2012                  ROD AND REEL     6
37 2013          POTS AND TRAPS; FISH    20
38 2013 POTS AND TRAPS; SPINY LOBSTER     4
39 2014          POTS AND TRAPS; FISH     2
40 2015          POTS AND TRAPS; FISH    12
41 2016 POTS AND TRAPS; SPINY LOBSTER     1
42 2016   REEL; ELECTRIC OR HYDRAULIC     6
43 2017 POTS AND TRAPS; SPINY LOBSTER     1
44 2017                  ROD AND REEL    17
45 2018                   HAUL SEINES     7
46 2018           POTS AND TRAPS; CMB     2
47 2018                  ROD AND REEL     3
48 2019                   HAUL SEINES     2
49 2019 ROD AND REEL; ELECTRIC (HAND)    20
50 2020           POTS AND TRAPS; CMB     1
51 2020          POTS AND TRAPS; FISH    19
52 2020                  ROD AND REEL     4
53 2021          BY HAND; DIVING GEAR     1
54 2021          POTS AND TRAPS; FISH     5
55 2022 POTS AND TRAPS; SPINY LOBSTER     2
56 2023 POTS AND TRAPS; SPINY LOBSTER    21
57 2023                SPEARS; DIVING     1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># VS </span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by gear groups </span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>length_data_geargroup29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup29)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR  gear count
1  1983 Other     2
2  1987  Trap    12
3  1988  Trap     4
4  1991  Trap     4
5  1994   Net     1
6  1994  Trap    22
7  1995   Net    13
8  1996  Trap     6
9  2003  Trap     3
10 2004  Trap     6
11 2005  Trap    23
12 2006 Other     4
13 2008  Trap     7
14 2010 Other     1
15 2011   Net     1
16 2011 Other    13
17 2012   Net     3
18 2013  Trap    24
19 2014  Trap     2
20 2015  Trap    12
21 2018   Net     7
22 2019   Net     2
23 2020  Trap    20
24 2021 Other     1
25 2021  Trap     5
26 2023 Other     1</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="glm-analysis" class="level1 page-columns page-full">
<h1>GLM analysis</h1>
<p>No filtering based on number of trips/fish per year yet, analysis of all available data.</p>
<p>123 records removed due to not being measured in fork length:</p>
<p>20 GILL NETS; OTHER</p>
<p>5 NOT CODED</p>
<p>32 LINES HAND</p>
<p>66 POTS AND TRAPS; FISH</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(length_data_final<span class="sc">$</span>gear) <span class="co"># "Hook and Line", "Trap", "Other", "Net"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Other"         "Net"           "Hook and Line" "Trap"         </code></pre>
</div>
</div>
<section id="hook-and-line" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="hook-and-line">Hook and Line</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-screen-inset">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_hookline_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-screen-inset">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_hookline_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-screen-inset">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_hookline_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_hl, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                        Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
scale(FINAL_DATE)       558.58  558.58     1  61.34 27.5380 2.028e-06 ***
LAND_STANDARD_GEAR_NAME 427.81  106.95     4 321.73  5.2727 0.0003993 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  9 97399.60
mod2    9 94348.12</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line gear p value is significant </span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_hl
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
mod3    5 94365 94404 -47178    94355                         
mod2    9 94348 94417 -47165    94330 25.098  4  4.808e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line date p value is significant </span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_hl
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
mod4    8 94360 94422 -47172    94344                        
mod2    9 94348 94417 -47165    94330 14.27  1  0.0001584 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="do">### lines hand vs rod and reel and lines power troll other vs rod and reel are signifficantly different </span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>mod_contr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 LAND_STANDARD_GEAR_NAME       emmean     SE  df asymp.LCL asymp.UCL
 LINES HAND                      3.45 0.0133 Inf      3.42      3.48
 LINES POWER TROLL OTHER         3.41 0.0522 Inf      3.30      3.51
 REEL; ELECTRIC OR HYDRAULIC     3.54 0.0737 Inf      3.40      3.69
 ROD AND REEL                    3.59 0.0290 Inf      3.53      3.65
 ROD AND REEL; ELECTRIC (HAND)   3.47 0.0666 Inf      3.34      3.60

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 

$contrasts
 contrast                                                    estimate     SE
 LINES HAND - LINES POWER TROLL OTHER                          0.0428 0.0527
 LINES HAND - REEL; ELECTRIC OR HYDRAULIC                     -0.0911 0.0738
 LINES HAND - ROD AND REEL                                    -0.1420 0.0288
 LINES HAND - ROD AND REEL; ELECTRIC (HAND)                   -0.0170 0.0662
 LINES POWER TROLL OTHER - REEL; ELECTRIC OR HYDRAULIC        -0.1338 0.0915
 LINES POWER TROLL OTHER - ROD AND REEL                       -0.1848 0.0608
 LINES POWER TROLL OTHER - ROD AND REEL; ELECTRIC (HAND)      -0.0597 0.0850
 REEL; ELECTRIC OR HYDRAULIC - ROD AND REEL                   -0.0510 0.0781
 REEL; ELECTRIC OR HYDRAULIC - ROD AND REEL; ELECTRIC (HAND)   0.0741 0.0987
 ROD AND REEL - ROD AND REEL; ELECTRIC (HAND)                  0.1251 0.0704
  df z.ratio p.value
 Inf   0.811  0.9273
 Inf  -1.234  0.7316
 Inf  -4.926  &lt;.0001
 Inf  -0.256  0.9991
 Inf  -1.462  0.5872
 Inf  -3.037  0.0202
 Inf  -0.703  0.9560
 Inf  -0.652  0.9663
 Inf   0.751  0.9444
 Inf   1.777  0.3873

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 5 estimates </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="do">### suggestion: "lines power troll other", "lines hand" "rod and reel electric" and "reel electric or hydroulic" be grouped together</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="do">### "rod and reel" be kept separate </span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME       emmean     SE  df asymp.LCL asymp.UCL .group
 LINES POWER TROLL OTHER         3.41 0.0522 Inf      3.30      3.51  1    
 LINES HAND                      3.45 0.0133 Inf      3.42      3.48  1    
 ROD AND REEL; ELECTRIC (HAND)   3.47 0.0666 Inf      3.34      3.60  12   
 REEL; ELECTRIC OR HYDRAULIC     3.54 0.0737 Inf      3.40      3.69  12   
 ROD AND REEL                    3.59 0.0290 Inf      3.53      3.65   2   

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 5 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</section>
<section id="net" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="net">Net</h2>
<p>â€œGILL NETS; OTHERâ€ not included because all 20 records are measured in standard length, i didnâ€™t have a conversion for that</p>
<p>Adyan - The â€œGILL NETS: GL 1-2 INâ€ AND â€œGILL NETS: GL 2-4 INâ€ records we were thinking of are in STX, Iâ€™ll highlight those in the stx_yts document tomorrow.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_netstd_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_netstd_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_netstd_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="do">### both fixed linear and glm models have warning message because ENTANGLING NETS (GILL) UNSPECIFIED only occur in one year, preventing convergence across timeline </span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_nlsg, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                        Sum Sq Mean Sq NumDF  DenDF F value  Pr(&gt;F)  
scale(FINAL_DATE)       56.667  56.667     1 47.194  2.8882 0.09581 .
LAND_STANDARD_GEAR_NAME 30.189  15.095     2 44.851  0.7694 0.46933  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log)) </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  7 5780.378
mod2    7 5584.267</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="do">### net (using LAND_STANDARD_GEAR_NAME) does not have any significantly different gears </span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_nlsg
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod3    5 5580.4 5604.8 -2785.2   5570.4                     
mod2    7 5584.3 5618.4 -2785.1   5570.3 0.1426  2     0.9312</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="do">### There is no significantly different time in the Net grouping </span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_nlsg
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod4    6 5583.4 5612.6 -2785.7   5571.4                     
mod2    7 5584.3 5618.4 -2785.1   5570.3 1.0955  1     0.2953</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="do">### no significant p values for time period or gears, further comparisons not needed </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell column-page">

</div>
<div class="cell column-page">

</div>
</section>
<section id="trap" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="trap">Trap</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_trap_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_trap_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_trap_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_tr, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                        Sum Sq Mean Sq NumDF  DenDF F value  Pr(&gt;F)  
scale(FINAL_DATE)       40.959  40.959     1 474.43  4.7854 0.02919 *
LAND_STANDARD_GEAR_NAME 24.781   8.260     3 536.62  0.9651 0.40888  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  8 11813.57
mod2    8 11203.24</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="do">### Trap does not have any significantly different gears </span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_tr
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod3    5 11199 11227 -5594.3    11189                     
mod2    8 11203 11249 -5593.6    11187 1.3628  3     0.7143</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="do">### There is no significantly different time in the Trap grouping </span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_tr
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod4    7 11203 11243 -5594.4    11189                     
mod2    8 11203 11249 -5593.6    11187 1.4656  1      0.226</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No significant p values for time period or gears, further comparisons not needed </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="gear-density-plots" class="level1 page-columns page-full">
<h1>Gear Density Plots</h1>
<p>Filtered to years with 30 or more length records (regardless of gear) per year. STT and STJ records are grouped together.</p>
<section id="aggregated-density-plots" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="aggregated-density-plots">Aggregated density plots</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/agg_pdf_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>USVI TIP length comps by gear and interview type. Investigate if MARFIN and MRAG interview types can be used or should be dropped?</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="gear-grouping-investigation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="gear-grouping-investigation">Gear grouping investigation</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_hl_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_trap_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_net_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_other_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="break-at-2005" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="break-at-2005">Break at 2005</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_plot_2005-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_hookandline_plot_2005-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_net_plot_2005-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_trap_plot_2005-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_other_plot_2005-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="annual-density-plots" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="annual-density-plots">Annual Density plots</h2>
<p>This will be split by final gear aggregations once these are decided, removes â€œotherâ€ gear types.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/annual_pdf_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell column-page">
<div class="cell-output cell-output-stdout">
<pre><code>
  ST JOHN ST THOMAS 
      109     19781 </code></pre>
</div>
</div>
</section>
</section>
<section id="stacked-bar-charts" class="level1 page-columns page-full">
<h1>Stacked bar charts</h1>
<section id="visual-representation-of-gear-distribution-within-groupings" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="visual-representation-of-gear-distribution-within-groupings">Visual representation of gear distribution within groupings</h4>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_plot-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
</section>
<section id="gear-distribution-across-time-by-gear-groupings" class="level1 page-columns page-full">
<h1>Gear distribution across time by gear groupings</h1>
<section id="all-gears-over-time" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="all-gears-over-time">All gears over time</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="1440"></p>
<figcaption class="figure-caption">Stoplight Parrotfish LAND_STANDARD_GEAR_NAME STX</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="hook-and-line-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="hook-and-line-gear-distribution-over-time-by-year">Hook and Line Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_hl_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_hl_plot_range-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="trap-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="trap-gear-distribution-over-time-by-year">Trap Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_tr_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="diving-gear-distribution-over-time-by-year---no-gear-grouping" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="diving-gear-distribution-over-time-by-year---no-gear-grouping">Diving Gear Distribution Over Time by Year - NO GEAR GROUPING</h2>
<div class="cell column-page">

</div>
</section>
<section id="net-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="net-gear-distribution-over-time-by-year">Net Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_net_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="spear-gear-distribution-over-time-by-year---no-grouping" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="spear-gear-distribution-over-time-by-year---no-grouping">Spear Gear Distribution Over Time by Year - NO GROUPING</h2>
<div class="cell column-page">

</div>
</section>
<section id="other-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="other-gear-distribution-over-time-by-year">Other Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_ot_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
</section>
<section id="cummulative-density-plots" class="level1 page-columns page-full">
<h1>Cummulative Density Plots</h1>
<section id="aggregated-cdf" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="aggregated-cdf">Aggregated CDF</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/agg_cdf_plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="management-periods" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="management-periods">Management periods*</h2>
<p><strong>This section is optional and may be empty if there are not signifcant changes</strong></p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_cdf_plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="annual-cdf" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="annual-cdf">Annual CDF</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/annual_cdf_plot-1.png" class="img-fluid" width="864"></p>
</div>
</div>
</section>
</section>
<section id="island-density-plots" class="level1 page-columns page-full">
<h1>Island Density Plots</h1>
<section id="aggregated-density-plots-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="aggregated-density-plots-1">Aggregated density plots</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/agg_pdf_plot_reg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="management-periods-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="management-periods-1">Management periods*</h2>
<p><strong>This section is optional and may be empty if there are not significant changes</strong></p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_pdf_plot_reg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="annual-density-plots-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="annual-density-plots-1">Annual Density plots</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/annual_pdf_plot_reg-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<div class="cell column-page">

</div>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb95" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "sttj_yt_sedar84_sizecomp_landstdgearname"</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Katherine Godwin"</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="an">toc_expand:</span><span class="co"> true</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 4</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>This script will be expanding upon the length-comp script c1_nominal_len_comps.Rmd created by Molly Stevens.</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a><span class="fu"># Yellowtail Snapper STTJ</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up library </span></span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>librarian<span class="sc">::</span><span class="fu">shelf</span>(here, tidyverse, ROracle, keyring, dotenv, reshape, openxlsx, janitor, DT, pander, knitr) <span class="co">#plyr</span></span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a><span class="co"># if conflicts in pkgs arise, use the following:</span></span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a><span class="co"># library(conflicted)</span></span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a><span class="co"># conflicted::conflicts_prefer(here::here)</span></span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a><span class="co">#pull data by island</span></span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a><span class="co"># cr_tip(state_codes = c('PR', 'VI'))</span></span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find out the date of the most recent extraction</span></span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a>tip_date <span class="ot">&lt;-</span> <span class="fu">max</span>(</span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">".*?([0-9]+).RDS*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>,</span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">list.files</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"raw"</span>),</span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a>                             <span class="at">pattern =</span> <span class="st">"com_tip_PR_VI"</span>))))</span>
<span id="cb95-40"><a href="#cb95-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-41"><a href="#cb95-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out the name of the most recent extraction</span></span>
<span id="cb95-42"><a href="#cb95-42" aria-hidden="true" tabindex="-1"></a>tip_file <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"raw"</span>),</span>
<span id="cb95-43"><a href="#cb95-43" aria-hidden="true" tabindex="-1"></a>                       <span class="at">pattern =</span> <span class="fu">paste0</span>(<span class="st">"^com_tip_PR_VI_+"</span>, tip_date))</span>
<span id="cb95-44"><a href="#cb95-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-45"><a href="#cb95-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-46"><a href="#cb95-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the most recent extraction</span></span>
<span id="cb95-47"><a href="#cb95-47" aria-hidden="true" tabindex="-1"></a>tip <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"raw"</span>, tip_file))</span>
<span id="cb95-48"><a href="#cb95-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-49"><a href="#cb95-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to STTJ and Yellowtail Snapper AND create new filterable date value </span></span>
<span id="cb95-50"><a href="#cb95-50" aria-hidden="true" tabindex="-1"></a>sttj_yt <span class="ot">&lt;-</span> tip <span class="sc">|&gt;</span> </span>
<span id="cb95-51"><a href="#cb95-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COUNTY_LANDED <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"ST THOMAS"</span>, <span class="st">"ST JOHN"</span>),</span>
<span id="cb95-52"><a href="#cb95-52" aria-hidden="true" tabindex="-1"></a>         OBS_STANDARD_SPECIES_CODE <span class="sc">==</span> <span class="st">"168907"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb95-53"><a href="#cb95-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TEST_DATE =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(INTERVIEW_DATE)),</span>
<span id="cb95-54"><a href="#cb95-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">FINAL_DATE =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(TEST_DATE) <span class="sc">~</span> INTERVIEW_DATE, </span>
<span id="cb95-55"><a href="#cb95-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span> <span class="sc">~</span> TEST_DATE))</span>
<span id="cb95-56"><a href="#cb95-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-57"><a href="#cb95-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-58"><a href="#cb95-58" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/functions/len_len_convert.R"</span>)</span>
<span id="cb95-59"><a href="#cb95-59" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/functions/fig_format_export.R"</span>)</span>
<span id="cb95-60"><a href="#cb95-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-61"><a href="#cb95-61" aria-hidden="true" tabindex="-1"></a>LLconv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/CSVs/LLconversions.csv"</span>,</span>
<span id="cb95-62"><a href="#cb95-62" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb95-63"><a href="#cb95-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-64"><a href="#cb95-64" aria-hidden="true" tabindex="-1"></a>TIP_gears <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/CSVs/tip_gears_yts_sttj_landstdgearname.csv"</span>,</span>
<span id="cb95-65"><a href="#cb95-65" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb95-66"><a href="#cb95-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-67"><a href="#cb95-67" aria-hidden="true" tabindex="-1"></a>gearcols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Net"</span> <span class="ot">=</span> <span class="st">"#FF0000"</span>, <span class="st">"Trap"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"#5D057D"</span>, <span class="st">"Hook and Line"</span> <span class="ot">=</span><span class="st">"#046C9A"</span>, <span class="st">"Gill Net"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Haul Seine"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Lobster Trap"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Trammel Net"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Combined"</span> <span class="ot">=</span> <span class="st">"black"</span>)</span>
<span id="cb95-68"><a href="#cb95-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-69"><a href="#cb95-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-70"><a href="#cb95-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb95-71"><a href="#cb95-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-72"><a href="#cb95-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-73"><a href="#cb95-73" aria-hidden="true" tabindex="-1"></a><span class="fu">## Control Settings and Exploratory Frequency Tables</span></span>
<span id="cb95-74"><a href="#cb95-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-77"><a href="#cb95-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb95-78"><a href="#cb95-78" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-79"><a href="#cb95-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-80"><a href="#cb95-80" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="st">"YTS"</span></span>
<span id="cb95-81"><a href="#cb95-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-82"><a href="#cb95-82" aria-hidden="true" tabindex="-1"></a>region <span class="ot">&lt;-</span> <span class="st">"PUERTO RICO - USVI"</span></span>
<span id="cb95-83"><a href="#cb95-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-84"><a href="#cb95-84" aria-hidden="true" tabindex="-1"></a>county <span class="ot">&lt;-</span> <span class="st">"ST THOMAS/ST JOHN"</span></span>
<span id="cb95-85"><a href="#cb95-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-86"><a href="#cb95-86" aria-hidden="true" tabindex="-1"></a>bin_size <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb95-87"><a href="#cb95-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-88"><a href="#cb95-88" aria-hidden="true" tabindex="-1"></a>len_type <span class="ot">&lt;-</span> <span class="st">"FORK LENGTH"</span></span>
<span id="cb95-89"><a href="#cb95-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-90"><a href="#cb95-90" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LENGTH_TYPE1, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb95-91"><a href="#cb95-91" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LENGTH_TYPE2, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb95-92"><a href="#cb95-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-93"><a href="#cb95-93" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(sttj_yt<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-94"><a href="#cb95-94" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(sttj_yt<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-95"><a href="#cb95-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-96"><a href="#cb95-96" aria-hidden="true" tabindex="-1"></a>tip_range  <span class="ot">&lt;-</span> sttj_yt[<span class="fu">with</span>(sttj_yt,<span class="fu">order</span>(<span class="sc">-</span>LENGTH1_MM)),]</span>
<span id="cb95-97"><a href="#cb95-97" aria-hidden="true" tabindex="-1"></a>tip_range<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span>
<span id="cb95-98"><a href="#cb95-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-99"><a href="#cb95-99" aria-hidden="true" tabindex="-1"></a>tip_range2 <span class="ot">&lt;-</span> sttj_yt[<span class="fu">with</span>(sttj_yt,<span class="fu">order</span>(LENGTH1_MM)),]</span>
<span id="cb95-100"><a href="#cb95-100" aria-hidden="true" tabindex="-1"></a>tip_range2<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span>
<span id="cb95-101"><a href="#cb95-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-102"><a href="#cb95-102" aria-hidden="true" tabindex="-1"></a><span class="do">##range currently set to not drop any obs (centimeters)</span></span>
<span id="cb95-103"><a href="#cb95-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-104"><a href="#cb95-104" aria-hidden="true" tabindex="-1"></a>min_size <span class="ot">&lt;-</span> <span class="dv">14</span> </span>
<span id="cb95-105"><a href="#cb95-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-106"><a href="#cb95-106" aria-hidden="true" tabindex="-1"></a>max_size <span class="ot">&lt;-</span> <span class="dv">80</span>   </span>
<span id="cb95-107"><a href="#cb95-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-108"><a href="#cb95-108" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(sttj_yt<span class="sc">$</span>YEAR,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-109"><a href="#cb95-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-110"><a href="#cb95-110" aria-hidden="true" tabindex="-1"></a>min_year <span class="ot">&lt;-</span> <span class="dv">1983</span></span>
<span id="cb95-111"><a href="#cb95-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-112"><a href="#cb95-112" aria-hidden="true" tabindex="-1"></a>max_year <span class="ot">&lt;-</span> <span class="dv">2022</span> </span>
<span id="cb95-113"><a href="#cb95-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-114"><a href="#cb95-114" aria-hidden="true" tabindex="-1"></a>break_year <span class="ot">&lt;-</span> <span class="dv">2005</span> <span class="co"># this is an optional value to denote a change in management. inclusive on the upper bound. can be set to NA if not relevant.  2005 trap specifications were updated and many closures went into place</span></span>
<span id="cb95-115"><a href="#cb95-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-116"><a href="#cb95-116" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb95-117"><a href="#cb95-117" aria-hidden="true" tabindex="-1"></a><span class="do">##  TABLES START HERE </span></span>
<span id="cb95-118"><a href="#cb95-118" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb95-119"><a href="#cb95-119" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb95-120"><a href="#cb95-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-121"><a href="#cb95-121" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb95-122"><a href="#cb95-122" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, sttj_yt<span class="sc">$</span>STATE_LANDED, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb95-123"><a href="#cb95-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-124"><a href="#cb95-124" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>FISHING_MODE, sttj_yt<span class="sc">$</span>INT_TYPE, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb95-125"><a href="#cb95-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-126"><a href="#cb95-126" aria-hidden="true" tabindex="-1"></a><span class="co"># marfin &lt;- sttj_yt%&gt;%</span></span>
<span id="cb95-127"><a href="#cb95-127" aria-hidden="true" tabindex="-1"></a><span class="co">#             filter(INT_TYPE == "USVI MARFIN REEFFISH SAMPLING")</span></span>
<span id="cb95-128"><a href="#cb95-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-129"><a href="#cb95-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-130"><a href="#cb95-130" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>YEAR,sttj_yt<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb95-131"><a href="#cb95-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb95-132"><a href="#cb95-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-133"><a href="#cb95-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-136"><a href="#cb95-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb95-137"><a href="#cb95-137" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-138"><a href="#cb95-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-139"><a href="#cb95-139" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>COUNTY_LANDED,sttj_yt<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb95-140"><a href="#cb95-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-141"><a href="#cb95-141" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>YEAR,sttj_yt<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb95-142"><a href="#cb95-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-143"><a href="#cb95-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-144"><a href="#cb95-144" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Filter to Commercial samples</span></span>
<span id="cb95-145"><a href="#cb95-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-148"><a href="#cb95-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb95-149"><a href="#cb95-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-150"><a href="#cb95-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-151"><a href="#cb95-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-152"><a href="#cb95-152" aria-hidden="true" tabindex="-1"></a><span class="do">################## PICK VARIABLES THAT I NEED HERE ;</span></span>
<span id="cb95-153"><a href="#cb95-153" aria-hidden="true" tabindex="-1"></a><span class="do">################## ASSIGN GEARS, ETC. BASED ON FLOW CHART</span></span>
<span id="cb95-154"><a href="#cb95-154" aria-hidden="true" tabindex="-1"></a><span class="do">## FILTER OUT COMMERCIAL SAMPLES</span></span>
<span id="cb95-155"><a href="#cb95-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-156"><a href="#cb95-156" aria-hidden="true" tabindex="-1"></a>tip2 <span class="ot">&lt;-</span> <span class="co">#readRDS('./data_clean/tip_GOM.Rdata') %&gt;%</span></span>
<span id="cb95-157"><a href="#cb95-157" aria-hidden="true" tabindex="-1"></a>  sttj_yt <span class="sc">%&gt;%</span></span>
<span id="cb95-158"><a href="#cb95-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( <span class="co">#MULT_TRIP == '0')%&gt;%  ##no mult_trip in Caribbean TIP --&gt; ALL full catch samples</span></span>
<span id="cb95-159"><a href="#cb95-159" aria-hidden="true" tabindex="-1"></a>    FISHING_MODE<span class="sc">==</span><span class="st">'COMMERCIAL'</span>,</span>
<span id="cb95-160"><a href="#cb95-160" aria-hidden="true" tabindex="-1"></a>    LENGTH_TYPE1<span class="sc">!=</span><span class="st">'NO LENGTH'</span>,</span>
<span id="cb95-161"><a href="#cb95-161" aria-hidden="true" tabindex="-1"></a>    YEAR <span class="sc">&lt;=</span> <span class="dv">2023</span></span>
<span id="cb95-162"><a href="#cb95-162" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb95-163"><a href="#cb95-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type_convert</span>() <span class="sc">%&gt;%</span></span>
<span id="cb95-164"><a href="#cb95-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">REGION_NAME =</span> region,</span>
<span id="cb95-165"><a href="#cb95-165" aria-hidden="true" tabindex="-1"></a>         <span class="at">OBS_STANDARD_SPECIES_CODE =</span> <span class="fu">as.numeric</span>(OBS_STANDARD_SPECIES_CODE), </span>
<span id="cb95-166"><a href="#cb95-166" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb95-167"><a href="#cb95-167" aria-hidden="true" tabindex="-1"></a><span class="do">####################SARAH'S CORRECTIONS NOW FIXED IN TIP DATABASE   </span></span>
<span id="cb95-168"><a href="#cb95-168" aria-hidden="true" tabindex="-1"></a><span class="co">#         COUNTY_LANDED = ifelse((YEAR==2018 &amp; COUNTY_LANDED=='NOT CODED'), 'ST THOMAS',</span></span>
<span id="cb95-169"><a href="#cb95-169" aria-hidden="true" tabindex="-1"></a><span class="co">#                                ifelse((YEAR==2017 &amp; COUNTY_LANDED=='NOT CODED'), 'ST CROIX', COUNTY_LANDED)),</span></span>
<span id="cb95-170"><a href="#cb95-170" aria-hidden="true" tabindex="-1"></a><span class="co">#         LENGTH1     = ifelse(LENGTH1_MM&gt;2000, LENGTH1/10, LENGTH1),</span></span>
<span id="cb95-171"><a href="#cb95-171" aria-hidden="true" tabindex="-1"></a><span class="co">#         LENGTH1_MM  = ifelse(LENGTH1_MM&gt;2000, LENGTH1_MM/10,LENGTH1_MM),</span></span>
<span id="cb95-172"><a href="#cb95-172" aria-hidden="true" tabindex="-1"></a><span class="do">####################</span></span>
<span id="cb95-173"><a href="#cb95-173" aria-hidden="true" tabindex="-1"></a>         <span class="at">source      =</span> <span class="st">"TIP"</span>, </span>
<span id="cb95-174"><a href="#cb95-174" aria-hidden="true" tabindex="-1"></a>         <span class="at">YTS         =</span> <span class="fu">ifelse</span>(OBS_STANDARD_SPECIES_CODE<span class="sc">==</span><span class="dv">168907</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="co">#binary flag for queen triggerfish vs 'other'</span></span>
<span id="cb95-175"><a href="#cb95-175" aria-hidden="true" tabindex="-1"></a>         <span class="at">ISLAND      =</span> <span class="fu">ifelse</span>(STATE_LANDED<span class="sc">==</span><span class="st">'PUERTO RICO'</span>, STATE_LANDED, COUNTY_LANDED),</span>
<span id="cb95-176"><a href="#cb95-176" aria-hidden="true" tabindex="-1"></a>         <span class="co">#STAT_AREA = ifelse(STANDARDAREA_1&gt;1, STANDARDAREA_1, LAND_STANDARD_AREA_ID),</span></span>
<span id="cb95-177"><a href="#cb95-177" aria-hidden="true" tabindex="-1"></a>         <span class="at">OBS_ID      =</span> <span class="fu">as.character</span>(OBS_ID)</span>
<span id="cb95-178"><a href="#cb95-178" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb95-179"><a href="#cb95-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(REGION_NAME,</span>
<span id="cb95-180"><a href="#cb95-180" aria-hidden="true" tabindex="-1"></a>         source,</span>
<span id="cb95-181"><a href="#cb95-181" aria-hidden="true" tabindex="-1"></a>         ID,</span>
<span id="cb95-182"><a href="#cb95-182" aria-hidden="true" tabindex="-1"></a>         INTERVIEW_DATE,</span>
<span id="cb95-183"><a href="#cb95-183" aria-hidden="true" tabindex="-1"></a>         FINAL_DATE,</span>
<span id="cb95-184"><a href="#cb95-184" aria-hidden="true" tabindex="-1"></a>         FISHING_MODE,</span>
<span id="cb95-185"><a href="#cb95-185" aria-hidden="true" tabindex="-1"></a>         INT_TYPE,</span>
<span id="cb95-186"><a href="#cb95-186" aria-hidden="true" tabindex="-1"></a>         <span class="at">YEAR =</span> YEAR,</span>
<span id="cb95-187"><a href="#cb95-187" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITIS_CODE   =</span> OBS_STANDARD_SPECIES_CODE,</span>
<span id="cb95-188"><a href="#cb95-188" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPECIES     =</span> OBS_STANDARD_SPECIES_NAME,</span>
<span id="cb95-189"><a href="#cb95-189" aria-hidden="true" tabindex="-1"></a>         QUANTITY,</span>
<span id="cb95-190"><a href="#cb95-190" aria-hidden="true" tabindex="-1"></a>         YTS,</span>
<span id="cb95-191"><a href="#cb95-191" aria-hidden="true" tabindex="-1"></a>         STATE_LANDED,</span>
<span id="cb95-192"><a href="#cb95-192" aria-hidden="true" tabindex="-1"></a>         COUNTY_LANDED,</span>
<span id="cb95-193"><a href="#cb95-193" aria-hidden="true" tabindex="-1"></a>         <span class="at">COUNTY_CODE=</span>LANDING_AREA_COUNTY_CODE,</span>
<span id="cb95-194"><a href="#cb95-194" aria-hidden="true" tabindex="-1"></a>         PLACE_LANDED,</span>
<span id="cb95-195"><a href="#cb95-195" aria-hidden="true" tabindex="-1"></a>         DEALER,</span>
<span id="cb95-196"><a href="#cb95-196" aria-hidden="true" tabindex="-1"></a>         DEALER_CODE,</span>
<span id="cb95-197"><a href="#cb95-197" aria-hidden="true" tabindex="-1"></a>         ISLAND,</span>
<span id="cb95-198"><a href="#cb95-198" aria-hidden="true" tabindex="-1"></a>         OBS_WEIGHT_KG,</span>
<span id="cb95-199"><a href="#cb95-199" aria-hidden="true" tabindex="-1"></a>         LENGTH1_MM,</span>
<span id="cb95-200"><a href="#cb95-200" aria-hidden="true" tabindex="-1"></a>         LENGTH1,</span>
<span id="cb95-201"><a href="#cb95-201" aria-hidden="true" tabindex="-1"></a>         LENGTH_TYPE1,</span>
<span id="cb95-202"><a href="#cb95-202" aria-hidden="true" tabindex="-1"></a>         LENGTH_UNIT1,</span>
<span id="cb95-203"><a href="#cb95-203" aria-hidden="true" tabindex="-1"></a>         OBS_ID,</span>
<span id="cb95-204"><a href="#cb95-204" aria-hidden="true" tabindex="-1"></a>         LAND_STANDARD_GEAR_NAME,</span>
<span id="cb95-205"><a href="#cb95-205" aria-hidden="true" tabindex="-1"></a>         LAND_GEAR_NAME,</span>
<span id="cb95-206"><a href="#cb95-206" aria-hidden="true" tabindex="-1"></a>         LANDING_TYPE,</span>
<span id="cb95-207"><a href="#cb95-207" aria-hidden="true" tabindex="-1"></a>         BIAS_TYPE,</span>
<span id="cb95-208"><a href="#cb95-208" aria-hidden="true" tabindex="-1"></a>         VESSEL_ID,</span>
<span id="cb95-209"><a href="#cb95-209" aria-hidden="true" tabindex="-1"></a>         LICENSE,</span>
<span id="cb95-210"><a href="#cb95-210" aria-hidden="true" tabindex="-1"></a>         SAMPLE_ID,</span>
<span id="cb95-211"><a href="#cb95-211" aria-hidden="true" tabindex="-1"></a>         AREA_1,</span>
<span id="cb95-212"><a href="#cb95-212" aria-hidden="true" tabindex="-1"></a>         AREANAME_1,</span>
<span id="cb95-213"><a href="#cb95-213" aria-hidden="true" tabindex="-1"></a>         STANDARDAREA_1,</span>
<span id="cb95-214"><a href="#cb95-214" aria-hidden="true" tabindex="-1"></a>         STANDARDAREANAME_1,</span>
<span id="cb95-215"><a href="#cb95-215" aria-hidden="true" tabindex="-1"></a>         AGENT_USERNAME_ID,</span>
<span id="cb95-216"><a href="#cb95-216" aria-hidden="true" tabindex="-1"></a>         DEALER_CODE,</span>
<span id="cb95-217"><a href="#cb95-217" aria-hidden="true" tabindex="-1"></a>         VESSEL_ID</span>
<span id="cb95-218"><a href="#cb95-218" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-219"><a href="#cb95-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-220"><a href="#cb95-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-221"><a href="#cb95-221" aria-hidden="true" tabindex="-1"></a>Length composition after filtering to commercial records</span>
<span id="cb95-222"><a href="#cb95-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-225"><a href="#cb95-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb95-226"><a href="#cb95-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-227"><a href="#cb95-227" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-228"><a href="#cb95-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-229"><a href="#cb95-229" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>COUNTY_LANDED,tip2<span class="sc">$</span>ISLAND,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb95-230"><a href="#cb95-230" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>YEAR,tip2<span class="sc">$</span>ISLAND,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb95-231"><a href="#cb95-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-232"><a href="#cb95-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-233"><a href="#cb95-233" aria-hidden="true" tabindex="-1"></a>lencheck <span class="ot">&lt;-</span> tip2[tip2<span class="sc">$</span>LENGTH1_MM<span class="sc">&gt;</span><span class="dv">2000</span>,] <span class="co">#no lengths greater than 2000</span></span>
<span id="cb95-234"><a href="#cb95-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-235"><a href="#cb95-235" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range  &lt;- tip2[with(tip2,order(-LENGTH1_MM)),]</span></span>
<span id="cb95-236"><a href="#cb95-236" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range$LENGTH1_MM[1:25]</span></span>
<span id="cb95-237"><a href="#cb95-237" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-238"><a href="#cb95-238" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range2 &lt;- tip2[with(tip2,order(LENGTH1_MM)),]</span></span>
<span id="cb95-239"><a href="#cb95-239" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range2$LENGTH1_MM[1:25]</span></span>
<span id="cb95-240"><a href="#cb95-240" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>LENGTH_TYPE1,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb95-241"><a href="#cb95-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-242"><a href="#cb95-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-243"><a href="#cb95-243" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb95-244"><a href="#cb95-244" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-245"><a href="#cb95-245" aria-hidden="true" tabindex="-1"></a><span class="co"># table(tip2$ITIS_CODE,tip2$SPECIES,useNA='always')</span></span>
<span id="cb95-246"><a href="#cb95-246" aria-hidden="true" tabindex="-1"></a><span class="co"># table(tip2$SPECIES,tip2$YTS,useNA='always')</span></span>
<span id="cb95-247"><a href="#cb95-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-248"><a href="#cb95-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-249"><a href="#cb95-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-250"><a href="#cb95-250" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract marfin samples, look at island distribution</span></span>
<span id="cb95-251"><a href="#cb95-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-254"><a href="#cb95-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb95-255"><a href="#cb95-255" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-256"><a href="#cb95-256" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-257"><a href="#cb95-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-258"><a href="#cb95-258" aria-hidden="true" tabindex="-1"></a><span class="do">##extract marfin samples, look at island distribution</span></span>
<span id="cb95-259"><a href="#cb95-259" aria-hidden="true" tabindex="-1"></a>marfin <span class="ot">&lt;-</span> tip2<span class="sc">%&gt;%</span></span>
<span id="cb95-260"><a href="#cb95-260" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(INT_TYPE <span class="sc">==</span> <span class="st">"USVI MARFIN REEFFISH SAMPLING"</span>)</span>
<span id="cb95-261"><a href="#cb95-261" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(marfin<span class="sc">$</span>YEAR, marfin<span class="sc">$</span>ISLAND,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb95-262"><a href="#cb95-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-263"><a href="#cb95-263" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(marfin<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, marfin<span class="sc">$</span>ISLAND,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb95-264"><a href="#cb95-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-265"><a href="#cb95-265" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(marfin<span class="sc">$</span>LAND_STANDARD_GEAR_NAME,marfin<span class="sc">$</span>YEAR, marfin<span class="sc">$</span>ISLAND,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb95-266"><a href="#cb95-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-267"><a href="#cb95-267" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>YEAR,tip2<span class="sc">$</span>LENGTH_TYPE1,<span class="at">useNA=</span><span class="st">'always'</span>)  <span class="do">##TL more prevalent in recent years</span></span>
<span id="cb95-268"><a href="#cb95-268" aria-hidden="true" tabindex="-1"></a><span class="co"># table(tip2$LENGTH_TYPE1,tip2$LENGTH_TYPE2,useNA='always') </span></span>
<span id="cb95-269"><a href="#cb95-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-270"><a href="#cb95-270" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>ISLAND,tip2<span class="sc">$</span>STATE_LANDED)</span>
<span id="cb95-271"><a href="#cb95-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-272"><a href="#cb95-272" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tip2$LENGTH1_MM,tip2$OBS_WEIGHT_KG,color=tip2$LENGTH_TYPE1)</span></span>
<span id="cb95-273"><a href="#cb95-273" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tip2$LENGTH1_MM,tip2$SAMPLE_WEIGHT_KG)</span></span>
<span id="cb95-274"><a href="#cb95-274" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tip2$LENGTH1_MM,tip2$SUB_SAMPLE_WEIGHT_KG)</span></span>
<span id="cb95-275"><a href="#cb95-275" aria-hidden="true" tabindex="-1"></a>tip2<span class="sc">$</span>yearc <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tip2<span class="sc">$</span>YEAR)</span>
<span id="cb95-276"><a href="#cb95-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-277"><a href="#cb95-277" aria-hidden="true" tabindex="-1"></a><span class="do">##############export all plots starting w/ year&gt;=2015, all islands</span></span>
<span id="cb95-278"><a href="#cb95-278" aria-hidden="true" tabindex="-1"></a><span class="do">#### here, isolated ST THOMAS 2018 for bulk of problems w single port sampler</span></span>
<span id="cb95-279"><a href="#cb95-279" aria-hidden="true" tabindex="-1"></a><span class="do">#### create new RMarkdown script describing this issue for internal distribution</span></span>
<span id="cb95-280"><a href="#cb95-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-281"><a href="#cb95-281" aria-hidden="true" tabindex="-1"></a><span class="co"># tip2[(tip2$YEAR==2018 &amp; tip2$ISLAND=='ST THOMAS'),] %&gt;%</span></span>
<span id="cb95-282"><a href="#cb95-282" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(LENGTH1_MM,OBS_WEIGHT_KG))+</span></span>
<span id="cb95-283"><a href="#cb95-283" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(color = AGENT_USERNAME_ID))  +  ##fork length is splitting</span></span>
<span id="cb95-284"><a href="#cb95-284" aria-hidden="true" tabindex="-1"></a><span class="co">#   # geom_point(aes(color = ISLAND))  +</span></span>
<span id="cb95-285"><a href="#cb95-285" aria-hidden="true" tabindex="-1"></a><span class="co">#   #labs(title = paste0(tip2$ISLAND,  "\n", min(tip2$YEAR), "-", max(tip2$YEAR)))+</span></span>
<span id="cb95-286"><a href="#cb95-286" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span>
<span id="cb95-287"><a href="#cb95-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-288"><a href="#cb95-288" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################################</span></span>
<span id="cb95-289"><a href="#cb95-289" aria-hidden="true" tabindex="-1"></a><span class="do">##### merge in gear tables </span></span>
<span id="cb95-290"><a href="#cb95-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-291"><a href="#cb95-291" aria-hidden="true" tabindex="-1"></a><span class="do">##LOOK AT GEAR ASSIGNMENTS BY SPECIES</span></span>
<span id="cb95-292"><a href="#cb95-292" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, sttj_yt<span class="sc">$</span>STANDARDGEARNAME_2)</span>
<span id="cb95-293"><a href="#cb95-293" aria-hidden="true" tabindex="-1"></a><span class="co">#table(sttj_yt$GEAR, useNA='always')  ##N gears?</span></span>
<span id="cb95-294"><a href="#cb95-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-295"><a href="#cb95-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-296"><a href="#cb95-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-297"><a href="#cb95-297" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Add gear groupings, NO length-length conversions available</span></span>
<span id="cb95-298"><a href="#cb95-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-299"><a href="#cb95-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb95-300"><a href="#cb95-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-301"><a href="#cb95-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-302"><a href="#cb95-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-303"><a href="#cb95-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-304"><a href="#cb95-304" aria-hidden="true" tabindex="-1"></a><span class="do">###add length-length conversions to helper_table ; </span></span>
<span id="cb95-305"><a href="#cb95-305" aria-hidden="true" tabindex="-1"></a>tip3 <span class="ot">&lt;-</span> <span class="fu">merge</span>(tip2, TIP_gears, <span class="at">by.x=</span><span class="st">"LAND_STANDARD_GEAR_NAME"</span>,<span class="at">all.x=</span>T)</span>
<span id="cb95-306"><a href="#cb95-306" aria-hidden="true" tabindex="-1"></a><span class="co">#gfin2a &lt;- merge(gfin, flc, by.x=c("State_Landed","County_Landed"),all.x=T)</span></span>
<span id="cb95-307"><a href="#cb95-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-308"><a href="#cb95-308" aria-hidden="true" tabindex="-1"></a>tip4 <span class="ot">&lt;-</span> tip3[tip3<span class="sc">$</span>YTS<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb95-309"><a href="#cb95-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-310"><a href="#cb95-310" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip3<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, tip3<span class="sc">$</span>gear, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb95-311"><a href="#cb95-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-312"><a href="#cb95-312" aria-hidden="true" tabindex="-1"></a><span class="co">#gear_groups &lt;- c("HAND LINE", "LONGLINE") </span></span>
<span id="cb95-313"><a href="#cb95-313" aria-hidden="true" tabindex="-1"></a>gear_groups <span class="ot">&lt;-</span> <span class="fu">unique</span>(TIP_gears<span class="sc">$</span>gear)</span>
<span id="cb95-314"><a href="#cb95-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-315"><a href="#cb95-315" aria-hidden="true" tabindex="-1"></a><span class="co"># antiforklength &lt;- tip4 |&gt;</span></span>
<span id="cb95-316"><a href="#cb95-316" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(LENGTH_TYPE1 != "FORK LENGTH")</span></span>
<span id="cb95-317"><a href="#cb95-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-318"><a href="#cb95-318" aria-hidden="true" tabindex="-1"></a><span class="do">##splitting here to more easily qa/qc above</span></span>
<span id="cb95-319"><a href="#cb95-319" aria-hidden="true" tabindex="-1"></a>join_length_dat <span class="ot">&lt;-</span> tip4 <span class="sc">%&gt;%</span> <span class="co">#bind_rows(tip3 , gfin2) %&gt;%</span></span>
<span id="cb95-320"><a href="#cb95-320" aria-hidden="true" tabindex="-1"></a>  <span class="co"># len_len_convert(params = LLconv, </span></span>
<span id="cb95-321"><a href="#cb95-321" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 raw_length = LENGTH1, </span></span>
<span id="cb95-322"><a href="#cb95-322" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 length_type =LENGTH_TYPE1, </span></span>
<span id="cb95-323"><a href="#cb95-323" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 length_units =  LENGTH_UNIT1, </span></span>
<span id="cb95-324"><a href="#cb95-324" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 desired_type = len_type) %&gt;%</span></span>
<span id="cb95-325"><a href="#cb95-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">untable</span>(<span class="at">num =</span> .<span class="sc">$</span>QUANTITY)  <span class="sc">%&gt;%</span></span>
<span id="cb95-326"><a href="#cb95-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(LENGTH_TYPE1 <span class="sc">==</span> <span class="st">"FORK LENGTH"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-327"><a href="#cb95-327" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(NEW_GEAR_NAME %in% c(gear_groups)) %&gt;%</span></span>
<span id="cb95-328"><a href="#cb95-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="co">#gear = ifelse(grepl("hand*", NEW_GEAR_NAME, ignore.case = T, fixed = F), "HL", "LL"), #this part will need to be generalized for more than 2 gear types ; ++HOOKLINE IS HANDLINE IN THIS FILE ; OVERWRITING ALL HL TO LL ; CHANGED "hook*" TO "hand*"</span></span>
<span id="cb95-329"><a href="#cb95-329" aria-hidden="true" tabindex="-1"></a>         <span class="co">#gear=GEAR_GRP,</span></span>
<span id="cb95-330"><a href="#cb95-330" aria-hidden="true" tabindex="-1"></a>         <span class="at">FL_CM =</span> LENGTH1_MM<span class="sc">/</span><span class="dv">10</span>, </span>
<span id="cb95-331"><a href="#cb95-331" aria-hidden="true" tabindex="-1"></a>         <span class="at">lbin =</span> <span class="fu">floor</span>(FL_CM <span class="sc">/</span> bin_size)<span class="sc">*</span>bin_size, </span>
<span id="cb95-332"><a href="#cb95-332" aria-hidden="true" tabindex="-1"></a>         <span class="at">mgt_period =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">&lt;=</span> break_year, <span class="fu">paste0</span>(min_year,<span class="st">" - "</span>, break_year), <span class="fu">paste0</span>( break_year<span class="sc">+</span><span class="dv">1</span>, <span class="st">" - "</span>, max_year)))</span>
<span id="cb95-333"><a href="#cb95-333" aria-hidden="true" tabindex="-1"></a><span class="co"># is "select" the problem, its #out </span></span>
<span id="cb95-334"><a href="#cb95-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-335"><a href="#cb95-335" aria-hidden="true" tabindex="-1"></a><span class="co"># FINAL dataset here ----</span></span>
<span id="cb95-336"><a href="#cb95-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-337"><a href="#cb95-337" aria-hidden="true" tabindex="-1"></a>length_data_final <span class="ot">&lt;-</span> join_length_dat <span class="sc">%&gt;%</span></span>
<span id="cb95-338"><a href="#cb95-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, INTERVIEW_DATE, FINAL_DATE, ID, OBS_ID, <span class="at">STATE =</span> STATE_LANDED, <span class="at">COUNTY=</span>COUNTY_LANDED, COUNTY_CODE, FL_CM, lbin, source, gear, gear_short, LAND_STANDARD_GEAR_NAME, LAND_GEAR_NAME, mgt_period, ISLAND, INT_TYPE, fleet, DEALER_CODE, VESSEL_ID, LICENSE) <span class="sc">%&gt;%</span>  <span class="co">#STAT_AREA</span></span>
<span id="cb95-339"><a href="#cb95-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(FL_CM , min_size, max_size),</span>
<span id="cb95-340"><a href="#cb95-340" aria-hidden="true" tabindex="-1"></a>         ISLAND <span class="sc">!=</span> <span class="st">'NOT CODED'</span>)</span>
<span id="cb95-341"><a href="#cb95-341" aria-hidden="true" tabindex="-1"></a>         <span class="co">#,</span></span>
<span id="cb95-342"><a href="#cb95-342" aria-hidden="true" tabindex="-1"></a>         <span class="co">#INT_TYPE != 'USVI MARFIN REEFFISH SAMPLING') </span></span>
<span id="cb95-343"><a href="#cb95-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-344"><a href="#cb95-344" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyst have asked for a record of dropped observations</span></span>
<span id="cb95-345"><a href="#cb95-345" aria-hidden="true" tabindex="-1"></a><span class="do">######### ADAPT THIS TO OUTPUT ALL DROPPED RECORDS ABOVE--MOVE HIGHER IN THE SCRIPT TO HAVE ALL VARS</span></span>
<span id="cb95-346"><a href="#cb95-346" aria-hidden="true" tabindex="-1"></a>dropped_obs <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(join_length_dat, length_data_final, <span class="at">by =</span> <span class="st">"OBS_ID"</span>)  </span>
<span id="cb95-347"><a href="#cb95-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-348"><a href="#cb95-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-349"><a href="#cb95-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-350"><a href="#cb95-350" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################DOCUMENT ALL DROPPED DATA</span></span>
<span id="cb95-351"><a href="#cb95-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-352"><a href="#cb95-352" aria-hidden="true" tabindex="-1"></a><span class="co"># drop &lt;- list()  ##++this creates an empty list for for loop</span></span>
<span id="cb95-353"><a href="#cb95-353" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-354"><a href="#cb95-354" aria-hidden="true" tabindex="-1"></a><span class="co"># # for loop generates binned length comps for each of the final gears. Stored in list. RUN:  View(comps[[1]]) to see in R</span></span>
<span id="cb95-355"><a href="#cb95-355" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-356"><a href="#cb95-356" aria-hidden="true" tabindex="-1"></a><span class="co">#  drop[[1]] &lt;-  NON-RANDOM SAMPLES</span></span>
<span id="cb95-357"><a href="#cb95-357" aria-hidden="true" tabindex="-1"></a><span class="co">#  drop[[2]] &lt;-  SIZE DATA</span></span>
<span id="cb95-358"><a href="#cb95-358" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(gear == final_gears[i]) %&gt;%</span></span>
<span id="cb95-359"><a href="#cb95-359" aria-hidden="true" tabindex="-1"></a><span class="co"># names(comps)[[1]] &lt;- paste0(final_gears[i], "_", bin_size, "cm") ##++tabs are named here ; could add _nom here if desired (instead of _lfd and _lfdw in main file)</span></span>
<span id="cb95-360"><a href="#cb95-360" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb95-361"><a href="#cb95-361" aria-hidden="true" tabindex="-1"></a><span class="do">################################################</span></span>
<span id="cb95-362"><a href="#cb95-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-363"><a href="#cb95-363" aria-hidden="true" tabindex="-1"></a><span class="do">###this is writing only size data issues (e.g. samples too small/large to be considered realistic)</span></span>
<span id="cb95-364"><a href="#cb95-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-365"><a href="#cb95-365" aria-hidden="true" tabindex="-1"></a><span class="co"># write.xlsx(dropped_obs, file = paste0("./outputs/", sp, "_size_dropped_observations_", gsub("-", "", Sys.Date()), ".xlsx"))</span></span>
<span id="cb95-366"><a href="#cb95-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-367"><a href="#cb95-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-368"><a href="#cb95-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-369"><a href="#cb95-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r maintain_empty_bins}</span></span>
<span id="cb95-370"><a href="#cb95-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-371"><a href="#cb95-371" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-372"><a href="#cb95-372" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-373"><a href="#cb95-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-374"><a href="#cb95-374" aria-hidden="true" tabindex="-1"></a><span class="co"># this is some funky code to make sure bins with no obervations are maintained in the data. Open to finding a more elegant solution but this works</span></span>
<span id="cb95-375"><a href="#cb95-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-376"><a href="#cb95-376" aria-hidden="true" tabindex="-1"></a>full_set <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">YEAR =</span> <span class="fu">seq</span>(<span class="at">from =</span> min_year, <span class="at">to =</span> max_year, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb95-377"><a href="#cb95-377" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lbin =</span> <span class="fu">seq</span>(<span class="at">from =</span> min_size, <span class="at">to =</span> max_size, <span class="at">by =</span> bin_size), </span>
<span id="cb95-378"><a href="#cb95-378" aria-hidden="true" tabindex="-1"></a>                     <span class="at">N =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-379"><a href="#cb95-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> lbin, <span class="at">values_from =</span> N)</span>
<span id="cb95-380"><a href="#cb95-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-381"><a href="#cb95-381" aria-hidden="true" tabindex="-1"></a>comp_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"YEAR"</span>, <span class="st">"ln_fish"</span>, <span class="st">"ln_trips"</span>, <span class="st">"ln_dealers"</span>,<span class="st">"ln_vessels"</span>, <span class="fu">names</span>(full_set)[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb95-382"><a href="#cb95-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-383"><a href="#cb95-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-384"><a href="#cb95-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-385"><a href="#cb95-385" aria-hidden="true" tabindex="-1"></a><span class="fu"># Filtration level investigation</span></span>
<span id="cb95-386"><a href="#cb95-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-387"><a href="#cb95-387" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unique trip ID vs gear by year investigation</span></span>
<span id="cb95-388"><a href="#cb95-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-389"><a href="#cb95-389" aria-hidden="true" tabindex="-1"></a><span class="fu">#### How many unique trip ID's per year?</span></span>
<span id="cb95-390"><a href="#cb95-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-391"><a href="#cb95-391" aria-hidden="true" tabindex="-1"></a>Group by year, count unique trip id's</span>
<span id="cb95-392"><a href="#cb95-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-393"><a href="#cb95-393" aria-hidden="true" tabindex="-1"></a>When we remove data from years with less than 10 unique trip ID's, we are left with 24 years of data.</span>
<span id="cb95-394"><a href="#cb95-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-395"><a href="#cb95-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb95-396"><a href="#cb95-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb95-397"><a href="#cb95-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-398"><a href="#cb95-398" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb95-399"><a href="#cb95-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb95-400"><a href="#cb95-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb95-401"><a href="#cb95-401" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_tripcount)</span>
<span id="cb95-402"><a href="#cb95-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-403"><a href="#cb95-403" aria-hidden="true" tabindex="-1"></a>length_data_trip30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb95-404"><a href="#cb95-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb95-405"><a href="#cb95-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(ID) <span class="sc">&gt;=</span> <span class="dv">10</span>)<span class="sc">|&gt;</span></span>
<span id="cb95-406"><a href="#cb95-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb95-407"><a href="#cb95-407" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_trip30)</span>
<span id="cb95-408"><a href="#cb95-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-409"><a href="#cb95-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-410"><a href="#cb95-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-411"><a href="#cb95-411" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unique length records per gear per year</span></span>
<span id="cb95-412"><a href="#cb95-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-413"><a href="#cb95-413" aria-hidden="true" tabindex="-1"></a><span class="fu">### How many length records per gear per year?</span></span>
<span id="cb95-414"><a href="#cb95-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-415"><a href="#cb95-415" aria-hidden="true" tabindex="-1"></a>Group by year, count occurrences of each gear</span>
<span id="cb95-416"><a href="#cb95-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-417"><a href="#cb95-417" aria-hidden="true" tabindex="-1"></a>There are years when individual gears occur less than 30 times but when grouped, the gear groups exceed 30 occurrences per year. Do we want to rely on gear groups with larger than 30 occurrences per year or individual gears with more than 30 occurrences?</span>
<span id="cb95-418"><a href="#cb95-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-419"><a href="#cb95-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb95-420"><a href="#cb95-420" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-421"><a href="#cb95-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-422"><a href="#cb95-422" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur each year</span></span>
<span id="cb95-423"><a href="#cb95-423" aria-hidden="true" tabindex="-1"></a>length_data_gearcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb95-424"><a href="#cb95-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb95-425"><a href="#cb95-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb95-426"><a href="#cb95-426" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gearcount)</span>
<span id="cb95-427"><a href="#cb95-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-428"><a href="#cb95-428" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur 30 or more times each year</span></span>
<span id="cb95-429"><a href="#cb95-429" aria-hidden="true" tabindex="-1"></a>length_data_gear30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb95-430"><a href="#cb95-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb95-431"><a href="#cb95-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb95-432"><a href="#cb95-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb95-433"><a href="#cb95-433" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear30)</span>
<span id="cb95-434"><a href="#cb95-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-435"><a href="#cb95-435" aria-hidden="true" tabindex="-1"></a><span class="co"># group gears that occur 30 or more times per year by gear grouping </span></span>
<span id="cb95-436"><a href="#cb95-436" aria-hidden="true" tabindex="-1"></a>length_data_geartogether30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb95-437"><a href="#cb95-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb95-438"><a href="#cb95-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb95-439"><a href="#cb95-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb95-440"><a href="#cb95-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span> </span>
<span id="cb95-441"><a href="#cb95-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb95-442"><a href="#cb95-442" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geartogether30)</span>
<span id="cb95-443"><a href="#cb95-443" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by specific gear per year</span></span>
<span id="cb95-444"><a href="#cb95-444" aria-hidden="true" tabindex="-1"></a><span class="co"># 26 years of data available </span></span>
<span id="cb95-445"><a href="#cb95-445" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geartogether30<span class="sc">$</span>YEAR, length_data_geartogether30<span class="sc">$</span>gear)</span>
<span id="cb95-446"><a href="#cb95-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-447"><a href="#cb95-447" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur each year</span></span>
<span id="cb95-448"><a href="#cb95-448" aria-hidden="true" tabindex="-1"></a>length_data_geargroupcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb95-449"><a href="#cb95-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb95-450"><a href="#cb95-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb95-451"><a href="#cb95-451" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroupcount)</span>
<span id="cb95-452"><a href="#cb95-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-453"><a href="#cb95-453" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur 30 or more times each year</span></span>
<span id="cb95-454"><a href="#cb95-454" aria-hidden="true" tabindex="-1"></a>length_data_geargroup30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb95-455"><a href="#cb95-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb95-456"><a href="#cb95-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb95-457"><a href="#cb95-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb95-458"><a href="#cb95-458" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup30)</span>
<span id="cb95-459"><a href="#cb95-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-460"><a href="#cb95-460" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by gear grouping per year</span></span>
<span id="cb95-461"><a href="#cb95-461" aria-hidden="true" tabindex="-1"></a><span class="co"># 26 years of data available </span></span>
<span id="cb95-462"><a href="#cb95-462" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geargroup30<span class="sc">$</span>YEAR, length_data_geargroup30<span class="sc">$</span>gear)</span>
<span id="cb95-463"><a href="#cb95-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-464"><a href="#cb95-464" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by individual gears </span></span>
<span id="cb95-465"><a href="#cb95-465" aria-hidden="true" tabindex="-1"></a>length_data_gear29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb95-466"><a href="#cb95-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb95-467"><a href="#cb95-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb95-468"><a href="#cb95-468" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb95-469"><a href="#cb95-469" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb95-470"><a href="#cb95-470" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb95-471"><a href="#cb95-471" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear29)</span>
<span id="cb95-472"><a href="#cb95-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-473"><a href="#cb95-473" aria-hidden="true" tabindex="-1"></a><span class="co"># VS </span></span>
<span id="cb95-474"><a href="#cb95-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-475"><a href="#cb95-475" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by gear groups </span></span>
<span id="cb95-476"><a href="#cb95-476" aria-hidden="true" tabindex="-1"></a>length_data_geargroup29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb95-477"><a href="#cb95-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb95-478"><a href="#cb95-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb95-479"><a href="#cb95-479" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb95-480"><a href="#cb95-480" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb95-481"><a href="#cb95-481" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb95-482"><a href="#cb95-482" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup29)</span>
<span id="cb95-483"><a href="#cb95-483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-484"><a href="#cb95-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-485"><a href="#cb95-485" aria-hidden="true" tabindex="-1"></a><span class="fu"># GLM analysis</span></span>
<span id="cb95-486"><a href="#cb95-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-487"><a href="#cb95-487" aria-hidden="true" tabindex="-1"></a>No filtering based on number of trips/fish per year yet, analysis of all available data.</span>
<span id="cb95-488"><a href="#cb95-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-489"><a href="#cb95-489" aria-hidden="true" tabindex="-1"></a>123 records removed due to not being measured in fork length:</span>
<span id="cb95-490"><a href="#cb95-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-491"><a href="#cb95-491" aria-hidden="true" tabindex="-1"></a>20 GILL NETS; OTHER</span>
<span id="cb95-492"><a href="#cb95-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-493"><a href="#cb95-493" aria-hidden="true" tabindex="-1"></a>5 NOT CODED</span>
<span id="cb95-494"><a href="#cb95-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-495"><a href="#cb95-495" aria-hidden="true" tabindex="-1"></a>32 LINES HAND</span>
<span id="cb95-496"><a href="#cb95-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-497"><a href="#cb95-497" aria-hidden="true" tabindex="-1"></a>66 POTS AND TRAPS; FISH</span>
<span id="cb95-498"><a href="#cb95-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-499"><a href="#cb95-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_hookandline_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb95-500"><a href="#cb95-500" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(length_data_final<span class="sc">$</span>gear) <span class="co"># "Hook and Line", "Trap", "Other", "Net"</span></span>
<span id="cb95-501"><a href="#cb95-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-502"><a href="#cb95-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-503"><a href="#cb95-503" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hook and Line</span></span>
<span id="cb95-504"><a href="#cb95-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-505"><a href="#cb95-505" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_hookline_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb95-506"><a href="#cb95-506" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-507"><a href="#cb95-507" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-508"><a href="#cb95-508" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen-inset </span></span>
<span id="cb95-509"><a href="#cb95-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-510"><a href="#cb95-510" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb95-511"><a href="#cb95-511" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb95-512"><a href="#cb95-512" aria-hidden="true" tabindex="-1"></a>use_gear_hl <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb95-513"><a href="#cb95-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb95-514"><a href="#cb95-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear <span class="sc">==</span> <span class="st">"Hook and Line"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb95-515"><a href="#cb95-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb95-516"><a href="#cb95-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb95-517"><a href="#cb95-517" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb95-518"><a href="#cb95-518" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb95-519"><a href="#cb95-519" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(use_gear_hl, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb95-520"><a href="#cb95-520" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb95-521"><a href="#cb95-521" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb95-522"><a href="#cb95-522" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb95-523"><a href="#cb95-523" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb95-524"><a href="#cb95-524" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(use_gear_hl, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb95-525"><a href="#cb95-525" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb95-526"><a href="#cb95-526" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb95-527"><a href="#cb95-527" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb95-528"><a href="#cb95-528" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb95-529"><a href="#cb95-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-530"><a href="#cb95-530" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb95-531"><a href="#cb95-531" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb95-532"><a href="#cb95-532" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(use_gear_hl, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb95-533"><a href="#cb95-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb95-534"><a href="#cb95-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb95-535"><a href="#cb95-535" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb95-536"><a href="#cb95-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb95-537"><a href="#cb95-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb95-538"><a href="#cb95-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb95-539"><a href="#cb95-539" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb95-540"><a href="#cb95-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb95-541"><a href="#cb95-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-542"><a href="#cb95-542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-543"><a href="#cb95-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-544"><a href="#cb95-544" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_hookandline_analysis, fig.fullwidth}</span></span>
<span id="cb95-545"><a href="#cb95-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-546"><a href="#cb95-546" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-547"><a href="#cb95-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-548"><a href="#cb95-548" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb95-549"><a href="#cb95-549" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb95-550"><a href="#cb95-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-551"><a href="#cb95-551" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb95-552"><a href="#cb95-552" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb95-553"><a href="#cb95-553" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_hl, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb95-554"><a href="#cb95-554" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span>
<span id="cb95-555"><a href="#cb95-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-556"><a href="#cb95-556" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb95-557"><a href="#cb95-557" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb95-558"><a href="#cb95-558" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb95-559"><a href="#cb95-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-560"><a href="#cb95-560" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb95-561"><a href="#cb95-561" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb95-562"><a href="#cb95-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-563"><a href="#cb95-563" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb95-564"><a href="#cb95-564" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb95-565"><a href="#cb95-565" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb95-566"><a href="#cb95-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-567"><a href="#cb95-567" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb95-568"><a href="#cb95-568" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb95-569"><a href="#cb95-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-570"><a href="#cb95-570" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb95-571"><a href="#cb95-571" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb95-572"><a href="#cb95-572" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb95-573"><a href="#cb95-573" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line gear p value is significant </span></span>
<span id="cb95-574"><a href="#cb95-574" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb95-575"><a href="#cb95-575" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb95-576"><a href="#cb95-576" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line date p value is significant </span></span>
<span id="cb95-577"><a href="#cb95-577" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb95-578"><a href="#cb95-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-579"><a href="#cb95-579" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb95-580"><a href="#cb95-580" aria-hidden="true" tabindex="-1"></a><span class="do">### lines hand vs rod and reel and lines power troll other vs rod and reel are signifficantly different </span></span>
<span id="cb95-581"><a href="#cb95-581" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb95-582"><a href="#cb95-582" aria-hidden="true" tabindex="-1"></a>mod_contr</span>
<span id="cb95-583"><a href="#cb95-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-584"><a href="#cb95-584" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb95-585"><a href="#cb95-585" aria-hidden="true" tabindex="-1"></a><span class="do">### suggestion: "lines power troll other", "lines hand" "rod and reel electric" and "reel electric or hydroulic" be grouped together</span></span>
<span id="cb95-586"><a href="#cb95-586" aria-hidden="true" tabindex="-1"></a><span class="do">### "rod and reel" be kept separate </span></span>
<span id="cb95-587"><a href="#cb95-587" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb95-588"><a href="#cb95-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-589"><a href="#cb95-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-590"><a href="#cb95-590" aria-hidden="true" tabindex="-1"></a><span class="fu">## Net</span></span>
<span id="cb95-591"><a href="#cb95-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-592"><a href="#cb95-592" aria-hidden="true" tabindex="-1"></a>"GILL NETS; OTHER" not included because all 20 records are measured in standard length, i didn't have a conversion for that</span>
<span id="cb95-593"><a href="#cb95-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-594"><a href="#cb95-594" aria-hidden="true" tabindex="-1"></a>Adyan - The "GILL NETS: GL 1-2 IN" AND "GILL NETS: GL 2-4 IN" records we were thinking of are in STX, I'll highlight those in the stx_yts document tomorrow.</span>
<span id="cb95-595"><a href="#cb95-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-596"><a href="#cb95-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_netstd_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb95-597"><a href="#cb95-597" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-598"><a href="#cb95-598" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-599"><a href="#cb95-599" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-600"><a href="#cb95-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-601"><a href="#cb95-601" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb95-602"><a href="#cb95-602" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb95-603"><a href="#cb95-603" aria-hidden="true" tabindex="-1"></a><span class="co"># net land_standard_gear_name</span></span>
<span id="cb95-604"><a href="#cb95-604" aria-hidden="true" tabindex="-1"></a>use_gear_nlsg <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb95-605"><a href="#cb95-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb95-606"><a href="#cb95-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear <span class="sc">==</span> <span class="st">"Net"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb95-607"><a href="#cb95-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb95-608"><a href="#cb95-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb95-609"><a href="#cb95-609" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb95-610"><a href="#cb95-610" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb95-611"><a href="#cb95-611" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(use_gear_nlsg, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb95-612"><a href="#cb95-612" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb95-613"><a href="#cb95-613" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb95-614"><a href="#cb95-614" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb95-615"><a href="#cb95-615" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb95-616"><a href="#cb95-616" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(use_gear_nlsg, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb95-617"><a href="#cb95-617" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb95-618"><a href="#cb95-618" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb95-619"><a href="#cb95-619" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb95-620"><a href="#cb95-620" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb95-621"><a href="#cb95-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-622"><a href="#cb95-622" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb95-623"><a href="#cb95-623" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb95-624"><a href="#cb95-624" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(use_gear_nlsg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb95-625"><a href="#cb95-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb95-626"><a href="#cb95-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb95-627"><a href="#cb95-627" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb95-628"><a href="#cb95-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb95-629"><a href="#cb95-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb95-630"><a href="#cb95-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb95-631"><a href="#cb95-631" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb95-632"><a href="#cb95-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb95-633"><a href="#cb95-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-634"><a href="#cb95-634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-635"><a href="#cb95-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-636"><a href="#cb95-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_netstd_analysis}</span></span>
<span id="cb95-637"><a href="#cb95-637" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-638"><a href="#cb95-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-639"><a href="#cb95-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-640"><a href="#cb95-640" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb95-641"><a href="#cb95-641" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb95-642"><a href="#cb95-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-643"><a href="#cb95-643" aria-hidden="true" tabindex="-1"></a><span class="do">### both fixed linear and glm models have warning message because ENTANGLING NETS (GILL) UNSPECIFIED only occur in one year, preventing convergence across timeline </span></span>
<span id="cb95-644"><a href="#cb95-644" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb95-645"><a href="#cb95-645" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb95-646"><a href="#cb95-646" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_nlsg, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb95-647"><a href="#cb95-647" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span>
<span id="cb95-648"><a href="#cb95-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-649"><a href="#cb95-649" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb95-650"><a href="#cb95-650" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb95-651"><a href="#cb95-651" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log)) </span>
<span id="cb95-652"><a href="#cb95-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-653"><a href="#cb95-653" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb95-654"><a href="#cb95-654" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb95-655"><a href="#cb95-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-656"><a href="#cb95-656" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb95-657"><a href="#cb95-657" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb95-658"><a href="#cb95-658" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb95-659"><a href="#cb95-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-660"><a href="#cb95-660" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb95-661"><a href="#cb95-661" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb95-662"><a href="#cb95-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-663"><a href="#cb95-663" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb95-664"><a href="#cb95-664" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb95-665"><a href="#cb95-665" aria-hidden="true" tabindex="-1"></a><span class="do">### net (using LAND_STANDARD_GEAR_NAME) does not have any significantly different gears </span></span>
<span id="cb95-666"><a href="#cb95-666" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3) </span>
<span id="cb95-667"><a href="#cb95-667" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope</span></span>
<span id="cb95-668"><a href="#cb95-668" aria-hidden="true" tabindex="-1"></a><span class="do">### There is no significantly different time in the Net grouping </span></span>
<span id="cb95-669"><a href="#cb95-669" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb95-670"><a href="#cb95-670" aria-hidden="true" tabindex="-1"></a><span class="do">### no significant p values for time period or gears, further comparisons not needed </span></span>
<span id="cb95-671"><a href="#cb95-671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-672"><a href="#cb95-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-673"><a href="#cb95-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_net_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb95-674"><a href="#cb95-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-675"><a href="#cb95-675" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-676"><a href="#cb95-676" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-677"><a href="#cb95-677" aria-hidden="true" tabindex="-1"></a><span class="do">#### Net - LAND_GEAR_NAME</span></span>
<span id="cb95-678"><a href="#cb95-678" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb95-679"><a href="#cb95-679" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggplot2) </span></span>
<span id="cb95-680"><a href="#cb95-680" aria-hidden="true" tabindex="-1"></a><span class="co"># # net land_standard_gear_name</span></span>
<span id="cb95-681"><a href="#cb95-681" aria-hidden="true" tabindex="-1"></a><span class="co"># use_gear_nlg &lt;- length_data_final |&gt;</span></span>
<span id="cb95-682"><a href="#cb95-682" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_GEAR_NAME, gear) |&gt; </span></span>
<span id="cb95-683"><a href="#cb95-683" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(gear == "Net") |&gt; </span></span>
<span id="cb95-684"><a href="#cb95-684" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(ID = as.character(ID)) |&gt; </span></span>
<span id="cb95-685"><a href="#cb95-685" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-gear)</span></span>
<span id="cb95-686"><a href="#cb95-686" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggpubr)</span></span>
<span id="cb95-687"><a href="#cb95-687" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create box plot across years</span></span>
<span id="cb95-688"><a href="#cb95-688" aria-hidden="true" tabindex="-1"></a><span class="co"># box_plot &lt;- ggboxplot(use_gear_nlg, x = "LAND_GEAR_NAME", y = "FL_CM",</span></span>
<span id="cb95-689"><a href="#cb95-689" aria-hidden="true" tabindex="-1"></a><span class="co">#                  color = "LAND_GEAR_NAME",</span></span>
<span id="cb95-690"><a href="#cb95-690" aria-hidden="true" tabindex="-1"></a><span class="co">#                  ylab = "FL_CM", xlab = "LAND_GEAR_NAME")</span></span>
<span id="cb95-691"><a href="#cb95-691" aria-hidden="true" tabindex="-1"></a><span class="co"># box_plot</span></span>
<span id="cb95-692"><a href="#cb95-692" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create density plot across years</span></span>
<span id="cb95-693"><a href="#cb95-693" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot &lt;- ggdensity(use_gear_nlg, x = "FL_CM",</span></span>
<span id="cb95-694"><a href="#cb95-694" aria-hidden="true" tabindex="-1"></a><span class="co">#                           add = "mean", rug = TRUE,</span></span>
<span id="cb95-695"><a href="#cb95-695" aria-hidden="true" tabindex="-1"></a><span class="co">#                           color = "LAND_GEAR_NAME", fill = "LAND_GEAR_NAME",</span></span>
<span id="cb95-696"><a href="#cb95-696" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ylab = "FL_CM", xlab = "Gear")</span></span>
<span id="cb95-697"><a href="#cb95-697" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot</span></span>
<span id="cb95-698"><a href="#cb95-698" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-699"><a href="#cb95-699" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot data</span></span>
<span id="cb95-700"><a href="#cb95-700" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggplot2)</span></span>
<span id="cb95-701"><a href="#cb95-701" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(use_gear_nlg, aes(x = as.Date(FINAL_DATE), y = FL_CM)) +</span></span>
<span id="cb95-702"><a href="#cb95-702" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(colour = LAND_GEAR_NAME, shape = LAND_GEAR_NAME), size = 1, alpha = 0.5) +</span></span>
<span id="cb95-703"><a href="#cb95-703" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth(method = "lm", formula = "y ~ x", col = "black") +</span></span>
<span id="cb95-704"><a href="#cb95-704" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb95-705"><a href="#cb95-705" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "", y = "Length (cm)", colour = "", shape = "") +</span></span>
<span id="cb95-706"><a href="#cb95-706" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb95-707"><a href="#cb95-707" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = "bottom", legend.text = element_text(size = 10),</span></span>
<span id="cb95-708"><a href="#cb95-708" aria-hidden="true" tabindex="-1"></a><span class="co">#         legend.box.spacing = unit(0, "npc"), panel.grid = element_blank()) +</span></span>
<span id="cb95-709"><a href="#cb95-709" aria-hidden="true" tabindex="-1"></a><span class="co">#   guides(colour = guide_legend(override.aes = list(size = 2)))</span></span>
<span id="cb95-710"><a href="#cb95-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-711"><a href="#cb95-711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-712"><a href="#cb95-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-713"><a href="#cb95-713" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_net_analysis}</span></span>
<span id="cb95-714"><a href="#cb95-714" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-715"><a href="#cb95-715" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-716"><a href="#cb95-716" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-717"><a href="#cb95-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-718"><a href="#cb95-718" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb95-719"><a href="#cb95-719" aria-hidden="true" tabindex="-1"></a><span class="co"># library(lmerTest)</span></span>
<span id="cb95-720"><a href="#cb95-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-721"><a href="#cb95-721" aria-hidden="true" tabindex="-1"></a><span class="do">########### initial testing to determine which variables are significant </span></span>
<span id="cb95-722"><a href="#cb95-722" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb95-723"><a href="#cb95-723" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = use_gear_nlg, REML = FALSE)</span></span>
<span id="cb95-724"><a href="#cb95-724" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb95-725"><a href="#cb95-725" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-726"><a href="#cb95-726" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb95-727"><a href="#cb95-727" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = use_gear_nlg, REML = FALSE)</span></span>
<span id="cb95-728"><a href="#cb95-728" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb95-729"><a href="#cb95-729" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-730"><a href="#cb95-730" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb95-731"><a href="#cb95-731" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb95-732"><a href="#cb95-732" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = use_gear_nlg, REML = FALSE)</span></span>
<span id="cb95-733"><a href="#cb95-733" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb95-734"><a href="#cb95-734" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb95-735"><a href="#cb95-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-736"><a href="#cb95-736" aria-hidden="true" tabindex="-1"></a><span class="do">########### START ANALYSIS HERE </span></span>
<span id="cb95-737"><a href="#cb95-737" aria-hidden="true" tabindex="-1"></a><span class="do">### both fixed linear and glm models have warning message because ENTANGLING NETS (GILL) UNSPECIFIED only occur in one year, preventing convergence across timeline </span></span>
<span id="cb95-738"><a href="#cb95-738" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb95-739"><a href="#cb95-739" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1.1 = lmer(FL_CM ~ scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb95-740"><a href="#cb95-740" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = use_gear_nlg, REML = FALSE)</span></span>
<span id="cb95-741"><a href="#cb95-741" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1.1)</span></span>
<span id="cb95-742"><a href="#cb95-742" aria-hidden="true" tabindex="-1"></a><span class="co"># # summary(mod1.1, correlation = FALSE)</span></span>
<span id="cb95-743"><a href="#cb95-743" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-744"><a href="#cb95-744" aria-hidden="true" tabindex="-1"></a><span class="co"># # comparing length to date and gear in a gamma full model</span></span>
<span id="cb95-745"><a href="#cb95-745" aria-hidden="true" tabindex="-1"></a><span class="co"># mod2 = glmer(FL_CM ~ scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb95-746"><a href="#cb95-746" aria-hidden="true" tabindex="-1"></a><span class="co">#              data = use_gear_nlg, family = Gamma(link=log))</span></span>
<span id="cb95-747"><a href="#cb95-747" aria-hidden="true" tabindex="-1"></a><span class="co"># # anova(mod2) #no p value given for gamma model by itself </span></span>
<span id="cb95-748"><a href="#cb95-748" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-749"><a href="#cb95-749" aria-hidden="true" tabindex="-1"></a><span class="co"># # check which number is lower, lower number is better fitting model </span></span>
<span id="cb95-750"><a href="#cb95-750" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC(mod1.1, mod2)</span></span>
<span id="cb95-751"><a href="#cb95-751" aria-hidden="true" tabindex="-1"></a><span class="co"># # glm is better fit</span></span>
<span id="cb95-752"><a href="#cb95-752" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-753"><a href="#cb95-753" aria-hidden="true" tabindex="-1"></a><span class="co"># # gamma reduced model</span></span>
<span id="cb95-754"><a href="#cb95-754" aria-hidden="true" tabindex="-1"></a><span class="co"># mod3 = glmer(FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb95-755"><a href="#cb95-755" aria-hidden="true" tabindex="-1"></a><span class="co">#              data = use_gear_nlg, family = Gamma(link=log))</span></span>
<span id="cb95-756"><a href="#cb95-756" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-757"><a href="#cb95-757" aria-hidden="true" tabindex="-1"></a><span class="co"># mod4 = glmer(FL_CM ~ LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb95-758"><a href="#cb95-758" aria-hidden="true" tabindex="-1"></a><span class="co">#              data = use_gear_nlg, family = Gamma(link=log))</span></span>
<span id="cb95-759"><a href="#cb95-759" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-760"><a href="#cb95-760" aria-hidden="true" tabindex="-1"></a><span class="co"># # likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb95-761"><a href="#cb95-761" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod2, mod3) #gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb95-762"><a href="#cb95-762" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod2, mod4) #gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb95-763"><a href="#cb95-763" aria-hidden="true" tabindex="-1"></a><span class="co"># # No significant p values for time period or gears</span></span>
<span id="cb95-764"><a href="#cb95-764" aria-hidden="true" tabindex="-1"></a><span class="co"># # Further comparisons not needed </span></span>
<span id="cb95-765"><a href="#cb95-765" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-766"><a href="#cb95-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-767"><a href="#cb95-767" aria-hidden="true" tabindex="-1"></a><span class="fu">## Trap</span></span>
<span id="cb95-768"><a href="#cb95-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-769"><a href="#cb95-769" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_trap_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb95-770"><a href="#cb95-770" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-771"><a href="#cb95-771" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-772"><a href="#cb95-772" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-773"><a href="#cb95-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-774"><a href="#cb95-774" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb95-775"><a href="#cb95-775" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) </span>
<span id="cb95-776"><a href="#cb95-776" aria-hidden="true" tabindex="-1"></a><span class="co"># net land_standard_gear_name</span></span>
<span id="cb95-777"><a href="#cb95-777" aria-hidden="true" tabindex="-1"></a>use_gear_tr <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb95-778"><a href="#cb95-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb95-779"><a href="#cb95-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear <span class="sc">==</span> <span class="st">"Trap"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb95-780"><a href="#cb95-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb95-781"><a href="#cb95-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb95-782"><a href="#cb95-782" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb95-783"><a href="#cb95-783" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb95-784"><a href="#cb95-784" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(use_gear_tr, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb95-785"><a href="#cb95-785" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb95-786"><a href="#cb95-786" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb95-787"><a href="#cb95-787" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb95-788"><a href="#cb95-788" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb95-789"><a href="#cb95-789" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(use_gear_tr, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb95-790"><a href="#cb95-790" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb95-791"><a href="#cb95-791" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb95-792"><a href="#cb95-792" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb95-793"><a href="#cb95-793" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb95-794"><a href="#cb95-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-795"><a href="#cb95-795" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb95-796"><a href="#cb95-796" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb95-797"><a href="#cb95-797" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(use_gear_tr, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb95-798"><a href="#cb95-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb95-799"><a href="#cb95-799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb95-800"><a href="#cb95-800" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb95-801"><a href="#cb95-801" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb95-802"><a href="#cb95-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb95-803"><a href="#cb95-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb95-804"><a href="#cb95-804" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb95-805"><a href="#cb95-805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb95-806"><a href="#cb95-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-807"><a href="#cb95-807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-808"><a href="#cb95-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-809"><a href="#cb95-809" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_trap_analysis}</span></span>
<span id="cb95-810"><a href="#cb95-810" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-811"><a href="#cb95-811" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-812"><a href="#cb95-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-813"><a href="#cb95-813" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb95-814"><a href="#cb95-814" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb95-815"><a href="#cb95-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-816"><a href="#cb95-816" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb95-817"><a href="#cb95-817" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb95-818"><a href="#cb95-818" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_tr, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb95-819"><a href="#cb95-819" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span>
<span id="cb95-820"><a href="#cb95-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-821"><a href="#cb95-821" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb95-822"><a href="#cb95-822" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb95-823"><a href="#cb95-823" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb95-824"><a href="#cb95-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-825"><a href="#cb95-825" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb95-826"><a href="#cb95-826" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb95-827"><a href="#cb95-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-828"><a href="#cb95-828" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb95-829"><a href="#cb95-829" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb95-830"><a href="#cb95-830" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb95-831"><a href="#cb95-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-832"><a href="#cb95-832" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb95-833"><a href="#cb95-833" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb95-834"><a href="#cb95-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-835"><a href="#cb95-835" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb95-836"><a href="#cb95-836" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb95-837"><a href="#cb95-837" aria-hidden="true" tabindex="-1"></a><span class="do">### Trap does not have any significantly different gears </span></span>
<span id="cb95-838"><a href="#cb95-838" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb95-839"><a href="#cb95-839" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb95-840"><a href="#cb95-840" aria-hidden="true" tabindex="-1"></a><span class="do">### There is no significantly different time in the Trap grouping </span></span>
<span id="cb95-841"><a href="#cb95-841" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb95-842"><a href="#cb95-842" aria-hidden="true" tabindex="-1"></a><span class="co"># No significant p values for time period or gears, further comparisons not needed </span></span>
<span id="cb95-843"><a href="#cb95-843" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-844"><a href="#cb95-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-845"><a href="#cb95-845" aria-hidden="true" tabindex="-1"></a><span class="fu"># Gear Density Plots </span></span>
<span id="cb95-846"><a href="#cb95-846" aria-hidden="true" tabindex="-1"></a>Filtered to years with 30 or more length records (regardless of gear) per year.</span>
<span id="cb95-847"><a href="#cb95-847" aria-hidden="true" tabindex="-1"></a>STT and STJ records are grouped together. </span>
<span id="cb95-848"><a href="#cb95-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-849"><a href="#cb95-849" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aggregated density plots</span></span>
<span id="cb95-850"><a href="#cb95-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-851"><a href="#cb95-851" aria-hidden="true" tabindex="-1"></a><span class="in">```{r agg_pdf_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb95-852"><a href="#cb95-852" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-853"><a href="#cb95-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-854"><a href="#cb95-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-855"><a href="#cb95-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-856"><a href="#cb95-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-857"><a href="#cb95-857" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################</span></span>
<span id="cb95-858"><a href="#cb95-858" aria-hidden="true" tabindex="-1"></a><span class="co"># dscounts = VLg %&gt;% group_by(source) %&gt;% filter(n() &gt;= 30) %&gt;% ungroup %&gt;% </span></span>
<span id="cb95-859"><a href="#cb95-859" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(source) %&gt;%</span></span>
<span id="cb95-860"><a href="#cb95-860" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(source, " (n= ", scales::comma(n), ")" ))</span></span>
<span id="cb95-861"><a href="#cb95-861" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-862"><a href="#cb95-862" aria-hidden="true" tabindex="-1"></a><span class="co"># dscc &lt;- scales::seq_gradient_pal("#22D463", "red", "Lab")(seq(0,1,length.out=dim(dscounts)[1]))</span></span>
<span id="cb95-863"><a href="#cb95-863" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-864"><a href="#cb95-864" aria-hidden="true" tabindex="-1"></a><span class="co">#  VLg %&gt;% group_by(source) %&gt;% filter(n() &gt;= 30) %&gt;% ungroup %&gt;% </span></span>
<span id="cb95-865"><a href="#cb95-865" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(FL_CM))+</span></span>
<span id="cb95-866"><a href="#cb95-866" aria-hidden="true" tabindex="-1"></a><span class="co"># #  geom_density( aes(color = "Combined"))+</span></span>
<span id="cb95-867"><a href="#cb95-867" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_density(aes(color = source))+</span></span>
<span id="cb95-868"><a href="#cb95-868" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_manual(values = dscc, labels = c(dscounts$n_labels))+</span></span>
<span id="cb95-869"><a href="#cb95-869" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Vertical Line Data Sources", x = "Fork Length (cm)", title = paste0(region,  " VL \n (N = ", scales::comma(sum(dscounts$n)), ")"))+</span></span>
<span id="cb95-870"><a href="#cb95-870" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()+ guides(colour=guide_legend(ncol=1))</span></span>
<span id="cb95-871"><a href="#cb95-871" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb95-872"><a href="#cb95-872" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb95-873"><a href="#cb95-873" aria-hidden="true" tabindex="-1"></a><span class="co"># table(VLg$YEAR,VLg$source)</span></span>
<span id="cb95-874"><a href="#cb95-874" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################</span></span>
<span id="cb95-875"><a href="#cb95-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-876"><a href="#cb95-876" aria-hidden="true" tabindex="-1"></a><span class="do">#####################EDIT HERE ; NOT WORKING BELOW (I don't think)</span></span>
<span id="cb95-877"><a href="#cb95-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-878"><a href="#cb95-878" aria-hidden="true" tabindex="-1"></a>ycounts <span class="ot">=</span>length_data_final <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb95-879"><a href="#cb95-879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(gear) <span class="sc">%&gt;%</span></span>
<span id="cb95-880"><a href="#cb95-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(gear, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-881"><a href="#cb95-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-882"><a href="#cb95-882" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb95-883"><a href="#cb95-883" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM))<span class="sc">+</span></span>
<span id="cb95-884"><a href="#cb95-884" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_density( aes(color = "Combined"),lwd=1.5)+</span></span>
<span id="cb95-885"><a href="#cb95-885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> gear), <span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb95-886"><a href="#cb95-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>ycounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-887"><a href="#cb95-887" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_hue(labels=c("Combined",ycounts$n_labels))+</span></span>
<span id="cb95-888"><a href="#cb95-888" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = gearcols, labels = c("Combined", counts$n_labels))+</span></span>
<span id="cb95-889"><a href="#cb95-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(region,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-890"><a href="#cb95-890" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-891"><a href="#cb95-891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-892"><a href="#cb95-892" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-893"><a href="#cb95-893" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb95-894"><a href="#cb95-894" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb95-895"><a href="#cb95-895" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb95-896"><a href="#cb95-896" aria-hidden="true" tabindex="-1"></a><span class="co">#  filter to 30 or more of same gear each year </span></span>
<span id="cb95-897"><a href="#cb95-897" aria-hidden="true" tabindex="-1"></a><span class="co"># ygearcounts =length_data_final |&gt; </span></span>
<span id="cb95-898"><a href="#cb95-898" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(YEAR, LAND_STANDARD_GEAR_NAME) |&gt;</span></span>
<span id="cb95-899"><a href="#cb95-899" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(n() &gt;= 30)|&gt;</span></span>
<span id="cb95-900"><a href="#cb95-900" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb95-901"><a href="#cb95-901" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(gear) %&gt;%</span></span>
<span id="cb95-902"><a href="#cb95-902" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_gearlabels = paste0(gear, " (n= ", n, ")" ))</span></span>
<span id="cb95-903"><a href="#cb95-903" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-904"><a href="#cb95-904" aria-hidden="true" tabindex="-1"></a><span class="co">#  length_data_final |&gt; </span></span>
<span id="cb95-905"><a href="#cb95-905" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(YEAR, LAND_STANDARD_GEAR_NAME) |&gt;</span></span>
<span id="cb95-906"><a href="#cb95-906" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(n() &gt;= 30)|&gt;</span></span>
<span id="cb95-907"><a href="#cb95-907" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb95-908"><a href="#cb95-908" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(FL_CM))+</span></span>
<span id="cb95-909"><a href="#cb95-909" aria-hidden="true" tabindex="-1"></a><span class="co">#  # geom_density( aes(color = "Combined"),lwd=1.5)+</span></span>
<span id="cb95-910"><a href="#cb95-910" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_density(aes(color = gear), size = 0.75)+</span></span>
<span id="cb95-911"><a href="#cb95-911" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_hue(labels=ygearcounts$n_gearlabels)+</span></span>
<span id="cb95-912"><a href="#cb95-912" aria-hidden="true" tabindex="-1"></a><span class="co">#  # scale_color_hue(labels=c("Combined",ycounts$n_labels))+</span></span>
<span id="cb95-913"><a href="#cb95-913" aria-hidden="true" tabindex="-1"></a><span class="co">#   #scale_color_manual(values = gearcols, labels = c("Combined", counts$n_labels))+</span></span>
<span id="cb95-914"><a href="#cb95-914" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Gear Type", x = "Fork Length (cm)", title = paste0(region,  "\n (N = ", sum(ygearcounts$n), ")"))+</span></span>
<span id="cb95-915"><a href="#cb95-915" aria-hidden="true" tabindex="-1"></a><span class="co">#   # theme_minimal()</span></span>
<span id="cb95-916"><a href="#cb95-916" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.title = element_text(size=14), </span></span>
<span id="cb95-917"><a href="#cb95-917" aria-hidden="true" tabindex="-1"></a><span class="co">#     legend.text = element_text(size=12))</span></span>
<span id="cb95-918"><a href="#cb95-918" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb95-919"><a href="#cb95-919" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb95-920"><a href="#cb95-920" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-921"><a href="#cb95-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-922"><a href="#cb95-922" aria-hidden="true" tabindex="-1"></a>USVI TIP length comps by gear and interview type. Investigate if MARFIN and MRAG interview types can be used or should be dropped?</span>
<span id="cb95-923"><a href="#cb95-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-924"><a href="#cb95-924" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=12, fig.height=8}</span></span>
<span id="cb95-925"><a href="#cb95-925" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-926"><a href="#cb95-926" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-927"><a href="#cb95-927" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-928"><a href="#cb95-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-929"><a href="#cb95-929" aria-hidden="true" tabindex="-1"></a><span class="co">#table(tip_CR$INT_TYPE,useNA='always')</span></span>
<span id="cb95-930"><a href="#cb95-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-931"><a href="#cb95-931" aria-hidden="true" tabindex="-1"></a>usvi <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>STATE<span class="sc">==</span><span class="st">'VIRGIN ISLANDS'</span>,]</span>
<span id="cb95-932"><a href="#cb95-932" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> usvi <span class="sc">%&gt;%</span></span>
<span id="cb95-933"><a href="#cb95-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(INT_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb95-934"><a href="#cb95-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(INT_TYPE, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-935"><a href="#cb95-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-936"><a href="#cb95-936" aria-hidden="true" tabindex="-1"></a>  usvi <span class="sc">%&gt;%</span></span>
<span id="cb95-937"><a href="#cb95-937" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> INT_TYPE))<span class="sc">+</span></span>
<span id="cb95-938"><a href="#cb95-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb95-939"><a href="#cb95-939" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-940"><a href="#cb95-940" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-941"><a href="#cb95-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Interview Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(usvi<span class="sc">$</span>STATE,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-942"><a href="#cb95-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>gear) <span class="sc">+</span></span>
<span id="cb95-943"><a href="#cb95-943" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-944"><a href="#cb95-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-945"><a href="#cb95-945" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-946"><a href="#cb95-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-947"><a href="#cb95-947" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-948"><a href="#cb95-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-949"><a href="#cb95-949" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gear grouping investigation</span></span>
<span id="cb95-950"><a href="#cb95-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-951"><a href="#cb95-951" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb95-952"><a href="#cb95-952" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-953"><a href="#cb95-953" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-954"><a href="#cb95-954" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-955"><a href="#cb95-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-956"><a href="#cb95-956" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb95-957"><a href="#cb95-957" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb95-958"><a href="#cb95-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb95-959"><a href="#cb95-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>ycounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-960"><a href="#cb95-960" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-961"><a href="#cb95-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-962"><a href="#cb95-962" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-963"><a href="#cb95-963" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-964"><a href="#cb95-964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-965"><a href="#cb95-965" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-966"><a href="#cb95-966" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-967"><a href="#cb95-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-968"><a href="#cb95-968" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-969"><a href="#cb95-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-970"><a href="#cb95-970" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_hl_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb95-971"><a href="#cb95-971" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-972"><a href="#cb95-972" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-973"><a href="#cb95-973" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-974"><a href="#cb95-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-975"><a href="#cb95-975" aria-hidden="true" tabindex="-1"></a>hl<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'HL'</span>,]</span>
<span id="cb95-976"><a href="#cb95-976" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> hl <span class="sc">%&gt;%</span></span>
<span id="cb95-977"><a href="#cb95-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb95-978"><a href="#cb95-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-979"><a href="#cb95-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-980"><a href="#cb95-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-981"><a href="#cb95-981" aria-hidden="true" tabindex="-1"></a><span class="co"># hl_car &lt;-</span></span>
<span id="cb95-982"><a href="#cb95-982" aria-hidden="true" tabindex="-1"></a>hl <span class="sc">%&gt;%</span></span>
<span id="cb95-983"><a href="#cb95-983" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb95-984"><a href="#cb95-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb95-985"><a href="#cb95-985" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-986"><a href="#cb95-986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-987"><a href="#cb95-987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-988"><a href="#cb95-988" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-989"><a href="#cb95-989" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-990"><a href="#cb95-990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-991"><a href="#cb95-991" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-992"><a href="#cb95-992" aria-hidden="true" tabindex="-1"></a><span class="co"># hl_car</span></span>
<span id="cb95-993"><a href="#cb95-993" aria-hidden="true" tabindex="-1"></a><span class="co"># export_fig(hl_car)</span></span>
<span id="cb95-994"><a href="#cb95-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-995"><a href="#cb95-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-996"><a href="#cb95-996" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-997"><a href="#cb95-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-998"><a href="#cb95-998" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_trap_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb95-999"><a href="#cb95-999" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1000"><a href="#cb95-1000" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1001"><a href="#cb95-1001" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1002"><a href="#cb95-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1003"><a href="#cb95-1003" aria-hidden="true" tabindex="-1"></a>trap <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'TR'</span>,]</span>
<span id="cb95-1004"><a href="#cb95-1004" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> trap <span class="sc">%&gt;%</span></span>
<span id="cb95-1005"><a href="#cb95-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb95-1006"><a href="#cb95-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1007"><a href="#cb95-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1008"><a href="#cb95-1008" aria-hidden="true" tabindex="-1"></a>trap <span class="sc">%&gt;%</span></span>
<span id="cb95-1009"><a href="#cb95-1009" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb95-1010"><a href="#cb95-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb95-1011"><a href="#cb95-1011" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1012"><a href="#cb95-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1013"><a href="#cb95-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1014"><a href="#cb95-1014" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1015"><a href="#cb95-1015" aria-hidden="true" tabindex="-1"></a> <span class="co"># theme_minimal()</span></span>
<span id="cb95-1016"><a href="#cb95-1016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-1017"><a href="#cb95-1017" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-1018"><a href="#cb95-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1019"><a href="#cb95-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1020"><a href="#cb95-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1021"><a href="#cb95-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_net_plot,fig.width=12, fig.height=8}</span></span>
<span id="cb95-1022"><a href="#cb95-1022" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1023"><a href="#cb95-1023" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1024"><a href="#cb95-1024" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1025"><a href="#cb95-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1026"><a href="#cb95-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#nets might need to be another category because haul seines, trammel, and entangling (gill unsp) have too many occurances to be in other </span></span>
<span id="cb95-1027"><a href="#cb95-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1028"><a href="#cb95-1028" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'NT'</span>,]</span>
<span id="cb95-1029"><a href="#cb95-1029" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> net <span class="sc">%&gt;%</span></span>
<span id="cb95-1030"><a href="#cb95-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb95-1031"><a href="#cb95-1031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1032"><a href="#cb95-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1033"><a href="#cb95-1033" aria-hidden="true" tabindex="-1"></a>net <span class="sc">%&gt;%</span></span>
<span id="cb95-1034"><a href="#cb95-1034" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM,<span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb95-1035"><a href="#cb95-1035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb95-1036"><a href="#cb95-1036" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1037"><a href="#cb95-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1038"><a href="#cb95-1038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1039"><a href="#cb95-1039" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1040"><a href="#cb95-1040" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-1041"><a href="#cb95-1041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-1042"><a href="#cb95-1042" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-1043"><a href="#cb95-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1044"><a href="#cb95-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1045"><a href="#cb95-1045" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1046"><a href="#cb95-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1047"><a href="#cb95-1047" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_other_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb95-1048"><a href="#cb95-1048" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1049"><a href="#cb95-1049" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1050"><a href="#cb95-1050" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1051"><a href="#cb95-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1052"><a href="#cb95-1052" aria-hidden="true" tabindex="-1"></a>ot<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'OT'</span>,]</span>
<span id="cb95-1053"><a href="#cb95-1053" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> ot <span class="sc">%&gt;%</span></span>
<span id="cb95-1054"><a href="#cb95-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb95-1055"><a href="#cb95-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1056"><a href="#cb95-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1057"><a href="#cb95-1057" aria-hidden="true" tabindex="-1"></a>ot <span class="sc">%&gt;%</span></span>
<span id="cb95-1058"><a href="#cb95-1058" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb95-1059"><a href="#cb95-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb95-1060"><a href="#cb95-1060" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1061"><a href="#cb95-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1062"><a href="#cb95-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1063"><a href="#cb95-1063" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1064"><a href="#cb95-1064" aria-hidden="true" tabindex="-1"></a> <span class="co"># theme_minimal()</span></span>
<span id="cb95-1065"><a href="#cb95-1065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-1066"><a href="#cb95-1066" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-1067"><a href="#cb95-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1068"><a href="#cb95-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1069"><a href="#cb95-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1070"><a href="#cb95-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">## Break at 2005</span></span>
<span id="cb95-1071"><a href="#cb95-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1072"><a href="#cb95-1072" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_plot_2005, fig.width=15, fig.height=8}</span></span>
<span id="cb95-1073"><a href="#cb95-1073" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1074"><a href="#cb95-1074" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-1075"><a href="#cb95-1075" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1076"><a href="#cb95-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1077"><a href="#cb95-1077" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> <span class="co"># filter(YEAR &gt; 2011) |&gt; </span></span>
<span id="cb95-1078"><a href="#cb95-1078" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb95-1079"><a href="#cb95-1079" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb95-1080"><a href="#cb95-1080" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>ycounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1081"><a href="#cb95-1081" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1082"><a href="#cb95-1082" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1083"><a href="#cb95-1083" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1084"><a href="#cb95-1084" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~mgt_period) +</span></span>
<span id="cb95-1085"><a href="#cb95-1085" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-1086"><a href="#cb95-1086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-1087"><a href="#cb95-1087" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-1088"><a href="#cb95-1088" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1089"><a href="#cb95-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1090"><a href="#cb95-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1091"><a href="#cb95-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1092"><a href="#cb95-1092" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_hookandline_plot_2005, fig.width=15, fig.height=8}</span></span>
<span id="cb95-1093"><a href="#cb95-1093" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1094"><a href="#cb95-1094" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1095"><a href="#cb95-1095" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1096"><a href="#cb95-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1097"><a href="#cb95-1097" aria-hidden="true" tabindex="-1"></a>HL <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'HL'</span>,]</span>
<span id="cb95-1098"><a href="#cb95-1098" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> HL <span class="sc">%&gt;%</span></span>
<span id="cb95-1099"><a href="#cb95-1099" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb95-1100"><a href="#cb95-1100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1101"><a href="#cb95-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1102"><a href="#cb95-1102" aria-hidden="true" tabindex="-1"></a>HL <span class="sc">%&gt;%</span> <span class="co">#filter(YEAR &gt; 2011) |&gt; </span></span>
<span id="cb95-1103"><a href="#cb95-1103" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb95-1104"><a href="#cb95-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb95-1105"><a href="#cb95-1105" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1106"><a href="#cb95-1106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1107"><a href="#cb95-1107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1108"><a href="#cb95-1108" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1109"><a href="#cb95-1109" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~mgt_period) +</span></span>
<span id="cb95-1110"><a href="#cb95-1110" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-1111"><a href="#cb95-1111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-1112"><a href="#cb95-1112" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-1113"><a href="#cb95-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1114"><a href="#cb95-1114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1115"><a href="#cb95-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1116"><a href="#cb95-1116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_net_plot_2005, fig.width=12, fig.height=8}</span></span>
<span id="cb95-1117"><a href="#cb95-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1118"><a href="#cb95-1118" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1119"><a href="#cb95-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1120"><a href="#cb95-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1121"><a href="#cb95-1121" aria-hidden="true" tabindex="-1"></a><span class="co">#nets might need to be another category because haul seines, trammel, and entangling (gill unsp) have too many occurances to be in other </span></span>
<span id="cb95-1122"><a href="#cb95-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1123"><a href="#cb95-1123" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'NT'</span>,]</span>
<span id="cb95-1124"><a href="#cb95-1124" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> net <span class="sc">%&gt;%</span></span>
<span id="cb95-1125"><a href="#cb95-1125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb95-1126"><a href="#cb95-1126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1127"><a href="#cb95-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1128"><a href="#cb95-1128" aria-hidden="true" tabindex="-1"></a>net <span class="sc">%&gt;%</span> <span class="co">#filter(YEAR &gt; 2011) |&gt;</span></span>
<span id="cb95-1129"><a href="#cb95-1129" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM,<span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb95-1130"><a href="#cb95-1130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb95-1131"><a href="#cb95-1131" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1132"><a href="#cb95-1132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1133"><a href="#cb95-1133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1134"><a href="#cb95-1134" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1135"><a href="#cb95-1135" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~mgt_period) +</span></span>
<span id="cb95-1136"><a href="#cb95-1136" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-1137"><a href="#cb95-1137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-1138"><a href="#cb95-1138" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-1139"><a href="#cb95-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1140"><a href="#cb95-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1141"><a href="#cb95-1141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1142"><a href="#cb95-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1143"><a href="#cb95-1143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_trap_plot_2005, fig.width=12, fig.height=8}</span></span>
<span id="cb95-1144"><a href="#cb95-1144" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1145"><a href="#cb95-1145" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1146"><a href="#cb95-1146" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1147"><a href="#cb95-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1148"><a href="#cb95-1148" aria-hidden="true" tabindex="-1"></a>trap <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'TR'</span>,]</span>
<span id="cb95-1149"><a href="#cb95-1149" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> trap <span class="sc">%&gt;%</span></span>
<span id="cb95-1150"><a href="#cb95-1150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb95-1151"><a href="#cb95-1151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1152"><a href="#cb95-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1153"><a href="#cb95-1153" aria-hidden="true" tabindex="-1"></a>trap <span class="sc">%&gt;%</span> <span class="co">#filter(YEAR &gt; 2011) |&gt;</span></span>
<span id="cb95-1154"><a href="#cb95-1154" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM,<span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb95-1155"><a href="#cb95-1155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb95-1156"><a href="#cb95-1156" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1157"><a href="#cb95-1157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1158"><a href="#cb95-1158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1159"><a href="#cb95-1159" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1160"><a href="#cb95-1160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb95-1161"><a href="#cb95-1161" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-1162"><a href="#cb95-1162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-1163"><a href="#cb95-1163" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-1164"><a href="#cb95-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1165"><a href="#cb95-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1166"><a href="#cb95-1166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1167"><a href="#cb95-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1168"><a href="#cb95-1168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_other_plot_2005, fig.width=15, fig.height=8}</span></span>
<span id="cb95-1169"><a href="#cb95-1169" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1170"><a href="#cb95-1170" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1171"><a href="#cb95-1171" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1172"><a href="#cb95-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1173"><a href="#cb95-1173" aria-hidden="true" tabindex="-1"></a>ot<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'OT'</span>,]</span>
<span id="cb95-1174"><a href="#cb95-1174" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> ot <span class="sc">%&gt;%</span></span>
<span id="cb95-1175"><a href="#cb95-1175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb95-1176"><a href="#cb95-1176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1177"><a href="#cb95-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1178"><a href="#cb95-1178" aria-hidden="true" tabindex="-1"></a>ot <span class="sc">%&gt;%</span> <span class="co"># filter(YEAR &gt; 2011) |&gt; </span></span>
<span id="cb95-1179"><a href="#cb95-1179" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb95-1180"><a href="#cb95-1180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb95-1181"><a href="#cb95-1181" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1182"><a href="#cb95-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1183"><a href="#cb95-1183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1184"><a href="#cb95-1184" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1185"><a href="#cb95-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb95-1186"><a href="#cb95-1186" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-1187"><a href="#cb95-1187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-1188"><a href="#cb95-1188" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-1189"><a href="#cb95-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1190"><a href="#cb95-1190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1191"><a href="#cb95-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1192"><a href="#cb95-1192" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual Density plots</span></span>
<span id="cb95-1193"><a href="#cb95-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1194"><a href="#cb95-1194" aria-hidden="true" tabindex="-1"></a>This will be split by final gear aggregations once these are decided, removes "other" gear types.</span>
<span id="cb95-1195"><a href="#cb95-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1196"><a href="#cb95-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual_pdf_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb95-1197"><a href="#cb95-1197" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1198"><a href="#cb95-1198" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1199"><a href="#cb95-1199" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-1200"><a href="#cb95-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1201"><a href="#cb95-1201" aria-hidden="true" tabindex="-1"></a>fleet_final <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>fleet<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb95-1202"><a href="#cb95-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1203"><a href="#cb95-1203" aria-hidden="true" tabindex="-1"></a>fcounts <span class="ot">=</span> fleet_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb95-1204"><a href="#cb95-1204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(gear) <span class="sc">%&gt;%</span></span>
<span id="cb95-1205"><a href="#cb95-1205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(gear, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1206"><a href="#cb95-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1207"><a href="#cb95-1207" aria-hidden="true" tabindex="-1"></a>all_car <span class="ot">&lt;-</span></span>
<span id="cb95-1208"><a href="#cb95-1208" aria-hidden="true" tabindex="-1"></a> fleet_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb95-1209"><a href="#cb95-1209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb95-1210"><a href="#cb95-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_labs =</span> <span class="fu">paste0</span>(YEAR, <span class="st">"</span><span class="sc">\n</span><span class="st"> n = "</span>, <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb95-1211"><a href="#cb95-1211" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb95-1212"><a href="#cb95-1212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb95-1213"><a href="#cb95-1213" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1214"><a href="#cb95-1214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>fcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1215"><a href="#cb95-1215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(fcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1216"><a href="#cb95-1216" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>year_labs)<span class="sc">+</span></span>
<span id="cb95-1217"><a href="#cb95-1217" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-1218"><a href="#cb95-1218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-1219"><a href="#cb95-1219" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-1220"><a href="#cb95-1220" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1221"><a href="#cb95-1221" aria-hidden="true" tabindex="-1"></a>all_car</span>
<span id="cb95-1222"><a href="#cb95-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">export_fig_page</span>(all_car)</span>
<span id="cb95-1223"><a href="#cb95-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1224"><a href="#cb95-1224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1225"><a href="#cb95-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1226"><a href="#cb95-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1227"><a href="#cb95-1227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r STT}</span></span>
<span id="cb95-1228"><a href="#cb95-1228" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1229"><a href="#cb95-1229" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1230"><a href="#cb95-1230" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-1231"><a href="#cb95-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1232"><a href="#cb95-1232" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_final<span class="sc">$</span>ISLAND)</span>
<span id="cb95-1233"><a href="#cb95-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1234"><a href="#cb95-1234" aria-hidden="true" tabindex="-1"></a>ST <span class="ot">&lt;-</span> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb95-1235"><a href="#cb95-1235" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(ISLAND<span class="sc">==</span><span class="st">'ST THOMAS'</span><span class="sc">|</span>ISLAND<span class="sc">==</span><span class="st">'ST JOHN'</span>)</span>
<span id="cb95-1236"><a href="#cb95-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1237"><a href="#cb95-1237" aria-hidden="true" tabindex="-1"></a>vessel_st <span class="ot">&lt;-</span> <span class="fu">distinct</span>(ST, VESSEL_ID, LICENSE)</span>
<span id="cb95-1238"><a href="#cb95-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1239"><a href="#cb95-1239" aria-hidden="true" tabindex="-1"></a>final_gears <span class="ot">&lt;-</span> <span class="fu">unique</span>(ST<span class="sc">$</span>gear_short)  <span class="do">##++this is where final length comps are generated ; could be aggregated above (e.g. via lookup table) &amp; should be 1 here </span></span>
<span id="cb95-1240"><a href="#cb95-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1241"><a href="#cb95-1241" aria-hidden="true" tabindex="-1"></a>ST_comps <span class="ot">&lt;-</span> <span class="fu">list</span>()  <span class="do">##++this creates an empty list for for loop</span></span>
<span id="cb95-1242"><a href="#cb95-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1243"><a href="#cb95-1243" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop generates binned length comps for each of the final gears. Stored in list. RUN:  View(comps[[1]]) to see in R</span></span>
<span id="cb95-1244"><a href="#cb95-1244" aria-hidden="true" tabindex="-1"></a><span class="co"># View(ST_comps[[1]])</span></span>
<span id="cb95-1245"><a href="#cb95-1245" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(final_gears)){</span>
<span id="cb95-1246"><a href="#cb95-1246" aria-hidden="true" tabindex="-1"></a> ST_comps[[i]] <span class="ot">&lt;-</span>  ST <span class="sc">%&gt;%</span></span>
<span id="cb95-1247"><a href="#cb95-1247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear_short <span class="sc">==</span> final_gears[i]) <span class="sc">%&gt;%</span></span>
<span id="cb95-1248"><a href="#cb95-1248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb95-1249"><a href="#cb95-1249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ln_fish =</span> <span class="fu">n</span>(),</span>
<span id="cb95-1250"><a href="#cb95-1250" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_trips =</span> <span class="fu">length</span>(<span class="fu">unique</span>(ID)),</span>
<span id="cb95-1251"><a href="#cb95-1251" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_dealers=</span><span class="fu">length</span>(<span class="fu">unique</span>(DEALER_CODE)),</span>
<span id="cb95-1252"><a href="#cb95-1252" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_vessels=</span><span class="fu">length</span>(<span class="fu">unique</span>(VESSEL_ID))) <span class="sc">%&gt;%</span></span>
<span id="cb95-1253"><a href="#cb95-1253" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb95-1254"><a href="#cb95-1254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels, lbin)<span class="sc">%&gt;%</span></span>
<span id="cb95-1255"><a href="#cb95-1255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">unique</span>(ln_fish)) <span class="sc">%&gt;%</span></span>
<span id="cb95-1256"><a href="#cb95-1256" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb95-1257"><a href="#cb95-1257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels), </span>
<span id="cb95-1258"><a href="#cb95-1258" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> lbin, </span>
<span id="cb95-1259"><a href="#cb95-1259" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> freq, </span>
<span id="cb95-1260"><a href="#cb95-1260" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">freq =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb95-1261"><a href="#cb95-1261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(full_set) <span class="sc">%&gt;%</span></span>
<span id="cb95-1262"><a href="#cb95-1262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comp_names)<span class="sc">%&gt;%</span></span>
<span id="cb95-1263"><a href="#cb95-1263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-1264"><a href="#cb95-1264" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">flag_n  =</span> <span class="fu">ifelse</span>(ln_fish <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">0</span>, </span>
<span id="cb95-1265"><a href="#cb95-1265" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(ln_fish <span class="sc">&lt;</span> <span class="dv">15</span>, <span class="dv">2</span>, <span class="dv">1</span>)))</span>
<span id="cb95-1266"><a href="#cb95-1266" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb95-1267"><a href="#cb95-1267" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(ST_comps)[[i]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(final_gears[i], <span class="st">"_"</span>, bin_size, <span class="st">"cm"</span>) <span class="do">##++tabs are named here ; could add _nom here if desired (instead of _lfd and _lfdw in main file)</span></span>
<span id="cb95-1268"><a href="#cb95-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1269"><a href="#cb95-1269" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb95-1270"><a href="#cb95-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1271"><a href="#cb95-1271" aria-hidden="true" tabindex="-1"></a><span class="co">#write.xlsx(ST_comps, file="./comps/ST_QTF_com_lfd_8319_20210827C.xlsx")</span></span>
<span id="cb95-1272"><a href="#cb95-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1273"><a href="#cb95-1273" aria-hidden="true" tabindex="-1"></a><span class="do">##NOT WORKING =(</span></span>
<span id="cb95-1274"><a href="#cb95-1274" aria-hidden="true" tabindex="-1"></a><span class="co">#write.xlsx(comps, file = paste0("./comps/", sp, "_com_lfd_", sprintf('%02d', min_year %% 100), sprintf('%02d', max_year %% 100), "_", gsub("-", "", Sys.Date()), ".xlsx"))</span></span>
<span id="cb95-1275"><a href="#cb95-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1276"><a href="#cb95-1276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1277"><a href="#cb95-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1278"><a href="#cb95-1278" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stacked bar charts</span></span>
<span id="cb95-1279"><a href="#cb95-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1280"><a href="#cb95-1280" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visual representation of gear distribution within groupings</span></span>
<span id="cb95-1281"><a href="#cb95-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1282"><a href="#cb95-1282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_plot, fig.width=10, fig.height=6}</span></span>
<span id="cb95-1283"><a href="#cb95-1283" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1284"><a href="#cb95-1284" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1285"><a href="#cb95-1285" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1286"><a href="#cb95-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1287"><a href="#cb95-1287" aria-hidden="true" tabindex="-1"></a><span class="co"># counts =length_data_final %&gt;%</span></span>
<span id="cb95-1288"><a href="#cb95-1288" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(gear) %&gt;%</span></span>
<span id="cb95-1289"><a href="#cb95-1289" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(gear, " (n= ", n, ")" ))</span></span>
<span id="cb95-1290"><a href="#cb95-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1291"><a href="#cb95-1291" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb95-1292"><a href="#cb95-1292" aria-hidden="true" tabindex="-1"></a>  length_data_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb95-1293"><a href="#cb95-1293" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> LAND_STANDARD_GEAR_NAME, <span class="at">y =</span> FL_CM, <span class="at">x=</span> gear))<span class="sc">+</span></span>
<span id="cb95-1294"><a href="#cb95-1294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">stat=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb95-1295"><a href="#cb95-1295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>ycounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1296"><a href="#cb95-1296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1297"><a href="#cb95-1297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb95-1298"><a href="#cb95-1298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))</span>
<span id="cb95-1299"><a href="#cb95-1299" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guides(color = guide_legend(override.aes = list(size = 0.5))) </span></span>
<span id="cb95-1300"><a href="#cb95-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1301"><a href="#cb95-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1302"><a href="#cb95-1302" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1303"><a href="#cb95-1303" aria-hidden="true" tabindex="-1"></a><span class="co"># # hl_car &lt;-</span></span>
<span id="cb95-1304"><a href="#cb95-1304" aria-hidden="true" tabindex="-1"></a><span class="co"># hl %&gt;%</span></span>
<span id="cb95-1305"><a href="#cb95-1305" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(FL_CM, color = LAND_STANDARD_GEAR_NAME))+</span></span>
<span id="cb95-1306"><a href="#cb95-1306" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_density()+</span></span>
<span id="cb95-1307"><a href="#cb95-1307" aria-hidden="true" tabindex="-1"></a><span class="co">#  # scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1308"><a href="#cb95-1308" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_hue(labels = counts$n_labels)+</span></span>
<span id="cb95-1309"><a href="#cb95-1309" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Gear Type", x = "Fork Length (cm)", title = paste0(region,  "\n (N = ", sum(counts$n), ")"))+</span></span>
<span id="cb95-1310"><a href="#cb95-1310" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1311"><a href="#cb95-1311" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span>
<span id="cb95-1312"><a href="#cb95-1312" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1313"><a href="#cb95-1313" aria-hidden="true" tabindex="-1"></a><span class="co">#  length_data_final %&gt;%  group_by(YEAR) %&gt;% filter(n() &gt;= 30) %&gt;% ungroup %&gt;%</span></span>
<span id="cb95-1314"><a href="#cb95-1314" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(FL_CM, color = gear))+</span></span>
<span id="cb95-1315"><a href="#cb95-1315" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_density()+</span></span>
<span id="cb95-1316"><a href="#cb95-1316" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_hue(labels=ycounts$n_labels)+</span></span>
<span id="cb95-1317"><a href="#cb95-1317" aria-hidden="true" tabindex="-1"></a><span class="co"># #  scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1318"><a href="#cb95-1318" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Gear Type", x = "Fork Length (cm)", title = paste0(region,  "\n (N = ", sum(ycounts$n), ")"))+</span></span>
<span id="cb95-1319"><a href="#cb95-1319" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1320"><a href="#cb95-1320" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span>
<span id="cb95-1321"><a href="#cb95-1321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1322"><a href="#cb95-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1323"><a href="#cb95-1323" aria-hidden="true" tabindex="-1"></a><span class="fu"># Gear distribution across time by gear groupings</span></span>
<span id="cb95-1324"><a href="#cb95-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1325"><a href="#cb95-1325" aria-hidden="true" tabindex="-1"></a><span class="fu">## All gears over time</span></span>
<span id="cb95-1326"><a href="#cb95-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1327"><a href="#cb95-1327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=15, fig.height=15}</span></span>
<span id="cb95-1328"><a href="#cb95-1328" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1329"><a href="#cb95-1329" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Stoplight Parrotfish LAND_STANDARD_GEAR_NAME STX</span></span>
<span id="cb95-1330"><a href="#cb95-1330" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb95-1331"><a href="#cb95-1331" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-1332"><a href="#cb95-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1333"><a href="#cb95-1333" aria-hidden="true" tabindex="-1"></a><span class="co"># create count of observed records by individual gear name</span></span>
<span id="cb95-1334"><a href="#cb95-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1335"><a href="#cb95-1335" aria-hidden="true" tabindex="-1"></a>sttj_count <span class="ot">&lt;-</span> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb95-1336"><a href="#cb95-1336" aria-hidden="true" tabindex="-1"></a>   <span class="fu">add_count</span>(COUNTY) <span class="sc">%&gt;%</span></span>
<span id="cb95-1337"><a href="#cb95-1337" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">COUNTYn =</span> <span class="fu">paste0</span>(COUNTY, <span class="st">' ('</span>, n, <span class="st">')'</span>)) </span>
<span id="cb95-1338"><a href="#cb95-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1339"><a href="#cb95-1339" aria-hidden="true" tabindex="-1"></a>sttj_gear_time <span class="ot">&lt;-</span> <span class="fu">subset</span>(sttj_count, <span class="at">select =</span> <span class="sc">-</span>n) <span class="sc">%&gt;%</span> </span>
<span id="cb95-1340"><a href="#cb95-1340" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_count</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb95-1341"><a href="#cb95-1341" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">LAND_STANDARD_GEAR_NAMEn =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">'('</span>, n, <span class="st">')'</span>))</span>
<span id="cb95-1342"><a href="#cb95-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1343"><a href="#cb95-1343" aria-hidden="true" tabindex="-1"></a><span class="co"># plot    </span></span>
<span id="cb95-1344"><a href="#cb95-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1345"><a href="#cb95-1345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> sttj_gear_time, <span class="fu">aes</span>(<span class="at">x =</span> FINAL_DATE, <span class="at">y =</span> LAND_STANDARD_GEAR_NAMEn , <span class="at">group =</span> COUNTY ,<span class="at">color =</span> COUNTYn )) <span class="sc">+</span> </span>
<span id="cb95-1346"><a href="#cb95-1346" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(COUNTY), <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb95-1347"><a href="#cb95-1347" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb95-1348"><a href="#cb95-1348" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"STANDARDGEARNAME_1 (# obs)"</span>, </span>
<span id="cb95-1349"><a href="#cb95-1349" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Area-time distribution of landed gear STTJ"</span>, </span>
<span id="cb95-1350"><a href="#cb95-1350" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"COUNTY (# obs)"</span>,</span>
<span id="cb95-1351"><a href="#cb95-1351" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"N = "</span>, <span class="fu">nrow</span>(sttj_gear_time))) </span>
<span id="cb95-1352"><a href="#cb95-1352" aria-hidden="true" tabindex="-1"></a>    <span class="co"># theme(legend.position = "none")</span></span>
<span id="cb95-1353"><a href="#cb95-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1354"><a href="#cb95-1354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1355"><a href="#cb95-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1356"><a href="#cb95-1356" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hook and Line Gear Distribution Over Time by Year</span></span>
<span id="cb95-1357"><a href="#cb95-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1358"><a href="#cb95-1358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_hl_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb95-1359"><a href="#cb95-1359" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1360"><a href="#cb95-1360" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1361"><a href="#cb95-1361" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1362"><a href="#cb95-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1363"><a href="#cb95-1363" aria-hidden="true" tabindex="-1"></a>hl2<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'HL'</span>,]</span>
<span id="cb95-1364"><a href="#cb95-1364" aria-hidden="true" tabindex="-1"></a>hl4<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(hl2<span class="sc">$</span>FL_CM, <span class="fu">list</span>(hl2<span class="sc">$</span>YEAR, hl2<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb95-1365"><a href="#cb95-1365" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(hl4) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb95-1366"><a href="#cb95-1366" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> hl2 <span class="sc">%&gt;%</span></span>
<span id="cb95-1367"><a href="#cb95-1367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb95-1368"><a href="#cb95-1368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1369"><a href="#cb95-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1370"><a href="#cb95-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1371"><a href="#cb95-1371" aria-hidden="true" tabindex="-1"></a><span class="co"># hl_car &lt;-</span></span>
<span id="cb95-1372"><a href="#cb95-1372" aria-hidden="true" tabindex="-1"></a>hl4 <span class="sc">%&gt;%</span></span>
<span id="cb95-1373"><a href="#cb95-1373" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb95-1374"><a href="#cb95-1374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb95-1375"><a href="#cb95-1375" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1376"><a href="#cb95-1376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1377"><a href="#cb95-1377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1378"><a href="#cb95-1378" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1379"><a href="#cb95-1379" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-1380"><a href="#cb95-1380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-1381"><a href="#cb95-1381" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-1382"><a href="#cb95-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1383"><a href="#cb95-1383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1384"><a href="#cb95-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1385"><a href="#cb95-1385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_hl_plot_range, fig.width=12, fig.height=8}</span></span>
<span id="cb95-1386"><a href="#cb95-1386" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1387"><a href="#cb95-1387" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1388"><a href="#cb95-1388" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1389"><a href="#cb95-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1390"><a href="#cb95-1390" aria-hidden="true" tabindex="-1"></a><span class="co"># display yearly values of gears in same group on same graph</span></span>
<span id="cb95-1391"><a href="#cb95-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1392"><a href="#cb95-1392" aria-hidden="true" tabindex="-1"></a>summary_hl2 <span class="ot">&lt;-</span> hl2 <span class="sc">%&gt;%</span> </span>
<span id="cb95-1393"><a href="#cb95-1393" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> </span>
<span id="cb95-1394"><a href="#cb95-1394" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">lower =</span> <span class="fu">min</span>(FL_CM), <span class="at">upper =</span> <span class="fu">max</span>(FL_CM), <span class="at">p =</span> <span class="fu">median</span>(FL_CM))</span>
<span id="cb95-1395"><a href="#cb95-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1396"><a href="#cb95-1396" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> summary_hl2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> YEAR, <span class="at">y =</span> p)) <span class="sc">+</span></span>
<span id="cb95-1397"><a href="#cb95-1397" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_pointrange</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper)) <span class="co"># doesn't separate by gear, can we do that? </span></span>
<span id="cb95-1398"><a href="#cb95-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1399"><a href="#cb95-1399" aria-hidden="true" tabindex="-1"></a><span class="do">## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).</span></span>
<span id="cb95-1400"><a href="#cb95-1400" aria-hidden="true" tabindex="-1"></a><span class="do">##   data: a data frame.</span></span>
<span id="cb95-1401"><a href="#cb95-1401" aria-hidden="true" tabindex="-1"></a><span class="do">##   measurevar: the name of a column that contains the variable to be summariezed</span></span>
<span id="cb95-1402"><a href="#cb95-1402" aria-hidden="true" tabindex="-1"></a><span class="do">##   groupvars: a vector containing names of columns that contain grouping variables</span></span>
<span id="cb95-1403"><a href="#cb95-1403" aria-hidden="true" tabindex="-1"></a><span class="do">##   na.rm: a boolean that indicates whether to ignore NA's</span></span>
<span id="cb95-1404"><a href="#cb95-1404" aria-hidden="true" tabindex="-1"></a><span class="do">##   conf.interval: the percent range of the confidence interval (default is 95%)</span></span>
<span id="cb95-1405"><a href="#cb95-1405" aria-hidden="true" tabindex="-1"></a><span class="co"># summarySE &lt;- function(data=hl2, measurevar, groupvars=c("gear", "YEAR"), na.rm=FALSE,</span></span>
<span id="cb95-1406"><a href="#cb95-1406" aria-hidden="true" tabindex="-1"></a><span class="co">#                       conf.interval=.95, .drop=TRUE) {</span></span>
<span id="cb95-1407"><a href="#cb95-1407" aria-hidden="true" tabindex="-1"></a><span class="co">#     library(plyr)</span></span>
<span id="cb95-1408"><a href="#cb95-1408" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1409"><a href="#cb95-1409" aria-hidden="true" tabindex="-1"></a><span class="co">#     # New version of length which can handle NA's: if na.rm==T, don't count them</span></span>
<span id="cb95-1410"><a href="#cb95-1410" aria-hidden="true" tabindex="-1"></a><span class="co">#     length2 &lt;- function (x, na.rm=FALSE) {</span></span>
<span id="cb95-1411"><a href="#cb95-1411" aria-hidden="true" tabindex="-1"></a><span class="co">#         if (na.rm) sum(!is.na(x))</span></span>
<span id="cb95-1412"><a href="#cb95-1412" aria-hidden="true" tabindex="-1"></a><span class="co">#         else       length(x)</span></span>
<span id="cb95-1413"><a href="#cb95-1413" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb95-1414"><a href="#cb95-1414" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1415"><a href="#cb95-1415" aria-hidden="true" tabindex="-1"></a><span class="co">#     # This does the summary. For each group's data frame, return a vector with</span></span>
<span id="cb95-1416"><a href="#cb95-1416" aria-hidden="true" tabindex="-1"></a><span class="co">#     # N, mean, and sd</span></span>
<span id="cb95-1417"><a href="#cb95-1417" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac &lt;- ddply(data, groupvars, .drop=.drop,</span></span>
<span id="cb95-1418"><a href="#cb95-1418" aria-hidden="true" tabindex="-1"></a><span class="co">#       .fun = function(xx, col) {</span></span>
<span id="cb95-1419"><a href="#cb95-1419" aria-hidden="true" tabindex="-1"></a><span class="co">#         c(N    = length2(xx[[col]], na.rm=na.rm),</span></span>
<span id="cb95-1420"><a href="#cb95-1420" aria-hidden="true" tabindex="-1"></a><span class="co">#           mean = mean   (xx[[col]], na.rm=na.rm),</span></span>
<span id="cb95-1421"><a href="#cb95-1421" aria-hidden="true" tabindex="-1"></a><span class="co">#           sd   = sd     (xx[[col]], na.rm=na.rm)</span></span>
<span id="cb95-1422"><a href="#cb95-1422" aria-hidden="true" tabindex="-1"></a><span class="co">#         )</span></span>
<span id="cb95-1423"><a href="#cb95-1423" aria-hidden="true" tabindex="-1"></a><span class="co">#       },</span></span>
<span id="cb95-1424"><a href="#cb95-1424" aria-hidden="true" tabindex="-1"></a><span class="co">#       measurevar</span></span>
<span id="cb95-1425"><a href="#cb95-1425" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb95-1426"><a href="#cb95-1426" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1427"><a href="#cb95-1427" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Rename the "mean" column    </span></span>
<span id="cb95-1428"><a href="#cb95-1428" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac &lt;- rename(datac, c("mean" = measurevar))</span></span>
<span id="cb95-1429"><a href="#cb95-1429" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1430"><a href="#cb95-1430" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac$se &lt;- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean</span></span>
<span id="cb95-1431"><a href="#cb95-1431" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1432"><a href="#cb95-1432" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Confidence interval multiplier for standard error</span></span>
<span id="cb95-1433"><a href="#cb95-1433" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Calculate t-statistic for confidence interval: </span></span>
<span id="cb95-1434"><a href="#cb95-1434" aria-hidden="true" tabindex="-1"></a><span class="co">#     # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1</span></span>
<span id="cb95-1435"><a href="#cb95-1435" aria-hidden="true" tabindex="-1"></a><span class="co">#     ciMult &lt;- qt(conf.interval/2 + .5, datac$N-1)</span></span>
<span id="cb95-1436"><a href="#cb95-1436" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac$ci &lt;- datac$se * ciMult</span></span>
<span id="cb95-1437"><a href="#cb95-1437" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1438"><a href="#cb95-1438" aria-hidden="true" tabindex="-1"></a><span class="co">#     return(datac)</span></span>
<span id="cb95-1439"><a href="#cb95-1439" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb95-1440"><a href="#cb95-1440" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1441"><a href="#cb95-1441" aria-hidden="true" tabindex="-1"></a><span class="co"># hl2sum &lt;- summarySE(data=hl2, measurevar="FL_CM", groupvars=c("gear","year"), na.rm=FALSE, conf.interval=.95)</span></span>
<span id="cb95-1442"><a href="#cb95-1442" aria-hidden="true" tabindex="-1"></a><span class="co"># hl2sum &lt;- summarySE(hl2, measurevar="FL_CM", groupvars=c("gear","year"))</span></span>
<span id="cb95-1443"><a href="#cb95-1443" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1444"><a href="#cb95-1444" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(hl2, aes(x=YEAR, y=FL_CM, colour=gear)) + </span></span>
<span id="cb95-1445"><a href="#cb95-1445" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_errorbar(aes(ymin=FL_CM-se, ymax=FL_CM+se), width=.1) +</span></span>
<span id="cb95-1446"><a href="#cb95-1446" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_line() +</span></span>
<span id="cb95-1447"><a href="#cb95-1447" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_point()</span></span>
<span id="cb95-1448"><a href="#cb95-1448" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1449"><a href="#cb95-1449" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(hl2, aes(x=YEAR, y=FL_CM, colour=gear, group=gear)) + </span></span>
<span id="cb95-1450"><a href="#cb95-1450" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_errorbar(aes(ymin=FL_CM-se, ymax=FL_CM+se), colour="black", width=.1, position=pd) +</span></span>
<span id="cb95-1451"><a href="#cb95-1451" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_line(position=pd) +</span></span>
<span id="cb95-1452"><a href="#cb95-1452" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_point(position=pd, size=3, shape=21, fill="white") + # 21 is filled circle</span></span>
<span id="cb95-1453"><a href="#cb95-1453" aria-hidden="true" tabindex="-1"></a><span class="co">#     xlab("Year") +</span></span>
<span id="cb95-1454"><a href="#cb95-1454" aria-hidden="true" tabindex="-1"></a><span class="co">#     ylab("Fork Length (cm)") +</span></span>
<span id="cb95-1455"><a href="#cb95-1455" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_colour_hue(name="Gear type",    # Legend label, use darker colors</span></span>
<span id="cb95-1456"><a href="#cb95-1456" aria-hidden="true" tabindex="-1"></a><span class="co">#                      breaks=gear,</span></span>
<span id="cb95-1457"><a href="#cb95-1457" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels=gear,</span></span>
<span id="cb95-1458"><a href="#cb95-1458" aria-hidden="true" tabindex="-1"></a><span class="co">#                      l=40) +                    # Use darker colors, lightness=40</span></span>
<span id="cb95-1459"><a href="#cb95-1459" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggtitle("Average ") +</span></span>
<span id="cb95-1460"><a href="#cb95-1460" aria-hidden="true" tabindex="-1"></a><span class="co">#     expand_limits(y=0) +                        # Expand y range</span></span>
<span id="cb95-1461"><a href="#cb95-1461" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_y_continuous(breaks=0:20*4) +         # Set tick every 4</span></span>
<span id="cb95-1462"><a href="#cb95-1462" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme_bw() +</span></span>
<span id="cb95-1463"><a href="#cb95-1463" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(legend.justification=c(1,0),</span></span>
<span id="cb95-1464"><a href="#cb95-1464" aria-hidden="true" tabindex="-1"></a><span class="co">#           legend.position=c(1,0))               # Position legend in bottom right</span></span>
<span id="cb95-1465"><a href="#cb95-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1466"><a href="#cb95-1466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1467"><a href="#cb95-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1468"><a href="#cb95-1468" aria-hidden="true" tabindex="-1"></a><span class="fu">## Trap Gear Distribution Over Time by Year</span></span>
<span id="cb95-1469"><a href="#cb95-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1470"><a href="#cb95-1470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_tr_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb95-1471"><a href="#cb95-1471" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1472"><a href="#cb95-1472" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1473"><a href="#cb95-1473" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1474"><a href="#cb95-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1475"><a href="#cb95-1475" aria-hidden="true" tabindex="-1"></a>trap <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'TR'</span>,]</span>
<span id="cb95-1476"><a href="#cb95-1476" aria-hidden="true" tabindex="-1"></a>trap2<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(trap<span class="sc">$</span>FL_CM, <span class="fu">list</span>(trap<span class="sc">$</span>YEAR, trap<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb95-1477"><a href="#cb95-1477" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(trap2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb95-1478"><a href="#cb95-1478" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> trap <span class="sc">%&gt;%</span></span>
<span id="cb95-1479"><a href="#cb95-1479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb95-1480"><a href="#cb95-1480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1481"><a href="#cb95-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1482"><a href="#cb95-1482" aria-hidden="true" tabindex="-1"></a>trap2 <span class="sc">%&gt;%</span></span>
<span id="cb95-1483"><a href="#cb95-1483" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb95-1484"><a href="#cb95-1484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb95-1485"><a href="#cb95-1485" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1486"><a href="#cb95-1486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1487"><a href="#cb95-1487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1488"><a href="#cb95-1488" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1489"><a href="#cb95-1489" aria-hidden="true" tabindex="-1"></a> <span class="co"># theme_minimal()</span></span>
<span id="cb95-1490"><a href="#cb95-1490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-1491"><a href="#cb95-1491" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-1492"><a href="#cb95-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1493"><a href="#cb95-1493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1494"><a href="#cb95-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1495"><a href="#cb95-1495" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diving Gear Distribution Over Time by Year - NO GEAR GROUPING</span></span>
<span id="cb95-1496"><a href="#cb95-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1497"><a href="#cb95-1497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_DV_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb95-1498"><a href="#cb95-1498" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1499"><a href="#cb95-1499" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1500"><a href="#cb95-1500" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1501"><a href="#cb95-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1502"><a href="#cb95-1502" aria-hidden="true" tabindex="-1"></a><span class="co"># diving &lt;- length_data_final[length_data_final$gear_short=='DV',]</span></span>
<span id="cb95-1503"><a href="#cb95-1503" aria-hidden="true" tabindex="-1"></a><span class="co"># diving2&lt;- aggregate(diving$FL_CM, list(diving$YEAR, diving$LAND_STANDARD_GEAR_NAME), mean)</span></span>
<span id="cb95-1504"><a href="#cb95-1504" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(diving2) &lt;- c('Year', 'LAND_STANDARD_GEAR_NAME', 'yearlyValue')</span></span>
<span id="cb95-1505"><a href="#cb95-1505" aria-hidden="true" tabindex="-1"></a><span class="co"># counts = diving %&gt;%</span></span>
<span id="cb95-1506"><a href="#cb95-1506" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(LAND_STANDARD_GEAR_NAME) %&gt;%</span></span>
<span id="cb95-1507"><a href="#cb95-1507" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(LAND_STANDARD_GEAR_NAME, " (n= ", n, ")" ))</span></span>
<span id="cb95-1508"><a href="#cb95-1508" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1509"><a href="#cb95-1509" aria-hidden="true" tabindex="-1"></a><span class="co"># diving2 %&gt;%</span></span>
<span id="cb95-1510"><a href="#cb95-1510" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(x = Year, y = yearlyValue, color = LAND_STANDARD_GEAR_NAME, group = 1))+</span></span>
<span id="cb95-1511"><a href="#cb95-1511" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(size = 2) +</span></span>
<span id="cb95-1512"><a href="#cb95-1512" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1513"><a href="#cb95-1513" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_hue(labels = counts$n_labels)+</span></span>
<span id="cb95-1514"><a href="#cb95-1514" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Gear Type", y = "Fork Length (cm)", x= "Year", title = paste0(region,  "\n (N = ", sum(counts$n), ")"))+</span></span>
<span id="cb95-1515"><a href="#cb95-1515" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1516"><a href="#cb95-1516" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span>
<span id="cb95-1517"><a href="#cb95-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1518"><a href="#cb95-1518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1519"><a href="#cb95-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1520"><a href="#cb95-1520" aria-hidden="true" tabindex="-1"></a><span class="fu">## Net Gear Distribution Over Time by Year</span></span>
<span id="cb95-1521"><a href="#cb95-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1522"><a href="#cb95-1522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_net_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb95-1523"><a href="#cb95-1523" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1524"><a href="#cb95-1524" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1525"><a href="#cb95-1525" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1526"><a href="#cb95-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1527"><a href="#cb95-1527" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'NT'</span>,]</span>
<span id="cb95-1528"><a href="#cb95-1528" aria-hidden="true" tabindex="-1"></a>net2<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(net<span class="sc">$</span>FL_CM, <span class="fu">list</span>(net<span class="sc">$</span>YEAR, net<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb95-1529"><a href="#cb95-1529" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(net2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb95-1530"><a href="#cb95-1530" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> net <span class="sc">%&gt;%</span></span>
<span id="cb95-1531"><a href="#cb95-1531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb95-1532"><a href="#cb95-1532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1533"><a href="#cb95-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1534"><a href="#cb95-1534" aria-hidden="true" tabindex="-1"></a>net2 <span class="sc">%&gt;%</span></span>
<span id="cb95-1535"><a href="#cb95-1535" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb95-1536"><a href="#cb95-1536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb95-1537"><a href="#cb95-1537" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1538"><a href="#cb95-1538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1539"><a href="#cb95-1539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1540"><a href="#cb95-1540" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1541"><a href="#cb95-1541" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-1542"><a href="#cb95-1542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-1543"><a href="#cb95-1543" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-1544"><a href="#cb95-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1545"><a href="#cb95-1545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1546"><a href="#cb95-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1547"><a href="#cb95-1547" aria-hidden="true" tabindex="-1"></a><span class="fu">## Spear Gear Distribution Over Time by Year - NO GROUPING</span></span>
<span id="cb95-1548"><a href="#cb95-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1549"><a href="#cb95-1549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_sp_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb95-1550"><a href="#cb95-1550" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1551"><a href="#cb95-1551" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1552"><a href="#cb95-1552" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1553"><a href="#cb95-1553" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1554"><a href="#cb95-1554" aria-hidden="true" tabindex="-1"></a><span class="co"># sp&lt;- length_data_final[length_data_final$gear_short=='SP',]</span></span>
<span id="cb95-1555"><a href="#cb95-1555" aria-hidden="true" tabindex="-1"></a><span class="co"># sp2&lt;- aggregate(sp$FL_CM, list(sp$YEAR, sp$LAND_STANDARD_GEAR_NAME), mean)</span></span>
<span id="cb95-1556"><a href="#cb95-1556" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(sp2) &lt;- c('Year', 'LAND_STANDARD_GEAR_NAME', 'yearlyValue')</span></span>
<span id="cb95-1557"><a href="#cb95-1557" aria-hidden="true" tabindex="-1"></a><span class="co"># counts = sp %&gt;%</span></span>
<span id="cb95-1558"><a href="#cb95-1558" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(LAND_STANDARD_GEAR_NAME) %&gt;%</span></span>
<span id="cb95-1559"><a href="#cb95-1559" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(LAND_STANDARD_GEAR_NAME, " (n= ", n, ")" ))</span></span>
<span id="cb95-1560"><a href="#cb95-1560" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1561"><a href="#cb95-1561" aria-hidden="true" tabindex="-1"></a><span class="co"># sp2 %&gt;%</span></span>
<span id="cb95-1562"><a href="#cb95-1562" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(x = Year, y = yearlyValue, color = LAND_STANDARD_GEAR_NAME, group = 1))+</span></span>
<span id="cb95-1563"><a href="#cb95-1563" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(size = 2) +</span></span>
<span id="cb95-1564"><a href="#cb95-1564" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1565"><a href="#cb95-1565" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_hue(labels = counts$n_labels)+</span></span>
<span id="cb95-1566"><a href="#cb95-1566" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Gear Type", y = "Fork Length (cm)", x= "Year", title = paste0(region,  "\n (N = ", sum(counts$n), ")"))+</span></span>
<span id="cb95-1567"><a href="#cb95-1567" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1568"><a href="#cb95-1568" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span>
<span id="cb95-1569"><a href="#cb95-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1570"><a href="#cb95-1570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1571"><a href="#cb95-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1572"><a href="#cb95-1572" aria-hidden="true" tabindex="-1"></a><span class="fu">## Other Gear Distribution Over Time by Year</span></span>
<span id="cb95-1573"><a href="#cb95-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1574"><a href="#cb95-1574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_ot_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb95-1575"><a href="#cb95-1575" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1576"><a href="#cb95-1576" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1577"><a href="#cb95-1577" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb95-1578"><a href="#cb95-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1579"><a href="#cb95-1579" aria-hidden="true" tabindex="-1"></a>ot<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'OT'</span>,]</span>
<span id="cb95-1580"><a href="#cb95-1580" aria-hidden="true" tabindex="-1"></a>ot2<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(ot<span class="sc">$</span>FL_CM, <span class="fu">list</span>(ot<span class="sc">$</span>YEAR, ot<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb95-1581"><a href="#cb95-1581" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ot2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb95-1582"><a href="#cb95-1582" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> ot <span class="sc">%&gt;%</span></span>
<span id="cb95-1583"><a href="#cb95-1583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb95-1584"><a href="#cb95-1584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1585"><a href="#cb95-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1586"><a href="#cb95-1586" aria-hidden="true" tabindex="-1"></a>ot2 <span class="sc">%&gt;%</span></span>
<span id="cb95-1587"><a href="#cb95-1587" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb95-1588"><a href="#cb95-1588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb95-1589"><a href="#cb95-1589" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1590"><a href="#cb95-1590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1591"><a href="#cb95-1591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1592"><a href="#cb95-1592" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb95-1593"><a href="#cb95-1593" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb95-1594"><a href="#cb95-1594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb95-1595"><a href="#cb95-1595" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb95-1596"><a href="#cb95-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1597"><a href="#cb95-1597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1598"><a href="#cb95-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1599"><a href="#cb95-1599" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cummulative Density Plots</span></span>
<span id="cb95-1600"><a href="#cb95-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1601"><a href="#cb95-1601" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aggregated CDF</span></span>
<span id="cb95-1602"><a href="#cb95-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1603"><a href="#cb95-1603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r agg_cdf_plot}</span></span>
<span id="cb95-1604"><a href="#cb95-1604" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1605"><a href="#cb95-1605" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1606"><a href="#cb95-1606" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-1607"><a href="#cb95-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1608"><a href="#cb95-1608" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span>length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb95-1609"><a href="#cb95-1609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(gear) <span class="sc">%&gt;%</span></span>
<span id="cb95-1610"><a href="#cb95-1610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(gear, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1611"><a href="#cb95-1611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1612"><a href="#cb95-1612" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb95-1613"><a href="#cb95-1613" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1614"><a href="#cb95-1614" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb95-1615"><a href="#cb95-1615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()<span class="sc">+</span></span>
<span id="cb95-1616"><a href="#cb95-1616" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1617"><a href="#cb95-1617" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1618"><a href="#cb95-1618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1619"><a href="#cb95-1619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb95-1620"><a href="#cb95-1620" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1621"><a href="#cb95-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1622"><a href="#cb95-1622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1623"><a href="#cb95-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1624"><a href="#cb95-1624" aria-hidden="true" tabindex="-1"></a><span class="fu">## Management periods\*</span></span>
<span id="cb95-1625"><a href="#cb95-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1626"><a href="#cb95-1626" aria-hidden="true" tabindex="-1"></a>**This section is optional and may be empty if there are not signifcant changes**</span>
<span id="cb95-1627"><a href="#cb95-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1628"><a href="#cb95-1628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_cdf_plot, eval=!is.na(break_year)}</span></span>
<span id="cb95-1629"><a href="#cb95-1629" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1630"><a href="#cb95-1630" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1631"><a href="#cb95-1631" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-1632"><a href="#cb95-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1633"><a href="#cb95-1633" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb95-1634"><a href="#cb95-1634" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1635"><a href="#cb95-1635" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb95-1636"><a href="#cb95-1636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()<span class="sc">+</span></span>
<span id="cb95-1637"><a href="#cb95-1637" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1638"><a href="#cb95-1638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1639"><a href="#cb95-1639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1640"><a href="#cb95-1640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb95-1641"><a href="#cb95-1641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb95-1642"><a href="#cb95-1642" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1643"><a href="#cb95-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1644"><a href="#cb95-1644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1645"><a href="#cb95-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1646"><a href="#cb95-1646" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual CDF</span></span>
<span id="cb95-1647"><a href="#cb95-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1648"><a href="#cb95-1648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual_cdf_plot, fig.height=9, fig.width=9}</span></span>
<span id="cb95-1649"><a href="#cb95-1649" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1650"><a href="#cb95-1650" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1651"><a href="#cb95-1651" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-1652"><a href="#cb95-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1653"><a href="#cb95-1653" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span> </span>
<span id="cb95-1654"><a href="#cb95-1654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb95-1655"><a href="#cb95-1655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_labs =</span> <span class="fu">paste0</span>(YEAR, <span class="st">"</span><span class="sc">\n</span><span class="st"> n = "</span>, <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb95-1656"><a href="#cb95-1656" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1657"><a href="#cb95-1657" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb95-1658"><a href="#cb95-1658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()<span class="sc">+</span></span>
<span id="cb95-1659"><a href="#cb95-1659" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb95-1660"><a href="#cb95-1660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1661"><a href="#cb95-1661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1662"><a href="#cb95-1662" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>year_labs)<span class="sc">+</span></span>
<span id="cb95-1663"><a href="#cb95-1663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb95-1664"><a href="#cb95-1664" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1665"><a href="#cb95-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1666"><a href="#cb95-1666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1667"><a href="#cb95-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1668"><a href="#cb95-1668" aria-hidden="true" tabindex="-1"></a><span class="fu"># Island Density Plots</span></span>
<span id="cb95-1669"><a href="#cb95-1669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1670"><a href="#cb95-1670" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aggregated density plots</span></span>
<span id="cb95-1671"><a href="#cb95-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1672"><a href="#cb95-1672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r agg_pdf_plot_reg}</span></span>
<span id="cb95-1673"><a href="#cb95-1673" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1674"><a href="#cb95-1674" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1675"><a href="#cb95-1675" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-1676"><a href="#cb95-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1677"><a href="#cb95-1677" aria-hidden="true" tabindex="-1"></a>srcounts <span class="ot">=</span>length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb95-1678"><a href="#cb95-1678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ISLAND) <span class="sc">%&gt;%</span></span>
<span id="cb95-1679"><a href="#cb95-1679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(ISLAND, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb95-1680"><a href="#cb95-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1681"><a href="#cb95-1681" aria-hidden="true" tabindex="-1"></a><span class="co">#srcounts &lt;- srcounts %&gt;% drop_na(SUBREGION)</span></span>
<span id="cb95-1682"><a href="#cb95-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1683"><a href="#cb95-1683" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb95-1684"><a href="#cb95-1684" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM))<span class="sc">+</span></span>
<span id="cb95-1685"><a href="#cb95-1685" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_density( aes(color = "Combined"))+</span></span>
<span id="cb95-1686"><a href="#cb95-1686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> ISLAND))<span class="sc">+</span></span>
<span id="cb95-1687"><a href="#cb95-1687" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = regcols, labels = c("Combined", srcounts$n_labels))+</span></span>
<span id="cb95-1688"><a href="#cb95-1688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>srcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1689"><a href="#cb95-1689" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Island"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(srcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1690"><a href="#cb95-1690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb95-1691"><a href="#cb95-1691" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1692"><a href="#cb95-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1693"><a href="#cb95-1693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1694"><a href="#cb95-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1695"><a href="#cb95-1695" aria-hidden="true" tabindex="-1"></a><span class="fu">## Management periods\*</span></span>
<span id="cb95-1696"><a href="#cb95-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1697"><a href="#cb95-1697" aria-hidden="true" tabindex="-1"></a>**This section is optional and may be empty if there are not significant changes**</span>
<span id="cb95-1698"><a href="#cb95-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1699"><a href="#cb95-1699" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_pdf_plot_reg, eval=!is.na(break_year)}</span></span>
<span id="cb95-1700"><a href="#cb95-1700" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1701"><a href="#cb95-1701" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1702"><a href="#cb95-1702" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-1703"><a href="#cb95-1703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1704"><a href="#cb95-1704" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb95-1705"><a href="#cb95-1705" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1706"><a href="#cb95-1706" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> ISLAND))<span class="sc">+</span></span>
<span id="cb95-1707"><a href="#cb95-1707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()<span class="sc">+</span></span>
<span id="cb95-1708"><a href="#cb95-1708" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = regcols, labels = srcounts$n_labels)+</span></span>
<span id="cb95-1709"><a href="#cb95-1709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> srcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1710"><a href="#cb95-1710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Island"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(srcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1711"><a href="#cb95-1711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb95-1712"><a href="#cb95-1712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb95-1713"><a href="#cb95-1713" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1714"><a href="#cb95-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1715"><a href="#cb95-1715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1716"><a href="#cb95-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1717"><a href="#cb95-1717" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual Density plots</span></span>
<span id="cb95-1718"><a href="#cb95-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1719"><a href="#cb95-1719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual_pdf_plot_reg, fig.height=9, fig.width=9}</span></span>
<span id="cb95-1720"><a href="#cb95-1720" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1721"><a href="#cb95-1721" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1722"><a href="#cb95-1722" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-1723"><a href="#cb95-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1724"><a href="#cb95-1724" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span> </span>
<span id="cb95-1725"><a href="#cb95-1725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb95-1726"><a href="#cb95-1726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_labs =</span> <span class="fu">paste0</span>(YEAR, <span class="st">"</span><span class="sc">\n</span><span class="st"> n = "</span>, <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb95-1727"><a href="#cb95-1727" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1728"><a href="#cb95-1728" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> ISLAND))<span class="sc">+</span></span>
<span id="cb95-1729"><a href="#cb95-1729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()<span class="sc">+</span></span>
<span id="cb95-1730"><a href="#cb95-1730" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = regcols, labels = srcounts$n_labels)+</span></span>
<span id="cb95-1731"><a href="#cb95-1731" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> srcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb95-1732"><a href="#cb95-1732" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Subregion"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(srcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb95-1733"><a href="#cb95-1733" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>year_labs)<span class="sc">+</span></span>
<span id="cb95-1734"><a href="#cb95-1734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb95-1735"><a href="#cb95-1735" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-1736"><a href="#cb95-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1737"><a href="#cb95-1737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb95-1738"><a href="#cb95-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1739"><a href="#cb95-1739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb95-1740"><a href="#cb95-1740" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb95-1741"><a href="#cb95-1741" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb95-1742"><a href="#cb95-1742" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb95-1743"><a href="#cb95-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1744"><a href="#cb95-1744" aria-hidden="true" tabindex="-1"></a>final_gears <span class="ot">&lt;-</span> <span class="fu">unique</span>(length_data_final<span class="sc">$</span>gear_short)  <span class="do">##++this is where final length comps are generated ; could be aggregated above (e.g. via lookup table) &amp; should be 1 here </span></span>
<span id="cb95-1745"><a href="#cb95-1745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1746"><a href="#cb95-1746" aria-hidden="true" tabindex="-1"></a>comps <span class="ot">&lt;-</span> <span class="fu">list</span>()  <span class="do">##++this creates an empty list for for loop</span></span>
<span id="cb95-1747"><a href="#cb95-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1748"><a href="#cb95-1748" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop generates binned length comps for each of the final gears. Stored in list. RUN:  View(comps[[1]]) to see in R</span></span>
<span id="cb95-1749"><a href="#cb95-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1750"><a href="#cb95-1750" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(final_gears)){</span>
<span id="cb95-1751"><a href="#cb95-1751" aria-hidden="true" tabindex="-1"></a> comps[[i]] <span class="ot">&lt;-</span>  length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb95-1752"><a href="#cb95-1752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear_short <span class="sc">==</span> final_gears[i]) <span class="sc">%&gt;%</span></span>
<span id="cb95-1753"><a href="#cb95-1753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb95-1754"><a href="#cb95-1754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ln_fish =</span> <span class="fu">n</span>(),</span>
<span id="cb95-1755"><a href="#cb95-1755" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_trips =</span> <span class="fu">length</span>(<span class="fu">unique</span>(ID)),</span>
<span id="cb95-1756"><a href="#cb95-1756" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_dealers=</span><span class="fu">length</span>(<span class="fu">unique</span>(DEALER_CODE)),</span>
<span id="cb95-1757"><a href="#cb95-1757" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_vessels=</span><span class="fu">length</span>(<span class="fu">unique</span>(VESSEL_ID))) <span class="sc">%&gt;%</span></span>
<span id="cb95-1758"><a href="#cb95-1758" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb95-1759"><a href="#cb95-1759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels, lbin)<span class="sc">%&gt;%</span></span>
<span id="cb95-1760"><a href="#cb95-1760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">unique</span>(ln_fish)) <span class="sc">%&gt;%</span></span>
<span id="cb95-1761"><a href="#cb95-1761" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb95-1762"><a href="#cb95-1762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels), </span>
<span id="cb95-1763"><a href="#cb95-1763" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> lbin, </span>
<span id="cb95-1764"><a href="#cb95-1764" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> freq, </span>
<span id="cb95-1765"><a href="#cb95-1765" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">freq =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb95-1766"><a href="#cb95-1766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(full_set) <span class="sc">%&gt;%</span></span>
<span id="cb95-1767"><a href="#cb95-1767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comp_names)<span class="sc">%&gt;%</span></span>
<span id="cb95-1768"><a href="#cb95-1768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-1769"><a href="#cb95-1769" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">flag_n  =</span> <span class="fu">ifelse</span>(ln_fish <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">0</span>, </span>
<span id="cb95-1770"><a href="#cb95-1770" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(ln_fish <span class="sc">&lt;</span> <span class="dv">15</span>, <span class="dv">2</span>, <span class="dv">1</span>)))</span>
<span id="cb95-1771"><a href="#cb95-1771" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb95-1772"><a href="#cb95-1772" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(comps)[[i]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(final_gears[i], <span class="st">"_"</span>, bin_size, <span class="st">"cm"</span>) <span class="do">##++tabs are named here ; could add _nom here if desired (instead of _lfd and _lfdw in main file)</span></span>
<span id="cb95-1773"><a href="#cb95-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1774"><a href="#cb95-1774" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb95-1775"><a href="#cb95-1775" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb95-1776"><a href="#cb95-1776" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-1777"><a href="#cb95-1777" aria-hidden="true" tabindex="-1"></a><span class="co"># write.xlsx(comps, file = paste0("./outputs/", sp, "_com_lfd_", sprintf('%02d', min_year %% 100), sprintf('%02d', max_year %% 100), "_", gsub("-", "", Sys.Date()), ".xlsx"))</span></span>
<span id="cb95-1778"><a href="#cb95-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-1779"><a href="#cb95-1779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>