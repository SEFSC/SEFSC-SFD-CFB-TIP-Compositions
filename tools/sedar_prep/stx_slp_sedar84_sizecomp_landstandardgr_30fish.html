<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Katherine Godwin">

<title>stx_slp_sedar84_sizecomp_landstdgearname</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/libs/clipboard/clipboard.min.js"></script>
<script src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/quarto.js"></script>
<script src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/popper.min.js"></script>
<script src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/anchor.min.js"></script>
<link href="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#stoplight-parrotfish-stx" id="toc-stoplight-parrotfish-stx" class="nav-link active" data-scroll-target="#stoplight-parrotfish-stx">Stoplight Parrotfish STX</a>
  <ul>
  <li><a href="#control-settings-and-exploratory-frequency-tables" id="toc-control-settings-and-exploratory-frequency-tables" class="nav-link" data-scroll-target="#control-settings-and-exploratory-frequency-tables">Control Settings and Exploratory Frequency Tables</a>
  <ul class="collapse">
  <li><a href="#filter-to-commercial-samples" id="toc-filter-to-commercial-samples" class="nav-link" data-scroll-target="#filter-to-commercial-samples">Filter to Commercial samples</a></li>
  <li><a href="#extract-marfin-samples-look-at-island-distribution" id="toc-extract-marfin-samples-look-at-island-distribution" class="nav-link" data-scroll-target="#extract-marfin-samples-look-at-island-distribution">Extract marfin samples, look at island distribution</a></li>
  <li><a href="#add-gear-groupings-no-length-length-conversions-available" id="toc-add-gear-groupings-no-length-length-conversions-available" class="nav-link" data-scroll-target="#add-gear-groupings-no-length-length-conversions-available">Add gear groupings, NO length-length conversions available</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#filtration-level-investigation" id="toc-filtration-level-investigation" class="nav-link" data-scroll-target="#filtration-level-investigation">Filtration level investigation</a>
  <ul>
  <li><a href="#unique-trip-id-vs-gear-by-year-investigation" id="toc-unique-trip-id-vs-gear-by-year-investigation" class="nav-link" data-scroll-target="#unique-trip-id-vs-gear-by-year-investigation">Unique trip ID vs gear by year investigation</a>
  <ul class="collapse">
  <li><a href="#how-many-unique-trip-ids-per-year" id="toc-how-many-unique-trip-ids-per-year" class="nav-link" data-scroll-target="#how-many-unique-trip-ids-per-year">How many unique trip ID’s per year?</a></li>
  </ul></li>
  <li><a href="#unique-length-records-per-gear-per-year" id="toc-unique-length-records-per-gear-per-year" class="nav-link" data-scroll-target="#unique-length-records-per-gear-per-year">Unique length records per gear per year</a>
  <ul class="collapse">
  <li><a href="#how-many-length-records-per-gear-per-year" id="toc-how-many-length-records-per-gear-per-year" class="nav-link" data-scroll-target="#how-many-length-records-per-gear-per-year">How many length records per gear per year?</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#glm-analysis" id="toc-glm-analysis" class="nav-link" data-scroll-target="#glm-analysis">GLM analysis</a>
  <ul>
  <li><a href="#all-gears" id="toc-all-gears" class="nav-link" data-scroll-target="#all-gears">All Gears</a></li>
  <li><a href="#all-gears-2012-and-after" id="toc-all-gears-2012-and-after" class="nav-link" data-scroll-target="#all-gears-2012-and-after">All Gears 2012 and after</a></li>
  <li><a href="#diving" id="toc-diving" class="nav-link" data-scroll-target="#diving">Diving</a></li>
  <li><a href="#net---land_standard_gear_name" id="toc-net---land_standard_gear_name" class="nav-link" data-scroll-target="#net---land_standard_gear_name">Net - LAND_STANDARD_GEAR_NAME</a></li>
  <li><a href="#net---land_gear_name" id="toc-net---land_gear_name" class="nav-link" data-scroll-target="#net---land_gear_name">Net - LAND_GEAR_NAME</a></li>
  <li><a href="#trap" id="toc-trap" class="nav-link" data-scroll-target="#trap">Trap</a></li>
  </ul></li>
  <li><a href="#gear-density-plots" id="toc-gear-density-plots" class="nav-link" data-scroll-target="#gear-density-plots">Gear Density Plots</a>
  <ul>
  <li><a href="#aggregated-density-plots" id="toc-aggregated-density-plots" class="nav-link" data-scroll-target="#aggregated-density-plots">Aggregated density plots</a></li>
  <li><a href="#gear-grouping-investigation" id="toc-gear-grouping-investigation" class="nav-link" data-scroll-target="#gear-grouping-investigation">Gear grouping investigation</a></li>
  <li><a href="#break-at-2005" id="toc-break-at-2005" class="nav-link" data-scroll-target="#break-at-2005">Break at 2005</a></li>
  <li><a href="#annual-density-plots" id="toc-annual-density-plots" class="nav-link" data-scroll-target="#annual-density-plots">Annual Density plots</a></li>
  </ul></li>
  <li><a href="#stacked-bar-charts" id="toc-stacked-bar-charts" class="nav-link" data-scroll-target="#stacked-bar-charts">Stacked bar charts</a>
  <ul>
  <li><a href="#visual-representation-of-gear-distribution-within-groupings" id="toc-visual-representation-of-gear-distribution-within-groupings" class="nav-link" data-scroll-target="#visual-representation-of-gear-distribution-within-groupings">Visual representation of gear distribution within groupings</a></li>
  </ul></li>
  <li><a href="#gear-distribution-across-time-by-gear-groupings" id="toc-gear-distribution-across-time-by-gear-groupings" class="nav-link" data-scroll-target="#gear-distribution-across-time-by-gear-groupings">Gear distribution across time by gear groupings</a>
  <ul>
  <li><a href="#all-gears-over-time" id="toc-all-gears-over-time" class="nav-link" data-scroll-target="#all-gears-over-time">All gears over time</a></li>
  <li><a href="#diving-gear-distribution-over-time-by-year" id="toc-diving-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#diving-gear-distribution-over-time-by-year">Diving Gear Distribution Over Time by Year</a></li>
  <li><a href="#trap-gear-distribution-over-time-by-year" id="toc-trap-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#trap-gear-distribution-over-time-by-year">Trap Gear Distribution Over Time by Year</a></li>
  <li><a href="#net-gear-distribution-over-time-by-year" id="toc-net-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#net-gear-distribution-over-time-by-year">Net Gear Distribution Over Time by Year</a></li>
  <li><a href="#other-gear-distribution-over-time-by-year" id="toc-other-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#other-gear-distribution-over-time-by-year">Other Gear Distribution Over Time by Year</a></li>
  </ul></li>
  <li><a href="#cummulative-density-plots" id="toc-cummulative-density-plots" class="nav-link" data-scroll-target="#cummulative-density-plots">Cummulative Density Plots</a>
  <ul>
  <li><a href="#aggregated-cdf" id="toc-aggregated-cdf" class="nav-link" data-scroll-target="#aggregated-cdf">Aggregated CDF</a></li>
  <li><a href="#management-periods" id="toc-management-periods" class="nav-link" data-scroll-target="#management-periods">Management periods*</a></li>
  <li><a href="#annual-cdf" id="toc-annual-cdf" class="nav-link" data-scroll-target="#annual-cdf">Annual CDF</a></li>
  </ul></li>
  <li><a href="#island-density-plots" id="toc-island-density-plots" class="nav-link" data-scroll-target="#island-density-plots">Island Density Plots</a>
  <ul>
  <li><a href="#aggregated-density-plots-1" id="toc-aggregated-density-plots-1" class="nav-link" data-scroll-target="#aggregated-density-plots-1">Aggregated density plots</a></li>
  <li><a href="#management-periods-1" id="toc-management-periods-1" class="nav-link" data-scroll-target="#management-periods-1">Management periods*</a></li>
  <li><a href="#annual-density-plots-1" id="toc-annual-density-plots-1" class="nav-link" data-scroll-target="#annual-density-plots-1">Annual Density plots</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">stx_slp_sedar84_sizecomp_landstdgearname</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Katherine Godwin </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>This script will be expanding upon the length-comp script c1_nominal_len_comps.Rmd created by Molly Stevens.</p>
<section id="stoplight-parrotfish-stx" class="level1 page-columns page-full">
<h1>Stoplight Parrotfish STX</h1>
<div class="cell column-page">

</div>
<section id="control-settings-and-exploratory-frequency-tables" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="control-settings-and-exploratory-frequency-tables">Control Settings and Exploratory Frequency Tables</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="st">"SLP"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>region <span class="ot">&lt;-</span> <span class="st">"PUERTO RICO - USVI"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>county <span class="ot">&lt;-</span> <span class="st">"ST CROIX"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>bin_size <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>len_type <span class="ot">&lt;-</span> <span class="st">"FORK LENGTH"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>LENGTH_TYPE1, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
CURVED FORK LENGTH        FORK LENGTH          NO LENGTH       TOTAL LENGTH 
                 2              29048                120                412 
              &lt;NA&gt; 
                 0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>LENGTH_TYPE2, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
NO LENGTH      &lt;NA&gt; 
    29582         0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(stx_slp<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 123.4</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(stx_slp<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 829</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tip_range  <span class="ot">&lt;-</span> stx_slp[<span class="fu">with</span>(stx_slp,<span class="fu">order</span>(<span class="sc">-</span>LENGTH1_MM)),]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tip_range<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 829 808 796 793 725 650 640 628 612 602 525 510 507 505 500 495 495 482 480
[20] 480 470 460 460 460 460</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tip_range2 <span class="ot">&lt;-</span> stx_slp[<span class="fu">with</span>(stx_slp,<span class="fu">order</span>(LENGTH1_MM)),]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>tip_range2<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 123.4 124.0 124.5 125.9 126.0 126.8 127.9 128.8 135.1 161.0 162.0 168.0
[13] 169.0 170.0 170.0 174.0 175.0 176.0 177.0 178.0 180.0 180.0 180.0 180.0
[25] 180.0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">##range currently set to not drop any obs (centimeters)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>min_size <span class="ot">&lt;-</span> <span class="dv">12</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>max_size <span class="ot">&lt;-</span> <span class="dv">83</span>   </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(stx_slp<span class="sc">$</span>YEAR,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1983"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>min_year <span class="ot">&lt;-</span> <span class="dv">1983</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>max_year <span class="ot">&lt;-</span> <span class="dv">2022</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>break_year <span class="ot">&lt;-</span> <span class="dv">2005</span> <span class="co"># this is an optional value to denote a change in management. inclusive on the upper bound. can be set to NA if not relevant.  2005 trap specifications were updated and many closures went into place</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  TABLES START HERE </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
STOPLIGHT PARROTFISH                 &lt;NA&gt; 
               29582                    0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
        BY HAND; DIVING GEAR ENTANGLING NETS (GILL) UNSPC 
                         629                         2131 
            GILL NETS; OTHER                   LINES HAND 
                         121                          113 
       LINES LONG; REEF FISH                    NOT CODED 
                          11                          105 
    POTS AND TRAPS; BOX TRAP          POTS AND TRAPS; CMB 
                           1                         2922 
        POTS AND TRAPS; FISH                       SPEARS 
                       20041                         2133 
              SPEARS; DIVING                  STOP SEINES 
                        1088                            4 
                TRAMMEL NETS                         &lt;NA&gt; 
                         283                            0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, stx_slp<span class="sc">$</span>STATE_LANDED, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                              
                               VIRGIN ISLANDS  &lt;NA&gt;
  BY HAND; DIVING GEAR                    629     0
  ENTANGLING NETS (GILL) UNSPC           2131     0
  GILL NETS; OTHER                        121     0
  LINES HAND                              113     0
  LINES LONG; REEF FISH                    11     0
  NOT CODED                               105     0
  POTS AND TRAPS; BOX TRAP                  1     0
  POTS AND TRAPS; CMB                    2922     0
  POTS AND TRAPS; FISH                  20041     0
  SPEARS                                 2133     0
  SPEARS; DIVING                         1088     0
  STOP SEINES                               4     0
  TRAMMEL NETS                            283     0
  &lt;NA&gt;                                      0     0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>LAND_GEAR_NAME, stx_slp<span class="sc">$</span>STATE_LANDED, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          
                           VIRGIN ISLANDS  &lt;NA&gt;
  BY HAND; SCUBA                       25     0
  DIVING OUTFITS; OTHER               604     0
  GILL NETS; GL 1 - 2 INCH            657     0
  GILL NETS; GL 2 - 4 INCH           1474     0
  GILL NETS; OTHER                    121     0
  LINES HAND; OTHER                   113     0
  LINES LONG; REEF FISH                11     0
  NOT CODED 000                       105     0
  POTS AND TRAPS; BOX TRAP              1     0
  POTS AND TRAPS; CMB                2922     0
  POTS AND TRAPS; FISH              20041     0
  SPEAR; SCUBA                       1069     0
  SPEAR; SKIN DIVING                   19     0
  SPEARS                             2133     0
  STOP SEINES                           4     0
  TRAMMEL NETS                        283     0
  &lt;NA&gt;                                  0     0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>FISHING_MODE, stx_slp<span class="sc">$</span>INT_TYPE, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             DEALER SAMPLE FISHERMAN SAMPLE UNKNOWN
  COMMERCIAL           185            28761     153
  &lt;NA&gt;                   0                0       0
            
             USVI MARFIN REEFFISH SAMPLING USVI MRAG BYCATCH STUDY  &lt;NA&gt;
  COMMERCIAL                           149                     318    16
  &lt;NA&gt;                                   0                       0     0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># marfin &lt;- stx_slp%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">#             filter(INT_TYPE == "USVI MARFIN REEFFISH SAMPLING")</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>YEAR,stx_slp<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       STOPLIGHT PARROTFISH &lt;NA&gt;
  1983                  139    0
  1984                 2506    0
  1985                 2180    0
  1986                 1552    0
  1987                 1834    0
  1988                 5025    0
  1989                 4594    0
  1990                 1261    0
  1991                 2135    0
  1992                  750    0
  1993                  433    0
  1994                  402    0
  1995                  274    0
  1996                  106    0
  1997                  152    0
  1998                  477    0
  1999                  165    0
  2000                   27    0
  2001                  242    0
  2002                  908    0
  2003                  307    0
  2004                  288    0
  2005                  146    0
  2007                  355    0
  2008                  605    0
  2009                  633    0
  2010                  924    0
  2011                    2    0
  2016                  304    0
  2017                  416    0
  2018                  257    0
  2019                   76    0
  2021                   61    0
  2022                   23    0
  2023                   23    0
  &lt;NA&gt;                    0    0</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>COUNTY_LANDED,stx_slp<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          
           VIRGIN ISLANDS  &lt;NA&gt;
  ST CROIX          29582     0
  &lt;NA&gt;                  0     0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>YEAR,stx_slp<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       VIRGIN ISLANDS &lt;NA&gt;
  1983            139    0
  1984           2506    0
  1985           2180    0
  1986           1552    0
  1987           1834    0
  1988           5025    0
  1989           4594    0
  1990           1261    0
  1991           2135    0
  1992            750    0
  1993            433    0
  1994            402    0
  1995            274    0
  1996            106    0
  1997            152    0
  1998            477    0
  1999            165    0
  2000             27    0
  2001            242    0
  2002            908    0
  2003            307    0
  2004            288    0
  2005            146    0
  2007            355    0
  2008            605    0
  2009            633    0
  2010            924    0
  2011              2    0
  2016            304    0
  2017            416    0
  2018            257    0
  2019             76    0
  2021             61    0
  2022             23    0
  2023             23    0
  &lt;NA&gt;              0    0</code></pre>
</div>
</div>
<section id="filter-to-commercial-samples" class="level4">
<h4 class="anchored" data-anchor-id="filter-to-commercial-samples">Filter to Commercial samples</h4>
<p>Length composition after filtering to commercial records</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>          
           ST CROIX  &lt;NA&gt;
  ST CROIX    29462     0
  &lt;NA&gt;            0     0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      
       ST CROIX &lt;NA&gt;
  1983      139    0
  1984     2506    0
  1985     2180    0
  1986     1552    0
  1987     1834    0
  1988     5025    0
  1989     4594    0
  1990     1261    0
  1991     2135    0
  1992      655    0
  1993      409    0
  1994      402    0
  1995      273    0
  1996      106    0
  1997      152    0
  1998      477    0
  1999      165    0
  2000       27    0
  2001      242    0
  2002      908    0
  2003      307    0
  2004      288    0
  2005      146    0
  2007      355    0
  2008      605    0
  2009      633    0
  2010      924    0
  2011        2    0
  2016      304    0
  2017      416    0
  2018      257    0
  2019       76    0
  2021       61    0
  2022       23    0
  2023       23    0
  &lt;NA&gt;        0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
CURVED FORK LENGTH        FORK LENGTH       TOTAL LENGTH               &lt;NA&gt; 
                 2              29048                412                  0 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
        BY HAND; DIVING GEAR ENTANGLING NETS (GILL) UNSPC 
                         629                         2131 
            GILL NETS; OTHER                   LINES HAND 
                         121                          113 
       LINES LONG; REEF FISH                    NOT CODED 
                          11                          105 
    POTS AND TRAPS; BOX TRAP          POTS AND TRAPS; CMB 
                           1                         2922 
        POTS AND TRAPS; FISH                       SPEARS 
                       20041                         2133 
              SPEARS; DIVING                  STOP SEINES 
                        1088                            4 
                TRAMMEL NETS                         &lt;NA&gt; 
                         283                            0 </code></pre>
</div>
</div>
</section>
<section id="extract-marfin-samples-look-at-island-distribution" class="level4">
<h4 class="anchored" data-anchor-id="extract-marfin-samples-look-at-island-distribution">Extract marfin samples, look at island distribution</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      
       ST CROIX &lt;NA&gt;
  2008        7    0
  2009       37    0
  2010      105    0
  &lt;NA&gt;        0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                      
                       ST CROIX &lt;NA&gt;
  LINES HAND                  5    0
  POTS AND TRAPS; FISH      141    0
  SPEARS                      3    0
  &lt;NA&gt;                        0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>, ,  = ST CROIX

                      
                       2008 2009 2010 &lt;NA&gt;
  LINES HAND              0    0    5    0
  POTS AND TRAPS; FISH    4   37  100    0
  SPEARS                  3    0    0    0
  &lt;NA&gt;                    0    0    0    0

, ,  = NA

                      
                       2008 2009 2010 &lt;NA&gt;
  LINES HAND              0    0    0    0
  POTS AND TRAPS; FISH    0    0    0    0
  SPEARS                  0    0    0    0
  &lt;NA&gt;                    0    0    0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      
       CURVED FORK LENGTH FORK LENGTH TOTAL LENGTH &lt;NA&gt;
  1983                  0         139            0    0
  1984                  2        2504            0    0
  1985                  0        2180            0    0
  1986                  0        1552            0    0
  1987                  0        1834            0    0
  1988                  0        5025            0    0
  1989                  0        4594            0    0
  1990                  0        1261            0    0
  1991                  0        2135            0    0
  1992                  0         655            0    0
  1993                  0         409            0    0
  1994                  0         402            0    0
  1995                  0         273            0    0
  1996                  0         106            0    0
  1997                  0         152            0    0
  1998                  0         477            0    0
  1999                  0         165            0    0
  2000                  0          27            0    0
  2001                  0         242            0    0
  2002                  0         908            0    0
  2003                  0         307            0    0
  2004                  0         116          172    0
  2005                  0           0          146    0
  2007                  0         355            0    0
  2008                  0         605            0    0
  2009                  0         620           13    0
  2010                  0         924            0    0
  2011                  0           2            0    0
  2016                  0         304            0    0
  2017                  0         416            0    0
  2018                  0         257            0    0
  2019                  0          56           20    0
  2021                  0           0           61    0
  2022                  0          23            0    0
  2023                  0          23            0    0
  &lt;NA&gt;                  0           0            0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>          
           VIRGIN ISLANDS
  ST CROIX          29462</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                              
                               BUOY GEAR, VERTICAL BY HAND, DIVING GEAR
  BY HAND; DIVING GEAR                           0                   95
  ENTANGLING NETS (GILL) UNSPC                   0                    0
  GILL NETS; OTHER                               0                    0
  LINES HAND                                     0                    0
  LINES LONG; REEF FISH                          0                    0
  NOT CODED                                      0                    5
  POTS AND TRAPS; BOX TRAP                       0                    0
  POTS AND TRAPS; CMB                            0                    0
  POTS AND TRAPS; FISH                          15                   26
  SPEARS                                         0                  731
  SPEARS; DIVING                                 0                  550
  STOP SEINES                                    0                    0
  TRAMMEL NETS                                   0                    0
                              
                               ENTANGLING NETS (GILL) UNSPC LINES HAND
  BY HAND; DIVING GEAR                                    0          0
  ENTANGLING NETS (GILL) UNSPC                           43          0
  GILL NETS; OTHER                                        0          0
  LINES HAND                                              0          0
  LINES LONG; REEF FISH                                   0          0
  NOT CODED                                               0          0
  POTS AND TRAPS; BOX TRAP                                0          0
  POTS AND TRAPS; CMB                                     0        235
  POTS AND TRAPS; FISH                                    0        396
  SPEARS                                                  0          0
  SPEARS; DIVING                                          0          2
  STOP SEINES                                             0          0
  TRAMMEL NETS                                            0          0
                              
                               LINES POWER TROLL OTHER NOT CODED
  BY HAND; DIVING GEAR                               0         0
  ENTANGLING NETS (GILL) UNSPC                       0         4
  GILL NETS; OTHER                                   0         0
  LINES HAND                                         0         0
  LINES LONG; REEF FISH                              0         0
  NOT CODED                                          0        71
  POTS AND TRAPS; BOX TRAP                           0         0
  POTS AND TRAPS; CMB                                0         0
  POTS AND TRAPS; FISH                              28        40
  SPEARS                                             0         0
  SPEARS; DIVING                                     0         0
  STOP SEINES                                        0         0
  TRAMMEL NETS                                       0         0
                              
                               POTS AND TRAPS, FISH ROD AND REEL SPEARS
  BY HAND; DIVING GEAR                            0            0    131
  ENTANGLING NETS (GILL) UNSPC                    0            0      0
  GILL NETS; OTHER                                0            0      0
  LINES HAND                                     59            0      0
  LINES LONG; REEF FISH                           0            0      0
  NOT CODED                                       0            0      0
  POTS AND TRAPS; BOX TRAP                        0            0      0
  POTS AND TRAPS; CMB                             0            0      0
  POTS AND TRAPS; FISH                         4890           20      0
  SPEARS                                          0            0    376
  SPEARS; DIVING                                  0            0      0
  STOP SEINES                                     0            0      0
  TRAMMEL NETS                                    0            0      0
                              
                               SPEARS, DIVING TRAMMEL NETS
  BY HAND; DIVING GEAR                      0            0
  ENTANGLING NETS (GILL) UNSPC              0            0
  GILL NETS; OTHER                          0            0
  LINES HAND                                0            0
  LINES LONG; REEF FISH                     0            0
  NOT CODED                                 0            0
  POTS AND TRAPS; BOX TRAP                  0            0
  POTS AND TRAPS; CMB                       0            0
  POTS AND TRAPS; FISH                      0            0
  SPEARS                                    0            0
  SPEARS; DIVING                          113            0
  STOP SEINES                               0            0
  TRAMMEL NETS                              0          152</code></pre>
</div>
</div>
</section>
<section id="add-gear-groupings-no-length-length-conversions-available" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="add-gear-groupings-no-length-length-conversions-available">Add gear groupings, NO length-length conversions available</h4>
<p>Trap gears were originally placed in “other” category based on previous landings discussions. I moved them to their own group for visualization purposes right now.</p>
<div class="cell column-page">
<div class="cell-output cell-output-stdout">
<pre><code>                              
                               Diving   Net Other  Trap  &lt;NA&gt;
  BY HAND; DIVING GEAR            629     0     0     0     0
  ENTANGLING NETS (GILL) UNSPC      0  2131     0     0     0
  GILL NETS; OTHER                  0   121     0     0     0
  LINES HAND                        0     0   113     0     0
  LINES LONG; REEF FISH             0     0    11     0     0
  NOT CODED                         0     0   105     0     0
  POTS AND TRAPS; BOX TRAP          0     0     0     1     0
  POTS AND TRAPS; CMB               0     0     0  2922     0
  POTS AND TRAPS; FISH              0     0     0 19921     0
  SPEARS                         2133     0     0     0     0
  SPEARS; DIVING                 1088     0     0     0     0
  STOP SEINES                       0     0     4     0     0
  TRAMMEL NETS                      0   283     0     0     0
  &lt;NA&gt;                              0     0     0     0     0</code></pre>
</div>
</div>
<div class="cell column-page">

</div>
</section>
</section>
</section>
<section id="filtration-level-investigation" class="level1">
<h1>Filtration level investigation</h1>
<section id="unique-trip-id-vs-gear-by-year-investigation" class="level2">
<h2 class="anchored" data-anchor-id="unique-trip-id-vs-gear-by-year-investigation">Unique trip ID vs gear by year investigation</h2>
<section id="how-many-unique-trip-ids-per-year" class="level4">
<h4 class="anchored" data-anchor-id="how-many-unique-trip-ids-per-year">How many unique trip ID’s per year?</h4>
<p>Group by year, count unique trip id’s</p>
<p>When we remove data from years with less than 10 unique trip ID’s, we are left with 24 years of data (vs 33 without filter).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_tripcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR n_distinct(ID)
1  1983              8
2  1984            114
3  1985             63
4  1986             62
5  1987             92
6  1988            106
7  1989             48
8  1990             32
9  1991             24
10 1992             22
11 1993             25
12 1994             33
13 1995             30
14 1996             19
15 1997             20
16 1998             18
17 1999             11
18 2000              4
19 2001              7
20 2002             20
21 2003              8
22 2004              5
23 2007             17
24 2008             29
25 2009             42
26 2010             65
27 2011              2
28 2016             26
29 2017             26
30 2018             14
31 2019              4
32 2022              1
33 2023              2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>length_data_trip10 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(ID) <span class="sc">&gt;=</span> <span class="dv">10</span>)<span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_trip10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR n_distinct(ID)
1  1984            114
2  1985             63
3  1986             62
4  1987             92
5  1988            106
6  1989             48
7  1990             32
8  1991             24
9  1992             22
10 1993             25
11 1994             33
12 1995             30
13 1996             19
14 1997             20
15 1998             18
16 1999             11
17 2002             20
18 2007             17
19 2008             29
20 2009             42
21 2010             65
22 2016             26
23 2017             26
24 2018             14</code></pre>
</div>
</div>
</section>
</section>
<section id="unique-length-records-per-gear-per-year" class="level2">
<h2 class="anchored" data-anchor-id="unique-length-records-per-gear-per-year">Unique length records per gear per year</h2>
<section id="how-many-length-records-per-gear-per-year" class="level3">
<h3 class="anchored" data-anchor-id="how-many-length-records-per-gear-per-year">How many length records per gear per year?</h3>
<p>Group by year, count occurrences of each gear</p>
<p>There are years when individual gears occur less than 30 times but when grouped, the gear groups exceed 30 occurrences per year. Do we want to rely on gear groups with larger than 30 occurrences per year or individual gears with more than 30 occurrences?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur each year</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>length_data_gearcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gearcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR      LAND_STANDARD_GEAR_NAME count
1  1983                    NOT CODED    23
2  1983         POTS AND TRAPS; FISH   116
3  1984                    NOT CODED    32
4  1984          POTS AND TRAPS; CMB   926
5  1984         POTS AND TRAPS; FISH  1546
6  1985                    NOT CODED    45
7  1985          POTS AND TRAPS; CMB  1819
8  1985         POTS AND TRAPS; FISH   316
9  1986         POTS AND TRAPS; FISH  1552
10 1987         POTS AND TRAPS; FISH  1834
11 1988                   LINES HAND    59
12 1988         POTS AND TRAPS; FISH  4966
13 1989         POTS AND TRAPS; FISH  4594
14 1990         POTS AND TRAPS; FISH  1261
15 1991          POTS AND TRAPS; CMB   132
16 1991         POTS AND TRAPS; FISH  2003
17 1992                   LINES HAND    31
18 1992          POTS AND TRAPS; CMB    45
19 1992         POTS AND TRAPS; FISH   579
20 1993 ENTANGLING NETS (GILL) UNSPC   133
21 1993             GILL NETS; OTHER    96
22 1993                   LINES HAND    18
23 1993                    NOT CODED     5
24 1993         POTS AND TRAPS; FISH   157
25 1994 ENTANGLING NETS (GILL) UNSPC   131
26 1994             GILL NETS; OTHER     4
27 1994         POTS AND TRAPS; FISH   267
28 1995 ENTANGLING NETS (GILL) UNSPC   166
29 1995        LINES LONG; REEF FISH    11
30 1995         POTS AND TRAPS; FISH    96
31 1996         BY HAND; DIVING GEAR     7
32 1996 ENTANGLING NETS (GILL) UNSPC    69
33 1996         POTS AND TRAPS; FISH    30
34 1997 ENTANGLING NETS (GILL) UNSPC    61
35 1997         POTS AND TRAPS; FISH    91
36 1998         BY HAND; DIVING GEAR    98
37 1998 ENTANGLING NETS (GILL) UNSPC   274
38 1998         POTS AND TRAPS; FISH   105
39 1999         POTS AND TRAPS; FISH   165
40 2000 ENTANGLING NETS (GILL) UNSPC    21
41 2000         POTS AND TRAPS; FISH     6
42 2001 ENTANGLING NETS (GILL) UNSPC   240
43 2001         POTS AND TRAPS; FISH     2
44 2002 ENTANGLING NETS (GILL) UNSPC   804
45 2002         POTS AND TRAPS; FISH    27
46 2002                       SPEARS    77
47 2003         BY HAND; DIVING GEAR    36
48 2003 ENTANGLING NETS (GILL) UNSPC   232
49 2003                       SPEARS    39
50 2004         BY HAND; DIVING GEAR    54
51 2004                 TRAMMEL NETS    62
52 2007         BY HAND; DIVING GEAR    62
53 2007         POTS AND TRAPS; FISH    13
54 2007                       SPEARS   273
55 2007                 TRAMMEL NETS     7
56 2008         BY HAND; DIVING GEAR   100
57 2008         POTS AND TRAPS; FISH     8
58 2008                       SPEARS   497
59 2009         BY HAND; DIVING GEAR    10
60 2009         POTS AND TRAPS; FISH    57
61 2009                       SPEARS   553
62 2010         BY HAND; DIVING GEAR   105
63 2010             GILL NETS; OTHER    21
64 2010                   LINES HAND     5
65 2010         POTS AND TRAPS; FISH   100
66 2010                       SPEARS   693
67 2011     POTS AND TRAPS; BOX TRAP     1
68 2011                       SPEARS     1
69 2016         BY HAND; DIVING GEAR    49
70 2016         POTS AND TRAPS; FISH     4
71 2016               SPEARS; DIVING   251
72 2017         POTS AND TRAPS; FISH     3
73 2017               SPEARS; DIVING   409
74 2017                  STOP SEINES     4
75 2018               SPEARS; DIVING   257
76 2019         POTS AND TRAPS; FISH    12
77 2019               SPEARS; DIVING    44
78 2022               SPEARS; DIVING    23
79 2023               SPEARS; DIVING    23</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur 30 or more times each year</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>length_data_gear30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR      LAND_STANDARD_GEAR_NAME count
1  1983         POTS AND TRAPS; FISH   116
2  1984                    NOT CODED    32
3  1984          POTS AND TRAPS; CMB   926
4  1984         POTS AND TRAPS; FISH  1546
5  1985                    NOT CODED    45
6  1985          POTS AND TRAPS; CMB  1819
7  1985         POTS AND TRAPS; FISH   316
8  1986         POTS AND TRAPS; FISH  1552
9  1987         POTS AND TRAPS; FISH  1834
10 1988                   LINES HAND    59
11 1988         POTS AND TRAPS; FISH  4966
12 1989         POTS AND TRAPS; FISH  4594
13 1990         POTS AND TRAPS; FISH  1261
14 1991          POTS AND TRAPS; CMB   132
15 1991         POTS AND TRAPS; FISH  2003
16 1992                   LINES HAND    31
17 1992          POTS AND TRAPS; CMB    45
18 1992         POTS AND TRAPS; FISH   579
19 1993 ENTANGLING NETS (GILL) UNSPC   133
20 1993             GILL NETS; OTHER    96
21 1993         POTS AND TRAPS; FISH   157
22 1994 ENTANGLING NETS (GILL) UNSPC   131
23 1994         POTS AND TRAPS; FISH   267
24 1995 ENTANGLING NETS (GILL) UNSPC   166
25 1995         POTS AND TRAPS; FISH    96
26 1996 ENTANGLING NETS (GILL) UNSPC    69
27 1996         POTS AND TRAPS; FISH    30
28 1997 ENTANGLING NETS (GILL) UNSPC    61
29 1997         POTS AND TRAPS; FISH    91
30 1998         BY HAND; DIVING GEAR    98
31 1998 ENTANGLING NETS (GILL) UNSPC   274
32 1998         POTS AND TRAPS; FISH   105
33 1999         POTS AND TRAPS; FISH   165
34 2001 ENTANGLING NETS (GILL) UNSPC   240
35 2002 ENTANGLING NETS (GILL) UNSPC   804
36 2002                       SPEARS    77
37 2003         BY HAND; DIVING GEAR    36
38 2003 ENTANGLING NETS (GILL) UNSPC   232
39 2003                       SPEARS    39
40 2004         BY HAND; DIVING GEAR    54
41 2004                 TRAMMEL NETS    62
42 2007         BY HAND; DIVING GEAR    62
43 2007                       SPEARS   273
44 2008         BY HAND; DIVING GEAR   100
45 2008                       SPEARS   497
46 2009         POTS AND TRAPS; FISH    57
47 2009                       SPEARS   553
48 2010         BY HAND; DIVING GEAR   105
49 2010         POTS AND TRAPS; FISH   100
50 2010                       SPEARS   693
51 2016         BY HAND; DIVING GEAR    49
52 2016               SPEARS; DIVING   251
53 2017               SPEARS; DIVING   409
54 2018               SPEARS; DIVING   257
55 2019               SPEARS; DIVING    44</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group gears that occur 30 or more times per year by gear grouping </span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>length_data_geartogether30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geartogether30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR   gear count
1  1983   Trap   116
2  1984  Other    32
3  1984   Trap  2472
4  1985  Other    45
5  1985   Trap  2135
6  1986   Trap  1552
7  1987   Trap  1834
8  1988  Other    59
9  1988   Trap  4966
10 1989   Trap  4594
11 1990   Trap  1261
12 1991   Trap  2135
13 1992  Other    31
14 1992   Trap   624
15 1993    Net   229
16 1993   Trap   157
17 1994    Net   131
18 1994   Trap   267
19 1995    Net   166
20 1995   Trap    96
21 1996    Net    69
22 1996   Trap    30
23 1997    Net    61
24 1997   Trap    91
25 1998 Diving    98
26 1998    Net   274
27 1998   Trap   105
28 1999   Trap   165
29 2001    Net   240
30 2002 Diving    77
31 2002    Net   804
32 2003 Diving    75
33 2003    Net   232
34 2004 Diving    54
35 2004    Net    62
36 2007 Diving   335
37 2008 Diving   597
38 2009 Diving   553
39 2009   Trap    57
40 2010 Diving   798
41 2010   Trap   100
42 2016 Diving   300
43 2017 Diving   409
44 2018 Diving   257
45 2019 Diving    44</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by specific gear per year</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 29 years of data available </span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geartogether30<span class="sc">$</span>YEAR, length_data_geartogether30<span class="sc">$</span>gear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       Diving Net Other Trap
  1983      0   0     0    1
  1984      0   0     1    1
  1985      0   0     1    1
  1986      0   0     0    1
  1987      0   0     0    1
  1988      0   0     1    1
  1989      0   0     0    1
  1990      0   0     0    1
  1991      0   0     0    1
  1992      0   0     1    1
  1993      0   1     0    1
  1994      0   1     0    1
  1995      0   1     0    1
  1996      0   1     0    1
  1997      0   1     0    1
  1998      1   1     0    1
  1999      0   0     0    1
  2001      0   1     0    0
  2002      1   1     0    0
  2003      1   1     0    0
  2004      1   1     0    0
  2007      1   0     0    0
  2008      1   0     0    0
  2009      1   0     0    1
  2010      1   0     0    1
  2016      1   0     0    0
  2017      1   0     0    0
  2018      1   0     0    0
  2019      1   0     0    0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur each year</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>length_data_geargroupcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroupcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR   gear count
1  1983  Other    23
2  1983   Trap   116
3  1984  Other    32
4  1984   Trap  2472
5  1985  Other    45
6  1985   Trap  2135
7  1986   Trap  1552
8  1987   Trap  1834
9  1988  Other    59
10 1988   Trap  4966
11 1989   Trap  4594
12 1990   Trap  1261
13 1991   Trap  2135
14 1992  Other    31
15 1992   Trap   624
16 1993    Net   229
17 1993  Other    23
18 1993   Trap   157
19 1994    Net   135
20 1994   Trap   267
21 1995    Net   166
22 1995  Other    11
23 1995   Trap    96
24 1996 Diving     7
25 1996    Net    69
26 1996   Trap    30
27 1997    Net    61
28 1997   Trap    91
29 1998 Diving    98
30 1998    Net   274
31 1998   Trap   105
32 1999   Trap   165
33 2000    Net    21
34 2000   Trap     6
35 2001    Net   240
36 2001   Trap     2
37 2002 Diving    77
38 2002    Net   804
39 2002   Trap    27
40 2003 Diving    75
41 2003    Net   232
42 2004 Diving    54
43 2004    Net    62
44 2007 Diving   335
45 2007    Net     7
46 2007   Trap    13
47 2008 Diving   597
48 2008   Trap     8
49 2009 Diving   563
50 2009   Trap    57
51 2010 Diving   798
52 2010    Net    21
53 2010  Other     5
54 2010   Trap   100
55 2011 Diving     1
56 2011   Trap     1
57 2016 Diving   300
58 2016   Trap     4
59 2017 Diving   409
60 2017  Other     4
61 2017   Trap     3
62 2018 Diving   257
63 2019 Diving    44
64 2019   Trap    12
65 2022 Diving    23
66 2023 Diving    23</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur 30 or more times each year</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>length_data_geargroup30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR   gear count
1  1983   Trap   116
2  1984  Other    32
3  1984   Trap  2472
4  1985  Other    45
5  1985   Trap  2135
6  1986   Trap  1552
7  1987   Trap  1834
8  1988  Other    59
9  1988   Trap  4966
10 1989   Trap  4594
11 1990   Trap  1261
12 1991   Trap  2135
13 1992  Other    31
14 1992   Trap   624
15 1993    Net   229
16 1993   Trap   157
17 1994    Net   135
18 1994   Trap   267
19 1995    Net   166
20 1995   Trap    96
21 1996    Net    69
22 1996   Trap    30
23 1997    Net    61
24 1997   Trap    91
25 1998 Diving    98
26 1998    Net   274
27 1998   Trap   105
28 1999   Trap   165
29 2001    Net   240
30 2002 Diving    77
31 2002    Net   804
32 2003 Diving    75
33 2003    Net   232
34 2004 Diving    54
35 2004    Net    62
36 2007 Diving   335
37 2008 Diving   597
38 2009 Diving   563
39 2009   Trap    57
40 2010 Diving   798
41 2010   Trap   100
42 2016 Diving   300
43 2017 Diving   409
44 2018 Diving   257
45 2019 Diving    44</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by gear grouping per year</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 29 years of data available </span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geargroup30<span class="sc">$</span>YEAR, length_data_geargroup30<span class="sc">$</span>gear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       Diving Net Other Trap
  1983      0   0     0    1
  1984      0   0     1    1
  1985      0   0     1    1
  1986      0   0     0    1
  1987      0   0     0    1
  1988      0   0     1    1
  1989      0   0     0    1
  1990      0   0     0    1
  1991      0   0     0    1
  1992      0   0     1    1
  1993      0   1     0    1
  1994      0   1     0    1
  1995      0   1     0    1
  1996      0   1     0    1
  1997      0   1     0    1
  1998      1   1     0    1
  1999      0   0     0    1
  2001      0   1     0    0
  2002      1   1     0    0
  2003      1   1     0    0
  2004      1   1     0    0
  2007      1   0     0    0
  2008      1   0     0    0
  2009      1   0     0    1
  2010      1   0     0    1
  2016      1   0     0    0
  2017      1   0     0    0
  2018      1   0     0    0
  2019      1   0     0    0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by individual gears </span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>length_data_gear29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear29)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR      LAND_STANDARD_GEAR_NAME count
1  1983                    NOT CODED    23
2  1993                   LINES HAND    18
3  1993                    NOT CODED     5
4  1994             GILL NETS; OTHER     4
5  1995        LINES LONG; REEF FISH    11
6  1996         BY HAND; DIVING GEAR     7
7  2000 ENTANGLING NETS (GILL) UNSPC    21
8  2000         POTS AND TRAPS; FISH     6
9  2001         POTS AND TRAPS; FISH     2
10 2002         POTS AND TRAPS; FISH    27
11 2007         POTS AND TRAPS; FISH    13
12 2007                 TRAMMEL NETS     7
13 2008         POTS AND TRAPS; FISH     8
14 2009         BY HAND; DIVING GEAR    10
15 2010             GILL NETS; OTHER    21
16 2010                   LINES HAND     5
17 2011     POTS AND TRAPS; BOX TRAP     1
18 2011                       SPEARS     1
19 2016         POTS AND TRAPS; FISH     4
20 2017         POTS AND TRAPS; FISH     3
21 2017                  STOP SEINES     4
22 2019         POTS AND TRAPS; FISH    12
23 2022               SPEARS; DIVING    23
24 2023               SPEARS; DIVING    23</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># VS </span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by gear groups </span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>length_data_geargroup29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup29)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR   gear count
1  1983  Other    23
2  1993  Other    23
3  1995  Other    11
4  1996 Diving     7
5  2000    Net    21
6  2000   Trap     6
7  2001   Trap     2
8  2002   Trap    27
9  2007    Net     7
10 2007   Trap    13
11 2008   Trap     8
12 2010    Net    21
13 2010  Other     5
14 2011 Diving     1
15 2011   Trap     1
16 2016   Trap     4
17 2017  Other     4
18 2017   Trap     3
19 2019   Trap    12
20 2022 Diving    23
21 2023 Diving    23</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="glm-analysis" class="level1 page-columns page-full">
<h1>GLM analysis</h1>
<p>No filtering based on number of trips/fish per year yet, analysis of all available data.</p>
<p>414 records removed due to not being measured in fork length:</p>
<p>108 BY HAND; DIVING GEAR - total length</p>
<p>11 POTS AND TRAPS; FISH - total/curved fork length</p>
<p>81 SPEARS; DIVING - total length</p>
<p>214 TRAMMEL NETS - total length</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(length_data_final<span class="sc">$</span>gear) <span class="co"># "Hook and Line", "Trap", "Other", "Net"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Diving" "Net"    "Other"  "Trap"  </code></pre>
</div>
</div>
<section id="all-gears" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="all-gears">All Gears</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = length_data_glm, REML = FALSE)</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> length_data_glm, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                        Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
scale(FINAL_DATE)         0.04   0.043     1  65.96  0.0043    0.9479    
LAND_STANDARD_GEAR_NAME 409.54  34.129    12 734.83  3.3969 7.357e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1 17 150976.9
mod2   17 149330.8</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: length_data_glm
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)   
mod3    5 149335 149376 -74662   149325                        
mod2   17 149331 149471 -74648   149297 27.899 12   0.005724 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: length_data_glm
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
mod4   16 149330 149463 -74649   149298                     
mod2   17 149331 149471 -74648   149297 1.4857  1     0.2229</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>mod_contr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 LAND_STANDARD_GEAR_NAME      emmean     SE  df asymp.LCL asymp.UCL
 BY HAND; DIVING GEAR           3.37 0.0253 Inf      3.32      3.42
 ENTANGLING NETS (GILL) UNSPC   3.34 0.0171 Inf      3.31      3.37
 GILL NETS; OTHER               3.35 0.0421 Inf      3.26      3.43
 LINES HAND                     3.41 0.0464 Inf      3.32      3.50
 LINES LONG; REEF FISH          3.25 0.0583 Inf      3.14      3.37
 NOT CODED                      3.33 0.0316 Inf      3.27      3.39
 POTS AND TRAPS; BOX TRAP       3.15 0.1280 Inf      2.90      3.40
 POTS AND TRAPS; CMB            3.38 0.0166 Inf      3.34      3.41
 POTS AND TRAPS; FISH           3.34 0.0107 Inf      3.32      3.37
 SPEARS                         3.40 0.0192 Inf      3.36      3.44
 SPEARS; DIVING                 3.37 0.0305 Inf      3.31      3.43
 STOP SEINES                    3.32 0.0876 Inf      3.15      3.49
 TRAMMEL NETS                   3.44 0.0553 Inf      3.33      3.55

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 

$contrasts
 contrast                                                estimate     SE  df
 BY HAND; DIVING GEAR - ENTANGLING NETS (GILL) UNSPC      0.03146 0.0268 Inf
 BY HAND; DIVING GEAR - GILL NETS; OTHER                  0.02573 0.0458 Inf
 BY HAND; DIVING GEAR - LINES HAND                       -0.03745 0.0500 Inf
 BY HAND; DIVING GEAR - LINES LONG; REEF FISH             0.11829 0.0622 Inf
 BY HAND; DIVING GEAR - NOT CODED                         0.04435 0.0388 Inf
 BY HAND; DIVING GEAR - POTS AND TRAPS; BOX TRAP          0.22544 0.1287 Inf
 BY HAND; DIVING GEAR - POTS AND TRAPS; CMB              -0.00376 0.0270 Inf
 BY HAND; DIVING GEAR - POTS AND TRAPS; FISH              0.02813 0.0233 Inf
 BY HAND; DIVING GEAR - SPEARS                           -0.02835 0.0224 Inf
 BY HAND; DIVING GEAR - SPEARS; DIVING                    0.00470 0.0294 Inf
 BY HAND; DIVING GEAR - STOP SEINES                       0.05485 0.0873 Inf
 BY HAND; DIVING GEAR - TRAMMEL NETS                     -0.06430 0.0555 Inf
 ENTANGLING NETS (GILL) UNSPC - GILL NETS; OTHER         -0.00573 0.0430 Inf
 ENTANGLING NETS (GILL) UNSPC - LINES HAND               -0.06891 0.0474 Inf
 ENTANGLING NETS (GILL) UNSPC - LINES LONG; REEF FISH     0.08682 0.0586 Inf
 ENTANGLING NETS (GILL) UNSPC - NOT CODED                 0.01289 0.0344 Inf
 ENTANGLING NETS (GILL) UNSPC - POTS AND TRAPS; BOX TRAP  0.19398 0.1282 Inf
 ENTANGLING NETS (GILL) UNSPC - POTS AND TRAPS; CMB      -0.03522 0.0206 Inf
 ENTANGLING NETS (GILL) UNSPC - POTS AND TRAPS; FISH     -0.00333 0.0152 Inf
 ENTANGLING NETS (GILL) UNSPC - SPEARS                   -0.05982 0.0216 Inf
 ENTANGLING NETS (GILL) UNSPC - SPEARS; DIVING           -0.02676 0.0303 Inf
 ENTANGLING NETS (GILL) UNSPC - STOP SEINES               0.02339 0.0875 Inf
 ENTANGLING NETS (GILL) UNSPC - TRAMMEL NETS             -0.09576 0.0563 Inf
 GILL NETS; OTHER - LINES HAND                           -0.06318 0.0601 Inf
 GILL NETS; OTHER - LINES LONG; REEF FISH                 0.09256 0.0709 Inf
 GILL NETS; OTHER - NOT CODED                             0.01862 0.0512 Inf
 GILL NETS; OTHER - POTS AND TRAPS; BOX TRAP              0.19971 0.1337 Inf
 GILL NETS; OTHER - POTS AND TRAPS; CMB                  -0.02949 0.0434 Inf
 GILL NETS; OTHER - POTS AND TRAPS; FISH                  0.00240 0.0411 Inf
 GILL NETS; OTHER - SPEARS                               -0.05408 0.0424 Inf
 GILL NETS; OTHER - SPEARS; DIVING                       -0.02103 0.0483 Inf
 GILL NETS; OTHER - STOP SEINES                           0.02912 0.0953 Inf
 GILL NETS; OTHER - TRAMMEL NETS                         -0.09003 0.0676 Inf
 LINES HAND - LINES LONG; REEF FISH                       0.15573 0.0735 Inf
 LINES HAND - NOT CODED                                   0.08180 0.0548 Inf
 LINES HAND - POTS AND TRAPS; BOX TRAP                    0.26289 0.1352 Inf
 LINES HAND - POTS AND TRAPS; CMB                         0.03369 0.0474 Inf
 LINES HAND - POTS AND TRAPS; FISH                        0.06558 0.0454 Inf
 LINES HAND - SPEARS                                      0.00910 0.0470 Inf
 LINES HAND - SPEARS; DIVING                              0.04215 0.0523 Inf
 LINES HAND - STOP SEINES                                 0.09230 0.0973 Inf
 LINES HAND - TRAMMEL NETS                               -0.02685 0.0705 Inf
 LINES LONG; REEF FISH - NOT CODED                       -0.07393 0.0656 Inf
 LINES LONG; REEF FISH - POTS AND TRAPS; BOX TRAP         0.10715 0.1400 Inf
 LINES LONG; REEF FISH - POTS AND TRAPS; CMB             -0.12204 0.0596 Inf
 LINES LONG; REEF FISH - POTS AND TRAPS; FISH            -0.09015 0.0580 Inf
 LINES LONG; REEF FISH - SPEARS                          -0.14664 0.0601 Inf
 LINES LONG; REEF FISH - SPEARS; DIVING                  -0.11359 0.0640 Inf
 LINES LONG; REEF FISH - STOP SEINES                     -0.06343 0.1041 Inf
 LINES LONG; REEF FISH - TRAMMEL NETS                    -0.18258 0.0794 Inf
 NOT CODED - POTS AND TRAPS; BOX TRAP                     0.18109 0.1316 Inf
 NOT CODED - POTS AND TRAPS; CMB                         -0.04811 0.0315 Inf
 NOT CODED - POTS AND TRAPS; FISH                        -0.01622 0.0310 Inf
 NOT CODED - SPEARS                                      -0.07271 0.0350 Inf
 NOT CODED - SPEARS; DIVING                              -0.03965 0.0424 Inf
 NOT CODED - STOP SEINES                                  0.01050 0.0924 Inf
 NOT CODED - TRAMMEL NETS                                -0.10865 0.0627 Inf
 POTS AND TRAPS; BOX TRAP - POTS AND TRAPS; CMB          -0.22920 0.1285 Inf
 POTS AND TRAPS; BOX TRAP - POTS AND TRAPS; FISH         -0.19731 0.1276 Inf
 POTS AND TRAPS; BOX TRAP - SPEARS                       -0.25379 0.1279 Inf
 POTS AND TRAPS; BOX TRAP - SPEARS; DIVING               -0.22074 0.1280 Inf
 POTS AND TRAPS; BOX TRAP - STOP SEINES                  -0.17059 0.1521 Inf
 POTS AND TRAPS; BOX TRAP - TRAMMEL NETS                 -0.28974 0.1378 Inf
 POTS AND TRAPS; CMB - POTS AND TRAPS; FISH               0.03189 0.0139 Inf
 POTS AND TRAPS; CMB - SPEARS                            -0.02459 0.0213 Inf
 POTS AND TRAPS; CMB - SPEARS; DIVING                     0.00846 0.0312 Inf
 POTS AND TRAPS; CMB - STOP SEINES                        0.05861 0.0878 Inf
 POTS AND TRAPS; CMB - TRAMMEL NETS                      -0.06054 0.0563 Inf
 POTS AND TRAPS; FISH - SPEARS                           -0.05649 0.0164 Inf
 POTS AND TRAPS; FISH - SPEARS; DIVING                   -0.02343 0.0276 Inf
 POTS AND TRAPS; FISH - STOP SEINES                       0.02672 0.0866 Inf
 POTS AND TRAPS; FISH - TRAMMEL NETS                     -0.09243 0.0546 Inf
 SPEARS - SPEARS; DIVING                                  0.03305 0.0274 Inf
 SPEARS - STOP SEINES                                     0.08320 0.0865 Inf
 SPEARS - TRAMMEL NETS                                   -0.03595 0.0546 Inf
 SPEARS; DIVING - STOP SEINES                             0.05015 0.0832 Inf
 SPEARS; DIVING - TRAMMEL NETS                           -0.06900 0.0578 Inf
 STOP SEINES - TRAMMEL NETS                              -0.11915 0.1003 Inf
 z.ratio p.value
   1.173  0.9944
   0.562  1.0000
  -0.749  0.9999
   1.900  0.7956
   1.143  0.9956
   1.751  0.8733
  -0.139  1.0000
   1.207  0.9928
  -1.263  0.9893
   0.160  1.0000
   0.628  1.0000
  -1.159  0.9950
  -0.133  1.0000
  -1.454  0.9658
   1.482  0.9603
   0.375  1.0000
   1.513  0.9535
  -1.709  0.8915
  -0.219  1.0000
  -2.764  0.2190
  -0.885  0.9996
   0.267  1.0000
  -1.702  0.8946
  -1.051  0.9980
   1.306  0.9856
   0.364  1.0000
   1.494  0.9579
  -0.680  1.0000
   0.058  1.0000
  -1.275  0.9883
  -0.435  1.0000
   0.306  1.0000
  -1.332  0.9831
   2.118  0.6509
   1.494  0.9578
   1.945  0.7687
   0.711  1.0000
   1.445  0.9674
   0.193  1.0000
   0.807  0.9999
   0.948  0.9993
  -0.381  1.0000
  -1.127  0.9961
   0.765  0.9999
  -2.049  0.7003
  -1.554  0.9435
  -2.441  0.4146
  -1.775  0.8622
  -0.609  1.0000
  -2.299  0.5176
   1.376  0.9779
  -1.527  0.9504
  -0.523  1.0000
  -2.079  0.6791
  -0.934  0.9994
   0.114  1.0000
  -1.732  0.8820
  -1.784  0.8581
  -1.546  0.9456
  -1.984  0.7438
  -1.724  0.8851
  -1.122  0.9963
  -2.103  0.6620
   2.293  0.5221
  -1.156  0.9951
   0.271  1.0000
   0.667  1.0000
  -1.076  0.9975
  -3.439  0.0334
  -0.850  0.9998
   0.308  1.0000
  -1.692  0.8983
   1.207  0.9928
   0.962  0.9992
  -0.659  1.0000
   0.602  1.0000
  -1.195  0.9934
  -1.187  0.9938

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 13 estimates </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME      emmean     SE  df asymp.LCL asymp.UCL .group
 POTS AND TRAPS; BOX TRAP       3.15 0.1280 Inf      2.90      3.40  12   
 LINES LONG; REEF FISH          3.25 0.0583 Inf      3.14      3.37  12   
 STOP SEINES                    3.32 0.0876 Inf      3.15      3.49  12   
 NOT CODED                      3.33 0.0316 Inf      3.27      3.39  12   
 ENTANGLING NETS (GILL) UNSPC   3.34 0.0171 Inf      3.31      3.37  12   
 POTS AND TRAPS; FISH           3.34 0.0107 Inf      3.32      3.37  1    
 GILL NETS; OTHER               3.35 0.0421 Inf      3.26      3.43  12   
 SPEARS; DIVING                 3.37 0.0305 Inf      3.31      3.43  12   
 BY HAND; DIVING GEAR           3.37 0.0253 Inf      3.32      3.42  12   
 POTS AND TRAPS; CMB            3.38 0.0166 Inf      3.34      3.41  12   
 SPEARS                         3.40 0.0192 Inf      3.36      3.44   2   
 LINES HAND                     3.41 0.0464 Inf      3.32      3.50  12   
 TRAMMEL NETS                   3.44 0.0553 Inf      3.33      3.55  12   

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 13 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld <span class="ot">&lt;-</span> multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>length_data_fishcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_fish =</span> <span class="fu">n</span>()) </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_fish <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld, length_data_fishcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_trip <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_fish, length_data_tripcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_final <span class="ot">&lt;-</span> allgears_multcompcld_trip <span class="sc">|&gt;</span> </span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="st">".group"</span>,</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"n_distinct_ID"</span> <span class="ot">=</span> <span class="st">"n_distinct(ID)"</span>)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgears_multcompcld_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME      emmean     SE  df asymp.LCL asymp.UCL group
 POTS AND TRAPS; BOX TRAP       3.15 0.1280 Inf      2.90      3.40  12  
 LINES LONG; REEF FISH          3.25 0.0583 Inf      3.14      3.37  12  
 STOP SEINES                    3.32 0.0876 Inf      3.15      3.49  12  
 NOT CODED                      3.33 0.0316 Inf      3.27      3.39  12  
 ENTANGLING NETS (GILL) UNSPC   3.34 0.0171 Inf      3.31      3.37  12  
 POTS AND TRAPS; FISH           3.34 0.0107 Inf      3.32      3.37  1   
 GILL NETS; OTHER               3.35 0.0421 Inf      3.26      3.43  12  
 SPEARS; DIVING                 3.37 0.0305 Inf      3.31      3.43  12  
 BY HAND; DIVING GEAR           3.37 0.0253 Inf      3.32      3.42  12  
 POTS AND TRAPS; CMB            3.38 0.0166 Inf      3.34      3.41  12  
 SPEARS                         3.40 0.0192 Inf      3.36      3.44   2  
 LINES HAND                     3.41 0.0464 Inf      3.32      3.50  12  
 TRAMMEL NETS                   3.44 0.0553 Inf      3.33      3.55  12  
 n_fish n_distinct_ID
      1             1
     11             2
      4             1
    105             8
   2131            56
  19910           614
    121             5
   1007            65
    521            20
   2922           113
   2133           107
    113             4
     69             3

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 13 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgears_multcompcld_final, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/stx_slps_glm_allgears.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>, <span class="st">"3"</span>))</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_fish[i]))</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_distinct_ID[i]))</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>allgear_glm_totals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_distinct_ID =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_final<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_final<span class="sc">$</span>n_distinct_ID[i]))),</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_fish =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_final<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_final<span class="sc">$</span>n_fish[i]))))</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgear_glm_totals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  group n_distinct_ID n_fish
1     1           892  26915
2     2           385   9138
3     3             0      0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgear_glm_totals, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/stx_slps_glm_allgears_totals.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="all-gears-2012-and-after" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="all-gears-2012-and-after">All Gears 2012 and after</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear2012_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear2012_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear2012_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = length_data_glm, REML = FALSE)</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> length_data_glm_2012, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                        Sum Sq Mean Sq NumDF  DenDF F value Pr(&gt;F)
scale(FINAL_DATE)       11.051 11.0507     1 64.136  1.0550 0.3082
LAND_STANDARD_GEAR_NAME 11.077  3.6924     3 77.454  0.3525 0.7874</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  8 5757.156
mod2    8 5659.457</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: length_data_glm_2012
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC  logLik deviance Chisq Df Pr(&gt;Chisq)
mod3    5 5654.0 5678.9 -2822.0   5644.0                    
mod2    8 5659.5 5699.3 -2821.7   5643.5 0.502  3     0.9185</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: length_data_glm_2012
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod4    7 5657.8 5692.7 -2821.9   5643.8                     
mod2    8 5659.5 5699.3 -2821.7   5643.5 0.3084  1     0.5786</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>mod_contr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 LAND_STANDARD_GEAR_NAME emmean    SE  df asymp.LCL asymp.UCL
 BY HAND; DIVING GEAR      3.27 0.117 Inf      3.04      3.50
 POTS AND TRAPS; FISH      3.30 0.079 Inf      3.14      3.45
 SPEARS; DIVING            3.33 0.023 Inf      3.28      3.37
 STOP SEINES               3.27 0.148 Inf      2.98      3.56

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 

$contrasts
 contrast                                    estimate     SE  df z.ratio
 BY HAND; DIVING GEAR - POTS AND TRAPS; FISH -0.02711 0.1401 Inf  -0.193
 BY HAND; DIVING GEAR - SPEARS; DIVING       -0.05800 0.1194 Inf  -0.486
 BY HAND; DIVING GEAR - STOP SEINES           0.00463 0.1882 Inf   0.025
 POTS AND TRAPS; FISH - SPEARS; DIVING       -0.03089 0.0822 Inf  -0.376
 POTS AND TRAPS; FISH - STOP SEINES           0.03174 0.1674 Inf   0.190
 SPEARS; DIVING - STOP SEINES                 0.06263 0.1496 Inf   0.419
 p.value
  0.9974
  0.9623
  1.0000
  0.9819
  0.9976
  0.9753

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME emmean    SE  df asymp.LCL asymp.UCL .group
 STOP SEINES               3.27 0.148 Inf      2.98      3.56  1    
 BY HAND; DIVING GEAR      3.27 0.117 Inf      3.04      3.50  1    
 POTS AND TRAPS; FISH      3.30 0.079 Inf      3.14      3.45  1    
 SPEARS; DIVING            3.33 0.023 Inf      3.28      3.37  1    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_2012 <span class="ot">&lt;-</span> multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>length_data_fishcount <span class="ot">&lt;-</span> length_data_glm_2012 <span class="sc">|&gt;</span> </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_fish =</span> <span class="fu">n</span>()) </span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_glm_2012 <span class="sc">|&gt;</span> </span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_fish_2012 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_2012, length_data_fishcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_trip_2012 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_fish_2012, length_data_tripcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_finaL_2012 <span class="ot">&lt;-</span> allgears_multcompcld_trip_2012 <span class="sc">|&gt;</span> </span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="st">".group"</span>,</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"n_distinct_ID"</span> <span class="ot">=</span> <span class="st">"n_distinct(ID)"</span>)</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgears_multcompcld_finaL_2012)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME emmean    SE  df asymp.LCL asymp.UCL group n_fish
 STOP SEINES               3.27 0.148 Inf      2.98      3.56  1         4
 BY HAND; DIVING GEAR      3.27 0.117 Inf      3.04      3.50  1        49
 POTS AND TRAPS; FISH      3.30 0.079 Inf      3.14      3.45  1        19
 SPEARS; DIVING            3.33 0.023 Inf      3.28      3.37  1      1007
 n_distinct_ID
             1
             3
             4
            65

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgears_multcompcld_finaL_2012, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/stx_slps_2012glm_allgears.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>group_2012 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>, <span class="st">"3"</span>))</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_fish[i]))</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_distinct_ID[i]))</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>allgear_glm_totals_2012 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_distinct_ID =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group_2012<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_finaL_2012<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_finaL_2012<span class="sc">$</span>n_distinct_ID[i]))),</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_fish =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group_2012<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_finaL_2012<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_finaL_2012<span class="sc">$</span>n_fish[i]))))</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgear_glm_totals_2012)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  group n_distinct_ID n_fish
1     1            73   1079
2     2             0      0
3     3             0      0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgear_glm_totals_2012, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/stx_slps_2012glm_allgears_totals.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="diving" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="diving">Diving</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_diving_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_diving_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_diving_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_dv, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                        Sum Sq Mean Sq NumDF  DenDF F value Pr(&gt;F)
scale(FINAL_DATE)       12.955 12.9550     1 136.48  1.1913  0.277
LAND_STANDARD_GEAR_NAME  6.155  3.0775     2 138.74  0.2830  0.754</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_dv, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  7 19441.58
mod2    7 19220.79</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_dv, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_dv, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line gear p value is significant </span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_dv
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod3    5 19218 19249 -9603.8    19208                     
mod2    7 19221 19264 -9603.4    19207 0.8658  2     0.6486</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line date p value is significant </span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_dv
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod4    6 19219 19256 -9603.5    19207                     
mod2    7 19221 19264 -9603.4    19207 0.2286  1     0.6326</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="do">### no significant p values for time period or gears, further comparisons not needed </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="net---land_standard_gear_name" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="net---land_standard_gear_name">Net - LAND_STANDARD_GEAR_NAME</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_netstd_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_netstd_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_netstd_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="do">### both fixed linear and glm models have warning message because ENTANGLING NETS (GILL) UNSPECIFIED only occur in one year, preventing convergence across timeline </span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_nsg, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                         Sum Sq Mean Sq NumDF  DenDF F value Pr(&gt;F)
scale(FINAL_DATE)        0.6757  0.6757     1 11.452  0.0587 0.8129
LAND_STANDARD_GEAR_NAME 13.6563  6.8281     2 35.854  0.5929 0.5580</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log)) </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  7 12393.01
mod2    7 12286.82</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="do">### net (using LAND_STANDARD_GEAR_NAME) does not have any significantly different gears </span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_nsg
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod3    5 12284 12313 -6137.0    12274                     
mod2    7 12287 12327 -6136.4    12273 1.0914  2     0.5794</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="do">### There is no significantly different time in the Net grouping </span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_nsg
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod4    6 12287 12322 -6137.6    12275                     
mod2    7 12287 12327 -6136.4    12273 2.4445  1     0.1179</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="do">### no significant p values for time period or gears, further comparisons not needed </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="net---land_gear_name" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="net---land_gear_name">Net - LAND_GEAR_NAME</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_net_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_net_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_net_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                  Sum Sq Mean Sq NumDF  DenDF F value Pr(&gt;F)
scale(FINAL_DATE)  4.175  4.1753     1 14.259  0.3626 0.5565
LAND_GEAR_NAME    59.379 19.7931     3 42.591  1.7187 0.1775</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  8 12391.46
mod2    8 12286.98</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_nlg
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC  logLik deviance Chisq Df Pr(&gt;Chisq)
mod3    5 12284 12313 -6137.0    12274                    
mod2    8 12287 12333 -6135.5    12271 2.929  3     0.4027</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_nlg
Models:
mod4: FL_CM ~ LAND_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
mod4    7 12288 12328 -6136.9    12274                       
mod2    8 12287 12333 -6135.5    12271 2.7253  1    0.09877 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="trap" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="trap">Trap</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_trap_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_trap_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_trap_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_tr, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                         Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
scale(FINAL_DATE)         3.478   3.478     1  23.98  0.3575 0.5554861    
LAND_STANDARD_GEAR_NAME 154.524  77.262     2 655.23  7.9426 0.0003906 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  7 117739.5
mod2    7 116525.9</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_tr
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)   
mod3    5 116533 116573 -58261   116523                        
mod2    7 116526 116582 -58256   116512 10.691  2    0.00477 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="do">### There is no significantly different time in the Trap grouping </span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_tr
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)  
mod4    6 116527 116575 -58257   116515                       
mod2    7 116526 116582 -58256   116512 2.8568  1    0.09099 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>mod_contr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 LAND_STANDARD_GEAR_NAME  emmean     SE  df asymp.LCL asymp.UCL
 POTS AND TRAPS; BOX TRAP   3.16 0.1255 Inf      2.92      3.41
 POTS AND TRAPS; CMB        3.39 0.0209 Inf      3.35      3.43
 POTS AND TRAPS; FISH       3.36 0.0175 Inf      3.32      3.39

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 

$contrasts
 contrast                                        estimate    SE  df z.ratio
 POTS AND TRAPS; BOX TRAP - POTS AND TRAPS; CMB    -0.226 0.124 Inf  -1.824
 POTS AND TRAPS; BOX TRAP - POTS AND TRAPS; FISH   -0.192 0.124 Inf  -1.549
 POTS AND TRAPS; CMB - POTS AND TRAPS; FISH         0.035 0.012 Inf   2.917
 p.value
  0.1618
  0.2682
  0.0099

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME  emmean     SE  df asymp.LCL asymp.UCL .group
 POTS AND TRAPS; BOX TRAP   3.16 0.1255 Inf      2.92      3.41  12   
 POTS AND TRAPS; FISH       3.36 0.0175 Inf      3.32      3.39  1    
 POTS AND TRAPS; CMB        3.39 0.0209 Inf      3.35      3.43   2   

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I took out box traps to confirm difference between fish trap and cmb traps and difference is still present </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="gear-density-plots" class="level1 page-columns page-full">
<h1>Gear Density Plots</h1>
<p>Filtered to years with 30 or more length records (regardless of gear) per year.</p>
<section id="aggregated-density-plots" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="aggregated-density-plots">Aggregated density plots</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/agg_pdf_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>USVI TIP length comps by gear and interview type. Investigate if MARFIN and MRAG interview types can be used or should be dropped?</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="gear-grouping-investigation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="gear-grouping-investigation">Gear grouping investigation</h2>
<p>Filtered to minimum 30 fish per year</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_dv_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_trap_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_net_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_net_LANDGEAR_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_other_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="break-at-2005" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="break-at-2005">Break at 2005</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_plot_2005-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_hookandline_plot_2005-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_net_plot_2005-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_trap_plot_2005-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_other_plot_2005-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="annual-density-plots" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="annual-density-plots">Annual Density plots</h2>
<p>This will be split by final gear aggregations once these are decided, removes “other” gear types.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/annual_pdf_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell column-page">

</div>
</section>
</section>
<section id="stacked-bar-charts" class="level1 page-columns page-full">
<h1>Stacked bar charts</h1>
<section id="visual-representation-of-gear-distribution-within-groupings" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="visual-representation-of-gear-distribution-within-groupings">Visual representation of gear distribution within groupings</h4>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_plot-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
</section>
<section id="gear-distribution-across-time-by-gear-groupings" class="level1 page-columns page-full">
<h1>Gear distribution across time by gear groupings</h1>
<section id="all-gears-over-time" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="all-gears-over-time">All gears over time</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="1440"></p>
<figcaption class="figure-caption">Stoplight Parrotfish LAND_STANDARD_GEAR_NAME STX</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="diving-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="diving-gear-distribution-over-time-by-year">Diving Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_dv_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell column-page">

</div>
</section>
<section id="trap-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="trap-gear-distribution-over-time-by-year">Trap Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_tr_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="net-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="net-gear-distribution-over-time-by-year">Net Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_net_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="other-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="other-gear-distribution-over-time-by-year">Other Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_ot_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
</section>
<section id="cummulative-density-plots" class="level1 page-columns page-full">
<h1>Cummulative Density Plots</h1>
<section id="aggregated-cdf" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="aggregated-cdf">Aggregated CDF</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/agg_cdf_plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="management-periods" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="management-periods">Management periods*</h2>
<p><strong>This section is optional and may be empty if there are not signifcant changes</strong></p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_cdf_plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="annual-cdf" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="annual-cdf">Annual CDF</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/annual_cdf_plot-1.png" class="img-fluid" width="864"></p>
</div>
</div>
</section>
</section>
<section id="island-density-plots" class="level1 page-columns page-full">
<h1>Island Density Plots</h1>
<section id="aggregated-density-plots-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="aggregated-density-plots-1">Aggregated density plots</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/agg_pdf_plot_reg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="management-periods-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="management-periods-1">Management periods*</h2>
<p><strong>This section is optional and may be empty if there are not significant changes</strong></p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_pdf_plot_reg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="annual-density-plots-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="annual-density-plots-1">Annual Density plots</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="stx_slp_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/annual_pdf_plot_reg-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<div class="cell column-page">

</div>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb135" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "stx_slp_sedar84_sizecomp_landstdgearname"</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Katherine Godwin"</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="an">toc_expand:</span><span class="co"> true</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 4</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>This script will be expanding upon the length-comp script c1_nominal_len_comps.Rmd created by Molly Stevens.</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stoplight Parrotfish STX</span></span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up library </span></span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a>librarian<span class="sc">::</span><span class="fu">shelf</span>(here, tidyverse, ROracle, keyring, dotenv, reshape, openxlsx, janitor, DT, pander, knitr) <span class="co">#plyr</span></span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a><span class="co"># if conflicts in pkgs arise, use the following:</span></span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a><span class="co"># library(conflicted)</span></span>
<span id="cb135-29"><a href="#cb135-29" aria-hidden="true" tabindex="-1"></a><span class="co"># conflicted::conflicts_prefer(here::here)</span></span>
<span id="cb135-30"><a href="#cb135-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-31"><a href="#cb135-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-32"><a href="#cb135-32" aria-hidden="true" tabindex="-1"></a><span class="co">#pull data by island</span></span>
<span id="cb135-33"><a href="#cb135-33" aria-hidden="true" tabindex="-1"></a><span class="co"># cr_tip(state_codes = c('PR', 'VI'))</span></span>
<span id="cb135-34"><a href="#cb135-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-35"><a href="#cb135-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find out the date of the most recent extraction</span></span>
<span id="cb135-36"><a href="#cb135-36" aria-hidden="true" tabindex="-1"></a>tip_date <span class="ot">&lt;-</span> <span class="fu">max</span>(</span>
<span id="cb135-37"><a href="#cb135-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">".*?([0-9]+).RDS*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>,</span>
<span id="cb135-38"><a href="#cb135-38" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">list.files</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"raw"</span>),</span>
<span id="cb135-39"><a href="#cb135-39" aria-hidden="true" tabindex="-1"></a>                             <span class="at">pattern =</span> <span class="st">"com_tip_PR_VI"</span>))))</span>
<span id="cb135-40"><a href="#cb135-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-41"><a href="#cb135-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out the name of the most recent extraction</span></span>
<span id="cb135-42"><a href="#cb135-42" aria-hidden="true" tabindex="-1"></a>tip_file <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"raw"</span>),</span>
<span id="cb135-43"><a href="#cb135-43" aria-hidden="true" tabindex="-1"></a>                       <span class="at">pattern =</span> <span class="fu">paste0</span>(<span class="st">"^com_tip_PR_VI_+"</span>, tip_date))</span>
<span id="cb135-44"><a href="#cb135-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-45"><a href="#cb135-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-46"><a href="#cb135-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the most recent extraction</span></span>
<span id="cb135-47"><a href="#cb135-47" aria-hidden="true" tabindex="-1"></a>tip <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"raw"</span>, tip_file))</span>
<span id="cb135-48"><a href="#cb135-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-49"><a href="#cb135-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to STTJ and Yellowtail Snapper AND create new filterable date value </span></span>
<span id="cb135-50"><a href="#cb135-50" aria-hidden="true" tabindex="-1"></a>stx_slp <span class="ot">&lt;-</span> tip <span class="sc">|&gt;</span> </span>
<span id="cb135-51"><a href="#cb135-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COUNTY_LANDED <span class="sc">==</span> <span class="st">"ST CROIX"</span>,</span>
<span id="cb135-52"><a href="#cb135-52" aria-hidden="true" tabindex="-1"></a>         OBS_STANDARD_SPECIES_CODE <span class="sc">==</span> <span class="st">"170867"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb135-53"><a href="#cb135-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TEST_DATE =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(INTERVIEW_DATE)),</span>
<span id="cb135-54"><a href="#cb135-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">FINAL_DATE =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(TEST_DATE) <span class="sc">~</span> INTERVIEW_DATE, </span>
<span id="cb135-55"><a href="#cb135-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span> <span class="sc">~</span> TEST_DATE))</span>
<span id="cb135-56"><a href="#cb135-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-57"><a href="#cb135-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-58"><a href="#cb135-58" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/functions/len_len_convert.R"</span>)</span>
<span id="cb135-59"><a href="#cb135-59" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/functions/fig_format_export.R"</span>)</span>
<span id="cb135-60"><a href="#cb135-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-61"><a href="#cb135-61" aria-hidden="true" tabindex="-1"></a>LLconv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/CSVs/LLconversions.csv"</span>,</span>
<span id="cb135-62"><a href="#cb135-62" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-63"><a href="#cb135-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-64"><a href="#cb135-64" aria-hidden="true" tabindex="-1"></a>TIP_gears <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/CSVs/tip_gears_stp_stx_LANDSTDGEARNAME.csv"</span>,</span>
<span id="cb135-65"><a href="#cb135-65" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-66"><a href="#cb135-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-67"><a href="#cb135-67" aria-hidden="true" tabindex="-1"></a>gearcols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Net"</span> <span class="ot">=</span> <span class="st">"#FF0000"</span>, <span class="st">"Trap"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"#5D057D"</span>, <span class="st">"Hook and Line"</span> <span class="ot">=</span><span class="st">"#046C9A"</span>, <span class="st">"Gill Net"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Haul Seine"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Lobster Trap"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Trammel Net"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Combined"</span> <span class="ot">=</span> <span class="st">"black"</span>)</span>
<span id="cb135-68"><a href="#cb135-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-69"><a href="#cb135-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-70"><a href="#cb135-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb135-71"><a href="#cb135-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-72"><a href="#cb135-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-73"><a href="#cb135-73" aria-hidden="true" tabindex="-1"></a><span class="fu">## Control Settings and Exploratory Frequency Tables</span></span>
<span id="cb135-74"><a href="#cb135-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-77"><a href="#cb135-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-78"><a href="#cb135-78" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-79"><a href="#cb135-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-80"><a href="#cb135-80" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="st">"SLP"</span></span>
<span id="cb135-81"><a href="#cb135-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-82"><a href="#cb135-82" aria-hidden="true" tabindex="-1"></a>region <span class="ot">&lt;-</span> <span class="st">"PUERTO RICO - USVI"</span></span>
<span id="cb135-83"><a href="#cb135-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-84"><a href="#cb135-84" aria-hidden="true" tabindex="-1"></a>county <span class="ot">&lt;-</span> <span class="st">"ST CROIX"</span></span>
<span id="cb135-85"><a href="#cb135-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-86"><a href="#cb135-86" aria-hidden="true" tabindex="-1"></a>bin_size <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb135-87"><a href="#cb135-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-88"><a href="#cb135-88" aria-hidden="true" tabindex="-1"></a>len_type <span class="ot">&lt;-</span> <span class="st">"FORK LENGTH"</span></span>
<span id="cb135-89"><a href="#cb135-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-90"><a href="#cb135-90" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>LENGTH_TYPE1, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-91"><a href="#cb135-91" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>LENGTH_TYPE2, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-92"><a href="#cb135-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-93"><a href="#cb135-93" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(stx_slp<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-94"><a href="#cb135-94" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(stx_slp<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-95"><a href="#cb135-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-96"><a href="#cb135-96" aria-hidden="true" tabindex="-1"></a>tip_range  <span class="ot">&lt;-</span> stx_slp[<span class="fu">with</span>(stx_slp,<span class="fu">order</span>(<span class="sc">-</span>LENGTH1_MM)),]</span>
<span id="cb135-97"><a href="#cb135-97" aria-hidden="true" tabindex="-1"></a>tip_range<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span>
<span id="cb135-98"><a href="#cb135-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-99"><a href="#cb135-99" aria-hidden="true" tabindex="-1"></a>tip_range2 <span class="ot">&lt;-</span> stx_slp[<span class="fu">with</span>(stx_slp,<span class="fu">order</span>(LENGTH1_MM)),]</span>
<span id="cb135-100"><a href="#cb135-100" aria-hidden="true" tabindex="-1"></a>tip_range2<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span>
<span id="cb135-101"><a href="#cb135-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-102"><a href="#cb135-102" aria-hidden="true" tabindex="-1"></a><span class="do">##range currently set to not drop any obs (centimeters)</span></span>
<span id="cb135-103"><a href="#cb135-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-104"><a href="#cb135-104" aria-hidden="true" tabindex="-1"></a>min_size <span class="ot">&lt;-</span> <span class="dv">12</span> </span>
<span id="cb135-105"><a href="#cb135-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-106"><a href="#cb135-106" aria-hidden="true" tabindex="-1"></a>max_size <span class="ot">&lt;-</span> <span class="dv">83</span>   </span>
<span id="cb135-107"><a href="#cb135-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-108"><a href="#cb135-108" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(stx_slp<span class="sc">$</span>YEAR,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-109"><a href="#cb135-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-110"><a href="#cb135-110" aria-hidden="true" tabindex="-1"></a>min_year <span class="ot">&lt;-</span> <span class="dv">1983</span></span>
<span id="cb135-111"><a href="#cb135-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-112"><a href="#cb135-112" aria-hidden="true" tabindex="-1"></a>max_year <span class="ot">&lt;-</span> <span class="dv">2022</span> </span>
<span id="cb135-113"><a href="#cb135-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-114"><a href="#cb135-114" aria-hidden="true" tabindex="-1"></a>break_year <span class="ot">&lt;-</span> <span class="dv">2005</span> <span class="co"># this is an optional value to denote a change in management. inclusive on the upper bound. can be set to NA if not relevant.  2005 trap specifications were updated and many closures went into place</span></span>
<span id="cb135-115"><a href="#cb135-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-116"><a href="#cb135-116" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb135-117"><a href="#cb135-117" aria-hidden="true" tabindex="-1"></a><span class="do">##  TABLES START HERE </span></span>
<span id="cb135-118"><a href="#cb135-118" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb135-119"><a href="#cb135-119" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-120"><a href="#cb135-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-121"><a href="#cb135-121" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-122"><a href="#cb135-122" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, stx_slp<span class="sc">$</span>STATE_LANDED, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-123"><a href="#cb135-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-124"><a href="#cb135-124" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>LAND_GEAR_NAME, stx_slp<span class="sc">$</span>STATE_LANDED, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-125"><a href="#cb135-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-126"><a href="#cb135-126" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>FISHING_MODE, stx_slp<span class="sc">$</span>INT_TYPE, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-127"><a href="#cb135-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-128"><a href="#cb135-128" aria-hidden="true" tabindex="-1"></a><span class="co"># marfin &lt;- stx_slp%&gt;%</span></span>
<span id="cb135-129"><a href="#cb135-129" aria-hidden="true" tabindex="-1"></a><span class="co">#             filter(INT_TYPE == "USVI MARFIN REEFFISH SAMPLING")</span></span>
<span id="cb135-130"><a href="#cb135-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-131"><a href="#cb135-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-132"><a href="#cb135-132" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>YEAR,stx_slp<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-133"><a href="#cb135-133" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb135-134"><a href="#cb135-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-135"><a href="#cb135-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-138"><a href="#cb135-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-139"><a href="#cb135-139" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-140"><a href="#cb135-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-141"><a href="#cb135-141" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>COUNTY_LANDED,stx_slp<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb135-142"><a href="#cb135-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-143"><a href="#cb135-143" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>YEAR,stx_slp<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb135-144"><a href="#cb135-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-145"><a href="#cb135-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-146"><a href="#cb135-146" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Filter to Commercial samples</span></span>
<span id="cb135-147"><a href="#cb135-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-150"><a href="#cb135-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-151"><a href="#cb135-151" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-152"><a href="#cb135-152" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-153"><a href="#cb135-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-154"><a href="#cb135-154" aria-hidden="true" tabindex="-1"></a><span class="do">################## PICK VARIABLES THAT I NEED HERE ;</span></span>
<span id="cb135-155"><a href="#cb135-155" aria-hidden="true" tabindex="-1"></a><span class="do">################## ASSIGN GEARS, ETC. BASED ON FLOW CHART</span></span>
<span id="cb135-156"><a href="#cb135-156" aria-hidden="true" tabindex="-1"></a><span class="do">## FILTER OUT COMMERCIAL SAMPLES</span></span>
<span id="cb135-157"><a href="#cb135-157" aria-hidden="true" tabindex="-1"></a><span class="do">## replace species 3 letter code and itis number in code</span></span>
<span id="cb135-158"><a href="#cb135-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-159"><a href="#cb135-159" aria-hidden="true" tabindex="-1"></a>tip2 <span class="ot">&lt;-</span> <span class="co">#readRDS('./data_clean/tip_GOM.Rdata') %&gt;%</span></span>
<span id="cb135-160"><a href="#cb135-160" aria-hidden="true" tabindex="-1"></a>  stx_slp <span class="sc">%&gt;%</span></span>
<span id="cb135-161"><a href="#cb135-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( <span class="co">#MULT_TRIP == '0')%&gt;%  ##no mult_trip in Caribbean TIP --&gt; ALL full catch samples</span></span>
<span id="cb135-162"><a href="#cb135-162" aria-hidden="true" tabindex="-1"></a>    FISHING_MODE<span class="sc">==</span><span class="st">'COMMERCIAL'</span>,</span>
<span id="cb135-163"><a href="#cb135-163" aria-hidden="true" tabindex="-1"></a>    LENGTH_TYPE1<span class="sc">!=</span><span class="st">'NO LENGTH'</span>,</span>
<span id="cb135-164"><a href="#cb135-164" aria-hidden="true" tabindex="-1"></a>    YEAR <span class="sc">&lt;=</span> <span class="dv">2023</span></span>
<span id="cb135-165"><a href="#cb135-165" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb135-166"><a href="#cb135-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type_convert</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-167"><a href="#cb135-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">REGION_NAME =</span> region,</span>
<span id="cb135-168"><a href="#cb135-168" aria-hidden="true" tabindex="-1"></a>         <span class="at">OBS_STANDARD_SPECIES_CODE =</span> <span class="fu">as.numeric</span>(OBS_STANDARD_SPECIES_CODE), </span>
<span id="cb135-169"><a href="#cb135-169" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb135-170"><a href="#cb135-170" aria-hidden="true" tabindex="-1"></a><span class="do">####################SARAH'S CORRECTIONS NOW FIXED IN TIP DATABASE   </span></span>
<span id="cb135-171"><a href="#cb135-171" aria-hidden="true" tabindex="-1"></a><span class="co">#         COUNTY_LANDED = ifelse((YEAR==2018 &amp; COUNTY_LANDED=='NOT CODED'), 'ST THOMAS',</span></span>
<span id="cb135-172"><a href="#cb135-172" aria-hidden="true" tabindex="-1"></a><span class="co">#                                ifelse((YEAR==2017 &amp; COUNTY_LANDED=='NOT CODED'), 'ST CROIX', COUNTY_LANDED)),</span></span>
<span id="cb135-173"><a href="#cb135-173" aria-hidden="true" tabindex="-1"></a><span class="co">#         LENGTH1     = ifelse(LENGTH1_MM&gt;2000, LENGTH1/10, LENGTH1),</span></span>
<span id="cb135-174"><a href="#cb135-174" aria-hidden="true" tabindex="-1"></a><span class="co">#         LENGTH1_MM  = ifelse(LENGTH1_MM&gt;2000, LENGTH1_MM/10,LENGTH1_MM),</span></span>
<span id="cb135-175"><a href="#cb135-175" aria-hidden="true" tabindex="-1"></a><span class="do">####################</span></span>
<span id="cb135-176"><a href="#cb135-176" aria-hidden="true" tabindex="-1"></a>         <span class="at">source      =</span> <span class="st">"TIP"</span>, </span>
<span id="cb135-177"><a href="#cb135-177" aria-hidden="true" tabindex="-1"></a>         <span class="at">SLP         =</span> <span class="fu">ifelse</span>(OBS_STANDARD_SPECIES_CODE<span class="sc">==</span><span class="dv">170867</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="co">#binary flag for queen triggerfish vs 'other'</span></span>
<span id="cb135-178"><a href="#cb135-178" aria-hidden="true" tabindex="-1"></a>         <span class="at">ISLAND      =</span> <span class="fu">ifelse</span>(STATE_LANDED<span class="sc">==</span><span class="st">'PUERTO RICO'</span>, STATE_LANDED, COUNTY_LANDED),</span>
<span id="cb135-179"><a href="#cb135-179" aria-hidden="true" tabindex="-1"></a>         <span class="co">#STAT_AREA = ifelse(STANDARDAREA_1&gt;1, STANDARDAREA_1, LAND_STANDARD_AREA_ID),</span></span>
<span id="cb135-180"><a href="#cb135-180" aria-hidden="true" tabindex="-1"></a>         <span class="at">OBS_ID      =</span> <span class="fu">as.character</span>(OBS_ID)</span>
<span id="cb135-181"><a href="#cb135-181" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb135-182"><a href="#cb135-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(REGION_NAME,</span>
<span id="cb135-183"><a href="#cb135-183" aria-hidden="true" tabindex="-1"></a>         source,</span>
<span id="cb135-184"><a href="#cb135-184" aria-hidden="true" tabindex="-1"></a>         ID,</span>
<span id="cb135-185"><a href="#cb135-185" aria-hidden="true" tabindex="-1"></a>         INTERVIEW_DATE,</span>
<span id="cb135-186"><a href="#cb135-186" aria-hidden="true" tabindex="-1"></a>         FINAL_DATE,</span>
<span id="cb135-187"><a href="#cb135-187" aria-hidden="true" tabindex="-1"></a>         FISHING_MODE,</span>
<span id="cb135-188"><a href="#cb135-188" aria-hidden="true" tabindex="-1"></a>         INT_TYPE,</span>
<span id="cb135-189"><a href="#cb135-189" aria-hidden="true" tabindex="-1"></a>         <span class="at">YEAR =</span> YEAR,</span>
<span id="cb135-190"><a href="#cb135-190" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITIS_CODE   =</span> OBS_STANDARD_SPECIES_CODE,</span>
<span id="cb135-191"><a href="#cb135-191" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPECIES     =</span> OBS_STANDARD_SPECIES_NAME,</span>
<span id="cb135-192"><a href="#cb135-192" aria-hidden="true" tabindex="-1"></a>         QUANTITY,</span>
<span id="cb135-193"><a href="#cb135-193" aria-hidden="true" tabindex="-1"></a>         SLP,</span>
<span id="cb135-194"><a href="#cb135-194" aria-hidden="true" tabindex="-1"></a>         STATE_LANDED,</span>
<span id="cb135-195"><a href="#cb135-195" aria-hidden="true" tabindex="-1"></a>         COUNTY_LANDED,</span>
<span id="cb135-196"><a href="#cb135-196" aria-hidden="true" tabindex="-1"></a>         <span class="at">COUNTY_CODE=</span>LANDING_AREA_COUNTY_CODE,</span>
<span id="cb135-197"><a href="#cb135-197" aria-hidden="true" tabindex="-1"></a>         PLACE_LANDED,</span>
<span id="cb135-198"><a href="#cb135-198" aria-hidden="true" tabindex="-1"></a>         DEALER,</span>
<span id="cb135-199"><a href="#cb135-199" aria-hidden="true" tabindex="-1"></a>         DEALER_CODE,</span>
<span id="cb135-200"><a href="#cb135-200" aria-hidden="true" tabindex="-1"></a>         ISLAND,</span>
<span id="cb135-201"><a href="#cb135-201" aria-hidden="true" tabindex="-1"></a>         OBS_WEIGHT_KG,</span>
<span id="cb135-202"><a href="#cb135-202" aria-hidden="true" tabindex="-1"></a>         LENGTH1_MM,</span>
<span id="cb135-203"><a href="#cb135-203" aria-hidden="true" tabindex="-1"></a>         LENGTH1,</span>
<span id="cb135-204"><a href="#cb135-204" aria-hidden="true" tabindex="-1"></a>         LENGTH_TYPE1,</span>
<span id="cb135-205"><a href="#cb135-205" aria-hidden="true" tabindex="-1"></a>         LENGTH_UNIT1,</span>
<span id="cb135-206"><a href="#cb135-206" aria-hidden="true" tabindex="-1"></a>         OBS_ID,</span>
<span id="cb135-207"><a href="#cb135-207" aria-hidden="true" tabindex="-1"></a>         LAND_STANDARD_GEAR_NAME,</span>
<span id="cb135-208"><a href="#cb135-208" aria-hidden="true" tabindex="-1"></a>         LAND_GEAR_NAME,</span>
<span id="cb135-209"><a href="#cb135-209" aria-hidden="true" tabindex="-1"></a>         LANDING_TYPE,</span>
<span id="cb135-210"><a href="#cb135-210" aria-hidden="true" tabindex="-1"></a>         BIAS_TYPE,</span>
<span id="cb135-211"><a href="#cb135-211" aria-hidden="true" tabindex="-1"></a>         VESSEL_ID,</span>
<span id="cb135-212"><a href="#cb135-212" aria-hidden="true" tabindex="-1"></a>         LICENSE,</span>
<span id="cb135-213"><a href="#cb135-213" aria-hidden="true" tabindex="-1"></a>         SAMPLE_ID,</span>
<span id="cb135-214"><a href="#cb135-214" aria-hidden="true" tabindex="-1"></a>         AREA_1,</span>
<span id="cb135-215"><a href="#cb135-215" aria-hidden="true" tabindex="-1"></a>         AREANAME_1,</span>
<span id="cb135-216"><a href="#cb135-216" aria-hidden="true" tabindex="-1"></a>         STANDARDAREA_1,</span>
<span id="cb135-217"><a href="#cb135-217" aria-hidden="true" tabindex="-1"></a>         STANDARDAREANAME_1,</span>
<span id="cb135-218"><a href="#cb135-218" aria-hidden="true" tabindex="-1"></a>         AGENT_USERNAME_ID,</span>
<span id="cb135-219"><a href="#cb135-219" aria-hidden="true" tabindex="-1"></a>         DEALER_CODE,</span>
<span id="cb135-220"><a href="#cb135-220" aria-hidden="true" tabindex="-1"></a>         VESSEL_ID</span>
<span id="cb135-221"><a href="#cb135-221" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-222"><a href="#cb135-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-223"><a href="#cb135-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-224"><a href="#cb135-224" aria-hidden="true" tabindex="-1"></a>Length composition after filtering to commercial records</span>
<span id="cb135-225"><a href="#cb135-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-228"><a href="#cb135-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-229"><a href="#cb135-229" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-230"><a href="#cb135-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-231"><a href="#cb135-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-232"><a href="#cb135-232" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>COUNTY_LANDED,tip2<span class="sc">$</span>ISLAND,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb135-233"><a href="#cb135-233" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>YEAR,tip2<span class="sc">$</span>ISLAND,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb135-234"><a href="#cb135-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-235"><a href="#cb135-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-236"><a href="#cb135-236" aria-hidden="true" tabindex="-1"></a>lencheck <span class="ot">&lt;-</span> tip2[tip2<span class="sc">$</span>LENGTH1_MM<span class="sc">&gt;</span><span class="dv">2000</span>,] <span class="co">#no lengths greater than 2000</span></span>
<span id="cb135-237"><a href="#cb135-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-238"><a href="#cb135-238" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range  &lt;- tip2[with(tip2,order(-LENGTH1_MM)),]</span></span>
<span id="cb135-239"><a href="#cb135-239" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range$LENGTH1_MM[1:25]</span></span>
<span id="cb135-240"><a href="#cb135-240" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-241"><a href="#cb135-241" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range2 &lt;- tip2[with(tip2,order(LENGTH1_MM)),]</span></span>
<span id="cb135-242"><a href="#cb135-242" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range2$LENGTH1_MM[1:25]</span></span>
<span id="cb135-243"><a href="#cb135-243" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>LENGTH_TYPE1,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-244"><a href="#cb135-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-245"><a href="#cb135-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-246"><a href="#cb135-246" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>LAND_STANDARD_GEAR_NAME,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-247"><a href="#cb135-247" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-248"><a href="#cb135-248" aria-hidden="true" tabindex="-1"></a><span class="co"># table(tip2$ITIS_CODE,tip2$SPECIES,useNA='always')</span></span>
<span id="cb135-249"><a href="#cb135-249" aria-hidden="true" tabindex="-1"></a><span class="co"># table(tip2$SPECIES,tip2$SLP,useNA='always')</span></span>
<span id="cb135-250"><a href="#cb135-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-251"><a href="#cb135-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-252"><a href="#cb135-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-253"><a href="#cb135-253" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract marfin samples, look at island distribution</span></span>
<span id="cb135-254"><a href="#cb135-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-257"><a href="#cb135-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb135-258"><a href="#cb135-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-259"><a href="#cb135-259" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-260"><a href="#cb135-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-261"><a href="#cb135-261" aria-hidden="true" tabindex="-1"></a><span class="do">##extract marfin samples, look at island distribution</span></span>
<span id="cb135-262"><a href="#cb135-262" aria-hidden="true" tabindex="-1"></a>marfin <span class="ot">&lt;-</span> tip2<span class="sc">%&gt;%</span></span>
<span id="cb135-263"><a href="#cb135-263" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(INT_TYPE <span class="sc">==</span> <span class="st">"USVI MARFIN REEFFISH SAMPLING"</span>)</span>
<span id="cb135-264"><a href="#cb135-264" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(marfin<span class="sc">$</span>YEAR, marfin<span class="sc">$</span>ISLAND,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-265"><a href="#cb135-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-266"><a href="#cb135-266" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(marfin<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, marfin<span class="sc">$</span>ISLAND,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-267"><a href="#cb135-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-268"><a href="#cb135-268" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(marfin<span class="sc">$</span>LAND_STANDARD_GEAR_NAME,marfin<span class="sc">$</span>YEAR, marfin<span class="sc">$</span>ISLAND,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-269"><a href="#cb135-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-270"><a href="#cb135-270" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>YEAR,tip2<span class="sc">$</span>LENGTH_TYPE1,<span class="at">useNA=</span><span class="st">'always'</span>)  <span class="do">##TL more prevalent in recent years</span></span>
<span id="cb135-271"><a href="#cb135-271" aria-hidden="true" tabindex="-1"></a><span class="co"># table(tip2$LENGTH_TYPE1,tip2$LENGTH_TYPE2,useNA='always') </span></span>
<span id="cb135-272"><a href="#cb135-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-273"><a href="#cb135-273" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>ISLAND,tip2<span class="sc">$</span>STATE_LANDED)</span>
<span id="cb135-274"><a href="#cb135-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-275"><a href="#cb135-275" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tip2$LENGTH1_MM,tip2$OBS_WEIGHT_KG,color=tip2$LENGTH_TYPE1)</span></span>
<span id="cb135-276"><a href="#cb135-276" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tip2$LENGTH1_MM,tip2$SAMPLE_WEIGHT_KG)</span></span>
<span id="cb135-277"><a href="#cb135-277" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tip2$LENGTH1_MM,tip2$SUB_SAMPLE_WEIGHT_KG)</span></span>
<span id="cb135-278"><a href="#cb135-278" aria-hidden="true" tabindex="-1"></a>tip2<span class="sc">$</span>yearc <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tip2<span class="sc">$</span>YEAR)</span>
<span id="cb135-279"><a href="#cb135-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-280"><a href="#cb135-280" aria-hidden="true" tabindex="-1"></a><span class="do">##############export all plots starting w/ year&gt;=2015, all islands</span></span>
<span id="cb135-281"><a href="#cb135-281" aria-hidden="true" tabindex="-1"></a><span class="do">#### here, isolated ST THOMAS 2018 for bulk of problems w single port sampler</span></span>
<span id="cb135-282"><a href="#cb135-282" aria-hidden="true" tabindex="-1"></a><span class="do">#### create new RMarkdown script describing this issue for internal distribution</span></span>
<span id="cb135-283"><a href="#cb135-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-284"><a href="#cb135-284" aria-hidden="true" tabindex="-1"></a><span class="co"># tip2[(tip2$YEAR==2018 &amp; tip2$ISLAND=='ST THOMAS'),] %&gt;%</span></span>
<span id="cb135-285"><a href="#cb135-285" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(LENGTH1_MM,OBS_WEIGHT_KG))+</span></span>
<span id="cb135-286"><a href="#cb135-286" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(color = AGENT_USERNAME_ID))  +  ##fork length is splitting</span></span>
<span id="cb135-287"><a href="#cb135-287" aria-hidden="true" tabindex="-1"></a><span class="co">#   # geom_point(aes(color = ISLAND))  +</span></span>
<span id="cb135-288"><a href="#cb135-288" aria-hidden="true" tabindex="-1"></a><span class="co">#   #labs(title = paste0(tip2$ISLAND,  "\n", min(tip2$YEAR), "-", max(tip2$YEAR)))+</span></span>
<span id="cb135-289"><a href="#cb135-289" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span>
<span id="cb135-290"><a href="#cb135-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-291"><a href="#cb135-291" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################################</span></span>
<span id="cb135-292"><a href="#cb135-292" aria-hidden="true" tabindex="-1"></a><span class="do">##### merge in gear tables </span></span>
<span id="cb135-293"><a href="#cb135-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-294"><a href="#cb135-294" aria-hidden="true" tabindex="-1"></a><span class="do">##LOOK AT GEAR ASSIGNMENTS BY SPECIES</span></span>
<span id="cb135-295"><a href="#cb135-295" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(stx_slp<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, stx_slp<span class="sc">$</span>STANDARDGEARNAME_2)</span>
<span id="cb135-296"><a href="#cb135-296" aria-hidden="true" tabindex="-1"></a><span class="co">#table(stx_slp$GEAR, useNA='always')  ##N gears?</span></span>
<span id="cb135-297"><a href="#cb135-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-298"><a href="#cb135-298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-299"><a href="#cb135-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-300"><a href="#cb135-300" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Add gear groupings, NO length-length conversions available</span></span>
<span id="cb135-301"><a href="#cb135-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-302"><a href="#cb135-302" aria-hidden="true" tabindex="-1"></a>Trap gears were originally placed in "other" category based on previous landings discussions. I moved them to their own group for visualization purposes right now. </span>
<span id="cb135-303"><a href="#cb135-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-304"><a href="#cb135-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb135-305"><a href="#cb135-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-306"><a href="#cb135-306" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-307"><a href="#cb135-307" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-308"><a href="#cb135-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-309"><a href="#cb135-309" aria-hidden="true" tabindex="-1"></a><span class="do">###add length-length conversions to helper_table ; </span></span>
<span id="cb135-310"><a href="#cb135-310" aria-hidden="true" tabindex="-1"></a>tip3 <span class="ot">&lt;-</span> <span class="fu">merge</span>(tip2, TIP_gears, <span class="at">by.x=</span><span class="st">"LAND_STANDARD_GEAR_NAME"</span>,<span class="at">all.x=</span>T)</span>
<span id="cb135-311"><a href="#cb135-311" aria-hidden="true" tabindex="-1"></a><span class="co">#gfin2a &lt;- merge(gfin, flc, by.x=c("State_Landed","County_Landed"),all.x=T)</span></span>
<span id="cb135-312"><a href="#cb135-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-313"><a href="#cb135-313" aria-hidden="true" tabindex="-1"></a>tip4 <span class="ot">&lt;-</span> tip3[tip3<span class="sc">$</span>SLP<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb135-314"><a href="#cb135-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-315"><a href="#cb135-315" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip3<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, tip3<span class="sc">$</span>gear, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb135-316"><a href="#cb135-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-317"><a href="#cb135-317" aria-hidden="true" tabindex="-1"></a><span class="co">#gear_groups &lt;- c("HAND LINE", "LONGLINE") </span></span>
<span id="cb135-318"><a href="#cb135-318" aria-hidden="true" tabindex="-1"></a>gear_groups <span class="ot">&lt;-</span> <span class="fu">unique</span>(TIP_gears<span class="sc">$</span>gear)</span>
<span id="cb135-319"><a href="#cb135-319" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-320"><a href="#cb135-320" aria-hidden="true" tabindex="-1"></a><span class="co"># antiforklength &lt;- tip4 |&gt;</span></span>
<span id="cb135-321"><a href="#cb135-321" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(LENGTH_TYPE1 != "FORK LENGTH")</span></span>
<span id="cb135-322"><a href="#cb135-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-323"><a href="#cb135-323" aria-hidden="true" tabindex="-1"></a><span class="do">##splitting here to more easily qa/qc above</span></span>
<span id="cb135-324"><a href="#cb135-324" aria-hidden="true" tabindex="-1"></a>join_length_dat <span class="ot">&lt;-</span> tip4 <span class="sc">%&gt;%</span> <span class="co">#bind_rows(tip3 , gfin2) %&gt;%</span></span>
<span id="cb135-325"><a href="#cb135-325" aria-hidden="true" tabindex="-1"></a>  <span class="co"># len_len_convert(params = LLconv, </span></span>
<span id="cb135-326"><a href="#cb135-326" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 raw_length = LENGTH1, </span></span>
<span id="cb135-327"><a href="#cb135-327" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 length_type =LENGTH_TYPE1, </span></span>
<span id="cb135-328"><a href="#cb135-328" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 length_units =  LENGTH_UNIT1, </span></span>
<span id="cb135-329"><a href="#cb135-329" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 desired_type = len_type) %&gt;%</span></span>
<span id="cb135-330"><a href="#cb135-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">untable</span>(<span class="at">num =</span> .<span class="sc">$</span>QUANTITY)  <span class="sc">%&gt;%</span></span>
<span id="cb135-331"><a href="#cb135-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(LENGTH_TYPE1 <span class="sc">==</span> <span class="st">"FORK LENGTH"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-332"><a href="#cb135-332" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(NEW_GEAR_NAME %in% c(gear_groups)) %&gt;%</span></span>
<span id="cb135-333"><a href="#cb135-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="co">#gear = ifelse(grepl("hand*", NEW_GEAR_NAME, ignore.case = T, fixed = F), "HL", "LL"), #this part will need to be generalized for more than 2 gear types ; ++HOOKLINE IS HANDLINE IN THIS FILE ; OVERWRITING ALL HL TO LL ; CHANGED "hook*" TO "hand*"</span></span>
<span id="cb135-334"><a href="#cb135-334" aria-hidden="true" tabindex="-1"></a>         <span class="co">#gear=GEAR_GRP,</span></span>
<span id="cb135-335"><a href="#cb135-335" aria-hidden="true" tabindex="-1"></a>         <span class="at">FL_CM =</span> LENGTH1_MM<span class="sc">/</span><span class="dv">10</span>, </span>
<span id="cb135-336"><a href="#cb135-336" aria-hidden="true" tabindex="-1"></a>         <span class="at">lbin =</span> <span class="fu">floor</span>(FL_CM <span class="sc">/</span> bin_size)<span class="sc">*</span>bin_size, </span>
<span id="cb135-337"><a href="#cb135-337" aria-hidden="true" tabindex="-1"></a>         <span class="at">mgt_period =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">&lt;=</span> break_year, <span class="fu">paste0</span>(min_year,<span class="st">" - "</span>, break_year), <span class="fu">paste0</span>( break_year<span class="sc">+</span><span class="dv">1</span>, <span class="st">" - "</span>, max_year)))</span>
<span id="cb135-338"><a href="#cb135-338" aria-hidden="true" tabindex="-1"></a><span class="co"># is "select" the problem, its #out </span></span>
<span id="cb135-339"><a href="#cb135-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-340"><a href="#cb135-340" aria-hidden="true" tabindex="-1"></a><span class="co"># FINAL dataset here ----</span></span>
<span id="cb135-341"><a href="#cb135-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-342"><a href="#cb135-342" aria-hidden="true" tabindex="-1"></a>length_data_final <span class="ot">&lt;-</span> join_length_dat <span class="sc">%&gt;%</span></span>
<span id="cb135-343"><a href="#cb135-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, INTERVIEW_DATE, FINAL_DATE, ID, OBS_ID, <span class="at">STATE =</span> STATE_LANDED, <span class="at">COUNTY=</span>COUNTY_LANDED, COUNTY_CODE, FL_CM, lbin, source, gear, gear_short, LAND_STANDARD_GEAR_NAME, LAND_GEAR_NAME, mgt_period, ISLAND, INT_TYPE, fleet, DEALER_CODE, VESSEL_ID, LICENSE) <span class="sc">%&gt;%</span>  <span class="co">#STAT_AREA</span></span>
<span id="cb135-344"><a href="#cb135-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(FL_CM , min_size, max_size),</span>
<span id="cb135-345"><a href="#cb135-345" aria-hidden="true" tabindex="-1"></a>         ISLAND <span class="sc">!=</span> <span class="st">'NOT CODED'</span>)</span>
<span id="cb135-346"><a href="#cb135-346" aria-hidden="true" tabindex="-1"></a>         <span class="co">#,</span></span>
<span id="cb135-347"><a href="#cb135-347" aria-hidden="true" tabindex="-1"></a>         <span class="co">#INT_TYPE != 'USVI MARFIN REEFFISH SAMPLING') </span></span>
<span id="cb135-348"><a href="#cb135-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-349"><a href="#cb135-349" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyst have asked for a record of dropped observations</span></span>
<span id="cb135-350"><a href="#cb135-350" aria-hidden="true" tabindex="-1"></a><span class="do">######### ADAPT THIS TO OUTPUT ALL DROPPED RECORDS ABOVE--MOVE HIGHER IN THE SCRIPT TO HAVE ALL VARS</span></span>
<span id="cb135-351"><a href="#cb135-351" aria-hidden="true" tabindex="-1"></a>dropped_obs <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(join_length_dat, length_data_final, <span class="at">by =</span> <span class="st">"OBS_ID"</span>)  </span>
<span id="cb135-352"><a href="#cb135-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-353"><a href="#cb135-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-354"><a href="#cb135-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-355"><a href="#cb135-355" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################DOCUMENT ALL DROPPED DATA</span></span>
<span id="cb135-356"><a href="#cb135-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-357"><a href="#cb135-357" aria-hidden="true" tabindex="-1"></a><span class="co"># drop &lt;- list()  ##++this creates an empty list for for loop</span></span>
<span id="cb135-358"><a href="#cb135-358" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-359"><a href="#cb135-359" aria-hidden="true" tabindex="-1"></a><span class="co"># # for loop generates binned length comps for each of the final gears. Stored in list. RUN:  View(comps[[1]]) to see in R</span></span>
<span id="cb135-360"><a href="#cb135-360" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-361"><a href="#cb135-361" aria-hidden="true" tabindex="-1"></a><span class="co">#  drop[[1]] &lt;-  NON-RANDOM SAMPLES</span></span>
<span id="cb135-362"><a href="#cb135-362" aria-hidden="true" tabindex="-1"></a><span class="co">#  drop[[2]] &lt;-  SIZE DATA</span></span>
<span id="cb135-363"><a href="#cb135-363" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(gear == final_gears[i]) %&gt;%</span></span>
<span id="cb135-364"><a href="#cb135-364" aria-hidden="true" tabindex="-1"></a><span class="co"># names(comps)[[1]] &lt;- paste0(final_gears[i], "_", bin_size, "cm") ##++tabs are named here ; could add _nom here if desired (instead of _lfd and _lfdw in main file)</span></span>
<span id="cb135-365"><a href="#cb135-365" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb135-366"><a href="#cb135-366" aria-hidden="true" tabindex="-1"></a><span class="do">################################################</span></span>
<span id="cb135-367"><a href="#cb135-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-368"><a href="#cb135-368" aria-hidden="true" tabindex="-1"></a><span class="do">###this is writing only size data issues (e.g. samples too small/large to be considered realistic)</span></span>
<span id="cb135-369"><a href="#cb135-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-370"><a href="#cb135-370" aria-hidden="true" tabindex="-1"></a><span class="co"># write.xlsx(dropped_obs, file = paste0("./outputs/", sp, "_size_dropped_observations_", gsub("-", "", Sys.Date()), ".xlsx"))</span></span>
<span id="cb135-371"><a href="#cb135-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-372"><a href="#cb135-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-373"><a href="#cb135-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-374"><a href="#cb135-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r maintain_empty_bins}</span></span>
<span id="cb135-375"><a href="#cb135-375" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-376"><a href="#cb135-376" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-377"><a href="#cb135-377" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-378"><a href="#cb135-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-379"><a href="#cb135-379" aria-hidden="true" tabindex="-1"></a><span class="co"># this is some funky code to make sure bins with no obervations are maintained in the data. Open to finding a more elegant solution but this works</span></span>
<span id="cb135-380"><a href="#cb135-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-381"><a href="#cb135-381" aria-hidden="true" tabindex="-1"></a>full_set <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">YEAR =</span> <span class="fu">seq</span>(<span class="at">from =</span> min_year, <span class="at">to =</span> max_year, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb135-382"><a href="#cb135-382" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lbin =</span> <span class="fu">seq</span>(<span class="at">from =</span> min_size, <span class="at">to =</span> max_size, <span class="at">by =</span> bin_size), </span>
<span id="cb135-383"><a href="#cb135-383" aria-hidden="true" tabindex="-1"></a>                     <span class="at">N =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-384"><a href="#cb135-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> lbin, <span class="at">values_from =</span> N)</span>
<span id="cb135-385"><a href="#cb135-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-386"><a href="#cb135-386" aria-hidden="true" tabindex="-1"></a>comp_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"YEAR"</span>, <span class="st">"ln_fish"</span>, <span class="st">"ln_trips"</span>, <span class="st">"ln_dealers"</span>,<span class="st">"ln_vessels"</span>, <span class="fu">names</span>(full_set)[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb135-387"><a href="#cb135-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-388"><a href="#cb135-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-389"><a href="#cb135-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-390"><a href="#cb135-390" aria-hidden="true" tabindex="-1"></a><span class="fu"># Filtration level investigation</span></span>
<span id="cb135-391"><a href="#cb135-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-392"><a href="#cb135-392" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unique trip ID vs gear by year investigation</span></span>
<span id="cb135-393"><a href="#cb135-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-394"><a href="#cb135-394" aria-hidden="true" tabindex="-1"></a><span class="fu">#### How many unique trip ID's per year?</span></span>
<span id="cb135-395"><a href="#cb135-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-396"><a href="#cb135-396" aria-hidden="true" tabindex="-1"></a>Group by year, count unique trip id's</span>
<span id="cb135-397"><a href="#cb135-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-398"><a href="#cb135-398" aria-hidden="true" tabindex="-1"></a>When we remove data from years with less than 10 unique trip ID's, we are left with 24 years of data (vs 33 without filter).</span>
<span id="cb135-399"><a href="#cb135-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-400"><a href="#cb135-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb135-401"><a href="#cb135-401" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb135-402"><a href="#cb135-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-403"><a href="#cb135-403" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb135-404"><a href="#cb135-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb135-405"><a href="#cb135-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb135-406"><a href="#cb135-406" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_tripcount)</span>
<span id="cb135-407"><a href="#cb135-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-408"><a href="#cb135-408" aria-hidden="true" tabindex="-1"></a>length_data_trip10 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb135-409"><a href="#cb135-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb135-410"><a href="#cb135-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(ID) <span class="sc">&gt;=</span> <span class="dv">10</span>)<span class="sc">|&gt;</span></span>
<span id="cb135-411"><a href="#cb135-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb135-412"><a href="#cb135-412" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_trip10)</span>
<span id="cb135-413"><a href="#cb135-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-414"><a href="#cb135-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-415"><a href="#cb135-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-416"><a href="#cb135-416" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unique length records per gear per year</span></span>
<span id="cb135-417"><a href="#cb135-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-418"><a href="#cb135-418" aria-hidden="true" tabindex="-1"></a><span class="fu">### How many length records per gear per year?</span></span>
<span id="cb135-419"><a href="#cb135-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-420"><a href="#cb135-420" aria-hidden="true" tabindex="-1"></a>Group by year, count occurrences of each gear</span>
<span id="cb135-421"><a href="#cb135-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-422"><a href="#cb135-422" aria-hidden="true" tabindex="-1"></a>There are years when individual gears occur less than 30 times but when grouped, the gear groups exceed 30 occurrences per year. Do we want to rely on gear groups with larger than 30 occurrences per year or individual gears with more than 30 occurrences?</span>
<span id="cb135-423"><a href="#cb135-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-424"><a href="#cb135-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb135-425"><a href="#cb135-425" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-426"><a href="#cb135-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-427"><a href="#cb135-427" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur each year</span></span>
<span id="cb135-428"><a href="#cb135-428" aria-hidden="true" tabindex="-1"></a>length_data_gearcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb135-429"><a href="#cb135-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb135-430"><a href="#cb135-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb135-431"><a href="#cb135-431" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gearcount)</span>
<span id="cb135-432"><a href="#cb135-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-433"><a href="#cb135-433" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur 30 or more times each year</span></span>
<span id="cb135-434"><a href="#cb135-434" aria-hidden="true" tabindex="-1"></a>length_data_gear30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb135-435"><a href="#cb135-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb135-436"><a href="#cb135-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb135-437"><a href="#cb135-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb135-438"><a href="#cb135-438" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear30)</span>
<span id="cb135-439"><a href="#cb135-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-440"><a href="#cb135-440" aria-hidden="true" tabindex="-1"></a><span class="co"># group gears that occur 30 or more times per year by gear grouping </span></span>
<span id="cb135-441"><a href="#cb135-441" aria-hidden="true" tabindex="-1"></a>length_data_geartogether30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb135-442"><a href="#cb135-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb135-443"><a href="#cb135-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb135-444"><a href="#cb135-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb135-445"><a href="#cb135-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span> </span>
<span id="cb135-446"><a href="#cb135-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb135-447"><a href="#cb135-447" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geartogether30)</span>
<span id="cb135-448"><a href="#cb135-448" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by specific gear per year</span></span>
<span id="cb135-449"><a href="#cb135-449" aria-hidden="true" tabindex="-1"></a><span class="co"># 29 years of data available </span></span>
<span id="cb135-450"><a href="#cb135-450" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geartogether30<span class="sc">$</span>YEAR, length_data_geartogether30<span class="sc">$</span>gear)</span>
<span id="cb135-451"><a href="#cb135-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-452"><a href="#cb135-452" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur each year</span></span>
<span id="cb135-453"><a href="#cb135-453" aria-hidden="true" tabindex="-1"></a>length_data_geargroupcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb135-454"><a href="#cb135-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb135-455"><a href="#cb135-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb135-456"><a href="#cb135-456" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroupcount)</span>
<span id="cb135-457"><a href="#cb135-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-458"><a href="#cb135-458" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur 30 or more times each year</span></span>
<span id="cb135-459"><a href="#cb135-459" aria-hidden="true" tabindex="-1"></a>length_data_geargroup30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb135-460"><a href="#cb135-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb135-461"><a href="#cb135-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb135-462"><a href="#cb135-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb135-463"><a href="#cb135-463" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup30)</span>
<span id="cb135-464"><a href="#cb135-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-465"><a href="#cb135-465" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by gear grouping per year</span></span>
<span id="cb135-466"><a href="#cb135-466" aria-hidden="true" tabindex="-1"></a><span class="co"># 29 years of data available </span></span>
<span id="cb135-467"><a href="#cb135-467" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geargroup30<span class="sc">$</span>YEAR, length_data_geargroup30<span class="sc">$</span>gear)</span>
<span id="cb135-468"><a href="#cb135-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-469"><a href="#cb135-469" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by individual gears </span></span>
<span id="cb135-470"><a href="#cb135-470" aria-hidden="true" tabindex="-1"></a>length_data_gear29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb135-471"><a href="#cb135-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb135-472"><a href="#cb135-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb135-473"><a href="#cb135-473" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb135-474"><a href="#cb135-474" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb135-475"><a href="#cb135-475" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb135-476"><a href="#cb135-476" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear29)</span>
<span id="cb135-477"><a href="#cb135-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-478"><a href="#cb135-478" aria-hidden="true" tabindex="-1"></a><span class="co"># VS </span></span>
<span id="cb135-479"><a href="#cb135-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-480"><a href="#cb135-480" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by gear groups </span></span>
<span id="cb135-481"><a href="#cb135-481" aria-hidden="true" tabindex="-1"></a>length_data_geargroup29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb135-482"><a href="#cb135-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb135-483"><a href="#cb135-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb135-484"><a href="#cb135-484" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb135-485"><a href="#cb135-485" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb135-486"><a href="#cb135-486" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb135-487"><a href="#cb135-487" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup29)</span>
<span id="cb135-488"><a href="#cb135-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-489"><a href="#cb135-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-490"><a href="#cb135-490" aria-hidden="true" tabindex="-1"></a><span class="fu"># GLM analysis</span></span>
<span id="cb135-491"><a href="#cb135-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-492"><a href="#cb135-492" aria-hidden="true" tabindex="-1"></a>No filtering based on number of trips/fish per year yet, analysis of all available data.</span>
<span id="cb135-493"><a href="#cb135-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-494"><a href="#cb135-494" aria-hidden="true" tabindex="-1"></a>414 records removed due to not being measured in fork length:</span>
<span id="cb135-495"><a href="#cb135-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-496"><a href="#cb135-496" aria-hidden="true" tabindex="-1"></a>108 BY HAND; DIVING GEAR - total length</span>
<span id="cb135-497"><a href="#cb135-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-498"><a href="#cb135-498" aria-hidden="true" tabindex="-1"></a>11 POTS AND TRAPS; FISH - total/curved fork length</span>
<span id="cb135-499"><a href="#cb135-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-500"><a href="#cb135-500" aria-hidden="true" tabindex="-1"></a>81 SPEARS; DIVING - total length</span>
<span id="cb135-501"><a href="#cb135-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-502"><a href="#cb135-502" aria-hidden="true" tabindex="-1"></a>214 TRAMMEL NETS - total length</span>
<span id="cb135-503"><a href="#cb135-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-504"><a href="#cb135-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_hookandline_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb135-505"><a href="#cb135-505" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(length_data_final<span class="sc">$</span>gear) <span class="co"># "Hook and Line", "Trap", "Other", "Net"</span></span>
<span id="cb135-506"><a href="#cb135-506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-507"><a href="#cb135-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-508"><a href="#cb135-508" aria-hidden="true" tabindex="-1"></a><span class="fu">## All Gears</span></span>
<span id="cb135-509"><a href="#cb135-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-510"><a href="#cb135-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_allgear_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb135-511"><a href="#cb135-511" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-512"><a href="#cb135-512" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-513"><a href="#cb135-513" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-514"><a href="#cb135-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-515"><a href="#cb135-515" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb135-516"><a href="#cb135-516" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb135-517"><a href="#cb135-517" aria-hidden="true" tabindex="-1"></a>length_data_glm <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb135-518"><a href="#cb135-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb135-519"><a href="#cb135-519" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(gear == "Hook and Line") |&gt; </span></span>
<span id="cb135-520"><a href="#cb135-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb135-521"><a href="#cb135-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb135-522"><a href="#cb135-522" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb135-523"><a href="#cb135-523" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb135-524"><a href="#cb135-524" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(length_data_glm, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb135-525"><a href="#cb135-525" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb135-526"><a href="#cb135-526" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb135-527"><a href="#cb135-527" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb135-528"><a href="#cb135-528" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb135-529"><a href="#cb135-529" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(length_data_glm, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb135-530"><a href="#cb135-530" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-531"><a href="#cb135-531" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb135-532"><a href="#cb135-532" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb135-533"><a href="#cb135-533" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb135-534"><a href="#cb135-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-535"><a href="#cb135-535" aria-hidden="true" tabindex="-1"></a><span class="co">#table(length_data_glm$LAND_STANDARD_GEAR_NAME, length_data_glm$YEAR)</span></span>
<span id="cb135-536"><a href="#cb135-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-537"><a href="#cb135-537" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb135-538"><a href="#cb135-538" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb135-539"><a href="#cb135-539" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(length_data_glm, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb135-540"><a href="#cb135-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb135-541"><a href="#cb135-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb135-542"><a href="#cb135-542" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb135-543"><a href="#cb135-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb135-544"><a href="#cb135-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb135-545"><a href="#cb135-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb135-546"><a href="#cb135-546" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb135-547"><a href="#cb135-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb135-548"><a href="#cb135-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-549"><a href="#cb135-549" aria-hidden="true" tabindex="-1"></a><span class="co"># # run again but with only sig different gears</span></span>
<span id="cb135-550"><a href="#cb135-550" aria-hidden="true" tabindex="-1"></a><span class="co"># rodreelfishtraps &lt;- length_data_glm |&gt; </span></span>
<span id="cb135-551"><a href="#cb135-551" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(LAND_STANDARD_GEAR_NAME == c("LINES HAND", "POTS AND TRAPS; FISH", "ROD AND REEL"))</span></span>
<span id="cb135-552"><a href="#cb135-552" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-553"><a href="#cb135-553" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(rodreelfishtraps, aes(x = as.Date(FINAL_DATE), y = FL_CM)) +</span></span>
<span id="cb135-554"><a href="#cb135-554" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(colour = LAND_STANDARD_GEAR_NAME, shape = LAND_STANDARD_GEAR_NAME), size = 1, alpha = 0.5) +</span></span>
<span id="cb135-555"><a href="#cb135-555" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth(method = "lm", formula = "y ~ x", col = "black") +</span></span>
<span id="cb135-556"><a href="#cb135-556" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb135-557"><a href="#cb135-557" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "", y = "Length (cm)", colour = "", shape = "") +</span></span>
<span id="cb135-558"><a href="#cb135-558" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb135-559"><a href="#cb135-559" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = "bottom", legend.text = element_text(size = 10),</span></span>
<span id="cb135-560"><a href="#cb135-560" aria-hidden="true" tabindex="-1"></a><span class="co">#         legend.box.spacing = unit(0, "npc"), panel.grid = element_blank()) +</span></span>
<span id="cb135-561"><a href="#cb135-561" aria-hidden="true" tabindex="-1"></a><span class="co">#   guides(colour = guide_legend(override.aes = list(size = 2)))</span></span>
<span id="cb135-562"><a href="#cb135-562" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-563"><a href="#cb135-563" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot &lt;- ggdensity(rodreelfishtraps, x = "FL_CM",</span></span>
<span id="cb135-564"><a href="#cb135-564" aria-hidden="true" tabindex="-1"></a><span class="co">#                           add = "mean", rug = TRUE,</span></span>
<span id="cb135-565"><a href="#cb135-565" aria-hidden="true" tabindex="-1"></a><span class="co">#                           color = "LAND_STANDARD_GEAR_NAME", fill = "LAND_STANDARD_GEAR_NAME",</span></span>
<span id="cb135-566"><a href="#cb135-566" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ylab = "FL_CM", xlab = "Gear")</span></span>
<span id="cb135-567"><a href="#cb135-567" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot</span></span>
<span id="cb135-568"><a href="#cb135-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-569"><a href="#cb135-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-570"><a href="#cb135-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_allgear_analysis, fig.fullwidth}</span></span>
<span id="cb135-571"><a href="#cb135-571" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-572"><a href="#cb135-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-573"><a href="#cb135-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-574"><a href="#cb135-574" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb135-575"><a href="#cb135-575" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb135-576"><a href="#cb135-576" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb135-577"><a href="#cb135-577" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb135-578"><a href="#cb135-578" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb135-579"><a href="#cb135-579" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-580"><a href="#cb135-580" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb135-581"><a href="#cb135-581" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = length_data_glm, REML = FALSE)</span></span>
<span id="cb135-582"><a href="#cb135-582" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb135-583"><a href="#cb135-583" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-584"><a href="#cb135-584" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb135-585"><a href="#cb135-585" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb135-586"><a href="#cb135-586" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb135-587"><a href="#cb135-587" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb135-588"><a href="#cb135-588" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb135-589"><a href="#cb135-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-590"><a href="#cb135-590" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb135-591"><a href="#cb135-591" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-592"><a href="#cb135-592" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> length_data_glm, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-593"><a href="#cb135-593" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span>
<span id="cb135-594"><a href="#cb135-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-595"><a href="#cb135-595" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb135-596"><a href="#cb135-596" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-597"><a href="#cb135-597" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-598"><a href="#cb135-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-599"><a href="#cb135-599" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb135-600"><a href="#cb135-600" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb135-601"><a href="#cb135-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-602"><a href="#cb135-602" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb135-603"><a href="#cb135-603" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-604"><a href="#cb135-604" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-605"><a href="#cb135-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-606"><a href="#cb135-606" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-607"><a href="#cb135-607" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-608"><a href="#cb135-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-609"><a href="#cb135-609" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb135-610"><a href="#cb135-610" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb135-611"><a href="#cb135-611" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb135-612"><a href="#cb135-612" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb135-613"><a href="#cb135-613" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb135-614"><a href="#cb135-614" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb135-615"><a href="#cb135-615" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb135-616"><a href="#cb135-616" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb135-617"><a href="#cb135-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-618"><a href="#cb135-618" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb135-619"><a href="#cb135-619" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb135-620"><a href="#cb135-620" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb135-621"><a href="#cb135-621" aria-hidden="true" tabindex="-1"></a>mod_contr</span>
<span id="cb135-622"><a href="#cb135-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-623"><a href="#cb135-623" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb135-624"><a href="#cb135-624" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb135-625"><a href="#cb135-625" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb135-626"><a href="#cb135-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-627"><a href="#cb135-627" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld <span class="ot">&lt;-</span> multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb135-628"><a href="#cb135-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-629"><a href="#cb135-629" aria-hidden="true" tabindex="-1"></a>length_data_fishcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb135-630"><a href="#cb135-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb135-631"><a href="#cb135-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_fish =</span> <span class="fu">n</span>()) </span>
<span id="cb135-632"><a href="#cb135-632" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb135-633"><a href="#cb135-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb135-634"><a href="#cb135-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb135-635"><a href="#cb135-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-636"><a href="#cb135-636" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_fish <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld, length_data_fishcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb135-637"><a href="#cb135-637" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_trip <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_fish, length_data_tripcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb135-638"><a href="#cb135-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-639"><a href="#cb135-639" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_final <span class="ot">&lt;-</span> allgears_multcompcld_trip <span class="sc">|&gt;</span> </span>
<span id="cb135-640"><a href="#cb135-640" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="st">".group"</span>,</span>
<span id="cb135-641"><a href="#cb135-641" aria-hidden="true" tabindex="-1"></a>                <span class="st">"n_distinct_ID"</span> <span class="ot">=</span> <span class="st">"n_distinct(ID)"</span>)</span>
<span id="cb135-642"><a href="#cb135-642" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgears_multcompcld_final)</span>
<span id="cb135-643"><a href="#cb135-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-644"><a href="#cb135-644" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgears_multcompcld_final, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/stx_slps_glm_allgears.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-645"><a href="#cb135-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-646"><a href="#cb135-646" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>, <span class="st">"3"</span>))</span>
<span id="cb135-647"><a href="#cb135-647" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_fish[i]))</span></span>
<span id="cb135-648"><a href="#cb135-648" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-649"><a href="#cb135-649" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_distinct_ID[i]))</span></span>
<span id="cb135-650"><a href="#cb135-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-651"><a href="#cb135-651" aria-hidden="true" tabindex="-1"></a>allgear_glm_totals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb135-652"><a href="#cb135-652" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_distinct_ID =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_final<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_final<span class="sc">$</span>n_distinct_ID[i]))),</span>
<span id="cb135-653"><a href="#cb135-653" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_fish =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_final<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_final<span class="sc">$</span>n_fish[i]))))</span>
<span id="cb135-654"><a href="#cb135-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-655"><a href="#cb135-655" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgear_glm_totals)</span>
<span id="cb135-656"><a href="#cb135-656" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgear_glm_totals, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/stx_slps_glm_allgears_totals.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-657"><a href="#cb135-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-658"><a href="#cb135-658" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-659"><a href="#cb135-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-660"><a href="#cb135-660" aria-hidden="true" tabindex="-1"></a><span class="fu">## All Gears 2012 and after</span></span>
<span id="cb135-661"><a href="#cb135-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-662"><a href="#cb135-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_allgear2012_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb135-663"><a href="#cb135-663" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-664"><a href="#cb135-664" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-665"><a href="#cb135-665" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-666"><a href="#cb135-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-667"><a href="#cb135-667" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb135-668"><a href="#cb135-668" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb135-669"><a href="#cb135-669" aria-hidden="true" tabindex="-1"></a>length_data_glm_2012 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb135-670"><a href="#cb135-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(YEAR <span class="sc">&gt;=</span> <span class="dv">2012</span>) <span class="sc">|&gt;</span> </span>
<span id="cb135-671"><a href="#cb135-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb135-672"><a href="#cb135-672" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(gear == "Hook and Line") |&gt; </span></span>
<span id="cb135-673"><a href="#cb135-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb135-674"><a href="#cb135-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb135-675"><a href="#cb135-675" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb135-676"><a href="#cb135-676" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb135-677"><a href="#cb135-677" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(length_data_glm_2012, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb135-678"><a href="#cb135-678" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb135-679"><a href="#cb135-679" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb135-680"><a href="#cb135-680" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb135-681"><a href="#cb135-681" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb135-682"><a href="#cb135-682" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(length_data_glm_2012, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb135-683"><a href="#cb135-683" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-684"><a href="#cb135-684" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb135-685"><a href="#cb135-685" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb135-686"><a href="#cb135-686" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb135-687"><a href="#cb135-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-688"><a href="#cb135-688" aria-hidden="true" tabindex="-1"></a><span class="co">#table(length_data_glm$LAND_STANDARD_GEAR_NAME, length_data_glm$YEAR)</span></span>
<span id="cb135-689"><a href="#cb135-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-690"><a href="#cb135-690" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb135-691"><a href="#cb135-691" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb135-692"><a href="#cb135-692" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(length_data_glm_2012, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb135-693"><a href="#cb135-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb135-694"><a href="#cb135-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb135-695"><a href="#cb135-695" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb135-696"><a href="#cb135-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb135-697"><a href="#cb135-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb135-698"><a href="#cb135-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb135-699"><a href="#cb135-699" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb135-700"><a href="#cb135-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb135-701"><a href="#cb135-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-702"><a href="#cb135-702" aria-hidden="true" tabindex="-1"></a><span class="co"># # run again but with only sig different gears</span></span>
<span id="cb135-703"><a href="#cb135-703" aria-hidden="true" tabindex="-1"></a><span class="co"># rodreelfishtraps &lt;- length_data_glm |&gt; </span></span>
<span id="cb135-704"><a href="#cb135-704" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(LAND_STANDARD_GEAR_NAME == c("LINES HAND", "POTS AND TRAPS; FISH", "ROD AND REEL"))</span></span>
<span id="cb135-705"><a href="#cb135-705" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-706"><a href="#cb135-706" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(rodreelfishtraps, aes(x = as.Date(FINAL_DATE), y = FL_CM)) +</span></span>
<span id="cb135-707"><a href="#cb135-707" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(colour = LAND_STANDARD_GEAR_NAME, shape = LAND_STANDARD_GEAR_NAME), size = 1, alpha = 0.5) +</span></span>
<span id="cb135-708"><a href="#cb135-708" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth(method = "lm", formula = "y ~ x", col = "black") +</span></span>
<span id="cb135-709"><a href="#cb135-709" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb135-710"><a href="#cb135-710" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "", y = "Length (cm)", colour = "", shape = "") +</span></span>
<span id="cb135-711"><a href="#cb135-711" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb135-712"><a href="#cb135-712" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = "bottom", legend.text = element_text(size = 10),</span></span>
<span id="cb135-713"><a href="#cb135-713" aria-hidden="true" tabindex="-1"></a><span class="co">#         legend.box.spacing = unit(0, "npc"), panel.grid = element_blank()) +</span></span>
<span id="cb135-714"><a href="#cb135-714" aria-hidden="true" tabindex="-1"></a><span class="co">#   guides(colour = guide_legend(override.aes = list(size = 2)))</span></span>
<span id="cb135-715"><a href="#cb135-715" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-716"><a href="#cb135-716" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot &lt;- ggdensity(rodreelfishtraps, x = "FL_CM",</span></span>
<span id="cb135-717"><a href="#cb135-717" aria-hidden="true" tabindex="-1"></a><span class="co">#                           add = "mean", rug = TRUE,</span></span>
<span id="cb135-718"><a href="#cb135-718" aria-hidden="true" tabindex="-1"></a><span class="co">#                           color = "LAND_STANDARD_GEAR_NAME", fill = "LAND_STANDARD_GEAR_NAME",</span></span>
<span id="cb135-719"><a href="#cb135-719" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ylab = "FL_CM", xlab = "Gear")</span></span>
<span id="cb135-720"><a href="#cb135-720" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot</span></span>
<span id="cb135-721"><a href="#cb135-721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-722"><a href="#cb135-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-723"><a href="#cb135-723" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_allgear2012_analysis, fig.fullwidth}</span></span>
<span id="cb135-724"><a href="#cb135-724" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-725"><a href="#cb135-725" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-726"><a href="#cb135-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-727"><a href="#cb135-727" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb135-728"><a href="#cb135-728" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb135-729"><a href="#cb135-729" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb135-730"><a href="#cb135-730" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb135-731"><a href="#cb135-731" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb135-732"><a href="#cb135-732" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-733"><a href="#cb135-733" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb135-734"><a href="#cb135-734" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = length_data_glm, REML = FALSE)</span></span>
<span id="cb135-735"><a href="#cb135-735" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb135-736"><a href="#cb135-736" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-737"><a href="#cb135-737" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb135-738"><a href="#cb135-738" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb135-739"><a href="#cb135-739" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb135-740"><a href="#cb135-740" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb135-741"><a href="#cb135-741" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb135-742"><a href="#cb135-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-743"><a href="#cb135-743" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb135-744"><a href="#cb135-744" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-745"><a href="#cb135-745" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> length_data_glm_2012, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-746"><a href="#cb135-746" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span>
<span id="cb135-747"><a href="#cb135-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-748"><a href="#cb135-748" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb135-749"><a href="#cb135-749" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-750"><a href="#cb135-750" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-751"><a href="#cb135-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-752"><a href="#cb135-752" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb135-753"><a href="#cb135-753" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb135-754"><a href="#cb135-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-755"><a href="#cb135-755" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb135-756"><a href="#cb135-756" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-757"><a href="#cb135-757" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-758"><a href="#cb135-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-759"><a href="#cb135-759" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-760"><a href="#cb135-760" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-761"><a href="#cb135-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-762"><a href="#cb135-762" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb135-763"><a href="#cb135-763" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb135-764"><a href="#cb135-764" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb135-765"><a href="#cb135-765" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb135-766"><a href="#cb135-766" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb135-767"><a href="#cb135-767" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb135-768"><a href="#cb135-768" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb135-769"><a href="#cb135-769" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb135-770"><a href="#cb135-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-771"><a href="#cb135-771" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb135-772"><a href="#cb135-772" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb135-773"><a href="#cb135-773" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb135-774"><a href="#cb135-774" aria-hidden="true" tabindex="-1"></a>mod_contr</span>
<span id="cb135-775"><a href="#cb135-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-776"><a href="#cb135-776" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb135-777"><a href="#cb135-777" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb135-778"><a href="#cb135-778" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb135-779"><a href="#cb135-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-780"><a href="#cb135-780" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_2012 <span class="ot">&lt;-</span> multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb135-781"><a href="#cb135-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-782"><a href="#cb135-782" aria-hidden="true" tabindex="-1"></a>length_data_fishcount <span class="ot">&lt;-</span> length_data_glm_2012 <span class="sc">|&gt;</span> </span>
<span id="cb135-783"><a href="#cb135-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb135-784"><a href="#cb135-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_fish =</span> <span class="fu">n</span>()) </span>
<span id="cb135-785"><a href="#cb135-785" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_glm_2012 <span class="sc">|&gt;</span> </span>
<span id="cb135-786"><a href="#cb135-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb135-787"><a href="#cb135-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb135-788"><a href="#cb135-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-789"><a href="#cb135-789" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_fish_2012 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_2012, length_data_fishcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb135-790"><a href="#cb135-790" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_trip_2012 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_fish_2012, length_data_tripcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb135-791"><a href="#cb135-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-792"><a href="#cb135-792" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_finaL_2012 <span class="ot">&lt;-</span> allgears_multcompcld_trip_2012 <span class="sc">|&gt;</span> </span>
<span id="cb135-793"><a href="#cb135-793" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="st">".group"</span>,</span>
<span id="cb135-794"><a href="#cb135-794" aria-hidden="true" tabindex="-1"></a>                <span class="st">"n_distinct_ID"</span> <span class="ot">=</span> <span class="st">"n_distinct(ID)"</span>)</span>
<span id="cb135-795"><a href="#cb135-795" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgears_multcompcld_finaL_2012)</span>
<span id="cb135-796"><a href="#cb135-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-797"><a href="#cb135-797" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgears_multcompcld_finaL_2012, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/stx_slps_2012glm_allgears.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-798"><a href="#cb135-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-799"><a href="#cb135-799" aria-hidden="true" tabindex="-1"></a>group_2012 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>, <span class="st">"3"</span>))</span>
<span id="cb135-800"><a href="#cb135-800" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_fish[i]))</span></span>
<span id="cb135-801"><a href="#cb135-801" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-802"><a href="#cb135-802" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_distinct_ID[i]))</span></span>
<span id="cb135-803"><a href="#cb135-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-804"><a href="#cb135-804" aria-hidden="true" tabindex="-1"></a>allgear_glm_totals_2012 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb135-805"><a href="#cb135-805" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_distinct_ID =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group_2012<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_finaL_2012<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_finaL_2012<span class="sc">$</span>n_distinct_ID[i]))),</span>
<span id="cb135-806"><a href="#cb135-806" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_fish =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group_2012<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_finaL_2012<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_finaL_2012<span class="sc">$</span>n_fish[i]))))</span>
<span id="cb135-807"><a href="#cb135-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-808"><a href="#cb135-808" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgear_glm_totals_2012)</span>
<span id="cb135-809"><a href="#cb135-809" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgear_glm_totals_2012, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/stx_slps_2012glm_allgears_totals.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-810"><a href="#cb135-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-811"><a href="#cb135-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-812"><a href="#cb135-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-813"><a href="#cb135-813" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diving</span></span>
<span id="cb135-814"><a href="#cb135-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-815"><a href="#cb135-815" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_diving_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb135-816"><a href="#cb135-816" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-817"><a href="#cb135-817" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-818"><a href="#cb135-818" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-819"><a href="#cb135-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-820"><a href="#cb135-820" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb135-821"><a href="#cb135-821" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb135-822"><a href="#cb135-822" aria-hidden="true" tabindex="-1"></a>use_gear_dv <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb135-823"><a href="#cb135-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb135-824"><a href="#cb135-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear <span class="sc">==</span> <span class="st">"Diving"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb135-825"><a href="#cb135-825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb135-826"><a href="#cb135-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb135-827"><a href="#cb135-827" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb135-828"><a href="#cb135-828" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb135-829"><a href="#cb135-829" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(use_gear_dv, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb135-830"><a href="#cb135-830" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb135-831"><a href="#cb135-831" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb135-832"><a href="#cb135-832" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb135-833"><a href="#cb135-833" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb135-834"><a href="#cb135-834" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(use_gear_dv, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb135-835"><a href="#cb135-835" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-836"><a href="#cb135-836" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb135-837"><a href="#cb135-837" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb135-838"><a href="#cb135-838" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb135-839"><a href="#cb135-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-840"><a href="#cb135-840" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb135-841"><a href="#cb135-841" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb135-842"><a href="#cb135-842" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(use_gear_dv, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb135-843"><a href="#cb135-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb135-844"><a href="#cb135-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb135-845"><a href="#cb135-845" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb135-846"><a href="#cb135-846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb135-847"><a href="#cb135-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb135-848"><a href="#cb135-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb135-849"><a href="#cb135-849" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb135-850"><a href="#cb135-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb135-851"><a href="#cb135-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-852"><a href="#cb135-852" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-853"><a href="#cb135-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-854"><a href="#cb135-854" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_dv_analysis, fig.fullwidth}</span></span>
<span id="cb135-855"><a href="#cb135-855" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-856"><a href="#cb135-856" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page  </span></span>
<span id="cb135-857"><a href="#cb135-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-858"><a href="#cb135-858" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb135-859"><a href="#cb135-859" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb135-860"><a href="#cb135-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-861"><a href="#cb135-861" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb135-862"><a href="#cb135-862" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-863"><a href="#cb135-863" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_dv, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-864"><a href="#cb135-864" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span>
<span id="cb135-865"><a href="#cb135-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-866"><a href="#cb135-866" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb135-867"><a href="#cb135-867" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-868"><a href="#cb135-868" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_dv, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-869"><a href="#cb135-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-870"><a href="#cb135-870" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb135-871"><a href="#cb135-871" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb135-872"><a href="#cb135-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-873"><a href="#cb135-873" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb135-874"><a href="#cb135-874" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-875"><a href="#cb135-875" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_dv, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-876"><a href="#cb135-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-877"><a href="#cb135-877" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-878"><a href="#cb135-878" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_dv, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-879"><a href="#cb135-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-880"><a href="#cb135-880" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb135-881"><a href="#cb135-881" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb135-882"><a href="#cb135-882" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb135-883"><a href="#cb135-883" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line gear p value is significant </span></span>
<span id="cb135-884"><a href="#cb135-884" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb135-885"><a href="#cb135-885" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb135-886"><a href="#cb135-886" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line date p value is significant </span></span>
<span id="cb135-887"><a href="#cb135-887" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb135-888"><a href="#cb135-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-889"><a href="#cb135-889" aria-hidden="true" tabindex="-1"></a><span class="do">### no significant p values for time period or gears, further comparisons not needed </span></span>
<span id="cb135-890"><a href="#cb135-890" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-891"><a href="#cb135-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-892"><a href="#cb135-892" aria-hidden="true" tabindex="-1"></a><span class="fu">## Net - LAND_STANDARD_GEAR_NAME</span></span>
<span id="cb135-893"><a href="#cb135-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-894"><a href="#cb135-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_netstd_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb135-895"><a href="#cb135-895" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-896"><a href="#cb135-896" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-897"><a href="#cb135-897" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-898"><a href="#cb135-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-899"><a href="#cb135-899" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb135-900"><a href="#cb135-900" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb135-901"><a href="#cb135-901" aria-hidden="true" tabindex="-1"></a><span class="co"># net land_standard_gear_name</span></span>
<span id="cb135-902"><a href="#cb135-902" aria-hidden="true" tabindex="-1"></a>use_gear_nsg <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb135-903"><a href="#cb135-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb135-904"><a href="#cb135-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear <span class="sc">==</span> <span class="st">"Net"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb135-905"><a href="#cb135-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb135-906"><a href="#cb135-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb135-907"><a href="#cb135-907" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb135-908"><a href="#cb135-908" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb135-909"><a href="#cb135-909" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(use_gear_nsg, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb135-910"><a href="#cb135-910" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb135-911"><a href="#cb135-911" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb135-912"><a href="#cb135-912" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb135-913"><a href="#cb135-913" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb135-914"><a href="#cb135-914" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(use_gear_nsg, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb135-915"><a href="#cb135-915" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-916"><a href="#cb135-916" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb135-917"><a href="#cb135-917" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb135-918"><a href="#cb135-918" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb135-919"><a href="#cb135-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-920"><a href="#cb135-920" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb135-921"><a href="#cb135-921" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb135-922"><a href="#cb135-922" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(use_gear_nsg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb135-923"><a href="#cb135-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb135-924"><a href="#cb135-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb135-925"><a href="#cb135-925" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb135-926"><a href="#cb135-926" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb135-927"><a href="#cb135-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb135-928"><a href="#cb135-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb135-929"><a href="#cb135-929" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb135-930"><a href="#cb135-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb135-931"><a href="#cb135-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-932"><a href="#cb135-932" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-933"><a href="#cb135-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-934"><a href="#cb135-934" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_netstd_analysis}</span></span>
<span id="cb135-935"><a href="#cb135-935" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-936"><a href="#cb135-936" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-937"><a href="#cb135-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-938"><a href="#cb135-938" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb135-939"><a href="#cb135-939" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb135-940"><a href="#cb135-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-941"><a href="#cb135-941" aria-hidden="true" tabindex="-1"></a><span class="do">### both fixed linear and glm models have warning message because ENTANGLING NETS (GILL) UNSPECIFIED only occur in one year, preventing convergence across timeline </span></span>
<span id="cb135-942"><a href="#cb135-942" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb135-943"><a href="#cb135-943" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-944"><a href="#cb135-944" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_nsg, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-945"><a href="#cb135-945" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span>
<span id="cb135-946"><a href="#cb135-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-947"><a href="#cb135-947" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb135-948"><a href="#cb135-948" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-949"><a href="#cb135-949" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log)) </span>
<span id="cb135-950"><a href="#cb135-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-951"><a href="#cb135-951" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb135-952"><a href="#cb135-952" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb135-953"><a href="#cb135-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-954"><a href="#cb135-954" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb135-955"><a href="#cb135-955" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-956"><a href="#cb135-956" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-957"><a href="#cb135-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-958"><a href="#cb135-958" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-959"><a href="#cb135-959" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-960"><a href="#cb135-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-961"><a href="#cb135-961" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb135-962"><a href="#cb135-962" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb135-963"><a href="#cb135-963" aria-hidden="true" tabindex="-1"></a><span class="do">### net (using LAND_STANDARD_GEAR_NAME) does not have any significantly different gears </span></span>
<span id="cb135-964"><a href="#cb135-964" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3) </span>
<span id="cb135-965"><a href="#cb135-965" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope</span></span>
<span id="cb135-966"><a href="#cb135-966" aria-hidden="true" tabindex="-1"></a><span class="do">### There is no significantly different time in the Net grouping </span></span>
<span id="cb135-967"><a href="#cb135-967" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb135-968"><a href="#cb135-968" aria-hidden="true" tabindex="-1"></a><span class="do">### no significant p values for time period or gears, further comparisons not needed </span></span>
<span id="cb135-969"><a href="#cb135-969" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-970"><a href="#cb135-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-971"><a href="#cb135-971" aria-hidden="true" tabindex="-1"></a><span class="fu">## Net - LAND_GEAR_NAME</span></span>
<span id="cb135-972"><a href="#cb135-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-973"><a href="#cb135-973" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_net_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb135-974"><a href="#cb135-974" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-975"><a href="#cb135-975" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-976"><a href="#cb135-976" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-977"><a href="#cb135-977" aria-hidden="true" tabindex="-1"></a><span class="do">#### Net - LAND_GEAR_NAME</span></span>
<span id="cb135-978"><a href="#cb135-978" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb135-979"><a href="#cb135-979" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb135-980"><a href="#cb135-980" aria-hidden="true" tabindex="-1"></a><span class="co"># net land_standard_gear_name</span></span>
<span id="cb135-981"><a href="#cb135-981" aria-hidden="true" tabindex="-1"></a>use_gear_nlg <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb135-982"><a href="#cb135-982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_GEAR_NAME, gear) <span class="sc">|&gt;</span></span>
<span id="cb135-983"><a href="#cb135-983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear <span class="sc">==</span> <span class="st">"Net"</span>) <span class="sc">|&gt;</span></span>
<span id="cb135-984"><a href="#cb135-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span></span>
<span id="cb135-985"><a href="#cb135-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb135-986"><a href="#cb135-986" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb135-987"><a href="#cb135-987" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb135-988"><a href="#cb135-988" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(use_gear_nlg, <span class="at">x =</span> <span class="st">"LAND_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb135-989"><a href="#cb135-989" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_GEAR_NAME"</span>,</span>
<span id="cb135-990"><a href="#cb135-990" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_GEAR_NAME"</span>)</span>
<span id="cb135-991"><a href="#cb135-991" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb135-992"><a href="#cb135-992" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb135-993"><a href="#cb135-993" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(use_gear_nlg, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb135-994"><a href="#cb135-994" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-995"><a href="#cb135-995" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_GEAR_NAME"</span>,</span>
<span id="cb135-996"><a href="#cb135-996" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb135-997"><a href="#cb135-997" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb135-998"><a href="#cb135-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-999"><a href="#cb135-999" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb135-1000"><a href="#cb135-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb135-1001"><a href="#cb135-1001" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(use_gear_nlg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb135-1002"><a href="#cb135-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_GEAR_NAME, <span class="at">shape =</span> LAND_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb135-1003"><a href="#cb135-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb135-1004"><a href="#cb135-1004" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb135-1005"><a href="#cb135-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb135-1006"><a href="#cb135-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb135-1007"><a href="#cb135-1007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb135-1008"><a href="#cb135-1008" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb135-1009"><a href="#cb135-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb135-1010"><a href="#cb135-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1011"><a href="#cb135-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1012"><a href="#cb135-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1013"><a href="#cb135-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_net_analysis}</span></span>
<span id="cb135-1014"><a href="#cb135-1014" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1015"><a href="#cb135-1015" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1016"><a href="#cb135-1016" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1017"><a href="#cb135-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1018"><a href="#cb135-1018" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb135-1019"><a href="#cb135-1019" aria-hidden="true" tabindex="-1"></a><span class="co"># library(lmerTest)</span></span>
<span id="cb135-1020"><a href="#cb135-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1021"><a href="#cb135-1021" aria-hidden="true" tabindex="-1"></a><span class="do">### both fixed linear and glm models have warning message because ENTANGLING NETS (GILL) UNSPECIFIED only occur in one year, preventing convergence across timeline </span></span>
<span id="cb135-1022"><a href="#cb135-1022" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb135-1023"><a href="#cb135-1023" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-1024"><a href="#cb135-1024" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_nlg, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-1025"><a href="#cb135-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span>
<span id="cb135-1026"><a href="#cb135-1026" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1.1, correlation = FALSE)</span></span>
<span id="cb135-1027"><a href="#cb135-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1028"><a href="#cb135-1028" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb135-1029"><a href="#cb135-1029" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-1030"><a href="#cb135-1030" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-1031"><a href="#cb135-1031" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod2) #no p value given for gamma model by itself</span></span>
<span id="cb135-1032"><a href="#cb135-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1033"><a href="#cb135-1033" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model</span></span>
<span id="cb135-1034"><a href="#cb135-1034" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2)</span>
<span id="cb135-1035"><a href="#cb135-1035" aria-hidden="true" tabindex="-1"></a><span class="co"># glm is better fit</span></span>
<span id="cb135-1036"><a href="#cb135-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1037"><a href="#cb135-1037" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb135-1038"><a href="#cb135-1038" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-1039"><a href="#cb135-1039" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-1040"><a href="#cb135-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1041"><a href="#cb135-1041" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-1042"><a href="#cb135-1042" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-1043"><a href="#cb135-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1044"><a href="#cb135-1044" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model</span></span>
<span id="cb135-1045"><a href="#cb135-1045" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3) <span class="co">#gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb135-1046"><a href="#cb135-1046" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4) <span class="co">#gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope</span></span>
<span id="cb135-1047"><a href="#cb135-1047" aria-hidden="true" tabindex="-1"></a><span class="do">### no significant p values for time period or gears, further comparisons not needed</span></span>
<span id="cb135-1048"><a href="#cb135-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1049"><a href="#cb135-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1050"><a href="#cb135-1050" aria-hidden="true" tabindex="-1"></a><span class="fu">## Trap</span></span>
<span id="cb135-1051"><a href="#cb135-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1052"><a href="#cb135-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_trap_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb135-1053"><a href="#cb135-1053" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1054"><a href="#cb135-1054" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1055"><a href="#cb135-1055" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1056"><a href="#cb135-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1057"><a href="#cb135-1057" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb135-1058"><a href="#cb135-1058" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) </span>
<span id="cb135-1059"><a href="#cb135-1059" aria-hidden="true" tabindex="-1"></a><span class="co"># net land_standard_gear_name</span></span>
<span id="cb135-1060"><a href="#cb135-1060" aria-hidden="true" tabindex="-1"></a>use_gear_tr <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb135-1061"><a href="#cb135-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb135-1062"><a href="#cb135-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear <span class="sc">==</span> <span class="st">"Trap"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb135-1063"><a href="#cb135-1063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb135-1064"><a href="#cb135-1064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb135-1065"><a href="#cb135-1065" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb135-1066"><a href="#cb135-1066" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb135-1067"><a href="#cb135-1067" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(use_gear_tr, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb135-1068"><a href="#cb135-1068" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb135-1069"><a href="#cb135-1069" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb135-1070"><a href="#cb135-1070" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb135-1071"><a href="#cb135-1071" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb135-1072"><a href="#cb135-1072" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(use_gear_tr, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb135-1073"><a href="#cb135-1073" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1074"><a href="#cb135-1074" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb135-1075"><a href="#cb135-1075" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb135-1076"><a href="#cb135-1076" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb135-1077"><a href="#cb135-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1078"><a href="#cb135-1078" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb135-1079"><a href="#cb135-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb135-1080"><a href="#cb135-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(use_gear_tr, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb135-1081"><a href="#cb135-1081" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb135-1082"><a href="#cb135-1082" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb135-1083"><a href="#cb135-1083" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb135-1084"><a href="#cb135-1084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb135-1085"><a href="#cb135-1085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb135-1086"><a href="#cb135-1086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb135-1087"><a href="#cb135-1087" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb135-1088"><a href="#cb135-1088" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb135-1089"><a href="#cb135-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1090"><a href="#cb135-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1091"><a href="#cb135-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1092"><a href="#cb135-1092" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_trap_analysis}</span></span>
<span id="cb135-1093"><a href="#cb135-1093" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1094"><a href="#cb135-1094" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1095"><a href="#cb135-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1096"><a href="#cb135-1096" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb135-1097"><a href="#cb135-1097" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb135-1098"><a href="#cb135-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1099"><a href="#cb135-1099" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb135-1100"><a href="#cb135-1100" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-1101"><a href="#cb135-1101" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_tr, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-1102"><a href="#cb135-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span>
<span id="cb135-1103"><a href="#cb135-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1104"><a href="#cb135-1104" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb135-1105"><a href="#cb135-1105" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-1106"><a href="#cb135-1106" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-1107"><a href="#cb135-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1108"><a href="#cb135-1108" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb135-1109"><a href="#cb135-1109" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb135-1110"><a href="#cb135-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1111"><a href="#cb135-1111" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb135-1112"><a href="#cb135-1112" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-1113"><a href="#cb135-1113" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-1114"><a href="#cb135-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1115"><a href="#cb135-1115" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb135-1116"><a href="#cb135-1116" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb135-1117"><a href="#cb135-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1118"><a href="#cb135-1118" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb135-1119"><a href="#cb135-1119" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb135-1120"><a href="#cb135-1120" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb135-1121"><a href="#cb135-1121" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb135-1122"><a href="#cb135-1122" aria-hidden="true" tabindex="-1"></a><span class="do">### There is no significantly different time in the Trap grouping </span></span>
<span id="cb135-1123"><a href="#cb135-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb135-1124"><a href="#cb135-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1125"><a href="#cb135-1125" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb135-1126"><a href="#cb135-1126" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb135-1127"><a href="#cb135-1127" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb135-1128"><a href="#cb135-1128" aria-hidden="true" tabindex="-1"></a>mod_contr</span>
<span id="cb135-1129"><a href="#cb135-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1130"><a href="#cb135-1130" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb135-1131"><a href="#cb135-1131" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb135-1132"><a href="#cb135-1132" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb135-1133"><a href="#cb135-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1134"><a href="#cb135-1134" aria-hidden="true" tabindex="-1"></a><span class="co"># I took out box traps to confirm difference between fish trap and cmb traps and difference is still present </span></span>
<span id="cb135-1135"><a href="#cb135-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1136"><a href="#cb135-1136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1137"><a href="#cb135-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1138"><a href="#cb135-1138" aria-hidden="true" tabindex="-1"></a><span class="fu"># Gear Density Plots</span></span>
<span id="cb135-1139"><a href="#cb135-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1140"><a href="#cb135-1140" aria-hidden="true" tabindex="-1"></a>Filtered to years with 30 or more length records (regardless of gear) per year.</span>
<span id="cb135-1141"><a href="#cb135-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1142"><a href="#cb135-1142" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aggregated density plots</span></span>
<span id="cb135-1143"><a href="#cb135-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1144"><a href="#cb135-1144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r agg_pdf_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1145"><a href="#cb135-1145" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1146"><a href="#cb135-1146" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1147"><a href="#cb135-1147" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1148"><a href="#cb135-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1149"><a href="#cb135-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1150"><a href="#cb135-1150" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################</span></span>
<span id="cb135-1151"><a href="#cb135-1151" aria-hidden="true" tabindex="-1"></a><span class="co"># dscounts = VLg %&gt;% group_by(source) %&gt;% filter(n() &gt;= 30) %&gt;% ungroup %&gt;% </span></span>
<span id="cb135-1152"><a href="#cb135-1152" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(source) %&gt;%</span></span>
<span id="cb135-1153"><a href="#cb135-1153" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(source, " (n= ", scales::comma(n), ")" ))</span></span>
<span id="cb135-1154"><a href="#cb135-1154" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1155"><a href="#cb135-1155" aria-hidden="true" tabindex="-1"></a><span class="co"># dscc &lt;- scales::seq_gradient_pal("#22D463", "red", "Lab")(seq(0,1,length.out=dim(dscounts)[1]))</span></span>
<span id="cb135-1156"><a href="#cb135-1156" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1157"><a href="#cb135-1157" aria-hidden="true" tabindex="-1"></a><span class="co">#  VLg %&gt;% group_by(source) %&gt;% filter(n() &gt;= 30) %&gt;% ungroup %&gt;% </span></span>
<span id="cb135-1158"><a href="#cb135-1158" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(FL_CM))+</span></span>
<span id="cb135-1159"><a href="#cb135-1159" aria-hidden="true" tabindex="-1"></a><span class="co"># #  geom_density( aes(color = "Combined"))+</span></span>
<span id="cb135-1160"><a href="#cb135-1160" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_density(aes(color = source))+</span></span>
<span id="cb135-1161"><a href="#cb135-1161" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_manual(values = dscc, labels = c(dscounts$n_labels))+</span></span>
<span id="cb135-1162"><a href="#cb135-1162" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Vertical Line Data Sources", x = "Fork Length (cm)", title = paste0(region,  " VL \n (N = ", scales::comma(sum(dscounts$n)), ")"))+</span></span>
<span id="cb135-1163"><a href="#cb135-1163" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()+ guides(colour=guide_legend(ncol=1))</span></span>
<span id="cb135-1164"><a href="#cb135-1164" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb135-1165"><a href="#cb135-1165" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb135-1166"><a href="#cb135-1166" aria-hidden="true" tabindex="-1"></a><span class="co"># table(VLg$YEAR,VLg$source)</span></span>
<span id="cb135-1167"><a href="#cb135-1167" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################</span></span>
<span id="cb135-1168"><a href="#cb135-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1169"><a href="#cb135-1169" aria-hidden="true" tabindex="-1"></a><span class="do">#####################EDIT HERE ; NOT WORKING BELOW (I don't think)</span></span>
<span id="cb135-1170"><a href="#cb135-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1171"><a href="#cb135-1171" aria-hidden="true" tabindex="-1"></a>ycounts <span class="ot">=</span>length_data_final <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1172"><a href="#cb135-1172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(gear) <span class="sc">%&gt;%</span></span>
<span id="cb135-1173"><a href="#cb135-1173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(gear, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1174"><a href="#cb135-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1175"><a href="#cb135-1175" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1176"><a href="#cb135-1176" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM))<span class="sc">+</span></span>
<span id="cb135-1177"><a href="#cb135-1177" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_density( aes(color = "Combined"),lwd=1.5)+</span></span>
<span id="cb135-1178"><a href="#cb135-1178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> gear), <span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1179"><a href="#cb135-1179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>ycounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1180"><a href="#cb135-1180" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_hue(labels=c("Combined",ycounts$n_labels))+</span></span>
<span id="cb135-1181"><a href="#cb135-1181" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = gearcols, labels = c("Combined", counts$n_labels))+</span></span>
<span id="cb135-1182"><a href="#cb135-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(region,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1183"><a href="#cb135-1183" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1184"><a href="#cb135-1184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1185"><a href="#cb135-1185" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1186"><a href="#cb135-1186" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb135-1187"><a href="#cb135-1187" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb135-1188"><a href="#cb135-1188" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb135-1189"><a href="#cb135-1189" aria-hidden="true" tabindex="-1"></a><span class="co">#  filter to 30 or more of same gear each year </span></span>
<span id="cb135-1190"><a href="#cb135-1190" aria-hidden="true" tabindex="-1"></a><span class="co"># ygearcounts =length_data_final |&gt; </span></span>
<span id="cb135-1191"><a href="#cb135-1191" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(YEAR, LAND_STANDARD_GEAR_NAME) |&gt;</span></span>
<span id="cb135-1192"><a href="#cb135-1192" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(n() &gt;= 30)|&gt;</span></span>
<span id="cb135-1193"><a href="#cb135-1193" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb135-1194"><a href="#cb135-1194" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(gear) %&gt;%</span></span>
<span id="cb135-1195"><a href="#cb135-1195" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_gearlabels = paste0(gear, " (n= ", n, ")" ))</span></span>
<span id="cb135-1196"><a href="#cb135-1196" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1197"><a href="#cb135-1197" aria-hidden="true" tabindex="-1"></a><span class="co">#  length_data_final |&gt; </span></span>
<span id="cb135-1198"><a href="#cb135-1198" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(YEAR, LAND_STANDARD_GEAR_NAME) |&gt;</span></span>
<span id="cb135-1199"><a href="#cb135-1199" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(n() &gt;= 30)|&gt;</span></span>
<span id="cb135-1200"><a href="#cb135-1200" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb135-1201"><a href="#cb135-1201" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(FL_CM))+</span></span>
<span id="cb135-1202"><a href="#cb135-1202" aria-hidden="true" tabindex="-1"></a><span class="co">#  # geom_density( aes(color = "Combined"),lwd=1.5)+</span></span>
<span id="cb135-1203"><a href="#cb135-1203" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_density(aes(color = gear), size = 0.75)+</span></span>
<span id="cb135-1204"><a href="#cb135-1204" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_hue(labels=ygearcounts$n_gearlabels)+</span></span>
<span id="cb135-1205"><a href="#cb135-1205" aria-hidden="true" tabindex="-1"></a><span class="co">#  # scale_color_hue(labels=c("Combined",ycounts$n_labels))+</span></span>
<span id="cb135-1206"><a href="#cb135-1206" aria-hidden="true" tabindex="-1"></a><span class="co">#   #scale_color_manual(values = gearcols, labels = c("Combined", counts$n_labels))+</span></span>
<span id="cb135-1207"><a href="#cb135-1207" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Gear Type", x = "Fork Length (cm)", title = paste0(region,  "\n (N = ", sum(ygearcounts$n), ")"))+</span></span>
<span id="cb135-1208"><a href="#cb135-1208" aria-hidden="true" tabindex="-1"></a><span class="co">#   # theme_minimal()</span></span>
<span id="cb135-1209"><a href="#cb135-1209" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.title = element_text(size=14), </span></span>
<span id="cb135-1210"><a href="#cb135-1210" aria-hidden="true" tabindex="-1"></a><span class="co">#     legend.text = element_text(size=12))</span></span>
<span id="cb135-1211"><a href="#cb135-1211" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb135-1212"><a href="#cb135-1212" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb135-1213"><a href="#cb135-1213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1214"><a href="#cb135-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1215"><a href="#cb135-1215" aria-hidden="true" tabindex="-1"></a>USVI TIP length comps by gear and interview type. Investigate if MARFIN and MRAG interview types can be used or should be dropped?</span>
<span id="cb135-1216"><a href="#cb135-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1217"><a href="#cb135-1217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1218"><a href="#cb135-1218" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1219"><a href="#cb135-1219" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1220"><a href="#cb135-1220" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1221"><a href="#cb135-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1222"><a href="#cb135-1222" aria-hidden="true" tabindex="-1"></a><span class="co">#table(tip_CR$INT_TYPE,useNA='always')</span></span>
<span id="cb135-1223"><a href="#cb135-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1224"><a href="#cb135-1224" aria-hidden="true" tabindex="-1"></a>usvi <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>STATE<span class="sc">==</span><span class="st">'VIRGIN ISLANDS'</span>,]</span>
<span id="cb135-1225"><a href="#cb135-1225" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> usvi <span class="sc">%&gt;%</span></span>
<span id="cb135-1226"><a href="#cb135-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(INT_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb135-1227"><a href="#cb135-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(INT_TYPE, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1228"><a href="#cb135-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1229"><a href="#cb135-1229" aria-hidden="true" tabindex="-1"></a>  usvi <span class="sc">%&gt;%</span></span>
<span id="cb135-1230"><a href="#cb135-1230" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> INT_TYPE))<span class="sc">+</span></span>
<span id="cb135-1231"><a href="#cb135-1231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1232"><a href="#cb135-1232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1233"><a href="#cb135-1233" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1234"><a href="#cb135-1234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Interview Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(usvi<span class="sc">$</span>STATE,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1235"><a href="#cb135-1235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>gear) <span class="sc">+</span></span>
<span id="cb135-1236"><a href="#cb135-1236" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1237"><a href="#cb135-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1238"><a href="#cb135-1238" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1239"><a href="#cb135-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1240"><a href="#cb135-1240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1241"><a href="#cb135-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1242"><a href="#cb135-1242" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gear grouping investigation</span></span>
<span id="cb135-1243"><a href="#cb135-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1244"><a href="#cb135-1244" aria-hidden="true" tabindex="-1"></a>Filtered to minimum 30 fish per year</span>
<span id="cb135-1245"><a href="#cb135-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1246"><a href="#cb135-1246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1247"><a href="#cb135-1247" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1248"><a href="#cb135-1248" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1249"><a href="#cb135-1249" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1250"><a href="#cb135-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1251"><a href="#cb135-1251" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1252"><a href="#cb135-1252" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb135-1253"><a href="#cb135-1253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1254"><a href="#cb135-1254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>ycounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1255"><a href="#cb135-1255" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1256"><a href="#cb135-1256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1257"><a href="#cb135-1257" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1258"><a href="#cb135-1258" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1259"><a href="#cb135-1259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1260"><a href="#cb135-1260" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1261"><a href="#cb135-1261" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1262"><a href="#cb135-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1263"><a href="#cb135-1263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1264"><a href="#cb135-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1265"><a href="#cb135-1265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_dv_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1266"><a href="#cb135-1266" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1267"><a href="#cb135-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1268"><a href="#cb135-1268" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1269"><a href="#cb135-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1270"><a href="#cb135-1270" aria-hidden="true" tabindex="-1"></a>dv<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'DV'</span>,]</span>
<span id="cb135-1271"><a href="#cb135-1271" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> dv <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1272"><a href="#cb135-1272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1273"><a href="#cb135-1273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1274"><a href="#cb135-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1275"><a href="#cb135-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1276"><a href="#cb135-1276" aria-hidden="true" tabindex="-1"></a><span class="co"># dv_car &lt;-</span></span>
<span id="cb135-1277"><a href="#cb135-1277" aria-hidden="true" tabindex="-1"></a>dv <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1278"><a href="#cb135-1278" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb135-1279"><a href="#cb135-1279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1280"><a href="#cb135-1280" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1281"><a href="#cb135-1281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1282"><a href="#cb135-1282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1283"><a href="#cb135-1283" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1284"><a href="#cb135-1284" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1285"><a href="#cb135-1285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1286"><a href="#cb135-1286" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1287"><a href="#cb135-1287" aria-hidden="true" tabindex="-1"></a><span class="co"># dv_car</span></span>
<span id="cb135-1288"><a href="#cb135-1288" aria-hidden="true" tabindex="-1"></a><span class="co"># export_fig(dv_car)</span></span>
<span id="cb135-1289"><a href="#cb135-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1290"><a href="#cb135-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1291"><a href="#cb135-1291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1292"><a href="#cb135-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1293"><a href="#cb135-1293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_trap_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1294"><a href="#cb135-1294" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1295"><a href="#cb135-1295" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1296"><a href="#cb135-1296" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1297"><a href="#cb135-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1298"><a href="#cb135-1298" aria-hidden="true" tabindex="-1"></a>trap <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'TR'</span>,]</span>
<span id="cb135-1299"><a href="#cb135-1299" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> trap <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1300"><a href="#cb135-1300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1301"><a href="#cb135-1301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1302"><a href="#cb135-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1303"><a href="#cb135-1303" aria-hidden="true" tabindex="-1"></a>trap <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1304"><a href="#cb135-1304" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb135-1305"><a href="#cb135-1305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1306"><a href="#cb135-1306" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1307"><a href="#cb135-1307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1308"><a href="#cb135-1308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1309"><a href="#cb135-1309" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1310"><a href="#cb135-1310" aria-hidden="true" tabindex="-1"></a> <span class="co"># theme_minimal()</span></span>
<span id="cb135-1311"><a href="#cb135-1311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb135-1312"><a href="#cb135-1312" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1313"><a href="#cb135-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1314"><a href="#cb135-1314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1315"><a href="#cb135-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1316"><a href="#cb135-1316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_net_plot,fig.width=12, fig.height=8}</span></span>
<span id="cb135-1317"><a href="#cb135-1317" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1318"><a href="#cb135-1318" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1319"><a href="#cb135-1319" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1320"><a href="#cb135-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1321"><a href="#cb135-1321" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'NT'</span>,]</span>
<span id="cb135-1322"><a href="#cb135-1322" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> net <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1323"><a href="#cb135-1323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1324"><a href="#cb135-1324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1325"><a href="#cb135-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1326"><a href="#cb135-1326" aria-hidden="true" tabindex="-1"></a>net <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1327"><a href="#cb135-1327" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM,<span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb135-1328"><a href="#cb135-1328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1329"><a href="#cb135-1329" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1330"><a href="#cb135-1330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1331"><a href="#cb135-1331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1332"><a href="#cb135-1332" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1333"><a href="#cb135-1333" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1334"><a href="#cb135-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1335"><a href="#cb135-1335" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1336"><a href="#cb135-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1337"><a href="#cb135-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1338"><a href="#cb135-1338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1339"><a href="#cb135-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1340"><a href="#cb135-1340" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_net_LANDGEAR_plot,fig.width=12, fig.height=8}</span></span>
<span id="cb135-1341"><a href="#cb135-1341" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1342"><a href="#cb135-1342" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1343"><a href="#cb135-1343" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1344"><a href="#cb135-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1345"><a href="#cb135-1345" aria-hidden="true" tabindex="-1"></a>net_LANDGEAR <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'NT'</span>,]</span>
<span id="cb135-1346"><a href="#cb135-1346" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> net_LANDGEAR <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1347"><a href="#cb135-1347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1348"><a href="#cb135-1348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1349"><a href="#cb135-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1350"><a href="#cb135-1350" aria-hidden="true" tabindex="-1"></a>net_LANDGEAR <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1351"><a href="#cb135-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM,<span class="at">color =</span> LAND_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb135-1352"><a href="#cb135-1352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1353"><a href="#cb135-1353" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1354"><a href="#cb135-1354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1355"><a href="#cb135-1355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1356"><a href="#cb135-1356" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1357"><a href="#cb135-1357" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1358"><a href="#cb135-1358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1359"><a href="#cb135-1359" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1360"><a href="#cb135-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1361"><a href="#cb135-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1362"><a href="#cb135-1362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1363"><a href="#cb135-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1364"><a href="#cb135-1364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_other_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1365"><a href="#cb135-1365" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1366"><a href="#cb135-1366" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1367"><a href="#cb135-1367" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1368"><a href="#cb135-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1369"><a href="#cb135-1369" aria-hidden="true" tabindex="-1"></a>ot<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'OT'</span>,]</span>
<span id="cb135-1370"><a href="#cb135-1370" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> ot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1371"><a href="#cb135-1371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1372"><a href="#cb135-1372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1373"><a href="#cb135-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1374"><a href="#cb135-1374" aria-hidden="true" tabindex="-1"></a>ot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1375"><a href="#cb135-1375" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb135-1376"><a href="#cb135-1376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1377"><a href="#cb135-1377" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1378"><a href="#cb135-1378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1379"><a href="#cb135-1379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1380"><a href="#cb135-1380" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1381"><a href="#cb135-1381" aria-hidden="true" tabindex="-1"></a> <span class="co"># theme_minimal()</span></span>
<span id="cb135-1382"><a href="#cb135-1382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1383"><a href="#cb135-1383" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1384"><a href="#cb135-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1385"><a href="#cb135-1385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1386"><a href="#cb135-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1387"><a href="#cb135-1387" aria-hidden="true" tabindex="-1"></a><span class="fu">## Break at 2005</span></span>
<span id="cb135-1388"><a href="#cb135-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1389"><a href="#cb135-1389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_plot_2005, fig.width=15, fig.height=8}</span></span>
<span id="cb135-1390"><a href="#cb135-1390" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1391"><a href="#cb135-1391" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1392"><a href="#cb135-1392" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1393"><a href="#cb135-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1394"><a href="#cb135-1394" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> <span class="co"># filter(YEAR &gt; 2011) |&gt; </span></span>
<span id="cb135-1395"><a href="#cb135-1395" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb135-1396"><a href="#cb135-1396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1397"><a href="#cb135-1397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>ycounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1398"><a href="#cb135-1398" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1399"><a href="#cb135-1399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1400"><a href="#cb135-1400" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1401"><a href="#cb135-1401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb135-1402"><a href="#cb135-1402" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1403"><a href="#cb135-1403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1404"><a href="#cb135-1404" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1405"><a href="#cb135-1405" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1406"><a href="#cb135-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1407"><a href="#cb135-1407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1408"><a href="#cb135-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1409"><a href="#cb135-1409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_hookandline_plot_2005, fig.width=15, fig.height=8}</span></span>
<span id="cb135-1410"><a href="#cb135-1410" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1411"><a href="#cb135-1411" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1412"><a href="#cb135-1412" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1413"><a href="#cb135-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1414"><a href="#cb135-1414" aria-hidden="true" tabindex="-1"></a>DV <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'DV'</span>,]</span>
<span id="cb135-1415"><a href="#cb135-1415" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> DV <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1416"><a href="#cb135-1416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1417"><a href="#cb135-1417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1418"><a href="#cb135-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1419"><a href="#cb135-1419" aria-hidden="true" tabindex="-1"></a>DV <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1420"><a href="#cb135-1420" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb135-1421"><a href="#cb135-1421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1422"><a href="#cb135-1422" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1423"><a href="#cb135-1423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1424"><a href="#cb135-1424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1425"><a href="#cb135-1425" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1426"><a href="#cb135-1426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb135-1427"><a href="#cb135-1427" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1428"><a href="#cb135-1428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1429"><a href="#cb135-1429" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1430"><a href="#cb135-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1431"><a href="#cb135-1431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1432"><a href="#cb135-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1433"><a href="#cb135-1433" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_net_plot_2005, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1434"><a href="#cb135-1434" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1435"><a href="#cb135-1435" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1436"><a href="#cb135-1436" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1437"><a href="#cb135-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1438"><a href="#cb135-1438" aria-hidden="true" tabindex="-1"></a><span class="co">#nets might need to be another category because haul seines, trammel, and entangling (gill unsp) have too many occurances to be in other </span></span>
<span id="cb135-1439"><a href="#cb135-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1440"><a href="#cb135-1440" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'NT'</span>,]</span>
<span id="cb135-1441"><a href="#cb135-1441" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> net <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1442"><a href="#cb135-1442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1443"><a href="#cb135-1443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1444"><a href="#cb135-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1445"><a href="#cb135-1445" aria-hidden="true" tabindex="-1"></a>net <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1446"><a href="#cb135-1446" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM,<span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb135-1447"><a href="#cb135-1447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1448"><a href="#cb135-1448" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1449"><a href="#cb135-1449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1450"><a href="#cb135-1450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1451"><a href="#cb135-1451" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1452"><a href="#cb135-1452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb135-1453"><a href="#cb135-1453" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1454"><a href="#cb135-1454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1455"><a href="#cb135-1455" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1456"><a href="#cb135-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1457"><a href="#cb135-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1458"><a href="#cb135-1458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1459"><a href="#cb135-1459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1460"><a href="#cb135-1460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_trap_plot_2005, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1461"><a href="#cb135-1461" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1462"><a href="#cb135-1462" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1463"><a href="#cb135-1463" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1464"><a href="#cb135-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1465"><a href="#cb135-1465" aria-hidden="true" tabindex="-1"></a>trap <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'TR'</span>,]</span>
<span id="cb135-1466"><a href="#cb135-1466" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> trap <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1467"><a href="#cb135-1467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1468"><a href="#cb135-1468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1469"><a href="#cb135-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1470"><a href="#cb135-1470" aria-hidden="true" tabindex="-1"></a>trap <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1471"><a href="#cb135-1471" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM,<span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb135-1472"><a href="#cb135-1472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1473"><a href="#cb135-1473" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1474"><a href="#cb135-1474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1475"><a href="#cb135-1475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1476"><a href="#cb135-1476" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1477"><a href="#cb135-1477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb135-1478"><a href="#cb135-1478" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1479"><a href="#cb135-1479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1480"><a href="#cb135-1480" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1481"><a href="#cb135-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1482"><a href="#cb135-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1483"><a href="#cb135-1483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1484"><a href="#cb135-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1485"><a href="#cb135-1485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_other_plot_2005, fig.width=15, fig.height=8}</span></span>
<span id="cb135-1486"><a href="#cb135-1486" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1487"><a href="#cb135-1487" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1488"><a href="#cb135-1488" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1489"><a href="#cb135-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1490"><a href="#cb135-1490" aria-hidden="true" tabindex="-1"></a>ot<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'OT'</span>,]</span>
<span id="cb135-1491"><a href="#cb135-1491" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> ot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1492"><a href="#cb135-1492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1493"><a href="#cb135-1493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1494"><a href="#cb135-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1495"><a href="#cb135-1495" aria-hidden="true" tabindex="-1"></a>ot <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1496"><a href="#cb135-1496" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb135-1497"><a href="#cb135-1497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1498"><a href="#cb135-1498" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1499"><a href="#cb135-1499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1500"><a href="#cb135-1500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1501"><a href="#cb135-1501" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1502"><a href="#cb135-1502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb135-1503"><a href="#cb135-1503" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1504"><a href="#cb135-1504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1505"><a href="#cb135-1505" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1506"><a href="#cb135-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1507"><a href="#cb135-1507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1508"><a href="#cb135-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1509"><a href="#cb135-1509" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual Density plots</span></span>
<span id="cb135-1510"><a href="#cb135-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1511"><a href="#cb135-1511" aria-hidden="true" tabindex="-1"></a>This will be split by final gear aggregations once these are decided, removes "other" gear types.</span>
<span id="cb135-1512"><a href="#cb135-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1513"><a href="#cb135-1513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual_pdf_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1514"><a href="#cb135-1514" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1515"><a href="#cb135-1515" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1516"><a href="#cb135-1516" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1517"><a href="#cb135-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1518"><a href="#cb135-1518" aria-hidden="true" tabindex="-1"></a>fleet_final <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>fleet<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb135-1519"><a href="#cb135-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1520"><a href="#cb135-1520" aria-hidden="true" tabindex="-1"></a>fcounts <span class="ot">=</span> fleet_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1521"><a href="#cb135-1521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(gear) <span class="sc">%&gt;%</span></span>
<span id="cb135-1522"><a href="#cb135-1522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(gear, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1523"><a href="#cb135-1523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1524"><a href="#cb135-1524" aria-hidden="true" tabindex="-1"></a>all_car <span class="ot">&lt;-</span></span>
<span id="cb135-1525"><a href="#cb135-1525" aria-hidden="true" tabindex="-1"></a> fleet_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1526"><a href="#cb135-1526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb135-1527"><a href="#cb135-1527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_labs =</span> <span class="fu">paste0</span>(YEAR, <span class="st">"</span><span class="sc">\n</span><span class="st"> n = "</span>, <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb135-1528"><a href="#cb135-1528" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb135-1529"><a href="#cb135-1529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb135-1530"><a href="#cb135-1530" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1531"><a href="#cb135-1531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>fcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1532"><a href="#cb135-1532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(fcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1533"><a href="#cb135-1533" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>year_labs)<span class="sc">+</span></span>
<span id="cb135-1534"><a href="#cb135-1534" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1535"><a href="#cb135-1535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1536"><a href="#cb135-1536" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1537"><a href="#cb135-1537" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1538"><a href="#cb135-1538" aria-hidden="true" tabindex="-1"></a>all_car</span>
<span id="cb135-1539"><a href="#cb135-1539" aria-hidden="true" tabindex="-1"></a><span class="fu">export_fig_page</span>(all_car)</span>
<span id="cb135-1540"><a href="#cb135-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1541"><a href="#cb135-1541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1542"><a href="#cb135-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1543"><a href="#cb135-1543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r stx}</span></span>
<span id="cb135-1544"><a href="#cb135-1544" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1545"><a href="#cb135-1545" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1546"><a href="#cb135-1546" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1547"><a href="#cb135-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1548"><a href="#cb135-1548" aria-hidden="true" tabindex="-1"></a><span class="co"># table(length_data_final$ISLAND)</span></span>
<span id="cb135-1549"><a href="#cb135-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1550"><a href="#cb135-1550" aria-hidden="true" tabindex="-1"></a>SX <span class="ot">&lt;-</span> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb135-1551"><a href="#cb135-1551" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(ISLAND<span class="sc">==</span><span class="st">'ST CROIX'</span>)</span>
<span id="cb135-1552"><a href="#cb135-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1553"><a href="#cb135-1553" aria-hidden="true" tabindex="-1"></a>vessel_sx <span class="ot">&lt;-</span> <span class="fu">distinct</span>(SX, VESSEL_ID, LICENSE)  <span class="do">##multiple vessels per license commonly</span></span>
<span id="cb135-1554"><a href="#cb135-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1555"><a href="#cb135-1555" aria-hidden="true" tabindex="-1"></a>final_gears <span class="ot">&lt;-</span> <span class="fu">unique</span>(SX<span class="sc">$</span>gear_short)  <span class="do">##++this is where final length comps are generated ; could be aggregated above (e.g. via lookup table) &amp; should be 1 here </span></span>
<span id="cb135-1556"><a href="#cb135-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1557"><a href="#cb135-1557" aria-hidden="true" tabindex="-1"></a>SX_comps <span class="ot">&lt;-</span> <span class="fu">list</span>()  <span class="do">##++this creates an empty list for for loop</span></span>
<span id="cb135-1558"><a href="#cb135-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1559"><a href="#cb135-1559" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop generates binned length comps for each of the final gears. Stored in list. RUN:  View(comps[[1]]) to see in R</span></span>
<span id="cb135-1560"><a href="#cb135-1560" aria-hidden="true" tabindex="-1"></a><span class="co"># view(SX_comps[[1]])</span></span>
<span id="cb135-1561"><a href="#cb135-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1562"><a href="#cb135-1562" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(final_gears)){</span>
<span id="cb135-1563"><a href="#cb135-1563" aria-hidden="true" tabindex="-1"></a> SX_comps[[i]] <span class="ot">&lt;-</span>  SX <span class="sc">%&gt;%</span></span>
<span id="cb135-1564"><a href="#cb135-1564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear_short <span class="sc">==</span> final_gears[i]) <span class="sc">%&gt;%</span></span>
<span id="cb135-1565"><a href="#cb135-1565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb135-1566"><a href="#cb135-1566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ln_fish =</span> <span class="fu">n</span>(),</span>
<span id="cb135-1567"><a href="#cb135-1567" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_trips =</span> <span class="fu">length</span>(<span class="fu">unique</span>(ID)),</span>
<span id="cb135-1568"><a href="#cb135-1568" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_dealers=</span><span class="fu">length</span>(<span class="fu">unique</span>(DEALER_CODE)),</span>
<span id="cb135-1569"><a href="#cb135-1569" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_vessels=</span><span class="fu">length</span>(<span class="fu">unique</span>(VESSEL_ID))) <span class="sc">%&gt;%</span></span>
<span id="cb135-1570"><a href="#cb135-1570" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-1571"><a href="#cb135-1571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels, lbin)<span class="sc">%&gt;%</span></span>
<span id="cb135-1572"><a href="#cb135-1572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">unique</span>(ln_fish)) <span class="sc">%&gt;%</span></span>
<span id="cb135-1573"><a href="#cb135-1573" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-1574"><a href="#cb135-1574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels), </span>
<span id="cb135-1575"><a href="#cb135-1575" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> lbin, </span>
<span id="cb135-1576"><a href="#cb135-1576" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> freq, </span>
<span id="cb135-1577"><a href="#cb135-1577" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">freq =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb135-1578"><a href="#cb135-1578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(full_set) <span class="sc">%&gt;%</span></span>
<span id="cb135-1579"><a href="#cb135-1579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comp_names)<span class="sc">%&gt;%</span></span>
<span id="cb135-1580"><a href="#cb135-1580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-1581"><a href="#cb135-1581" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">flag_n  =</span> <span class="fu">ifelse</span>(ln_fish <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">0</span>, </span>
<span id="cb135-1582"><a href="#cb135-1582" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(ln_fish <span class="sc">&lt;</span> <span class="dv">15</span>, <span class="dv">2</span>, <span class="dv">1</span>)))</span>
<span id="cb135-1583"><a href="#cb135-1583" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb135-1584"><a href="#cb135-1584" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(SX_comps)[[i]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(final_gears[i], <span class="st">"_"</span>, bin_size, <span class="st">"cm"</span>) <span class="do">##++tabs are named here ; could add _nom here if desired (instead of _lfd and _lfdw in main file)</span></span>
<span id="cb135-1585"><a href="#cb135-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1586"><a href="#cb135-1586" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb135-1587"><a href="#cb135-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1588"><a href="#cb135-1588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1589"><a href="#cb135-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1590"><a href="#cb135-1590" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stacked bar charts</span></span>
<span id="cb135-1591"><a href="#cb135-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1592"><a href="#cb135-1592" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visual representation of gear distribution within groupings</span></span>
<span id="cb135-1593"><a href="#cb135-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1594"><a href="#cb135-1594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_plot, fig.width=10, fig.height=6}</span></span>
<span id="cb135-1595"><a href="#cb135-1595" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1596"><a href="#cb135-1596" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1597"><a href="#cb135-1597" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1598"><a href="#cb135-1598" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1599"><a href="#cb135-1599" aria-hidden="true" tabindex="-1"></a><span class="co"># counts =length_data_final %&gt;%</span></span>
<span id="cb135-1600"><a href="#cb135-1600" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(LAND_STANDARD_GEAR_NAME) %&gt;%</span></span>
<span id="cb135-1601"><a href="#cb135-1601" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(LAND_STANDARD_GEAR_NAME, " (n= ", n, ")" ))</span></span>
<span id="cb135-1602"><a href="#cb135-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1603"><a href="#cb135-1603" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb135-1604"><a href="#cb135-1604" aria-hidden="true" tabindex="-1"></a>  length_data_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb135-1605"><a href="#cb135-1605" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> LAND_STANDARD_GEAR_NAME, <span class="at">y =</span> FL_CM, <span class="at">x=</span> gear))<span class="sc">+</span></span>
<span id="cb135-1606"><a href="#cb135-1606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">stat=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb135-1607"><a href="#cb135-1607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1608"><a href="#cb135-1608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1609"><a href="#cb135-1609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb135-1610"><a href="#cb135-1610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))</span>
<span id="cb135-1611"><a href="#cb135-1611" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guides(color = guide_legend(override.aes = list(size = 0.5))) </span></span>
<span id="cb135-1612"><a href="#cb135-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1613"><a href="#cb135-1613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1614"><a href="#cb135-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1615"><a href="#cb135-1615" aria-hidden="true" tabindex="-1"></a><span class="fu"># Gear distribution across time by gear groupings</span></span>
<span id="cb135-1616"><a href="#cb135-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1617"><a href="#cb135-1617" aria-hidden="true" tabindex="-1"></a><span class="fu">## All gears over time</span></span>
<span id="cb135-1618"><a href="#cb135-1618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1619"><a href="#cb135-1619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=15, fig.height=8}</span></span>
<span id="cb135-1620"><a href="#cb135-1620" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1621"><a href="#cb135-1621" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Stoplight Parrotfish LAND_STANDARD_GEAR_NAME STX</span></span>
<span id="cb135-1622"><a href="#cb135-1622" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb135-1623"><a href="#cb135-1623" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1624"><a href="#cb135-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1625"><a href="#cb135-1625" aria-hidden="true" tabindex="-1"></a><span class="co"># create count of observed records by individual gear name</span></span>
<span id="cb135-1626"><a href="#cb135-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1627"><a href="#cb135-1627" aria-hidden="true" tabindex="-1"></a>stx_count <span class="ot">&lt;-</span> length_data_final <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb135-1628"><a href="#cb135-1628" aria-hidden="true" tabindex="-1"></a>   <span class="fu">add_count</span>(COUNTY) <span class="sc">%&gt;%</span></span>
<span id="cb135-1629"><a href="#cb135-1629" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">COUNTYn =</span> <span class="fu">paste0</span>(COUNTY, <span class="st">' ('</span>, n, <span class="st">')'</span>)) </span>
<span id="cb135-1630"><a href="#cb135-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1631"><a href="#cb135-1631" aria-hidden="true" tabindex="-1"></a>stx_gear_time <span class="ot">&lt;-</span> <span class="fu">subset</span>(stx_count, <span class="at">select =</span> <span class="sc">-</span>n) <span class="sc">%&gt;%</span> </span>
<span id="cb135-1632"><a href="#cb135-1632" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_count</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1633"><a href="#cb135-1633" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">LAND_STANDARD_GEAR_NAMEn =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">'('</span>, n, <span class="st">')'</span>)) </span>
<span id="cb135-1634"><a href="#cb135-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1635"><a href="#cb135-1635" aria-hidden="true" tabindex="-1"></a><span class="co"># plot    </span></span>
<span id="cb135-1636"><a href="#cb135-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1637"><a href="#cb135-1637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> stx_gear_time, <span class="fu">aes</span>(<span class="at">x =</span> FINAL_DATE, <span class="at">y =</span> LAND_STANDARD_GEAR_NAMEn , <span class="at">group =</span> COUNTY ,<span class="at">color =</span> COUNTYn )) <span class="sc">+</span> </span>
<span id="cb135-1638"><a href="#cb135-1638" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(COUNTY), <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb135-1639"><a href="#cb135-1639" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb135-1640"><a href="#cb135-1640" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"STANDARDGEARNAME_1 (# obs)"</span>, </span>
<span id="cb135-1641"><a href="#cb135-1641" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Area-time distribution of landed gear STTJ"</span>, </span>
<span id="cb135-1642"><a href="#cb135-1642" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"COUNTY (# obs)"</span>,</span>
<span id="cb135-1643"><a href="#cb135-1643" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"N = "</span>, <span class="fu">nrow</span>(stx_gear_time))) </span>
<span id="cb135-1644"><a href="#cb135-1644" aria-hidden="true" tabindex="-1"></a>    <span class="co"># theme(legend.position = "none")</span></span>
<span id="cb135-1645"><a href="#cb135-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1646"><a href="#cb135-1646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1647"><a href="#cb135-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1648"><a href="#cb135-1648" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diving Gear Distribution Over Time by Year</span></span>
<span id="cb135-1649"><a href="#cb135-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1650"><a href="#cb135-1650" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_dv_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1651"><a href="#cb135-1651" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1652"><a href="#cb135-1652" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1653"><a href="#cb135-1653" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1654"><a href="#cb135-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1655"><a href="#cb135-1655" aria-hidden="true" tabindex="-1"></a>dv2<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'DV'</span>,]</span>
<span id="cb135-1656"><a href="#cb135-1656" aria-hidden="true" tabindex="-1"></a>dv4<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(dv2<span class="sc">$</span>FL_CM, <span class="fu">list</span>(dv2<span class="sc">$</span>YEAR, dv2<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb135-1657"><a href="#cb135-1657" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dv4) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb135-1658"><a href="#cb135-1658" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> dv2 <span class="sc">%&gt;%</span></span>
<span id="cb135-1659"><a href="#cb135-1659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1660"><a href="#cb135-1660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1661"><a href="#cb135-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1662"><a href="#cb135-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1663"><a href="#cb135-1663" aria-hidden="true" tabindex="-1"></a>dv4 <span class="sc">%&gt;%</span></span>
<span id="cb135-1664"><a href="#cb135-1664" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb135-1665"><a href="#cb135-1665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb135-1666"><a href="#cb135-1666" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1667"><a href="#cb135-1667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1668"><a href="#cb135-1668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1669"><a href="#cb135-1669" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1670"><a href="#cb135-1670" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1671"><a href="#cb135-1671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1672"><a href="#cb135-1672" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1673"><a href="#cb135-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1674"><a href="#cb135-1674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1675"><a href="#cb135-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1676"><a href="#cb135-1676" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_hl_plot_range, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1677"><a href="#cb135-1677" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1678"><a href="#cb135-1678" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1679"><a href="#cb135-1679" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1680"><a href="#cb135-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1681"><a href="#cb135-1681" aria-hidden="true" tabindex="-1"></a><span class="co"># display yearly values of gears in same group on same graph</span></span>
<span id="cb135-1682"><a href="#cb135-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1683"><a href="#cb135-1683" aria-hidden="true" tabindex="-1"></a><span class="co"># summary_hl2 &lt;- hl2 %&gt;% </span></span>
<span id="cb135-1684"><a href="#cb135-1684" aria-hidden="true" tabindex="-1"></a><span class="co">#     group_by(YEAR) %&gt;% </span></span>
<span id="cb135-1685"><a href="#cb135-1685" aria-hidden="true" tabindex="-1"></a><span class="co">#     summarise(lower = min(FL_CM), upper = max(FL_CM), p = median(FL_CM))</span></span>
<span id="cb135-1686"><a href="#cb135-1686" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1687"><a href="#cb135-1687" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(data = summary_hl2, mapping = aes(x = YEAR, y = p)) +</span></span>
<span id="cb135-1688"><a href="#cb135-1688" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_pointrange(mapping = aes(ymin = lower, ymax = upper)) # doesn't separate by gear, can we do that? </span></span>
<span id="cb135-1689"><a href="#cb135-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1690"><a href="#cb135-1690" aria-hidden="true" tabindex="-1"></a><span class="do">## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).</span></span>
<span id="cb135-1691"><a href="#cb135-1691" aria-hidden="true" tabindex="-1"></a><span class="do">##   data: a data frame.</span></span>
<span id="cb135-1692"><a href="#cb135-1692" aria-hidden="true" tabindex="-1"></a><span class="do">##   measurevar: the name of a column that contains the variable to be summariezed</span></span>
<span id="cb135-1693"><a href="#cb135-1693" aria-hidden="true" tabindex="-1"></a><span class="do">##   groupvars: a vector containing names of columns that contain grouping variables</span></span>
<span id="cb135-1694"><a href="#cb135-1694" aria-hidden="true" tabindex="-1"></a><span class="do">##   na.rm: a boolean that indicates whether to ignore NA's</span></span>
<span id="cb135-1695"><a href="#cb135-1695" aria-hidden="true" tabindex="-1"></a><span class="do">##   conf.interval: the percent range of the confidence interval (default is 95%)</span></span>
<span id="cb135-1696"><a href="#cb135-1696" aria-hidden="true" tabindex="-1"></a><span class="co"># summarySE &lt;- function(data=hl2, measurevar, groupvars=c("gear", "YEAR"), na.rm=FALSE,</span></span>
<span id="cb135-1697"><a href="#cb135-1697" aria-hidden="true" tabindex="-1"></a><span class="co">#                       conf.interval=.95, .drop=TRUE) {</span></span>
<span id="cb135-1698"><a href="#cb135-1698" aria-hidden="true" tabindex="-1"></a><span class="co">#     library(plyr)</span></span>
<span id="cb135-1699"><a href="#cb135-1699" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1700"><a href="#cb135-1700" aria-hidden="true" tabindex="-1"></a><span class="co">#     # New version of length which can handle NA's: if na.rm==T, don't count them</span></span>
<span id="cb135-1701"><a href="#cb135-1701" aria-hidden="true" tabindex="-1"></a><span class="co">#     length2 &lt;- function (x, na.rm=FALSE) {</span></span>
<span id="cb135-1702"><a href="#cb135-1702" aria-hidden="true" tabindex="-1"></a><span class="co">#         if (na.rm) sum(!is.na(x))</span></span>
<span id="cb135-1703"><a href="#cb135-1703" aria-hidden="true" tabindex="-1"></a><span class="co">#         else       length(x)</span></span>
<span id="cb135-1704"><a href="#cb135-1704" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb135-1705"><a href="#cb135-1705" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1706"><a href="#cb135-1706" aria-hidden="true" tabindex="-1"></a><span class="co">#     # This does the summary. For each group's data frame, return a vector with</span></span>
<span id="cb135-1707"><a href="#cb135-1707" aria-hidden="true" tabindex="-1"></a><span class="co">#     # N, mean, and sd</span></span>
<span id="cb135-1708"><a href="#cb135-1708" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac &lt;- ddply(data, groupvars, .drop=.drop,</span></span>
<span id="cb135-1709"><a href="#cb135-1709" aria-hidden="true" tabindex="-1"></a><span class="co">#       .fun = function(xx, col) {</span></span>
<span id="cb135-1710"><a href="#cb135-1710" aria-hidden="true" tabindex="-1"></a><span class="co">#         c(N    = length2(xx[[col]], na.rm=na.rm),</span></span>
<span id="cb135-1711"><a href="#cb135-1711" aria-hidden="true" tabindex="-1"></a><span class="co">#           mean = mean   (xx[[col]], na.rm=na.rm),</span></span>
<span id="cb135-1712"><a href="#cb135-1712" aria-hidden="true" tabindex="-1"></a><span class="co">#           sd   = sd     (xx[[col]], na.rm=na.rm)</span></span>
<span id="cb135-1713"><a href="#cb135-1713" aria-hidden="true" tabindex="-1"></a><span class="co">#         )</span></span>
<span id="cb135-1714"><a href="#cb135-1714" aria-hidden="true" tabindex="-1"></a><span class="co">#       },</span></span>
<span id="cb135-1715"><a href="#cb135-1715" aria-hidden="true" tabindex="-1"></a><span class="co">#       measurevar</span></span>
<span id="cb135-1716"><a href="#cb135-1716" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb135-1717"><a href="#cb135-1717" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1718"><a href="#cb135-1718" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Rename the "mean" column    </span></span>
<span id="cb135-1719"><a href="#cb135-1719" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac &lt;- rename(datac, c("mean" = measurevar))</span></span>
<span id="cb135-1720"><a href="#cb135-1720" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1721"><a href="#cb135-1721" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac$se &lt;- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean</span></span>
<span id="cb135-1722"><a href="#cb135-1722" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1723"><a href="#cb135-1723" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Confidence interval multiplier for standard error</span></span>
<span id="cb135-1724"><a href="#cb135-1724" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Calculate t-statistic for confidence interval: </span></span>
<span id="cb135-1725"><a href="#cb135-1725" aria-hidden="true" tabindex="-1"></a><span class="co">#     # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1</span></span>
<span id="cb135-1726"><a href="#cb135-1726" aria-hidden="true" tabindex="-1"></a><span class="co">#     ciMult &lt;- qt(conf.interval/2 + .5, datac$N-1)</span></span>
<span id="cb135-1727"><a href="#cb135-1727" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac$ci &lt;- datac$se * ciMult</span></span>
<span id="cb135-1728"><a href="#cb135-1728" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1729"><a href="#cb135-1729" aria-hidden="true" tabindex="-1"></a><span class="co">#     return(datac)</span></span>
<span id="cb135-1730"><a href="#cb135-1730" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb135-1731"><a href="#cb135-1731" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1732"><a href="#cb135-1732" aria-hidden="true" tabindex="-1"></a><span class="co"># hl2sum &lt;- summarySE(data=hl2, measurevar="FL_CM", groupvars=c("gear","year"), na.rm=FALSE, conf.interval=.95)</span></span>
<span id="cb135-1733"><a href="#cb135-1733" aria-hidden="true" tabindex="-1"></a><span class="co"># hl2sum &lt;- summarySE(hl2, measurevar="FL_CM", groupvars=c("gear","year"))</span></span>
<span id="cb135-1734"><a href="#cb135-1734" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1735"><a href="#cb135-1735" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(hl2, aes(x=YEAR, y=FL_CM, colour=gear)) + </span></span>
<span id="cb135-1736"><a href="#cb135-1736" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_errorbar(aes(ymin=FL_CM-se, ymax=FL_CM+se), width=.1) +</span></span>
<span id="cb135-1737"><a href="#cb135-1737" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_line() +</span></span>
<span id="cb135-1738"><a href="#cb135-1738" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_point()</span></span>
<span id="cb135-1739"><a href="#cb135-1739" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-1740"><a href="#cb135-1740" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(hl2, aes(x=YEAR, y=FL_CM, colour=gear, group=gear)) + </span></span>
<span id="cb135-1741"><a href="#cb135-1741" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_errorbar(aes(ymin=FL_CM-se, ymax=FL_CM+se), colour="black", width=.1, position=pd) +</span></span>
<span id="cb135-1742"><a href="#cb135-1742" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_line(position=pd) +</span></span>
<span id="cb135-1743"><a href="#cb135-1743" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_point(position=pd, size=3, shape=21, fill="white") + # 21 is filled circle</span></span>
<span id="cb135-1744"><a href="#cb135-1744" aria-hidden="true" tabindex="-1"></a><span class="co">#     xlab("Year") +</span></span>
<span id="cb135-1745"><a href="#cb135-1745" aria-hidden="true" tabindex="-1"></a><span class="co">#     ylab("Fork Length (cm)") +</span></span>
<span id="cb135-1746"><a href="#cb135-1746" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_colour_hue(name="Gear type",    # Legend label, use darker colors</span></span>
<span id="cb135-1747"><a href="#cb135-1747" aria-hidden="true" tabindex="-1"></a><span class="co">#                      breaks=gear,</span></span>
<span id="cb135-1748"><a href="#cb135-1748" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels=gear,</span></span>
<span id="cb135-1749"><a href="#cb135-1749" aria-hidden="true" tabindex="-1"></a><span class="co">#                      l=40) +                    # Use darker colors, lightness=40</span></span>
<span id="cb135-1750"><a href="#cb135-1750" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggtitle("Average ") +</span></span>
<span id="cb135-1751"><a href="#cb135-1751" aria-hidden="true" tabindex="-1"></a><span class="co">#     expand_limits(y=0) +                        # Expand y range</span></span>
<span id="cb135-1752"><a href="#cb135-1752" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_y_continuous(breaks=0:20*4) +         # Set tick every 4</span></span>
<span id="cb135-1753"><a href="#cb135-1753" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme_bw() +</span></span>
<span id="cb135-1754"><a href="#cb135-1754" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(legend.justification=c(1,0),</span></span>
<span id="cb135-1755"><a href="#cb135-1755" aria-hidden="true" tabindex="-1"></a><span class="co">#           legend.position=c(1,0))               # Position legend in bottom right</span></span>
<span id="cb135-1756"><a href="#cb135-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1757"><a href="#cb135-1757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1758"><a href="#cb135-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1759"><a href="#cb135-1759" aria-hidden="true" tabindex="-1"></a><span class="fu">## Trap Gear Distribution Over Time by Year</span></span>
<span id="cb135-1760"><a href="#cb135-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1761"><a href="#cb135-1761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_tr_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1762"><a href="#cb135-1762" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1763"><a href="#cb135-1763" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1764"><a href="#cb135-1764" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1765"><a href="#cb135-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1766"><a href="#cb135-1766" aria-hidden="true" tabindex="-1"></a>trap <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'TR'</span>,]</span>
<span id="cb135-1767"><a href="#cb135-1767" aria-hidden="true" tabindex="-1"></a>trap2<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(trap<span class="sc">$</span>FL_CM, <span class="fu">list</span>(trap<span class="sc">$</span>YEAR, trap<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb135-1768"><a href="#cb135-1768" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(trap2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb135-1769"><a href="#cb135-1769" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> trap <span class="sc">%&gt;%</span></span>
<span id="cb135-1770"><a href="#cb135-1770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1771"><a href="#cb135-1771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1772"><a href="#cb135-1772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1773"><a href="#cb135-1773" aria-hidden="true" tabindex="-1"></a>trap2 <span class="sc">%&gt;%</span></span>
<span id="cb135-1774"><a href="#cb135-1774" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb135-1775"><a href="#cb135-1775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb135-1776"><a href="#cb135-1776" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1777"><a href="#cb135-1777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1778"><a href="#cb135-1778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1779"><a href="#cb135-1779" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1780"><a href="#cb135-1780" aria-hidden="true" tabindex="-1"></a> <span class="co"># theme_minimal()</span></span>
<span id="cb135-1781"><a href="#cb135-1781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1782"><a href="#cb135-1782" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1783"><a href="#cb135-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1784"><a href="#cb135-1784" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1785"><a href="#cb135-1785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1786"><a href="#cb135-1786" aria-hidden="true" tabindex="-1"></a><span class="fu">## Net Gear Distribution Over Time by Year</span></span>
<span id="cb135-1787"><a href="#cb135-1787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1788"><a href="#cb135-1788" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_net_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1789"><a href="#cb135-1789" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1790"><a href="#cb135-1790" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1791"><a href="#cb135-1791" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1792"><a href="#cb135-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1793"><a href="#cb135-1793" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'NT'</span>,]</span>
<span id="cb135-1794"><a href="#cb135-1794" aria-hidden="true" tabindex="-1"></a>net2<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(net<span class="sc">$</span>FL_CM, <span class="fu">list</span>(net<span class="sc">$</span>YEAR, net<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb135-1795"><a href="#cb135-1795" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(net2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb135-1796"><a href="#cb135-1796" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> net <span class="sc">%&gt;%</span></span>
<span id="cb135-1797"><a href="#cb135-1797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1798"><a href="#cb135-1798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1799"><a href="#cb135-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1800"><a href="#cb135-1800" aria-hidden="true" tabindex="-1"></a>net2 <span class="sc">%&gt;%</span></span>
<span id="cb135-1801"><a href="#cb135-1801" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb135-1802"><a href="#cb135-1802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb135-1803"><a href="#cb135-1803" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1804"><a href="#cb135-1804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1805"><a href="#cb135-1805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1806"><a href="#cb135-1806" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1807"><a href="#cb135-1807" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1808"><a href="#cb135-1808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1809"><a href="#cb135-1809" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1810"><a href="#cb135-1810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1811"><a href="#cb135-1811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1812"><a href="#cb135-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1813"><a href="#cb135-1813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1814"><a href="#cb135-1814" aria-hidden="true" tabindex="-1"></a><span class="fu">## Other Gear Distribution Over Time by Year</span></span>
<span id="cb135-1815"><a href="#cb135-1815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1816"><a href="#cb135-1816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_ot_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb135-1817"><a href="#cb135-1817" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1818"><a href="#cb135-1818" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1819"><a href="#cb135-1819" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb135-1820"><a href="#cb135-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1821"><a href="#cb135-1821" aria-hidden="true" tabindex="-1"></a>ot<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'OT'</span>,]</span>
<span id="cb135-1822"><a href="#cb135-1822" aria-hidden="true" tabindex="-1"></a>ot2<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(ot<span class="sc">$</span>FL_CM, <span class="fu">list</span>(ot<span class="sc">$</span>YEAR, ot<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb135-1823"><a href="#cb135-1823" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ot2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb135-1824"><a href="#cb135-1824" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> ot <span class="sc">%&gt;%</span></span>
<span id="cb135-1825"><a href="#cb135-1825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb135-1826"><a href="#cb135-1826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1827"><a href="#cb135-1827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1828"><a href="#cb135-1828" aria-hidden="true" tabindex="-1"></a>ot2 <span class="sc">%&gt;%</span></span>
<span id="cb135-1829"><a href="#cb135-1829" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb135-1830"><a href="#cb135-1830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb135-1831"><a href="#cb135-1831" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1832"><a href="#cb135-1832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1833"><a href="#cb135-1833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1834"><a href="#cb135-1834" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb135-1835"><a href="#cb135-1835" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb135-1836"><a href="#cb135-1836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb135-1837"><a href="#cb135-1837" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb135-1838"><a href="#cb135-1838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1839"><a href="#cb135-1839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1840"><a href="#cb135-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1841"><a href="#cb135-1841" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cummulative Density Plots</span></span>
<span id="cb135-1842"><a href="#cb135-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1843"><a href="#cb135-1843" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aggregated CDF</span></span>
<span id="cb135-1844"><a href="#cb135-1844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1845"><a href="#cb135-1845" aria-hidden="true" tabindex="-1"></a><span class="in">```{r agg_cdf_plot}</span></span>
<span id="cb135-1846"><a href="#cb135-1846" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1847"><a href="#cb135-1847" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1848"><a href="#cb135-1848" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1849"><a href="#cb135-1849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1850"><a href="#cb135-1850" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span>length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb135-1851"><a href="#cb135-1851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(gear) <span class="sc">%&gt;%</span></span>
<span id="cb135-1852"><a href="#cb135-1852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(gear, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1853"><a href="#cb135-1853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1854"><a href="#cb135-1854" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb135-1855"><a href="#cb135-1855" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1856"><a href="#cb135-1856" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb135-1857"><a href="#cb135-1857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()<span class="sc">+</span></span>
<span id="cb135-1858"><a href="#cb135-1858" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1859"><a href="#cb135-1859" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1860"><a href="#cb135-1860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1861"><a href="#cb135-1861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-1862"><a href="#cb135-1862" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1863"><a href="#cb135-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1864"><a href="#cb135-1864" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1865"><a href="#cb135-1865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1866"><a href="#cb135-1866" aria-hidden="true" tabindex="-1"></a><span class="fu">## Management periods\*</span></span>
<span id="cb135-1867"><a href="#cb135-1867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1868"><a href="#cb135-1868" aria-hidden="true" tabindex="-1"></a>**This section is optional and may be empty if there are not signifcant changes**</span>
<span id="cb135-1869"><a href="#cb135-1869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1870"><a href="#cb135-1870" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_cdf_plot, eval=!is.na(break_year)}</span></span>
<span id="cb135-1871"><a href="#cb135-1871" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1872"><a href="#cb135-1872" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1873"><a href="#cb135-1873" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1874"><a href="#cb135-1874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1875"><a href="#cb135-1875" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb135-1876"><a href="#cb135-1876" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1877"><a href="#cb135-1877" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb135-1878"><a href="#cb135-1878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()<span class="sc">+</span></span>
<span id="cb135-1879"><a href="#cb135-1879" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1880"><a href="#cb135-1880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1881"><a href="#cb135-1881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1882"><a href="#cb135-1882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb135-1883"><a href="#cb135-1883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-1884"><a href="#cb135-1884" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1885"><a href="#cb135-1885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1886"><a href="#cb135-1886" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1887"><a href="#cb135-1887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1888"><a href="#cb135-1888" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual CDF</span></span>
<span id="cb135-1889"><a href="#cb135-1889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1890"><a href="#cb135-1890" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual_cdf_plot, fig.height=9, fig.width=9}</span></span>
<span id="cb135-1891"><a href="#cb135-1891" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1892"><a href="#cb135-1892" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1893"><a href="#cb135-1893" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1894"><a href="#cb135-1894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1895"><a href="#cb135-1895" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span> </span>
<span id="cb135-1896"><a href="#cb135-1896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb135-1897"><a href="#cb135-1897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_labs =</span> <span class="fu">paste0</span>(YEAR, <span class="st">"</span><span class="sc">\n</span><span class="st"> n = "</span>, <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb135-1898"><a href="#cb135-1898" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1899"><a href="#cb135-1899" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb135-1900"><a href="#cb135-1900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()<span class="sc">+</span></span>
<span id="cb135-1901"><a href="#cb135-1901" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb135-1902"><a href="#cb135-1902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1903"><a href="#cb135-1903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1904"><a href="#cb135-1904" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>year_labs)<span class="sc">+</span></span>
<span id="cb135-1905"><a href="#cb135-1905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-1906"><a href="#cb135-1906" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1907"><a href="#cb135-1907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1908"><a href="#cb135-1908" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1909"><a href="#cb135-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1910"><a href="#cb135-1910" aria-hidden="true" tabindex="-1"></a><span class="fu"># Island Density Plots</span></span>
<span id="cb135-1911"><a href="#cb135-1911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1912"><a href="#cb135-1912" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aggregated density plots</span></span>
<span id="cb135-1913"><a href="#cb135-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1914"><a href="#cb135-1914" aria-hidden="true" tabindex="-1"></a><span class="in">```{r agg_pdf_plot_reg}</span></span>
<span id="cb135-1915"><a href="#cb135-1915" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1916"><a href="#cb135-1916" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1917"><a href="#cb135-1917" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1918"><a href="#cb135-1918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1919"><a href="#cb135-1919" aria-hidden="true" tabindex="-1"></a>srcounts <span class="ot">=</span>length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb135-1920"><a href="#cb135-1920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ISLAND) <span class="sc">%&gt;%</span></span>
<span id="cb135-1921"><a href="#cb135-1921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(ISLAND, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb135-1922"><a href="#cb135-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1923"><a href="#cb135-1923" aria-hidden="true" tabindex="-1"></a><span class="co">#srcounts &lt;- srcounts %&gt;% drop_na(SUBREGION)</span></span>
<span id="cb135-1924"><a href="#cb135-1924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1925"><a href="#cb135-1925" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb135-1926"><a href="#cb135-1926" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM))<span class="sc">+</span></span>
<span id="cb135-1927"><a href="#cb135-1927" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_density( aes(color = "Combined"))+</span></span>
<span id="cb135-1928"><a href="#cb135-1928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> ISLAND))<span class="sc">+</span></span>
<span id="cb135-1929"><a href="#cb135-1929" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = regcols, labels = c("Combined", srcounts$n_labels))+</span></span>
<span id="cb135-1930"><a href="#cb135-1930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>srcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1931"><a href="#cb135-1931" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Island"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(srcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1932"><a href="#cb135-1932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-1933"><a href="#cb135-1933" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1934"><a href="#cb135-1934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1935"><a href="#cb135-1935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1936"><a href="#cb135-1936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1937"><a href="#cb135-1937" aria-hidden="true" tabindex="-1"></a><span class="fu">## Management periods\*</span></span>
<span id="cb135-1938"><a href="#cb135-1938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1939"><a href="#cb135-1939" aria-hidden="true" tabindex="-1"></a>**This section is optional and may be empty if there are not significant changes**</span>
<span id="cb135-1940"><a href="#cb135-1940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1941"><a href="#cb135-1941" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_pdf_plot_reg, eval=!is.na(break_year)}</span></span>
<span id="cb135-1942"><a href="#cb135-1942" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1943"><a href="#cb135-1943" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1944"><a href="#cb135-1944" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1945"><a href="#cb135-1945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1946"><a href="#cb135-1946" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb135-1947"><a href="#cb135-1947" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1948"><a href="#cb135-1948" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> ISLAND))<span class="sc">+</span></span>
<span id="cb135-1949"><a href="#cb135-1949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()<span class="sc">+</span></span>
<span id="cb135-1950"><a href="#cb135-1950" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = regcols, labels = srcounts$n_labels)+</span></span>
<span id="cb135-1951"><a href="#cb135-1951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> srcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1952"><a href="#cb135-1952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Island"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(srcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1953"><a href="#cb135-1953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb135-1954"><a href="#cb135-1954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-1955"><a href="#cb135-1955" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1956"><a href="#cb135-1956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1957"><a href="#cb135-1957" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1958"><a href="#cb135-1958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1959"><a href="#cb135-1959" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual Density plots</span></span>
<span id="cb135-1960"><a href="#cb135-1960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1961"><a href="#cb135-1961" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual_pdf_plot_reg, fig.height=9, fig.width=9}</span></span>
<span id="cb135-1962"><a href="#cb135-1962" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1963"><a href="#cb135-1963" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1964"><a href="#cb135-1964" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1965"><a href="#cb135-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1966"><a href="#cb135-1966" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span> </span>
<span id="cb135-1967"><a href="#cb135-1967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb135-1968"><a href="#cb135-1968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_labs =</span> <span class="fu">paste0</span>(YEAR, <span class="st">"</span><span class="sc">\n</span><span class="st"> n = "</span>, <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb135-1969"><a href="#cb135-1969" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1970"><a href="#cb135-1970" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> ISLAND))<span class="sc">+</span></span>
<span id="cb135-1971"><a href="#cb135-1971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()<span class="sc">+</span></span>
<span id="cb135-1972"><a href="#cb135-1972" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = regcols, labels = srcounts$n_labels)+</span></span>
<span id="cb135-1973"><a href="#cb135-1973" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> srcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb135-1974"><a href="#cb135-1974" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Subregion"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(srcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb135-1975"><a href="#cb135-1975" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>year_labs)<span class="sc">+</span></span>
<span id="cb135-1976"><a href="#cb135-1976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb135-1977"><a href="#cb135-1977" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb135-1978"><a href="#cb135-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1979"><a href="#cb135-1979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb135-1980"><a href="#cb135-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1981"><a href="#cb135-1981" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb135-1982"><a href="#cb135-1982" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb135-1983"><a href="#cb135-1983" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb135-1984"><a href="#cb135-1984" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb135-1985"><a href="#cb135-1985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1986"><a href="#cb135-1986" aria-hidden="true" tabindex="-1"></a>final_gears <span class="ot">&lt;-</span> <span class="fu">unique</span>(length_data_final<span class="sc">$</span>gear_short)  <span class="do">##++this is where final length comps are generated ; could be aggregated above (e.g. via lookup table) &amp; should be 1 here </span></span>
<span id="cb135-1987"><a href="#cb135-1987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1988"><a href="#cb135-1988" aria-hidden="true" tabindex="-1"></a>comps <span class="ot">&lt;-</span> <span class="fu">list</span>()  <span class="do">##++this creates an empty list for for loop</span></span>
<span id="cb135-1989"><a href="#cb135-1989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1990"><a href="#cb135-1990" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop generates binned length comps for each of the final gears. Stored in list. RUN:  View(comps[[1]]) to see in R</span></span>
<span id="cb135-1991"><a href="#cb135-1991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-1992"><a href="#cb135-1992" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(final_gears)){</span>
<span id="cb135-1993"><a href="#cb135-1993" aria-hidden="true" tabindex="-1"></a> comps[[i]] <span class="ot">&lt;-</span>  length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb135-1994"><a href="#cb135-1994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear_short <span class="sc">==</span> final_gears[i]) <span class="sc">%&gt;%</span></span>
<span id="cb135-1995"><a href="#cb135-1995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb135-1996"><a href="#cb135-1996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ln_fish =</span> <span class="fu">n</span>(),</span>
<span id="cb135-1997"><a href="#cb135-1997" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_trips =</span> <span class="fu">length</span>(<span class="fu">unique</span>(ID)),</span>
<span id="cb135-1998"><a href="#cb135-1998" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_dealers=</span><span class="fu">length</span>(<span class="fu">unique</span>(DEALER_CODE)),</span>
<span id="cb135-1999"><a href="#cb135-1999" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_vessels=</span><span class="fu">length</span>(<span class="fu">unique</span>(VESSEL_ID))) <span class="sc">%&gt;%</span></span>
<span id="cb135-2000"><a href="#cb135-2000" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-2001"><a href="#cb135-2001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels, lbin)<span class="sc">%&gt;%</span></span>
<span id="cb135-2002"><a href="#cb135-2002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">unique</span>(ln_fish)) <span class="sc">%&gt;%</span></span>
<span id="cb135-2003"><a href="#cb135-2003" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-2004"><a href="#cb135-2004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels), </span>
<span id="cb135-2005"><a href="#cb135-2005" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> lbin, </span>
<span id="cb135-2006"><a href="#cb135-2006" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> freq, </span>
<span id="cb135-2007"><a href="#cb135-2007" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">freq =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb135-2008"><a href="#cb135-2008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(full_set) <span class="sc">%&gt;%</span></span>
<span id="cb135-2009"><a href="#cb135-2009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comp_names)<span class="sc">%&gt;%</span></span>
<span id="cb135-2010"><a href="#cb135-2010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-2011"><a href="#cb135-2011" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">flag_n  =</span> <span class="fu">ifelse</span>(ln_fish <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">0</span>, </span>
<span id="cb135-2012"><a href="#cb135-2012" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(ln_fish <span class="sc">&lt;</span> <span class="dv">15</span>, <span class="dv">2</span>, <span class="dv">1</span>)))</span>
<span id="cb135-2013"><a href="#cb135-2013" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb135-2014"><a href="#cb135-2014" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(comps)[[i]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(final_gears[i], <span class="st">"_"</span>, bin_size, <span class="st">"cm"</span>) <span class="do">##++tabs are named here ; could add _nom here if desired (instead of _lfd and _lfdw in main file)</span></span>
<span id="cb135-2015"><a href="#cb135-2015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-2016"><a href="#cb135-2016" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb135-2017"><a href="#cb135-2017" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb135-2018"><a href="#cb135-2018" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb135-2019"><a href="#cb135-2019" aria-hidden="true" tabindex="-1"></a><span class="co"># write.xlsx(comps, file = paste0("./outputs/", sp, "_com_lfd_", sprintf('%02d', min_year %% 100), sprintf('%02d', max_year %% 100), "_", gsub("-", "", Sys.Date()), ".xlsx"))</span></span>
<span id="cb135-2020"><a href="#cb135-2020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-2021"><a href="#cb135-2021" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>