<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Katherine Godwin">

<title>sttj_yt_sedar84_sizecomp_landstdgearname</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/clipboard/clipboard.min.js"></script>
<script src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/quarto.js"></script>
<script src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/popper.min.js"></script>
<script src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/anchor.min.js"></script>
<link href="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#yellowtail-snapper-sttj" id="toc-yellowtail-snapper-sttj" class="nav-link active" data-scroll-target="#yellowtail-snapper-sttj">Yellowtail Snapper STTJ</a>
  <ul>
  <li><a href="#control-settings-and-exploratory-frequency-tables" id="toc-control-settings-and-exploratory-frequency-tables" class="nav-link" data-scroll-target="#control-settings-and-exploratory-frequency-tables">Control Settings and Exploratory Frequency Tables</a>
  <ul class="collapse">
  <li><a href="#filter-to-commercial-samples" id="toc-filter-to-commercial-samples" class="nav-link" data-scroll-target="#filter-to-commercial-samples">Filter to Commercial samples</a></li>
  <li><a href="#extract-marfin-samples-look-at-island-distribution" id="toc-extract-marfin-samples-look-at-island-distribution" class="nav-link" data-scroll-target="#extract-marfin-samples-look-at-island-distribution">Extract marfin samples, look at island distribution</a></li>
  <li><a href="#add-gear-groupings-no-length-length-conversions-available" id="toc-add-gear-groupings-no-length-length-conversions-available" class="nav-link" data-scroll-target="#add-gear-groupings-no-length-length-conversions-available">Add gear groupings, NO length-length conversions available</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#filtration-level-investigation" id="toc-filtration-level-investigation" class="nav-link" data-scroll-target="#filtration-level-investigation">Filtration level investigation</a>
  <ul>
  <li><a href="#unique-trip-id-vs-gear-by-year-investigation" id="toc-unique-trip-id-vs-gear-by-year-investigation" class="nav-link" data-scroll-target="#unique-trip-id-vs-gear-by-year-investigation">Unique trip ID vs gear by year investigation</a>
  <ul class="collapse">
  <li><a href="#how-many-unique-trip-ids-per-year" id="toc-how-many-unique-trip-ids-per-year" class="nav-link" data-scroll-target="#how-many-unique-trip-ids-per-year">How many unique trip ID’s per year?</a></li>
  </ul></li>
  <li><a href="#unique-length-records-per-gear-per-year" id="toc-unique-length-records-per-gear-per-year" class="nav-link" data-scroll-target="#unique-length-records-per-gear-per-year">Unique length records per gear per year</a>
  <ul class="collapse">
  <li><a href="#how-many-length-records-per-gear-per-year" id="toc-how-many-length-records-per-gear-per-year" class="nav-link" data-scroll-target="#how-many-length-records-per-gear-per-year">How many length records per gear per year?</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#glm-analysis" id="toc-glm-analysis" class="nav-link" data-scroll-target="#glm-analysis">GLM analysis</a>
  <ul>
  <li><a href="#all-gears" id="toc-all-gears" class="nav-link" data-scroll-target="#all-gears">All Gears</a></li>
  <li><a href="#all-gears-2012-and-after" id="toc-all-gears-2012-and-after" class="nav-link" data-scroll-target="#all-gears-2012-and-after">All Gears 2012 and after</a></li>
  <li><a href="#hook-and-line" id="toc-hook-and-line" class="nav-link" data-scroll-target="#hook-and-line">Hook and Line</a></li>
  <li><a href="#net" id="toc-net" class="nav-link" data-scroll-target="#net">Net</a></li>
  <li><a href="#trap" id="toc-trap" class="nav-link" data-scroll-target="#trap">Trap</a></li>
  </ul></li>
  <li><a href="#gear-density-plots" id="toc-gear-density-plots" class="nav-link" data-scroll-target="#gear-density-plots">Gear Density Plots</a>
  <ul>
  <li><a href="#aggregated-density-plots" id="toc-aggregated-density-plots" class="nav-link" data-scroll-target="#aggregated-density-plots">Aggregated density plots</a></li>
  <li><a href="#gear-grouping-investigation" id="toc-gear-grouping-investigation" class="nav-link" data-scroll-target="#gear-grouping-investigation">Gear grouping investigation</a></li>
  <li><a href="#break-at-2005" id="toc-break-at-2005" class="nav-link" data-scroll-target="#break-at-2005">Break at 2005</a></li>
  <li><a href="#annual-density-plots" id="toc-annual-density-plots" class="nav-link" data-scroll-target="#annual-density-plots">Annual Density plots</a></li>
  </ul></li>
  <li><a href="#stacked-bar-charts" id="toc-stacked-bar-charts" class="nav-link" data-scroll-target="#stacked-bar-charts">Stacked bar charts</a>
  <ul>
  <li><a href="#visual-representation-of-gear-distribution-within-groupings" id="toc-visual-representation-of-gear-distribution-within-groupings" class="nav-link" data-scroll-target="#visual-representation-of-gear-distribution-within-groupings">Visual representation of gear distribution within groupings</a></li>
  </ul></li>
  <li><a href="#gear-distribution-across-time-by-gear-groupings" id="toc-gear-distribution-across-time-by-gear-groupings" class="nav-link" data-scroll-target="#gear-distribution-across-time-by-gear-groupings">Gear distribution across time by gear groupings</a>
  <ul>
  <li><a href="#all-gears-over-time" id="toc-all-gears-over-time" class="nav-link" data-scroll-target="#all-gears-over-time">All gears over time</a></li>
  <li><a href="#hook-and-line-gear-distribution-over-time-by-year" id="toc-hook-and-line-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#hook-and-line-gear-distribution-over-time-by-year">Hook and Line Gear Distribution Over Time by Year</a></li>
  <li><a href="#trap-gear-distribution-over-time-by-year" id="toc-trap-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#trap-gear-distribution-over-time-by-year">Trap Gear Distribution Over Time by Year</a></li>
  <li><a href="#diving-gear-distribution-over-time-by-year---no-gear-grouping" id="toc-diving-gear-distribution-over-time-by-year---no-gear-grouping" class="nav-link" data-scroll-target="#diving-gear-distribution-over-time-by-year---no-gear-grouping">Diving Gear Distribution Over Time by Year - NO GEAR GROUPING</a></li>
  <li><a href="#net-gear-distribution-over-time-by-year" id="toc-net-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#net-gear-distribution-over-time-by-year">Net Gear Distribution Over Time by Year</a></li>
  <li><a href="#spear-gear-distribution-over-time-by-year---no-grouping" id="toc-spear-gear-distribution-over-time-by-year---no-grouping" class="nav-link" data-scroll-target="#spear-gear-distribution-over-time-by-year---no-grouping">Spear Gear Distribution Over Time by Year - NO GROUPING</a></li>
  <li><a href="#other-gear-distribution-over-time-by-year" id="toc-other-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#other-gear-distribution-over-time-by-year">Other Gear Distribution Over Time by Year</a></li>
  </ul></li>
  <li><a href="#cummulative-density-plots" id="toc-cummulative-density-plots" class="nav-link" data-scroll-target="#cummulative-density-plots">Cummulative Density Plots</a>
  <ul>
  <li><a href="#aggregated-cdf" id="toc-aggregated-cdf" class="nav-link" data-scroll-target="#aggregated-cdf">Aggregated CDF</a></li>
  <li><a href="#management-periods" id="toc-management-periods" class="nav-link" data-scroll-target="#management-periods">Management periods*</a></li>
  <li><a href="#annual-cdf" id="toc-annual-cdf" class="nav-link" data-scroll-target="#annual-cdf">Annual CDF</a></li>
  </ul></li>
  <li><a href="#island-density-plots" id="toc-island-density-plots" class="nav-link" data-scroll-target="#island-density-plots">Island Density Plots</a>
  <ul>
  <li><a href="#aggregated-density-plots-1" id="toc-aggregated-density-plots-1" class="nav-link" data-scroll-target="#aggregated-density-plots-1">Aggregated density plots</a></li>
  <li><a href="#management-periods-1" id="toc-management-periods-1" class="nav-link" data-scroll-target="#management-periods-1">Management periods*</a></li>
  <li><a href="#annual-density-plots-1" id="toc-annual-density-plots-1" class="nav-link" data-scroll-target="#annual-density-plots-1">Annual Density plots</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">sttj_yt_sedar84_sizecomp_landstdgearname</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Katherine Godwin </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>This script will be expanding upon the length-comp script c1_nominal_len_comps.Rmd created by Molly Stevens.</p>
<section id="yellowtail-snapper-sttj" class="level1 page-columns page-full">
<h1>Yellowtail Snapper STTJ</h1>
<div class="cell column-page">

</div>
<section id="control-settings-and-exploratory-frequency-tables" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="control-settings-and-exploratory-frequency-tables">Control Settings and Exploratory Frequency Tables</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="st">"YTS"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>region <span class="ot">&lt;-</span> <span class="st">"PUERTO RICO - USVI"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>county <span class="ot">&lt;-</span> <span class="st">"ST THOMAS/ST JOHN"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>bin_size <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>len_type <span class="ot">&lt;-</span> <span class="st">"FORK LENGTH"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LENGTH_TYPE1, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    FORK LENGTH       NO LENGTH STANDARD LENGTH    TOTAL LENGTH            &lt;NA&gt; 
          19888              14              67              56               0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LENGTH_TYPE2, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 FORK LENGTH    NO LENGTH TOTAL LENGTH         &lt;NA&gt; 
           1        19948           76            0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(sttj_yt<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 166</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(sttj_yt<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 796</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tip_range  <span class="ot">&lt;-</span> sttj_yt[<span class="fu">with</span>(sttj_yt,<span class="fu">order</span>(<span class="sc">-</span>LENGTH1_MM)),]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tip_range<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 796 690 660 650 650 645 645 640 632 628 620 610 600 600 595 595 590 590 588
[20] 585 585 585 585 585 585</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tip_range2 <span class="ot">&lt;-</span> sttj_yt[<span class="fu">with</span>(sttj_yt,<span class="fu">order</span>(LENGTH1_MM)),]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>tip_range2<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 166 183 183 185 190 190 190 190 191 192 192 194 195 196 198 200 203 203 204
[20] 204 205 205 205 206 206</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">##range currently set to not drop any obs (centimeters)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>min_size <span class="ot">&lt;-</span> <span class="dv">14</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>max_size <span class="ot">&lt;-</span> <span class="dv">80</span>   </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(sttj_yt<span class="sc">$</span>YEAR,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1983"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>min_year <span class="ot">&lt;-</span> <span class="dv">1983</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>max_year <span class="ot">&lt;-</span> <span class="dv">2022</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>break_year <span class="ot">&lt;-</span> <span class="dv">2005</span> <span class="co"># this is an optional value to denote a change in management. inclusive on the upper bound. can be set to NA if not relevant.  2005 trap specifications were updated and many closures went into place</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  TABLES START HERE </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
YELLOWTAIL SNAPPER,OCYURUS CHR                           &lt;NA&gt; 
                         20025                              0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
         BY HAND; DIVING GEAR                      DIP NETS 
                            1                           109 
      ENCIRCLING NETS (PURSE)  ENTANGLING NETS (GILL) UNSPC 
                          363                            48 
             GILL NETS; OTHER                  GRABS; HOOKS 
                           20                             1 
                  HAUL SEINES                 HOOKS; SPONGE 
                          556                            38 
                   LINES HAND     LINES LONG SET WITH HOOKS 
                        15276                             4 
        LINES LONG; REEF FISH       LINES POWER TROLL OTHER 
                          109                           544 
                    NOT CODED      POTS AND TRAPS; BOX TRAP 
                           27                             6 
          POTS AND TRAPS; CMB          POTS AND TRAPS; FISH 
                           78                          2155 
POTS AND TRAPS; SPINY LOBSTER   REEL; ELECTRIC OR HYDRAULIC 
                           64                           139 
                 ROD AND REEL ROD AND REEL; ELECTRIC (HAND) 
                          361                           124 
                       SPEARS                SPEARS; DIVING 
                            1                             1 
                         &lt;NA&gt; 
                            0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, sttj_yt<span class="sc">$</span>STATE_LANDED, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                               
                                VIRGIN ISLANDS  &lt;NA&gt;
  BY HAND; DIVING GEAR                       1     0
  DIP NETS                                 109     0
  ENCIRCLING NETS (PURSE)                  363     0
  ENTANGLING NETS (GILL) UNSPC              48     0
  GILL NETS; OTHER                          20     0
  GRABS; HOOKS                               1     0
  HAUL SEINES                              556     0
  HOOKS; SPONGE                             38     0
  LINES HAND                             15276     0
  LINES LONG SET WITH HOOKS                  4     0
  LINES LONG; REEF FISH                    109     0
  LINES POWER TROLL OTHER                  544     0
  NOT CODED                                 27     0
  POTS AND TRAPS; BOX TRAP                   6     0
  POTS AND TRAPS; CMB                       78     0
  POTS AND TRAPS; FISH                    2155     0
  POTS AND TRAPS; SPINY LOBSTER             64     0
  REEL; ELECTRIC OR HYDRAULIC              139     0
  ROD AND REEL                             361     0
  ROD AND REEL; ELECTRIC (HAND)            124     0
  SPEARS                                     1     0
  SPEARS; DIVING                             1     0
  &lt;NA&gt;                                       0     0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>FISHING_MODE, sttj_yt<span class="sc">$</span>INT_TYPE, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             FISHERMAN SAMPLE UNKNOWN USVI MARFIN REEFFISH SAMPLING
  COMMERCIAL            13306      29                          5164
  &lt;NA&gt;                      0       0                             0
            
             USVI MRAG BYCATCH STUDY  &lt;NA&gt;
  COMMERCIAL                    1526     0
  &lt;NA&gt;                             0     0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># marfin &lt;- sttj_yt%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#             filter(INT_TYPE == "USVI MARFIN REEFFISH SAMPLING")</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>YEAR,sttj_yt<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       YELLOWTAIL SNAPPER,OCYURUS CHR &lt;NA&gt;
  1983                            162    0
  1984                            639    0
  1985                           1021    0
  1986                            144    0
  1987                             12    0
  1988                             70    0
  1991                              4    0
  1992                            284    0
  1993                            335    0
  1994                            175    0
  1995                            221    0
  1996                            188    0
  2002                             69    0
  2003                              3    0
  2004                              6    0
  2005                            358    0
  2006                           1168    0
  2008                              7    0
  2009                           1189    0
  2010                           2605    0
  2011                           1927    0
  2012                           1034    0
  2013                            221    0
  2014                             49    0
  2015                             17    0
  2016                            852    0
  2017                           1589    0
  2018                           1730    0
  2019                           2061    0
  2020                            173    0
  2021                            371    0
  2022                            516    0
  2023                            825    0
  &lt;NA&gt;                              0    0</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>COUNTY_LANDED,sttj_yt<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            VIRGIN ISLANDS  &lt;NA&gt;
  ST JOHN              109     0
  ST THOMAS          19916     0
  &lt;NA&gt;                   0     0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>YEAR,sttj_yt<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       VIRGIN ISLANDS &lt;NA&gt;
  1983            162    0
  1984            639    0
  1985           1021    0
  1986            144    0
  1987             12    0
  1988             70    0
  1991              4    0
  1992            284    0
  1993            335    0
  1994            175    0
  1995            221    0
  1996            188    0
  2002             69    0
  2003              3    0
  2004              6    0
  2005            358    0
  2006           1168    0
  2008              7    0
  2009           1189    0
  2010           2605    0
  2011           1927    0
  2012           1034    0
  2013            221    0
  2014             49    0
  2015             17    0
  2016            852    0
  2017           1589    0
  2018           1730    0
  2019           2061    0
  2020            173    0
  2021            371    0
  2022            516    0
  2023            825    0
  &lt;NA&gt;              0    0</code></pre>
</div>
</div>
<section id="filter-to-commercial-samples" class="level4">
<h4 class="anchored" data-anchor-id="filter-to-commercial-samples">Filter to Commercial samples</h4>
<p>Length composition after filtering to commercial records</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>           
            ST JOHN ST THOMAS  &lt;NA&gt;
  ST JOHN       109         0     0
  ST THOMAS       0     19902     0
  &lt;NA&gt;            0         0     0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      
       ST JOHN ST THOMAS &lt;NA&gt;
  1983       0       149    0
  1984      12       627    0
  1985       1      1020    0
  1986       0       144    0
  1987       0        12    0
  1988       0        70    0
  1991       0         4    0
  1992       0       284    0
  1993       0       335    0
  1994       0       175    0
  1995       0       221    0
  1996       0       188    0
  2002       0        69    0
  2003       0         3    0
  2004       0         6    0
  2005       0       358    0
  2006       0      1168    0
  2008       4         3    0
  2009      10      1178    0
  2010      58      2547    0
  2011      21      1906    0
  2012       0      1034    0
  2013       0       221    0
  2014       0        49    0
  2015       0        17    0
  2016       3       849    0
  2017       0      1589    0
  2018       0      1730    0
  2019       0      2061    0
  2020       0       173    0
  2021       0       371    0
  2022       0       516    0
  2023       0       825    0
  &lt;NA&gt;       0         0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    FORK LENGTH STANDARD LENGTH    TOTAL LENGTH            &lt;NA&gt; 
          19888              67              56               0 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
         BY HAND; DIVING GEAR                      DIP NETS 
                            1                           109 
      ENCIRCLING NETS (PURSE)  ENTANGLING NETS (GILL) UNSPC 
                          363                            48 
             GILL NETS; OTHER                  GRABS; HOOKS 
                           20                             1 
                  HAUL SEINES                 HOOKS; SPONGE 
                          556                            38 
                   LINES HAND     LINES LONG SET WITH HOOKS 
                        15276                             4 
        LINES LONG; REEF FISH       LINES POWER TROLL OTHER 
                          109                           544 
                    NOT CODED      POTS AND TRAPS; BOX TRAP 
                           27                             6 
          POTS AND TRAPS; CMB          POTS AND TRAPS; FISH 
                           78                          2155 
POTS AND TRAPS; SPINY LOBSTER   REEL; ELECTRIC OR HYDRAULIC 
                           64                           139 
                 ROD AND REEL ROD AND REEL; ELECTRIC (HAND) 
                          361                           124 
                       SPEARS                SPEARS; DIVING 
                            1                             1 
                         &lt;NA&gt; 
                            0 </code></pre>
</div>
</div>
</section>
<section id="extract-marfin-samples-look-at-island-distribution" class="level4">
<h4 class="anchored" data-anchor-id="extract-marfin-samples-look-at-island-distribution">Extract marfin samples, look at island distribution</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      
       ST JOHN ST THOMAS &lt;NA&gt;
  2008       4         3    0
  2009       9       861    0
  2010       9      1433    0
  2011      21      1833    0
  2012       0       991    0
  &lt;NA&gt;       0         0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                               
                                ST JOHN ST THOMAS &lt;NA&gt;
  LINES HAND                         21      4610    0
  NOT CODED                           0        13    0
  POTS AND TRAPS; CMB                10        28    0
  POTS AND TRAPS; FISH               12       460    0
  POTS AND TRAPS; SPINY LOBSTER       0         4    0
  ROD AND REEL                        0         6    0
  &lt;NA&gt;                                0         0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>, ,  = ST JOHN

                               
                                2008 2009 2010 2011 2012 &lt;NA&gt;
  LINES HAND                       0    0    0   21    0    0
  NOT CODED                        0    0    0    0    0    0
  POTS AND TRAPS; CMB              4    6    0    0    0    0
  POTS AND TRAPS; FISH             0    3    9    0    0    0
  POTS AND TRAPS; SPINY LOBSTER    0    0    0    0    0    0
  ROD AND REEL                     0    0    0    0    0    0
  &lt;NA&gt;                             0    0    0    0    0    0

, ,  = ST THOMAS

                               
                                2008 2009 2010 2011 2012 &lt;NA&gt;
  LINES HAND                       0  761 1309 1690  850    0
  NOT CODED                        0    0    0   13    0    0
  POTS AND TRAPS; CMB              0   21    6    1    0    0
  POTS AND TRAPS; FISH             3   79  118  125  135    0
  POTS AND TRAPS; SPINY LOBSTER    0    0    0    4    0    0
  ROD AND REEL                     0    0    0    0    6    0
  &lt;NA&gt;                             0    0    0    0    0    0

, ,  = NA

                               
                                2008 2009 2010 2011 2012 &lt;NA&gt;
  LINES HAND                       0    0    0    0    0    0
  NOT CODED                        0    0    0    0    0    0
  POTS AND TRAPS; CMB              0    0    0    0    0    0
  POTS AND TRAPS; FISH             0    0    0    0    0    0
  POTS AND TRAPS; SPINY LOBSTER    0    0    0    0    0    0
  ROD AND REEL                     0    0    0    0    0    0
  &lt;NA&gt;                             0    0    0    0    0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      
       FORK LENGTH STANDARD LENGTH TOTAL LENGTH &lt;NA&gt;
  1983         149               0            0    0
  1984         639               0            0    0
  1985        1021               0            0    0
  1986         144               0            0    0
  1987          12               0            0    0
  1988           4              66            0    0
  1991           4               0            0    0
  1992         283               1            0    0
  1993         335               0            0    0
  1994         175               0            0    0
  1995         221               0            0    0
  1996         188               0            0    0
  2002          69               0            0    0
  2003           3               0            0    0
  2004           6               0            0    0
  2005         358               0            0    0
  2006        1168               0            0    0
  2008           7               0            0    0
  2009        1188               0            0    0
  2010        2605               0            0    0
  2011        1927               0            0    0
  2012        1034               0            0    0
  2013         221               0            0    0
  2014          49               0            0    0
  2015          12               0            5    0
  2016         801               0           51    0
  2017        1589               0            0    0
  2018        1730               0            0    0
  2019        2061               0            0    0
  2020         173               0            0    0
  2021         371               0            0    0
  2022         516               0            0    0
  2023         825               0            0    0
  &lt;NA&gt;           0               0            0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>           
            VIRGIN ISLANDS
  ST JOHN              109
  ST THOMAS          19902</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                               
                                CAST NETS ENCIRCLING NETS (PURSE) HOOKS, SPONGE
  BY HAND; DIVING GEAR                  0                       0             0
  DIP NETS                              0                       0             0
  ENCIRCLING NETS (PURSE)               0                      30             0
  ENTANGLING NETS (GILL) UNSPC          0                       0             0
  GILL NETS; OTHER                      0                       0             0
  GRABS; HOOKS                          0                       0             0
  HAUL SEINES                           0                       0             0
  HOOKS; SPONGE                         0                       0             0
  LINES HAND                            0                       0             0
  LINES LONG SET WITH HOOKS             0                       0             0
  LINES LONG; REEF FISH                 0                       0             0
  LINES POWER TROLL OTHER               0                       0             0
  NOT CODED                             0                       0             0
  POTS AND TRAPS; BOX TRAP              0                       0             0
  POTS AND TRAPS; CMB                   0                       0             0
  POTS AND TRAPS; FISH                  0                      14            42
  POTS AND TRAPS; SPINY LOBSTER         0                       0             0
  REEL; ELECTRIC OR HYDRAULIC           0                       0             0
  ROD AND REEL                         15                       0             0
  ROD AND REEL; ELECTRIC (HAND)         0                       0             0
  SPEARS                                0                       0             0
  SPEARS; DIVING                        0                       0             0
                               
                                LINES HAND LINES LONG, REEF FISH
  BY HAND; DIVING GEAR                   0                     0
  DIP NETS                               0                     0
  ENCIRCLING NETS (PURSE)                0                     0
  ENTANGLING NETS (GILL) UNSPC           0                     0
  GILL NETS; OTHER                       0                     0
  GRABS; HOOKS                           0                     0
  HAUL SEINES                            0                     0
  HOOKS; SPONGE                          0                     0
  LINES HAND                           458                     8
  LINES LONG SET WITH HOOKS              0                     0
  LINES LONG; REEF FISH                  0                     1
  LINES POWER TROLL OTHER                0                     0
  NOT CODED                              0                     0
  POTS AND TRAPS; BOX TRAP               0                     0
  POTS AND TRAPS; CMB                    0                     0
  POTS AND TRAPS; FISH                  70                     8
  POTS AND TRAPS; SPINY LOBSTER          0                     0
  REEL; ELECTRIC OR HYDRAULIC            0                     0
  ROD AND REEL                          17                     0
  ROD AND REEL; ELECTRIC (HAND)          0                     0
  SPEARS                                 0                     0
  SPEARS; DIVING                         0                     0
                               
                                LINES POWER TROLL OTHER NOT CODED
  BY HAND; DIVING GEAR                                0         0
  DIP NETS                                            0         0
  ENCIRCLING NETS (PURSE)                             0         0
  ENTANGLING NETS (GILL) UNSPC                        0         0
  GILL NETS; OTHER                                    0         0
  GRABS; HOOKS                                        0         0
  HAUL SEINES                                         0         0
  HOOKS; SPONGE                                       0         0
  LINES HAND                                          0         0
  LINES LONG SET WITH HOOKS                           0         0
  LINES LONG; REEF FISH                               0         0
  LINES POWER TROLL OTHER                           192         0
  NOT CODED                                           0        13
  POTS AND TRAPS; BOX TRAP                            0         0
  POTS AND TRAPS; CMB                                 0         0
  POTS AND TRAPS; FISH                               73         0
  POTS AND TRAPS; SPINY LOBSTER                       0         0
  REEL; ELECTRIC OR HYDRAULIC                         0         0
  ROD AND REEL                                        0         0
  ROD AND REEL; ELECTRIC (HAND)                       0         0
  SPEARS                                              0         0
  SPEARS; DIVING                                      0         0
                               
                                POTS AND TRAPS, FISH
  BY HAND; DIVING GEAR                             0
  DIP NETS                                         0
  ENCIRCLING NETS (PURSE)                          0
  ENTANGLING NETS (GILL) UNSPC                     0
  GILL NETS; OTHER                                 0
  GRABS; HOOKS                                     0
  HAUL SEINES                                      0
  HOOKS; SPONGE                                    0
  LINES HAND                                      26
  LINES LONG SET WITH HOOKS                        0
  LINES LONG; REEF FISH                            0
  LINES POWER TROLL OTHER                          0
  NOT CODED                                        0
  POTS AND TRAPS; BOX TRAP                         0
  POTS AND TRAPS; CMB                              6
  POTS AND TRAPS; FISH                           110
  POTS AND TRAPS; SPINY LOBSTER                    0
  REEL; ELECTRIC OR HYDRAULIC                      0
  ROD AND REEL                                     0
  ROD AND REEL; ELECTRIC (HAND)                    0
  SPEARS                                           0
  SPEARS; DIVING                                   0
                               
                                POTS AND TRAPS, SPINY LOBSTER
  BY HAND; DIVING GEAR                                      0
  DIP NETS                                                  0
  ENCIRCLING NETS (PURSE)                                   0
  ENTANGLING NETS (GILL) UNSPC                              0
  GILL NETS; OTHER                                          0
  GRABS; HOOKS                                              0
  HAUL SEINES                                               0
  HOOKS; SPONGE                                             0
  LINES HAND                                                0
  LINES LONG SET WITH HOOKS                                 0
  LINES LONG; REEF FISH                                     0
  LINES POWER TROLL OTHER                                   0
  NOT CODED                                                 0
  POTS AND TRAPS; BOX TRAP                                  0
  POTS AND TRAPS; CMB                                       7
  POTS AND TRAPS; FISH                                     66
  POTS AND TRAPS; SPINY LOBSTER                            19
  REEL; ELECTRIC OR HYDRAULIC                               0
  ROD AND REEL                                              0
  ROD AND REEL; ELECTRIC (HAND)                             0
  SPEARS                                                    0
  SPEARS; DIVING                                            0
                               
                                REEL, ELECTRIC OR HYDRAULIC ROD AND REEL
  BY HAND; DIVING GEAR                                    0            0
  DIP NETS                                                0            0
  ENCIRCLING NETS (PURSE)                                 0            0
  ENTANGLING NETS (GILL) UNSPC                            0            0
  GILL NETS; OTHER                                        0            0
  GRABS; HOOKS                                            0            0
  HAUL SEINES                                             0            0
  HOOKS; SPONGE                                           0            0
  LINES HAND                                              0            5
  LINES LONG SET WITH HOOKS                               0            0
  LINES LONG; REEF FISH                                   0            0
  LINES POWER TROLL OTHER                                 0            0
  NOT CODED                                               0            0
  POTS AND TRAPS; BOX TRAP                                0            0
  POTS AND TRAPS; CMB                                     0            0
  POTS AND TRAPS; FISH                                    1            0
  POTS AND TRAPS; SPINY LOBSTER                           0            0
  REEL; ELECTRIC OR HYDRAULIC                             0            0
  ROD AND REEL                                            0            2
  ROD AND REEL; ELECTRIC (HAND)                           0            0
  SPEARS                                                  0            0
  SPEARS; DIVING                                          0            0</code></pre>
</div>
</div>
</section>
<section id="add-gear-groupings-no-length-length-conversions-available" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="add-gear-groupings-no-length-length-conversions-available">Add gear groupings, NO length-length conversions available</h4>
<div class="cell column-page">
<div class="cell-output cell-output-stdout">
<pre><code>                               
                                Hook and Line   Net Other  Trap  &lt;NA&gt;
  BY HAND; DIVING GEAR                      0     0     1     0     0
  DIP NETS                                  0     0   109     0     0
  ENCIRCLING NETS (PURSE)                   0   363     0     0     0
  ENTANGLING NETS (GILL) UNSPC              0    48     0     0     0
  GILL NETS; OTHER                          0    20     0     0     0
  GRABS; HOOKS                              0     0     1     0     0
  HAUL SEINES                               0   556     0     0     0
  HOOKS; SPONGE                             0     0    38     0     0
  LINES HAND                            15276     0     0     0     0
  LINES LONG SET WITH HOOKS                 0     0     4     0     0
  LINES LONG; REEF FISH                     0     0   109     0     0
  LINES POWER TROLL OTHER                 544     0     0     0     0
  NOT CODED                                 0     0    20     0     0
  POTS AND TRAPS; BOX TRAP                  0     0     0     6     0
  POTS AND TRAPS; CMB                       0     0     0    78     0
  POTS AND TRAPS; FISH                      0     0     0  2148     0
  POTS AND TRAPS; SPINY LOBSTER             0     0     0    64     0
  REEL; ELECTRIC OR HYDRAULIC             139     0     0     0     0
  ROD AND REEL                            361     0     0     0     0
  ROD AND REEL; ELECTRIC (HAND)           124     0     0     0     0
  SPEARS                                    0     0     1     0     0
  SPEARS; DIVING                            0     0     1     0     0
  &lt;NA&gt;                                      0     0     0     0     0</code></pre>
</div>
</div>
<div class="cell column-page">

</div>
</section>
</section>
</section>
<section id="filtration-level-investigation" class="level1">
<h1>Filtration level investigation</h1>
<section id="unique-trip-id-vs-gear-by-year-investigation" class="level2">
<h2 class="anchored" data-anchor-id="unique-trip-id-vs-gear-by-year-investigation">Unique trip ID vs gear by year investigation</h2>
<section id="how-many-unique-trip-ids-per-year" class="level4">
<h4 class="anchored" data-anchor-id="how-many-unique-trip-ids-per-year">How many unique trip ID’s per year?</h4>
<p>Group by year, count unique trip id’s</p>
<p>When we remove data from years with less than 10 unique trip ID’s, we are left with 24 years of data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_tripcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR n_distinct(ID)
1  1983              8
2  1984             71
3  1985             70
4  1986             16
5  1987              7
6  1988              1
7  1991              2
8  1992             23
9  1993             36
10 1994             11
11 1995             12
12 1996             10
13 2002             10
14 2003              2
15 2004              4
16 2005             12
17 2006             28
18 2008              3
19 2009             54
20 2010            137
21 2011            106
22 2012             64
23 2013             20
24 2014              3
25 2015              1
26 2016             53
27 2017             72
28 2018             65
29 2019             62
30 2020             11
31 2021             21
32 2022             25
33 2023             42</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>length_data_trip30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(ID) <span class="sc">&gt;=</span> <span class="dv">10</span>)<span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_trip30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR n_distinct(ID)
1  1984             71
2  1985             70
3  1986             16
4  1992             23
5  1993             36
6  1994             11
7  1995             12
8  1996             10
9  2002             10
10 2005             12
11 2006             28
12 2009             54
13 2010            137
14 2011            106
15 2012             64
16 2013             20
17 2016             53
18 2017             72
19 2018             65
20 2019             62
21 2020             11
22 2021             21
23 2022             25
24 2023             42</code></pre>
</div>
</div>
</section>
</section>
<section id="unique-length-records-per-gear-per-year" class="level2">
<h2 class="anchored" data-anchor-id="unique-length-records-per-gear-per-year">Unique length records per gear per year</h2>
<section id="how-many-length-records-per-gear-per-year" class="level3">
<h3 class="anchored" data-anchor-id="how-many-length-records-per-gear-per-year">How many length records per gear per year?</h3>
<p>Group by year, count occurrences of each gear</p>
<p>There are years when individual gears occur less than 30 times but when grouped, the gear groups exceed 30 occurrences per year. Do we want to rely on gear groups with larger than 30 occurrences per year or individual gears with more than 30 occurrences?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur each year</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>length_data_gearcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gearcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    YEAR       LAND_STANDARD_GEAR_NAME count
1   1983                    LINES HAND   102
2   1983                     NOT CODED     2
3   1983          POTS AND TRAPS; FISH    45
4   1984                      DIP NETS   109
5   1984                  GRABS; HOOKS     1
6   1984                 HOOKS; SPONGE    38
7   1984                    LINES HAND   273
8   1984          POTS AND TRAPS; FISH   214
9   1984 POTS AND TRAPS; SPINY LOBSTER     6
10  1985  ENTANGLING NETS (GILL) UNSPC    48
11  1985                    LINES HAND   181
12  1985         LINES LONG; REEF FISH   109
13  1985       LINES POWER TROLL OTHER   464
14  1985           POTS AND TRAPS; CMB    15
15  1985          POTS AND TRAPS; FISH   204
16  1986       LINES POWER TROLL OTHER    80
17  1986          POTS AND TRAPS; FISH    64
18  1987          POTS AND TRAPS; FISH    12
19  1988          POTS AND TRAPS; FISH     4
20  1991          POTS AND TRAPS; FISH     4
21  1992       ENCIRCLING NETS (PURSE)   127
22  1992                    LINES HAND   110
23  1992          POTS AND TRAPS; FISH    46
24  1993       ENCIRCLING NETS (PURSE)   126
25  1993                    LINES HAND   151
26  1993           POTS AND TRAPS; CMB     1
27  1993          POTS AND TRAPS; FISH    57
28  1994       ENCIRCLING NETS (PURSE)     1
29  1994                    LINES HAND   152
30  1994          POTS AND TRAPS; FISH    19
31  1994 POTS AND TRAPS; SPINY LOBSTER     3
32  1995       ENCIRCLING NETS (PURSE)    13
33  1995                    LINES HAND   172
34  1995           POTS AND TRAPS; CMB     3
35  1995          POTS AND TRAPS; FISH    26
36  1995 POTS AND TRAPS; SPINY LOBSTER     7
37  1996                    LINES HAND   182
38  1996          POTS AND TRAPS; FISH     6
39  2002                    LINES HAND    37
40  2002           POTS AND TRAPS; CMB     8
41  2002          POTS AND TRAPS; FISH    24
42  2003          POTS AND TRAPS; FISH     3
43  2004      POTS AND TRAPS; BOX TRAP     6
44  2005                    LINES HAND   335
45  2005          POTS AND TRAPS; FISH     8
46  2005 POTS AND TRAPS; SPINY LOBSTER    15
47  2006                   HAUL SEINES   182
48  2006                    LINES HAND   944
49  2006     LINES LONG SET WITH HOOKS     4
50  2006           POTS AND TRAPS; CMB     7
51  2006          POTS AND TRAPS; FISH    31
52  2008           POTS AND TRAPS; CMB     4
53  2008          POTS AND TRAPS; FISH     3
54  2009       ENCIRCLING NETS (PURSE)    30
55  2009                    LINES HAND   962
56  2009           POTS AND TRAPS; CMB    30
57  2009          POTS AND TRAPS; FISH   166
58  2010       ENCIRCLING NETS (PURSE)    66
59  2010                   HAUL SEINES   292
60  2010                    LINES HAND  2033
61  2010           POTS AND TRAPS; CMB     6
62  2010          POTS AND TRAPS; FISH   189
63  2010                  ROD AND REEL    18
64  2010                        SPEARS     1
65  2011                   HAUL SEINES     1
66  2011                    LINES HAND  1765
67  2011                     NOT CODED    13
68  2011           POTS AND TRAPS; CMB     1
69  2011          POTS AND TRAPS; FISH   130
70  2011 POTS AND TRAPS; SPINY LOBSTER     4
71  2011                  ROD AND REEL    13
72  2012                   HAUL SEINES     3
73  2012                    LINES HAND   888
74  2012          POTS AND TRAPS; FISH   137
75  2012                  ROD AND REEL     6
76  2013                    LINES HAND   197
77  2013          POTS AND TRAPS; FISH    20
78  2013 POTS AND TRAPS; SPINY LOBSTER     4
79  2014                    LINES HAND    47
80  2014          POTS AND TRAPS; FISH     2
81  2015          POTS AND TRAPS; FISH    12
82  2016                    LINES HAND   653
83  2016          POTS AND TRAPS; FISH    92
84  2016 POTS AND TRAPS; SPINY LOBSTER     1
85  2016   REEL; ELECTRIC OR HYDRAULIC     6
86  2016                  ROD AND REEL    49
87  2017                   HAUL SEINES    69
88  2017                    LINES HAND  1292
89  2017          POTS AND TRAPS; FISH   210
90  2017 POTS AND TRAPS; SPINY LOBSTER     1
91  2017                  ROD AND REEL    17
92  2018                   HAUL SEINES     7
93  2018                    LINES HAND  1616
94  2018           POTS AND TRAPS; CMB     2
95  2018          POTS AND TRAPS; FISH   102
96  2018                  ROD AND REEL     3
97  2019                   HAUL SEINES     2
98  2019                    LINES HAND  1865
99  2019          POTS AND TRAPS; FISH   136
100 2019                  ROD AND REEL    38
101 2019 ROD AND REEL; ELECTRIC (HAND)    20
102 2020                    LINES HAND   149
103 2020           POTS AND TRAPS; CMB     1
104 2020          POTS AND TRAPS; FISH    19
105 2020                  ROD AND REEL     4
106 2021          BY HAND; DIVING GEAR     1
107 2021                    LINES HAND   260
108 2021          POTS AND TRAPS; FISH     5
109 2021   REEL; ELECTRIC OR HYDRAULIC    48
110 2021                  ROD AND REEL    57
111 2022                    LINES HAND   386
112 2022          POTS AND TRAPS; FISH    43
113 2022 POTS AND TRAPS; SPINY LOBSTER     2
114 2022   REEL; ELECTRIC OR HYDRAULIC    85
115 2023                    LINES HAND   492
116 2023          POTS AND TRAPS; FISH    51
117 2023 POTS AND TRAPS; SPINY LOBSTER    21
118 2023                  ROD AND REEL   156
119 2023 ROD AND REEL; ELECTRIC (HAND)   104
120 2023                SPEARS; DIVING     1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur 30 or more times each year</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>length_data_gear30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR       LAND_STANDARD_GEAR_NAME count
1  1983                    LINES HAND   102
2  1983          POTS AND TRAPS; FISH    45
3  1984                      DIP NETS   109
4  1984                 HOOKS; SPONGE    38
5  1984                    LINES HAND   273
6  1984          POTS AND TRAPS; FISH   214
7  1985  ENTANGLING NETS (GILL) UNSPC    48
8  1985                    LINES HAND   181
9  1985         LINES LONG; REEF FISH   109
10 1985       LINES POWER TROLL OTHER   464
11 1985          POTS AND TRAPS; FISH   204
12 1986       LINES POWER TROLL OTHER    80
13 1986          POTS AND TRAPS; FISH    64
14 1992       ENCIRCLING NETS (PURSE)   127
15 1992                    LINES HAND   110
16 1992          POTS AND TRAPS; FISH    46
17 1993       ENCIRCLING NETS (PURSE)   126
18 1993                    LINES HAND   151
19 1993          POTS AND TRAPS; FISH    57
20 1994                    LINES HAND   152
21 1995                    LINES HAND   172
22 1996                    LINES HAND   182
23 2002                    LINES HAND    37
24 2005                    LINES HAND   335
25 2006                   HAUL SEINES   182
26 2006                    LINES HAND   944
27 2006          POTS AND TRAPS; FISH    31
28 2009       ENCIRCLING NETS (PURSE)    30
29 2009                    LINES HAND   962
30 2009           POTS AND TRAPS; CMB    30
31 2009          POTS AND TRAPS; FISH   166
32 2010       ENCIRCLING NETS (PURSE)    66
33 2010                   HAUL SEINES   292
34 2010                    LINES HAND  2033
35 2010          POTS AND TRAPS; FISH   189
36 2011                    LINES HAND  1765
37 2011          POTS AND TRAPS; FISH   130
38 2012                    LINES HAND   888
39 2012          POTS AND TRAPS; FISH   137
40 2013                    LINES HAND   197
41 2014                    LINES HAND    47
42 2016                    LINES HAND   653
43 2016          POTS AND TRAPS; FISH    92
44 2016                  ROD AND REEL    49
45 2017                   HAUL SEINES    69
46 2017                    LINES HAND  1292
47 2017          POTS AND TRAPS; FISH   210
48 2018                    LINES HAND  1616
49 2018          POTS AND TRAPS; FISH   102
50 2019                    LINES HAND  1865
51 2019          POTS AND TRAPS; FISH   136
52 2019                  ROD AND REEL    38
53 2020                    LINES HAND   149
54 2021                    LINES HAND   260
55 2021   REEL; ELECTRIC OR HYDRAULIC    48
56 2021                  ROD AND REEL    57
57 2022                    LINES HAND   386
58 2022          POTS AND TRAPS; FISH    43
59 2022   REEL; ELECTRIC OR HYDRAULIC    85
60 2023                    LINES HAND   492
61 2023          POTS AND TRAPS; FISH    51
62 2023                  ROD AND REEL   156
63 2023 ROD AND REEL; ELECTRIC (HAND)   104</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group gears that occur 30 or more times per year by gear grouping </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>length_data_geartogether30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geartogether30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR          gear count
1  1983 Hook and Line   102
2  1983          Trap    45
3  1984 Hook and Line   273
4  1984         Other   147
5  1984          Trap   214
6  1985 Hook and Line   645
7  1985           Net    48
8  1985         Other   109
9  1985          Trap   204
10 1986 Hook and Line    80
11 1986          Trap    64
12 1992 Hook and Line   110
13 1992           Net   127
14 1992          Trap    46
15 1993 Hook and Line   151
16 1993           Net   126
17 1993          Trap    57
18 1994 Hook and Line   152
19 1995 Hook and Line   172
20 1996 Hook and Line   182
21 2002 Hook and Line    37
22 2005 Hook and Line   335
23 2006 Hook and Line   944
24 2006           Net   182
25 2006          Trap    31
26 2009 Hook and Line   962
27 2009           Net    30
28 2009          Trap   196
29 2010 Hook and Line  2033
30 2010           Net   358
31 2010          Trap   189
32 2011 Hook and Line  1765
33 2011          Trap   130
34 2012 Hook and Line   888
35 2012          Trap   137
36 2013 Hook and Line   197
37 2014 Hook and Line    47
38 2016 Hook and Line   702
39 2016          Trap    92
40 2017 Hook and Line  1292
41 2017           Net    69
42 2017          Trap   210
43 2018 Hook and Line  1616
44 2018          Trap   102
45 2019 Hook and Line  1903
46 2019          Trap   136
47 2020 Hook and Line   149
48 2021 Hook and Line   365
49 2022 Hook and Line   471
50 2022          Trap    43
51 2023 Hook and Line   752
52 2023          Trap    51</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by specific gear per year</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 26 years of data available </span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geartogether30<span class="sc">$</span>YEAR, length_data_geartogether30<span class="sc">$</span>gear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       Hook and Line Net Other Trap
  1983             1   0     0    1
  1984             1   0     1    1
  1985             1   1     1    1
  1986             1   0     0    1
  1992             1   1     0    1
  1993             1   1     0    1
  1994             1   0     0    0
  1995             1   0     0    0
  1996             1   0     0    0
  2002             1   0     0    0
  2005             1   0     0    0
  2006             1   1     0    1
  2009             1   1     0    1
  2010             1   1     0    1
  2011             1   0     0    1
  2012             1   0     0    1
  2013             1   0     0    0
  2014             1   0     0    0
  2016             1   0     0    1
  2017             1   1     0    1
  2018             1   0     0    1
  2019             1   0     0    1
  2020             1   0     0    0
  2021             1   0     0    0
  2022             1   0     0    1
  2023             1   0     0    1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur each year</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>length_data_geargroupcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroupcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR          gear count
1  1983 Hook and Line   102
2  1983         Other     2
3  1983          Trap    45
4  1984 Hook and Line   273
5  1984         Other   148
6  1984          Trap   220
7  1985 Hook and Line   645
8  1985           Net    48
9  1985         Other   109
10 1985          Trap   219
11 1986 Hook and Line    80
12 1986          Trap    64
13 1987          Trap    12
14 1988          Trap     4
15 1991          Trap     4
16 1992 Hook and Line   110
17 1992           Net   127
18 1992          Trap    46
19 1993 Hook and Line   151
20 1993           Net   126
21 1993          Trap    58
22 1994 Hook and Line   152
23 1994           Net     1
24 1994          Trap    22
25 1995 Hook and Line   172
26 1995           Net    13
27 1995          Trap    36
28 1996 Hook and Line   182
29 1996          Trap     6
30 2002 Hook and Line    37
31 2002          Trap    32
32 2003          Trap     3
33 2004          Trap     6
34 2005 Hook and Line   335
35 2005          Trap    23
36 2006 Hook and Line   944
37 2006           Net   182
38 2006         Other     4
39 2006          Trap    38
40 2008          Trap     7
41 2009 Hook and Line   962
42 2009           Net    30
43 2009          Trap   196
44 2010 Hook and Line  2051
45 2010           Net   358
46 2010         Other     1
47 2010          Trap   195
48 2011 Hook and Line  1778
49 2011           Net     1
50 2011         Other    13
51 2011          Trap   135
52 2012 Hook and Line   894
53 2012           Net     3
54 2012          Trap   137
55 2013 Hook and Line   197
56 2013          Trap    24
57 2014 Hook and Line    47
58 2014          Trap     2
59 2015          Trap    12
60 2016 Hook and Line   708
61 2016          Trap    93
62 2017 Hook and Line  1309
63 2017           Net    69
64 2017          Trap   211
65 2018 Hook and Line  1619
66 2018           Net     7
67 2018          Trap   104
68 2019 Hook and Line  1923
69 2019           Net     2
70 2019          Trap   136
71 2020 Hook and Line   153
72 2020          Trap    20
73 2021 Hook and Line   365
74 2021         Other     1
75 2021          Trap     5
76 2022 Hook and Line   471
77 2022          Trap    45
78 2023 Hook and Line   752
79 2023         Other     1
80 2023          Trap    72</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur 30 or more times each year</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>length_data_geargroup30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR          gear count
1  1983 Hook and Line   102
2  1983          Trap    45
3  1984 Hook and Line   273
4  1984         Other   148
5  1984          Trap   220
6  1985 Hook and Line   645
7  1985           Net    48
8  1985         Other   109
9  1985          Trap   219
10 1986 Hook and Line    80
11 1986          Trap    64
12 1992 Hook and Line   110
13 1992           Net   127
14 1992          Trap    46
15 1993 Hook and Line   151
16 1993           Net   126
17 1993          Trap    58
18 1994 Hook and Line   152
19 1995 Hook and Line   172
20 1995          Trap    36
21 1996 Hook and Line   182
22 2002 Hook and Line    37
23 2002          Trap    32
24 2005 Hook and Line   335
25 2006 Hook and Line   944
26 2006           Net   182
27 2006          Trap    38
28 2009 Hook and Line   962
29 2009           Net    30
30 2009          Trap   196
31 2010 Hook and Line  2051
32 2010           Net   358
33 2010          Trap   195
34 2011 Hook and Line  1778
35 2011          Trap   135
36 2012 Hook and Line   894
37 2012          Trap   137
38 2013 Hook and Line   197
39 2014 Hook and Line    47
40 2016 Hook and Line   708
41 2016          Trap    93
42 2017 Hook and Line  1309
43 2017           Net    69
44 2017          Trap   211
45 2018 Hook and Line  1619
46 2018          Trap   104
47 2019 Hook and Line  1923
48 2019          Trap   136
49 2020 Hook and Line   153
50 2021 Hook and Line   365
51 2022 Hook and Line   471
52 2022          Trap    45
53 2023 Hook and Line   752
54 2023          Trap    72</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by gear grouping per year</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 26 years of data available </span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geargroup30<span class="sc">$</span>YEAR, length_data_geargroup30<span class="sc">$</span>gear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       Hook and Line Net Other Trap
  1983             1   0     0    1
  1984             1   0     1    1
  1985             1   1     1    1
  1986             1   0     0    1
  1992             1   1     0    1
  1993             1   1     0    1
  1994             1   0     0    0
  1995             1   0     0    1
  1996             1   0     0    0
  2002             1   0     0    1
  2005             1   0     0    0
  2006             1   1     0    1
  2009             1   1     0    1
  2010             1   1     0    1
  2011             1   0     0    1
  2012             1   0     0    1
  2013             1   0     0    0
  2014             1   0     0    0
  2016             1   0     0    1
  2017             1   1     0    1
  2018             1   0     0    1
  2019             1   0     0    1
  2020             1   0     0    0
  2021             1   0     0    0
  2022             1   0     0    1
  2023             1   0     0    1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by individual gears </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>length_data_gear29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear29)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR       LAND_STANDARD_GEAR_NAME count
1  1983                     NOT CODED     2
2  1984                  GRABS; HOOKS     1
3  1984 POTS AND TRAPS; SPINY LOBSTER     6
4  1985           POTS AND TRAPS; CMB    15
5  1987          POTS AND TRAPS; FISH    12
6  1988          POTS AND TRAPS; FISH     4
7  1991          POTS AND TRAPS; FISH     4
8  1993           POTS AND TRAPS; CMB     1
9  1994       ENCIRCLING NETS (PURSE)     1
10 1994          POTS AND TRAPS; FISH    19
11 1994 POTS AND TRAPS; SPINY LOBSTER     3
12 1995       ENCIRCLING NETS (PURSE)    13
13 1995           POTS AND TRAPS; CMB     3
14 1995          POTS AND TRAPS; FISH    26
15 1995 POTS AND TRAPS; SPINY LOBSTER     7
16 1996          POTS AND TRAPS; FISH     6
17 2002           POTS AND TRAPS; CMB     8
18 2002          POTS AND TRAPS; FISH    24
19 2003          POTS AND TRAPS; FISH     3
20 2004      POTS AND TRAPS; BOX TRAP     6
21 2005          POTS AND TRAPS; FISH     8
22 2005 POTS AND TRAPS; SPINY LOBSTER    15
23 2006     LINES LONG SET WITH HOOKS     4
24 2006           POTS AND TRAPS; CMB     7
25 2008           POTS AND TRAPS; CMB     4
26 2008          POTS AND TRAPS; FISH     3
27 2010           POTS AND TRAPS; CMB     6
28 2010                  ROD AND REEL    18
29 2010                        SPEARS     1
30 2011                   HAUL SEINES     1
31 2011                     NOT CODED    13
32 2011           POTS AND TRAPS; CMB     1
33 2011 POTS AND TRAPS; SPINY LOBSTER     4
34 2011                  ROD AND REEL    13
35 2012                   HAUL SEINES     3
36 2012                  ROD AND REEL     6
37 2013          POTS AND TRAPS; FISH    20
38 2013 POTS AND TRAPS; SPINY LOBSTER     4
39 2014          POTS AND TRAPS; FISH     2
40 2015          POTS AND TRAPS; FISH    12
41 2016 POTS AND TRAPS; SPINY LOBSTER     1
42 2016   REEL; ELECTRIC OR HYDRAULIC     6
43 2017 POTS AND TRAPS; SPINY LOBSTER     1
44 2017                  ROD AND REEL    17
45 2018                   HAUL SEINES     7
46 2018           POTS AND TRAPS; CMB     2
47 2018                  ROD AND REEL     3
48 2019                   HAUL SEINES     2
49 2019 ROD AND REEL; ELECTRIC (HAND)    20
50 2020           POTS AND TRAPS; CMB     1
51 2020          POTS AND TRAPS; FISH    19
52 2020                  ROD AND REEL     4
53 2021          BY HAND; DIVING GEAR     1
54 2021          POTS AND TRAPS; FISH     5
55 2022 POTS AND TRAPS; SPINY LOBSTER     2
56 2023 POTS AND TRAPS; SPINY LOBSTER    21
57 2023                SPEARS; DIVING     1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># VS </span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by gear groups </span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>length_data_geargroup29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup29)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR  gear count
1  1983 Other     2
2  1987  Trap    12
3  1988  Trap     4
4  1991  Trap     4
5  1994   Net     1
6  1994  Trap    22
7  1995   Net    13
8  1996  Trap     6
9  2003  Trap     3
10 2004  Trap     6
11 2005  Trap    23
12 2006 Other     4
13 2008  Trap     7
14 2010 Other     1
15 2011   Net     1
16 2011 Other    13
17 2012   Net     3
18 2013  Trap    24
19 2014  Trap     2
20 2015  Trap    12
21 2018   Net     7
22 2019   Net     2
23 2020  Trap    20
24 2021 Other     1
25 2021  Trap     5
26 2023 Other     1</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="glm-analysis" class="level1 page-columns page-full">
<h1>GLM analysis</h1>
<p>No filtering based on number of trips/fish per year yet, analysis of all available data.</p>
<p>123 records removed due to not being measured in fork length:</p>
<p>20 GILL NETS; OTHER</p>
<p>5 NOT CODED</p>
<p>32 LINES HAND</p>
<p>66 POTS AND TRAPS; FISH</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(length_data_final<span class="sc">$</span>gear) <span class="co"># "Hook and Line", "Trap", "Other", "Net"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Other"         "Net"           "Hook and Line" "Trap"         </code></pre>
</div>
</div>
<section id="all-gears" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="all-gears">All Gears</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-screen-inset">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = length_data_glm, REML = FALSE)</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> length_data_glm, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                         Sum Sq Mean Sq NumDF   DenDF F value    Pr(&gt;F)    
scale(FINAL_DATE)        387.44  387.44     1   37.39 20.3525 6.197e-05 ***
LAND_STANDARD_GEAR_NAME 2519.79  125.99    20 1245.49  6.6182 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1 25 117178.6
mod2   25 113160.7</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: length_data_glm
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
mod3    5 113197 113236 -56593   113187                         
mod2   25 113161 113358 -56555   113111 76.135 20  1.761e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: length_data_glm
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC logLik deviance Chisq Df Pr(&gt;Chisq)  
mod4   24 113165 113355 -56559   113117                      
mod2   25 113161 113358 -56555   113111 6.596  1    0.01022 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>mod_contr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 LAND_STANDARD_GEAR_NAME       emmean     SE  df asymp.LCL asymp.UCL
 BY HAND; DIVING GEAR            3.41 0.1680 Inf      3.08      3.74
 DIP NETS                        3.55 0.1058 Inf      3.34      3.75
 ENCIRCLING NETS (PURSE)         3.44 0.0400 Inf      3.36      3.52
 ENTANGLING NETS (GILL) UNSPC    3.57 0.1354 Inf      3.31      3.84
 GRABS; HOOKS                    3.38 0.1614 Inf      3.06      3.70
 HAUL SEINES                     3.42 0.0343 Inf      3.35      3.49
 HOOKS; SPONGE                   3.61 0.1185 Inf      3.38      3.84
 LINES HAND                      3.45 0.0111 Inf      3.43      3.48
 LINES LONG SET WITH HOOKS       3.53 0.1346 Inf      3.27      3.80
 LINES LONG; REEF FISH           3.47 0.0971 Inf      3.28      3.66
 LINES POWER TROLL OTHER         3.50 0.0424 Inf      3.41      3.58
 NOT CODED                       3.44 0.1055 Inf      3.23      3.65
 POTS AND TRAPS; BOX TRAP        3.45 0.0778 Inf      3.29      3.60
 POTS AND TRAPS; CMB             3.37 0.0300 Inf      3.31      3.43
 POTS AND TRAPS; FISH            3.39 0.0091 Inf      3.37      3.41
 POTS AND TRAPS; SPINY LOBSTER   3.37 0.0396 Inf      3.29      3.44
 REEL; ELECTRIC OR HYDRAULIC     3.52 0.0788 Inf      3.37      3.68
 ROD AND REEL                    3.58 0.0292 Inf      3.52      3.64
 ROD AND REEL; ELECTRIC (HAND)   3.46 0.0688 Inf      3.33      3.60
 SPEARS                          3.55 0.1610 Inf      3.23      3.87
 SPEARS; DIVING                  3.67 0.1614 Inf      3.35      3.98

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 

$contrasts
 contrast                                                       estimate     SE
 BY HAND; DIVING GEAR - DIP NETS                               -0.134906 0.1987
 BY HAND; DIVING GEAR - ENCIRCLING NETS (PURSE)                -0.026737 0.1732
 BY HAND; DIVING GEAR - ENTANGLING NETS (GILL) UNSPC           -0.162144 0.2157
 BY HAND; DIVING GEAR - GRABS; HOOKS                            0.031659 0.2332
 BY HAND; DIVING GEAR - HAUL SEINES                            -0.006815 0.1716
 BY HAND; DIVING GEAR - HOOKS; SPONGE                          -0.197928 0.2057
 BY HAND; DIVING GEAR - LINES HAND                             -0.041031 0.1683
 BY HAND; DIVING GEAR - LINES LONG SET WITH HOOKS              -0.121032 0.2158
 BY HAND; DIVING GEAR - LINES LONG; REEF FISH                  -0.058674 0.1945
 BY HAND; DIVING GEAR - LINES POWER TROLL OTHER                -0.085430 0.1735
 BY HAND; DIVING GEAR - NOT CODED                              -0.026420 0.1989
 BY HAND; DIVING GEAR - POTS AND TRAPS; BOX TRAP               -0.034831 0.1853
 BY HAND; DIVING GEAR - POTS AND TRAPS; CMB                     0.040146 0.1710
 BY HAND; DIVING GEAR - POTS AND TRAPS; FISH                    0.022554 0.1684
 BY HAND; DIVING GEAR - POTS AND TRAPS; SPINY LOBSTER           0.046617 0.1726
 BY HAND; DIVING GEAR - REEL; ELECTRIC OR HYDRAULIC            -0.108923 0.1844
 BY HAND; DIVING GEAR - ROD AND REEL                           -0.165777 0.1702
 BY HAND; DIVING GEAR - ROD AND REEL; ELECTRIC (HAND)          -0.048742 0.1815
 BY HAND; DIVING GEAR - SPEARS                                 -0.137051 0.2331
 BY HAND; DIVING GEAR - SPEARS; DIVING                         -0.255429 0.2331
 DIP NETS - ENCIRCLING NETS (PURSE)                             0.108168 0.1129
 DIP NETS - ENTANGLING NETS (GILL) UNSPC                       -0.027238 0.1714
 DIP NETS - GRABS; HOOKS                                        0.166565 0.1912
 DIP NETS - HAUL SEINES                                         0.128091 0.1111
 DIP NETS - HOOKS; SPONGE                                      -0.063022 0.1565
 DIP NETS - LINES HAND                                          0.093875 0.1061
 DIP NETS - LINES LONG SET WITH HOOKS                           0.013874 0.1713
 DIP NETS - LINES LONG; REEF FISH                               0.076232 0.1432
 DIP NETS - LINES POWER TROLL OTHER                             0.049475 0.1134
 DIP NETS - NOT CODED                                           0.108485 0.1490
 DIP NETS - POTS AND TRAPS; BOX TRAP                            0.100074 0.1313
 DIP NETS - POTS AND TRAPS; CMB                                 0.175052 0.1098
 DIP NETS - POTS AND TRAPS; FISH                                0.157460 0.1056
 DIP NETS - POTS AND TRAPS; SPINY LOBSTER                       0.181522 0.1126
 DIP NETS - REEL; ELECTRIC OR HYDRAULIC                         0.025983 0.1317
 DIP NETS - ROD AND REEL                                       -0.030871 0.1096
 DIP NETS - ROD AND REEL; ELECTRIC (HAND)                       0.086164 0.1262
 DIP NETS - SPEARS                                             -0.002145 0.1925
 DIP NETS - SPEARS; DIVING                                     -0.120524 0.1929
 ENCIRCLING NETS (PURSE) - ENTANGLING NETS (GILL) UNSPC        -0.135406 0.1408
 ENCIRCLING NETS (PURSE) - GRABS; HOOKS                         0.058397 0.1659
 ENCIRCLING NETS (PURSE) - HAUL SEINES                          0.019923 0.0517
 ENCIRCLING NETS (PURSE) - HOOKS; SPONGE                       -0.171190 0.1248
 ENCIRCLING NETS (PURSE) - LINES HAND                          -0.014294 0.0406
 ENCIRCLING NETS (PURSE) - LINES LONG SET WITH HOOKS           -0.094295 0.1398
 ENCIRCLING NETS (PURSE) - LINES LONG; REEF FISH               -0.031936 0.1046
 ENCIRCLING NETS (PURSE) - LINES POWER TROLL OTHER             -0.058693 0.0572
 ENCIRCLING NETS (PURSE) - NOT CODED                            0.000317 0.1122
 ENCIRCLING NETS (PURSE) - POTS AND TRAPS; BOX TRAP            -0.008094 0.0873
 ENCIRCLING NETS (PURSE) - POTS AND TRAPS; CMB                  0.066883 0.0486
 ENCIRCLING NETS (PURSE) - POTS AND TRAPS; FISH                 0.049292 0.0397
 ENCIRCLING NETS (PURSE) - POTS AND TRAPS; SPINY LOBSTER        0.073354 0.0561
 ENCIRCLING NETS (PURSE) - REEL; ELECTRIC OR HYDRAULIC         -0.082185 0.0888
 ENCIRCLING NETS (PURSE) - ROD AND REEL                        -0.139040 0.0496
 ENCIRCLING NETS (PURSE) - ROD AND REEL; ELECTRIC (HAND)       -0.022004 0.0794
 ENCIRCLING NETS (PURSE) - SPEARS                              -0.110314 0.1657
 ENCIRCLING NETS (PURSE) - SPEARS; DIVING                      -0.228692 0.1667
 ENTANGLING NETS (GILL) UNSPC - GRABS; HOOKS                    0.193803 0.2103
 ENTANGLING NETS (GILL) UNSPC - HAUL SEINES                     0.155329 0.1395
 ENTANGLING NETS (GILL) UNSPC - HOOKS; SPONGE                  -0.035784 0.1795
 ENTANGLING NETS (GILL) UNSPC - LINES HAND                      0.121113 0.1356
 ENTANGLING NETS (GILL) UNSPC - LINES LONG SET WITH HOOKS       0.041112 0.1909
 ENTANGLING NETS (GILL) UNSPC - LINES LONG; REEF FISH           0.103470 0.1637
 ENTANGLING NETS (GILL) UNSPC - LINES POWER TROLL OTHER         0.076714 0.1393
 ENTANGLING NETS (GILL) UNSPC - NOT CODED                       0.135723 0.1712
 ENTANGLING NETS (GILL) UNSPC - POTS AND TRAPS; BOX TRAP        0.127313 0.1561
 ENTANGLING NETS (GILL) UNSPC - POTS AND TRAPS; CMB             0.202290 0.1377
 ENTANGLING NETS (GILL) UNSPC - POTS AND TRAPS; FISH            0.184698 0.1352
 ENTANGLING NETS (GILL) UNSPC - POTS AND TRAPS; SPINY LOBSTER   0.208761 0.1409
 ENTANGLING NETS (GILL) UNSPC - REEL; ELECTRIC OR HYDRAULIC     0.053221 0.1566
 ENTANGLING NETS (GILL) UNSPC - ROD AND REEL                   -0.003633 0.1384
 ENTANGLING NETS (GILL) UNSPC - ROD AND REEL; ELECTRIC (HAND)   0.113402 0.1518
 ENTANGLING NETS (GILL) UNSPC - SPEARS                          0.025093 0.2103
 ENTANGLING NETS (GILL) UNSPC - SPEARS; DIVING                 -0.093285 0.2107
 GRABS; HOOKS - HAUL SEINES                                    -0.038474 0.1649
 GRABS; HOOKS - HOOKS; SPONGE                                  -0.229587 0.1988
 GRABS; HOOKS - LINES HAND                                     -0.072690 0.1616
 GRABS; HOOKS - LINES LONG SET WITH HOOKS                      -0.152691 0.2100
 GRABS; HOOKS - LINES LONG; REEF FISH                          -0.090333 0.1879
 GRABS; HOOKS - LINES POWER TROLL OTHER                        -0.117089 0.1663
 GRABS; HOOKS - NOT CODED                                      -0.058080 0.1923
 GRABS; HOOKS - POTS AND TRAPS; BOX TRAP                       -0.066490 0.1790
 GRABS; HOOKS - POTS AND TRAPS; CMB                             0.008487 0.1639
 GRABS; HOOKS - POTS AND TRAPS; FISH                           -0.009105 0.1613
 GRABS; HOOKS - POTS AND TRAPS; SPINY LOBSTER                   0.014958 0.1660
 GRABS; HOOKS - REEL; ELECTRIC OR HYDRAULIC                    -0.140582 0.1797
 GRABS; HOOKS - ROD AND REEL                                   -0.197436 0.1640
 GRABS; HOOKS - ROD AND REEL; ELECTRIC (HAND)                  -0.080401 0.1755
 GRABS; HOOKS - SPEARS                                         -0.168710 0.2279
 GRABS; HOOKS - SPEARS; DIVING                                 -0.287088 0.2283
 HAUL SEINES - HOOKS; SPONGE                                   -0.191113 0.1232
 HAUL SEINES - LINES HAND                                      -0.034216 0.0346
 HAUL SEINES - LINES LONG SET WITH HOOKS                       -0.114217 0.1379
 HAUL SEINES - LINES LONG; REEF FISH                           -0.051859 0.1028
 HAUL SEINES - LINES POWER TROLL OTHER                         -0.078615 0.0541
 HAUL SEINES - NOT CODED                                       -0.019606 0.1106
 HAUL SEINES - POTS AND TRAPS; BOX TRAP                        -0.028016 0.0850
 HAUL SEINES - POTS AND TRAPS; CMB                              0.046961 0.0447
 HAUL SEINES - POTS AND TRAPS; FISH                             0.029369 0.0344
 HAUL SEINES - POTS AND TRAPS; SPINY LOBSTER                    0.053432 0.0522
 HAUL SEINES - REEL; ELECTRIC OR HYDRAULIC                     -0.102108 0.0860
 HAUL SEINES - ROD AND REEL                                    -0.158962 0.0445
 HAUL SEINES - ROD AND REEL; ELECTRIC (HAND)                   -0.041927 0.0764
 HAUL SEINES - SPEARS                                          -0.130236 0.1642
 HAUL SEINES - SPEARS; DIVING                                  -0.248614 0.1651
 HOOKS; SPONGE - LINES HAND                                     0.156897 0.1188
 HOOKS; SPONGE - LINES LONG SET WITH HOOKS                      0.076896 0.1793
 HOOKS; SPONGE - LINES LONG; REEF FISH                          0.139254 0.1527
 HOOKS; SPONGE - LINES POWER TROLL OTHER                        0.112498 0.1252
 HOOKS; SPONGE - NOT CODED                                      0.171507 0.1582
 HOOKS; SPONGE - POTS AND TRAPS; BOX TRAP                       0.163097 0.1417
 HOOKS; SPONGE - POTS AND TRAPS; CMB                            0.238074 0.1220
 HOOKS; SPONGE - POTS AND TRAPS; FISH                           0.220482 0.1184
 HOOKS; SPONGE - POTS AND TRAPS; SPINY LOBSTER                  0.244545 0.1246
 HOOKS; SPONGE - REEL; ELECTRIC OR HYDRAULIC                    0.089005 0.1423
 HOOKS; SPONGE - ROD AND REEL                                   0.032151 0.1220
 HOOKS; SPONGE - ROD AND REEL; ELECTRIC (HAND)                  0.149186 0.1370
 HOOKS; SPONGE - SPEARS                                         0.060877 0.1998
 HOOKS; SPONGE - SPEARS; DIVING                                -0.057501 0.2003
 LINES HAND - LINES LONG SET WITH HOOKS                        -0.080001 0.1348
 LINES HAND - LINES LONG; REEF FISH                            -0.017643 0.0975
 LINES HAND - LINES POWER TROLL OTHER                          -0.044399 0.0432
 LINES HAND - NOT CODED                                         0.014611 0.1057
 LINES HAND - POTS AND TRAPS; BOX TRAP                          0.006200 0.0786
 LINES HAND - POTS AND TRAPS; CMB                               0.081177 0.0310
 LINES HAND - POTS AND TRAPS; FISH                              0.063585 0.0114
 LINES HAND - POTS AND TRAPS; SPINY LOBSTER                     0.087648 0.0405
 LINES HAND - REEL; ELECTRIC OR HYDRAULIC                      -0.067892 0.0792
 LINES HAND - ROD AND REEL                                     -0.124746 0.0299
 LINES HAND - ROD AND REEL; ELECTRIC (HAND)                    -0.007711 0.0690
 LINES HAND - SPEARS                                           -0.096020 0.1611
 LINES HAND - SPEARS; DIVING                                   -0.214398 0.1617
 LINES LONG SET WITH HOOKS - LINES LONG; REEF FISH              0.062358 0.1659
 LINES LONG SET WITH HOOKS - LINES POWER TROLL OTHER            0.035602 0.1409
 LINES LONG SET WITH HOOKS - NOT CODED                          0.094612 0.1708
 LINES LONG SET WITH HOOKS - POTS AND TRAPS; BOX TRAP           0.086201 0.1554
 LINES LONG SET WITH HOOKS - POTS AND TRAPS; CMB                0.161178 0.1374
 LINES LONG SET WITH HOOKS - POTS AND TRAPS; FISH               0.143586 0.1346
 LINES LONG SET WITH HOOKS - POTS AND TRAPS; SPINY LOBSTER      0.167649 0.1403
 LINES LONG SET WITH HOOKS - REEL; ELECTRIC OR HYDRAULIC        0.012109 0.1562
 LINES LONG SET WITH HOOKS - ROD AND REEL                      -0.044745 0.1377
 LINES LONG SET WITH HOOKS - ROD AND REEL; ELECTRIC (HAND)      0.072290 0.1510
 LINES LONG SET WITH HOOKS - SPEARS                            -0.016019 0.2098
 LINES LONG SET WITH HOOKS - SPEARS; DIVING                    -0.134397 0.2105
 LINES LONG; REEF FISH - LINES POWER TROLL OTHER               -0.026756 0.1026
 LINES LONG; REEF FISH - NOT CODED                              0.032253 0.1429
 LINES LONG; REEF FISH - POTS AND TRAPS; BOX TRAP               0.023843 0.1243
 LINES LONG; REEF FISH - POTS AND TRAPS; CMB                    0.098820 0.1005
 LINES LONG; REEF FISH - POTS AND TRAPS; FISH                   0.081228 0.0970
 LINES LONG; REEF FISH - POTS AND TRAPS; SPINY LOBSTER          0.105291 0.1047
 LINES LONG; REEF FISH - REEL; ELECTRIC OR HYDRAULIC           -0.050249 0.1251
 LINES LONG; REEF FISH - ROD AND REEL                          -0.107103 0.1014
 LINES LONG; REEF FISH - ROD AND REEL; ELECTRIC (HAND)          0.009932 0.1190
 LINES LONG; REEF FISH - SPEARS                                -0.078377 0.1879
 LINES LONG; REEF FISH - SPEARS; DIVING                        -0.196755 0.1885
 LINES POWER TROLL OTHER - NOT CODED                            0.059010 0.1129
 LINES POWER TROLL OTHER - POTS AND TRAPS; BOX TRAP             0.050599 0.0883
 LINES POWER TROLL OTHER - POTS AND TRAPS; CMB                  0.125576 0.0499
 LINES POWER TROLL OTHER - POTS AND TRAPS; FISH                 0.107984 0.0420
 LINES POWER TROLL OTHER - POTS AND TRAPS; SPINY LOBSTER        0.132047 0.0577
 LINES POWER TROLL OTHER - REEL; ELECTRIC OR HYDRAULIC         -0.023493 0.0897
 LINES POWER TROLL OTHER - ROD AND REEL                        -0.080347 0.0515
 LINES POWER TROLL OTHER - ROD AND REEL; ELECTRIC (HAND)        0.036689 0.0809
 LINES POWER TROLL OTHER - SPEARS                              -0.051621 0.1664
 LINES POWER TROLL OTHER - SPEARS; DIVING                      -0.169999 0.1671
 NOT CODED - POTS AND TRAPS; BOX TRAP                          -0.008411 0.1308
 NOT CODED - POTS AND TRAPS; CMB                                0.066566 0.1092
 NOT CODED - POTS AND TRAPS; FISH                               0.048975 0.1054
 NOT CODED - POTS AND TRAPS; SPINY LOBSTER                      0.073037 0.1124
 NOT CODED - REEL; ELECTRIC OR HYDRAULIC                       -0.082502 0.1318
 NOT CODED - ROD AND REEL                                      -0.139357 0.1093
 NOT CODED - ROD AND REEL; ELECTRIC (HAND)                     -0.022321 0.1259
 NOT CODED - SPEARS                                            -0.110631 0.1923
 NOT CODED - SPEARS; DIVING                                    -0.229009 0.1929
 POTS AND TRAPS; BOX TRAP - POTS AND TRAPS; CMB                 0.074977 0.0833
 POTS AND TRAPS; BOX TRAP - POTS AND TRAPS; FISH                0.057386 0.0782
 POTS AND TRAPS; BOX TRAP - POTS AND TRAPS; SPINY LOBSTER       0.081448 0.0873
 POTS AND TRAPS; BOX TRAP - REEL; ELECTRIC OR HYDRAULIC        -0.074091 0.1109
 POTS AND TRAPS; BOX TRAP - ROD AND REEL                       -0.130946 0.0832
 POTS AND TRAPS; BOX TRAP - ROD AND REEL; ELECTRIC (HAND)      -0.013910 0.1039
 POTS AND TRAPS; BOX TRAP - SPEARS                             -0.102220 0.1788
 POTS AND TRAPS; BOX TRAP - SPEARS; DIVING                     -0.220598 0.1793
 POTS AND TRAPS; CMB - POTS AND TRAPS; FISH                    -0.017592 0.0301
 POTS AND TRAPS; CMB - POTS AND TRAPS; SPINY LOBSTER            0.006471 0.0495
 POTS AND TRAPS; CMB - REEL; ELECTRIC OR HYDRAULIC             -0.149069 0.0846
 POTS AND TRAPS; CMB - ROD AND REEL                            -0.205923 0.0419
 POTS AND TRAPS; CMB - ROD AND REEL; ELECTRIC (HAND)           -0.088888 0.0749
 POTS AND TRAPS; CMB - SPEARS                                  -0.177197 0.1637
 POTS AND TRAPS; CMB - SPEARS; DIVING                          -0.295575 0.1644
 POTS AND TRAPS; FISH - POTS AND TRAPS; SPINY LOBSTER           0.024063 0.0402
 POTS AND TRAPS; FISH - REEL; ELECTRIC OR HYDRAULIC            -0.131477 0.0793
 POTS AND TRAPS; FISH - ROD AND REEL                           -0.188331 0.0301
 POTS AND TRAPS; FISH - ROD AND REEL; ELECTRIC (HAND)          -0.071296 0.0691
 POTS AND TRAPS; FISH - SPEARS                                 -0.159605 0.1611
 POTS AND TRAPS; FISH - SPEARS; DIVING                         -0.277984 0.1617
 POTS AND TRAPS; SPINY LOBSTER - REEL; ELECTRIC OR HYDRAULIC   -0.155540 0.0879
 POTS AND TRAPS; SPINY LOBSTER - ROD AND REEL                  -0.212394 0.0485
 POTS AND TRAPS; SPINY LOBSTER - ROD AND REEL; ELECTRIC (HAND) -0.095358 0.0790
 POTS AND TRAPS; SPINY LOBSTER - SPEARS                        -0.183668 0.1657
 POTS AND TRAPS; SPINY LOBSTER - SPEARS; DIVING                -0.302046 0.1658
 REEL; ELECTRIC OR HYDRAULIC - ROD AND REEL                    -0.056854 0.0836
 REEL; ELECTRIC OR HYDRAULIC - ROD AND REEL; ELECTRIC (HAND)    0.060181 0.1045
 REEL; ELECTRIC OR HYDRAULIC - SPEARS                          -0.028128 0.1792
 REEL; ELECTRIC OR HYDRAULIC - SPEARS; DIVING                  -0.146507 0.1793
 ROD AND REEL - ROD AND REEL; ELECTRIC (HAND)                   0.117035 0.0738
 ROD AND REEL - SPEARS                                          0.028726 0.1635
 ROD AND REEL - SPEARS; DIVING                                 -0.089652 0.1635
 ROD AND REEL; ELECTRIC (HAND) - SPEARS                        -0.088309 0.1750
 ROD AND REEL; ELECTRIC (HAND) - SPEARS; DIVING                -0.206688 0.1749
 SPEARS - SPEARS; DIVING                                       -0.118378 0.2279
  df z.ratio p.value
 Inf  -0.679  1.0000
 Inf  -0.154  1.0000
 Inf  -0.752  1.0000
 Inf   0.136  1.0000
 Inf  -0.040  1.0000
 Inf  -0.962  1.0000
 Inf  -0.244  1.0000
 Inf  -0.561  1.0000
 Inf  -0.302  1.0000
 Inf  -0.492  1.0000
 Inf  -0.133  1.0000
 Inf  -0.188  1.0000
 Inf   0.235  1.0000
 Inf   0.134  1.0000
 Inf   0.270  1.0000
 Inf  -0.591  1.0000
 Inf  -0.974  1.0000
 Inf  -0.269  1.0000
 Inf  -0.588  1.0000
 Inf  -1.096  1.0000
 Inf   0.958  1.0000
 Inf  -0.159  1.0000
 Inf   0.871  1.0000
 Inf   1.153  0.9999
 Inf  -0.403  1.0000
 Inf   0.885  1.0000
 Inf   0.081  1.0000
 Inf   0.532  1.0000
 Inf   0.436  1.0000
 Inf   0.728  1.0000
 Inf   0.762  1.0000
 Inf   1.594  0.9924
 Inf   1.491  0.9967
 Inf   1.613  0.9912
 Inf   0.197  1.0000
 Inf  -0.282  1.0000
 Inf   0.683  1.0000
 Inf  -0.011  1.0000
 Inf  -0.625  1.0000
 Inf  -0.962  1.0000
 Inf   0.352  1.0000
 Inf   0.385  1.0000
 Inf  -1.372  0.9989
 Inf  -0.352  1.0000
 Inf  -0.674  1.0000
 Inf  -0.305  1.0000
 Inf  -1.026  1.0000
 Inf   0.003  1.0000
 Inf  -0.093  1.0000
 Inf   1.376  0.9989
 Inf   1.242  0.9997
 Inf   1.307  0.9995
 Inf  -0.925  1.0000
 Inf  -2.802  0.3751
 Inf  -0.277  1.0000
 Inf  -0.666  1.0000
 Inf  -1.372  0.9989
 Inf   0.922  1.0000
 Inf   1.114  1.0000
 Inf  -0.199  1.0000
 Inf   0.893  1.0000
 Inf   0.215  1.0000
 Inf   0.632  1.0000
 Inf   0.551  1.0000
 Inf   0.793  1.0000
 Inf   0.816  1.0000
 Inf   1.469  0.9973
 Inf   1.366  0.9990
 Inf   1.482  0.9970
 Inf   0.340  1.0000
 Inf  -0.026  1.0000
 Inf   0.747  1.0000
 Inf   0.119  1.0000
 Inf  -0.443  1.0000
 Inf  -0.233  1.0000
 Inf  -1.155  0.9999
 Inf  -0.450  1.0000
 Inf  -0.727  1.0000
 Inf  -0.481  1.0000
 Inf  -0.704  1.0000
 Inf  -0.302  1.0000
 Inf  -0.371  1.0000
 Inf   0.052  1.0000
 Inf  -0.056  1.0000
 Inf   0.090  1.0000
 Inf  -0.782  1.0000
 Inf  -1.204  0.9998
 Inf  -0.458  1.0000
 Inf  -0.740  1.0000
 Inf  -1.257  0.9997
 Inf  -1.551  0.9946
 Inf  -0.989  1.0000
 Inf  -0.828  1.0000
 Inf  -0.505  1.0000
 Inf  -1.453  0.9977
 Inf  -0.177  1.0000
 Inf  -0.330  1.0000
 Inf   1.050  1.0000
 Inf   0.854  1.0000
 Inf   1.024  1.0000
 Inf  -1.188  0.9999
 Inf  -3.573  0.0494
 Inf  -0.549  1.0000
 Inf  -0.793  1.0000
 Inf  -1.506  0.9963
 Inf   1.321  0.9994
 Inf   0.429  1.0000
 Inf   0.912  1.0000
 Inf   0.898  1.0000
 Inf   1.084  1.0000
 Inf   1.151  0.9999
 Inf   1.951  0.9333
 Inf   1.863  0.9572
 Inf   1.962  0.9297
 Inf   0.626  1.0000
 Inf   0.264  1.0000
 Inf   1.089  1.0000
 Inf   0.305  1.0000
 Inf  -0.287  1.0000
 Inf  -0.594  1.0000
 Inf  -0.181  1.0000
 Inf  -1.028  1.0000
 Inf   0.138  1.0000
 Inf   0.079  1.0000
 Inf   2.619  0.5143
 Inf   5.583  &lt;.0001
 Inf   2.165  0.8408
 Inf  -0.857  1.0000
 Inf  -4.168  0.0054
 Inf  -0.112  1.0000
 Inf  -0.596  1.0000
 Inf  -1.326  0.9993
 Inf   0.376  1.0000
 Inf   0.253  1.0000
 Inf   0.554  1.0000
 Inf   0.555  1.0000
 Inf   1.173  0.9999
 Inf   1.067  1.0000
 Inf   1.195  0.9999
 Inf   0.078  1.0000
 Inf  -0.325  1.0000
 Inf   0.479  1.0000
 Inf  -0.076  1.0000
 Inf  -0.639  1.0000
 Inf  -0.261  1.0000
 Inf   0.226  1.0000
 Inf   0.192  1.0000
 Inf   0.984  1.0000
 Inf   0.838  1.0000
 Inf   1.005  1.0000
 Inf  -0.402  1.0000
 Inf  -1.056  1.0000
 Inf   0.083  1.0000
 Inf  -0.417  1.0000
 Inf  -1.044  1.0000
 Inf   0.522  1.0000
 Inf   0.573  1.0000
 Inf   2.515  0.5969
 Inf   2.569  0.5543
 Inf   2.287  0.7665
 Inf  -0.262  1.0000
 Inf  -1.559  0.9942
 Inf   0.454  1.0000
 Inf  -0.310  1.0000
 Inf  -1.018  1.0000
 Inf  -0.064  1.0000
 Inf   0.610  1.0000
 Inf   0.465  1.0000
 Inf   0.650  1.0000
 Inf  -0.626  1.0000
 Inf  -1.275  0.9996
 Inf  -0.177  1.0000
 Inf  -0.575  1.0000
 Inf  -1.187  0.9999
 Inf   0.901  1.0000
 Inf   0.733  1.0000
 Inf   0.933  1.0000
 Inf  -0.668  1.0000
 Inf  -1.574  0.9935
 Inf  -0.134  1.0000
 Inf  -0.572  1.0000
 Inf  -1.230  0.9998
 Inf  -0.583  1.0000
 Inf   0.131  1.0000
 Inf  -1.762  0.9759
 Inf  -4.917  0.0002
 Inf  -1.187  0.9999
 Inf  -1.083  1.0000
 Inf  -1.798  0.9702
 Inf   0.598  1.0000
 Inf  -1.658  0.9879
 Inf  -6.264  &lt;.0001
 Inf  -1.032  1.0000
 Inf  -0.991  1.0000
 Inf  -1.719  0.9817
 Inf  -1.770  0.9748
 Inf  -4.377  0.0022
 Inf  -1.207  0.9998
 Inf  -1.108  1.0000
 Inf  -1.821  0.9659
 Inf  -0.680  1.0000
 Inf   0.576  1.0000
 Inf  -0.157  1.0000
 Inf  -0.817  1.0000
 Inf   1.586  0.9928
 Inf   0.176  1.0000
 Inf  -0.548  1.0000
 Inf  -0.505  1.0000
 Inf  -1.182  0.9999
 Inf  -0.519  1.0000

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 21 estimates </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME       emmean     SE  df asymp.LCL asymp.UCL .group
 POTS AND TRAPS; SPINY LOBSTER   3.37 0.0396 Inf      3.29      3.44  12   
 POTS AND TRAPS; CMB             3.37 0.0300 Inf      3.31      3.43  12   
 GRABS; HOOKS                    3.38 0.1614 Inf      3.06      3.70  123  
 POTS AND TRAPS; FISH            3.39 0.0091 Inf      3.37      3.41  1    
 BY HAND; DIVING GEAR            3.41 0.1680 Inf      3.08      3.74  123  
 HAUL SEINES                     3.42 0.0343 Inf      3.35      3.49  12   
 NOT CODED                       3.44 0.1055 Inf      3.23      3.65  123  
 ENCIRCLING NETS (PURSE)         3.44 0.0400 Inf      3.36      3.52  123  
 POTS AND TRAPS; BOX TRAP        3.45 0.0778 Inf      3.29      3.60  123  
 LINES HAND                      3.45 0.0111 Inf      3.43      3.48   2   
 ROD AND REEL; ELECTRIC (HAND)   3.46 0.0688 Inf      3.33      3.60  123  
 LINES LONG; REEF FISH           3.47 0.0971 Inf      3.28      3.66  123  
 LINES POWER TROLL OTHER         3.50 0.0424 Inf      3.41      3.58  123  
 REEL; ELECTRIC OR HYDRAULIC     3.52 0.0788 Inf      3.37      3.68  123  
 LINES LONG SET WITH HOOKS       3.53 0.1346 Inf      3.27      3.80  123  
 DIP NETS                        3.55 0.1058 Inf      3.34      3.75  123  
 SPEARS                          3.55 0.1610 Inf      3.23      3.87  123  
 ENTANGLING NETS (GILL) UNSPC    3.57 0.1354 Inf      3.31      3.84  123  
 ROD AND REEL                    3.58 0.0292 Inf      3.52      3.64    3  
 HOOKS; SPONGE                   3.61 0.1185 Inf      3.38      3.84  123  
 SPEARS; DIVING                  3.67 0.1614 Inf      3.35      3.98  123  

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 21 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld <span class="ot">&lt;-</span> multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>length_data_fishcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_fish =</span> <span class="fu">n</span>()) </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_fish <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld, length_data_fishcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_trip <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_fish, length_data_tripcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_final <span class="ot">&lt;-</span> allgears_multcompcld_trip <span class="sc">|&gt;</span> </span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="st">".group"</span>,</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"n_distinct_ID"</span> <span class="ot">=</span> <span class="st">"n_distinct(ID)"</span>)</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgears_multcompcld_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME       emmean     SE  df asymp.LCL asymp.UCL group
 POTS AND TRAPS; SPINY LOBSTER   3.37 0.0396 Inf      3.29      3.44  12  
 POTS AND TRAPS; CMB             3.37 0.0300 Inf      3.31      3.43  12  
 GRABS; HOOKS                    3.38 0.1614 Inf      3.06      3.70  123 
 POTS AND TRAPS; FISH            3.39 0.0091 Inf      3.37      3.41  1   
 BY HAND; DIVING GEAR            3.41 0.1680 Inf      3.08      3.74  123 
 HAUL SEINES                     3.42 0.0343 Inf      3.35      3.49  12  
 NOT CODED                       3.44 0.1055 Inf      3.23      3.65  123 
 ENCIRCLING NETS (PURSE)         3.44 0.0400 Inf      3.36      3.52  123 
 POTS AND TRAPS; BOX TRAP        3.45 0.0778 Inf      3.29      3.60  123 
 LINES HAND                      3.45 0.0111 Inf      3.43      3.48   2  
 ROD AND REEL; ELECTRIC (HAND)   3.46 0.0688 Inf      3.33      3.60  123 
 LINES LONG; REEF FISH           3.47 0.0971 Inf      3.28      3.66  123 
 LINES POWER TROLL OTHER         3.50 0.0424 Inf      3.41      3.58  123 
 REEL; ELECTRIC OR HYDRAULIC     3.52 0.0788 Inf      3.37      3.68  123 
 LINES LONG SET WITH HOOKS       3.53 0.1346 Inf      3.27      3.80  123 
 DIP NETS                        3.55 0.1058 Inf      3.34      3.75  123 
 SPEARS                          3.55 0.1610 Inf      3.23      3.87  123 
 ENTANGLING NETS (GILL) UNSPC    3.57 0.1354 Inf      3.31      3.84  123 
 ROD AND REEL                    3.58 0.0292 Inf      3.52      3.64    3 
 HOOKS; SPONGE                   3.61 0.1185 Inf      3.38      3.84  123 
 SPEARS; DIVING                  3.67 0.1614 Inf      3.35      3.98  123 
 n_fish n_distinct_ID
     64            13
     78            26
      1             1
   2084           444
      1             1
    556            26
     15             2
    363            20
      6             4
  15244           452
    124             6
    109             4
    544            20
    139             5
      4             1
    109             3
      1             1
     48             2
    361            29
     38             2
      1             1

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 21 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgears_multcompcld_final, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/sttj_yts_glm_allgears.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>, <span class="st">"3"</span>))</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_fish[i]))</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_distinct_ID[i]))</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>allgear_glm_totals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_distinct_ID =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_final<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_final<span class="sc">$</span>n_distinct_ID[i]))),</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_fish =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_final<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_final<span class="sc">$</span>n_fish[i]))))</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgear_glm_totals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  group n_distinct_ID n_fish
1     1           582   4285
2     2           590  17445
3     3           102   1864</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgear_glm_totals, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/sttj_yts_glm_allgears_totals.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="all-gears-2012-and-after" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="all-gears-2012-and-after">All Gears 2012 and after</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear2012_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear2012_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear2012_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-screen-inset">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = length_data_glm, REML = FALSE)</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> length_data_glm_2012, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                         Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
scale(FINAL_DATE)         67.49  67.492     1  10.58  3.6979    0.0818 .  
LAND_STANDARD_GEAR_NAME 1042.69 115.855     9 667.58  6.3476 1.165e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1 14 54700.42
mod2   14 52867.47</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: length_data_glm_2012
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
mod3    5 52891 52927 -26441    52881                         
mod2   14 52867 52968 -26420    52839 41.727  9  3.687e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: length_data_glm_2012
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)  
mod4   13 52870 52963 -26422    52844                       
mod2   14 52867 52968 -26420    52839 4.7511  1    0.02928 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>mod_contr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 LAND_STANDARD_GEAR_NAME       emmean     SE  df asymp.LCL asymp.UCL
 BY HAND; DIVING GEAR            3.40 0.1513 Inf      3.10      3.69
 HAUL SEINES                     3.43 0.0508 Inf      3.33      3.53
 LINES HAND                      3.43 0.0141 Inf      3.41      3.46
 POTS AND TRAPS; CMB             3.32 0.0970 Inf      3.13      3.51
 POTS AND TRAPS; FISH            3.38 0.0134 Inf      3.35      3.41
 POTS AND TRAPS; SPINY LOBSTER   3.40 0.0482 Inf      3.31      3.50
 REEL; ELECTRIC OR HYDRAULIC     3.51 0.0640 Inf      3.39      3.64
 ROD AND REEL                    3.55 0.0287 Inf      3.49      3.60
 ROD AND REEL; ELECTRIC (HAND)   3.45 0.0592 Inf      3.33      3.56
 SPEARS; DIVING                  3.68 0.1517 Inf      3.38      3.97

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 

$contrasts
 contrast                                                      estimate     SE
 BY HAND; DIVING GEAR - HAUL SEINES                            -0.03381 0.1598
 BY HAND; DIVING GEAR - LINES HAND                             -0.03627 0.1517
 BY HAND; DIVING GEAR - POTS AND TRAPS; CMB                     0.08097 0.1800
 BY HAND; DIVING GEAR - POTS AND TRAPS; FISH                    0.01886 0.1520
 BY HAND; DIVING GEAR - POTS AND TRAPS; SPINY LOBSTER          -0.00551 0.1585
 BY HAND; DIVING GEAR - REEL; ELECTRIC OR HYDRAULIC            -0.11252 0.1629
 BY HAND; DIVING GEAR - ROD AND REEL                           -0.14722 0.1537
 BY HAND; DIVING GEAR - ROD AND REEL; ELECTRIC (HAND)          -0.04941 0.1626
 BY HAND; DIVING GEAR - SPEARS; DIVING                         -0.27727 0.2138
 HAUL SEINES - LINES HAND                                      -0.00246 0.0506
 HAUL SEINES - POTS AND TRAPS; CMB                              0.11478 0.1086
 HAUL SEINES - POTS AND TRAPS; FISH                             0.05267 0.0505
 HAUL SEINES - POTS AND TRAPS; SPINY LOBSTER                    0.02830 0.0694
 HAUL SEINES - REEL; ELECTRIC OR HYDRAULIC                     -0.07871 0.0813
 HAUL SEINES - ROD AND REEL                                    -0.11340 0.0570
 HAUL SEINES - ROD AND REEL; ELECTRIC (HAND)                   -0.01559 0.0766
 HAUL SEINES - SPEARS; DIVING                                  -0.24346 0.1600
 LINES HAND - POTS AND TRAPS; CMB                               0.11724 0.0972
 LINES HAND - POTS AND TRAPS; FISH                              0.05513 0.0138
 LINES HAND - POTS AND TRAPS; SPINY LOBSTER                     0.03076 0.0488
 LINES HAND - REEL; ELECTRIC OR HYDRAULIC                      -0.07625 0.0642
 LINES HAND - ROD AND REEL                                     -0.11094 0.0291
 LINES HAND - ROD AND REEL; ELECTRIC (HAND)                    -0.01313 0.0589
 LINES HAND - SPEARS; DIVING                                   -0.24099 0.1520
 POTS AND TRAPS; CMB - POTS AND TRAPS; FISH                    -0.06211 0.0971
 POTS AND TRAPS; CMB - POTS AND TRAPS; SPINY LOBSTER           -0.08648 0.1081
 POTS AND TRAPS; CMB - REEL; ELECTRIC OR HYDRAULIC             -0.19349 0.1161
 POTS AND TRAPS; CMB - ROD AND REEL                            -0.22818 0.1006
 POTS AND TRAPS; CMB - ROD AND REEL; ELECTRIC (HAND)           -0.13038 0.1129
 POTS AND TRAPS; CMB - SPEARS; DIVING                          -0.35824 0.1801
 POTS AND TRAPS; FISH - POTS AND TRAPS; SPINY LOBSTER          -0.02437 0.0491
 POTS AND TRAPS; FISH - REEL; ELECTRIC OR HYDRAULIC            -0.13138 0.0646
 POTS AND TRAPS; FISH - ROD AND REEL                           -0.16608 0.0295
 POTS AND TRAPS; FISH - ROD AND REEL; ELECTRIC (HAND)          -0.06827 0.0592
 POTS AND TRAPS; FISH - SPEARS; DIVING                         -0.29613 0.1522
 POTS AND TRAPS; SPINY LOBSTER - REEL; ELECTRIC OR HYDRAULIC   -0.10701 0.0792
 POTS AND TRAPS; SPINY LOBSTER - ROD AND REEL                  -0.14170 0.0545
 POTS AND TRAPS; SPINY LOBSTER - ROD AND REEL; ELECTRIC (HAND) -0.04390 0.0752
 POTS AND TRAPS; SPINY LOBSTER - SPEARS; DIVING                -0.27176 0.1583
 REEL; ELECTRIC OR HYDRAULIC - ROD AND REEL                    -0.03469 0.0692
 REEL; ELECTRIC OR HYDRAULIC - ROD AND REEL; ELECTRIC (HAND)    0.06312 0.0867
 REEL; ELECTRIC OR HYDRAULIC - SPEARS; DIVING                  -0.16474 0.1642
 ROD AND REEL - ROD AND REEL; ELECTRIC (HAND)                   0.09781 0.0639
 ROD AND REEL - SPEARS; DIVING                                 -0.13005 0.1536
 ROD AND REEL; ELECTRIC (HAND) - SPEARS; DIVING                -0.22786 0.1621
  df z.ratio p.value
 Inf  -0.212  1.0000
 Inf  -0.239  1.0000
 Inf   0.450  1.0000
 Inf   0.124  1.0000
 Inf  -0.035  1.0000
 Inf  -0.691  0.9996
 Inf  -0.958  0.9944
 Inf  -0.304  1.0000
 Inf  -1.297  0.9547
 Inf  -0.049  1.0000
 Inf   1.057  0.9886
 Inf   1.042  0.9897
 Inf   0.408  1.0000
 Inf  -0.969  0.9939
 Inf  -1.988  0.6075
 Inf  -0.204  1.0000
 Inf  -1.522  0.8837
 Inf   1.206  0.9717
 Inf   4.000  0.0026
 Inf   0.630  0.9998
 Inf  -1.187  0.9744
 Inf  -3.819  0.0052
 Inf  -0.223  1.0000
 Inf  -1.586  0.8555
 Inf  -0.640  0.9998
 Inf  -0.800  0.9986
 Inf  -1.667  0.8143
 Inf  -2.267  0.4105
 Inf  -1.155  0.9788
 Inf  -1.990  0.6064
 Inf  -0.496  1.0000
 Inf  -2.034  0.5746
 Inf  -5.632  &lt;.0001
 Inf  -1.154  0.9789
 Inf  -1.946  0.6371
 Inf  -1.351  0.9415
 Inf  -2.600  0.2172
 Inf  -0.584  0.9999
 Inf  -1.717  0.7862
 Inf  -0.501  1.0000
 Inf   0.728  0.9993
 Inf  -1.003  0.9922
 Inf   1.531  0.8799
 Inf  -0.846  0.9978
 Inf  -1.406  0.9258

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 10 estimates </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME       emmean     SE  df asymp.LCL asymp.UCL .group
 POTS AND TRAPS; CMB             3.32 0.0970 Inf      3.13      3.51  123  
 POTS AND TRAPS; FISH            3.38 0.0134 Inf      3.35      3.41  1    
 BY HAND; DIVING GEAR            3.40 0.1513 Inf      3.10      3.69  123  
 POTS AND TRAPS; SPINY LOBSTER   3.40 0.0482 Inf      3.31      3.50  123  
 HAUL SEINES                     3.43 0.0508 Inf      3.33      3.53  123  
 LINES HAND                      3.43 0.0141 Inf      3.41      3.46   2   
 ROD AND REEL; ELECTRIC (HAND)   3.45 0.0592 Inf      3.33      3.56  123  
 REEL; ELECTRIC OR HYDRAULIC     3.51 0.0640 Inf      3.39      3.64  123  
 ROD AND REEL                    3.55 0.0287 Inf      3.49      3.60    3  
 SPEARS; DIVING                  3.68 0.1517 Inf      3.38      3.97  123  

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 10 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_2012 <span class="ot">&lt;-</span> multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>length_data_fishcount <span class="ot">&lt;-</span> length_data_glm_2012 <span class="sc">|&gt;</span> </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_fish =</span> <span class="fu">n</span>()) </span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_glm_2012 <span class="sc">|&gt;</span> </span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_fish_2012 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_2012, length_data_fishcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_trip_2012 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_fish_2012, length_data_tripcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_finaL_2012 <span class="ot">&lt;-</span> allgears_multcompcld_trip_2012 <span class="sc">|&gt;</span> </span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="st">".group"</span>,</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"n_distinct_ID"</span> <span class="ot">=</span> <span class="st">"n_distinct(ID)"</span>)</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgears_multcompcld_finaL_2012)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME       emmean     SE  df asymp.LCL asymp.UCL group
 POTS AND TRAPS; CMB             3.32 0.0970 Inf      3.13      3.51  123 
 POTS AND TRAPS; FISH            3.38 0.0134 Inf      3.35      3.41  1   
 BY HAND; DIVING GEAR            3.40 0.1513 Inf      3.10      3.69  123 
 POTS AND TRAPS; SPINY LOBSTER   3.40 0.0482 Inf      3.31      3.50  123 
 HAUL SEINES                     3.43 0.0508 Inf      3.33      3.53  123 
 LINES HAND                      3.43 0.0141 Inf      3.41      3.46   2  
 ROD AND REEL; ELECTRIC (HAND)   3.45 0.0592 Inf      3.33      3.56  123 
 REEL; ELECTRIC OR HYDRAULIC     3.51 0.0640 Inf      3.39      3.64  123 
 ROD AND REEL                    3.55 0.0287 Inf      3.49      3.60    3 
 SPEARS; DIVING                  3.68 0.1517 Inf      3.38      3.97  123 
 n_fish n_distinct_ID
      3             2
    829           158
      1             1
     29             7
     81             8
   7845           229
    124             6
    139             5
    330            23
      1             1

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 10 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgears_multcompcld_finaL_2012, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/sttj_yts_2012glm_allgears.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>group_2012 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>, <span class="st">"3"</span>))</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_fish[i]))</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_distinct_ID[i]))</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>allgear_glm_totals_2012 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_distinct_ID =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group_2012<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_finaL_2012<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_finaL_2012<span class="sc">$</span>n_distinct_ID[i]))),</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_fish =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group_2012<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_finaL_2012<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_finaL_2012<span class="sc">$</span>n_fish[i]))))</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgear_glm_totals_2012)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   group n_distinct_ID n_fish
1      1             2      3
2      2           158    829
3      3             1      1
4      1             7     29
5      2             8     81
6      3             6    124
7      1             5    139
8      2             1      1
9      3             2      3
10     1             1      1
11     2             7     29
12     3             8     81
13     1           229   7845
14     2             6    124
15     3             5    139
16     1             1      1
17     2             2      3
18     3             1      1
19     1             7     29
20     2             8     81
21     3             6    124
22     1             5    139
23     2            23    330
24     3             1      1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgear_glm_totals_2012, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/sttj_yts_2012glm_allgears_totals.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="hook-and-line" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="hook-and-line">Hook and Line</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_hookline_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_hookline_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_hookline_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-screen-inset">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_hl, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                        Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
scale(FINAL_DATE)       558.58  558.58     1  61.34 27.5380 2.028e-06 ***
LAND_STANDARD_GEAR_NAME 427.81  106.95     4 321.73  5.2727 0.0003993 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  9 97399.60
mod2    9 94348.12</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line gear p value is significant </span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_hl
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
mod3    5 94365 94404 -47178    94355                         
mod2    9 94348 94417 -47165    94330 25.098  4  4.808e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line date p value is significant </span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_hl
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC logLik deviance Chisq Df Pr(&gt;Chisq)    
mod4    8 94360 94422 -47172    94344                        
mod2    9 94348 94417 -47165    94330 14.27  1  0.0001584 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="do">### lines hand vs rod and reel and lines power troll other vs rod and reel are signifficantly different </span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>mod_contr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 LAND_STANDARD_GEAR_NAME       emmean     SE  df asymp.LCL asymp.UCL
 LINES HAND                      3.45 0.0133 Inf      3.42      3.48
 LINES POWER TROLL OTHER         3.41 0.0522 Inf      3.30      3.51
 REEL; ELECTRIC OR HYDRAULIC     3.54 0.0737 Inf      3.40      3.69
 ROD AND REEL                    3.59 0.0290 Inf      3.53      3.65
 ROD AND REEL; ELECTRIC (HAND)   3.47 0.0666 Inf      3.34      3.60

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 

$contrasts
 contrast                                                    estimate     SE
 LINES HAND - LINES POWER TROLL OTHER                          0.0428 0.0527
 LINES HAND - REEL; ELECTRIC OR HYDRAULIC                     -0.0911 0.0738
 LINES HAND - ROD AND REEL                                    -0.1420 0.0288
 LINES HAND - ROD AND REEL; ELECTRIC (HAND)                   -0.0170 0.0662
 LINES POWER TROLL OTHER - REEL; ELECTRIC OR HYDRAULIC        -0.1338 0.0915
 LINES POWER TROLL OTHER - ROD AND REEL                       -0.1848 0.0608
 LINES POWER TROLL OTHER - ROD AND REEL; ELECTRIC (HAND)      -0.0597 0.0850
 REEL; ELECTRIC OR HYDRAULIC - ROD AND REEL                   -0.0510 0.0781
 REEL; ELECTRIC OR HYDRAULIC - ROD AND REEL; ELECTRIC (HAND)   0.0741 0.0987
 ROD AND REEL - ROD AND REEL; ELECTRIC (HAND)                  0.1251 0.0704
  df z.ratio p.value
 Inf   0.811  0.9273
 Inf  -1.234  0.7316
 Inf  -4.926  &lt;.0001
 Inf  -0.256  0.9991
 Inf  -1.462  0.5872
 Inf  -3.037  0.0202
 Inf  -0.703  0.9560
 Inf  -0.652  0.9663
 Inf   0.751  0.9444
 Inf   1.777  0.3873

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 5 estimates </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="do">### suggestion: "lines power troll other", "lines hand" "rod and reel electric" and "reel electric or hydroulic" be grouped together</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="do">### "rod and reel" be kept separate </span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME       emmean     SE  df asymp.LCL asymp.UCL .group
 LINES POWER TROLL OTHER         3.41 0.0522 Inf      3.30      3.51  1    
 LINES HAND                      3.45 0.0133 Inf      3.42      3.48  1    
 ROD AND REEL; ELECTRIC (HAND)   3.47 0.0666 Inf      3.34      3.60  12   
 REEL; ELECTRIC OR HYDRAULIC     3.54 0.0737 Inf      3.40      3.69  12   
 ROD AND REEL                    3.59 0.0290 Inf      3.53      3.65   2   

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 5 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</section>
<section id="net" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="net">Net</h2>
<p>“GILL NETS; OTHER” not included because all 20 records are measured in standard length, i didn’t have a conversion for that</p>
<p>Adyan - The “GILL NETS: GL 1-2 IN” AND “GILL NETS: GL 2-4 IN” records we were thinking of are in STX, I’ll highlight those in the stx_yts document tomorrow.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_netstd_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_netstd_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_netstd_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="do">### both fixed linear and glm models have warning message because ENTANGLING NETS (GILL) UNSPECIFIED only occur in one year, preventing convergence across timeline </span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_nlsg, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                        Sum Sq Mean Sq NumDF  DenDF F value  Pr(&gt;F)  
scale(FINAL_DATE)       56.667  56.667     1 47.194  2.8882 0.09581 .
LAND_STANDARD_GEAR_NAME 30.189  15.095     2 44.851  0.7694 0.46933  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log)) </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  7 5780.378
mod2    7 5584.267</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="do">### net (using LAND_STANDARD_GEAR_NAME) does not have any significantly different gears </span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_nlsg
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod3    5 5580.4 5604.8 -2785.2   5570.4                     
mod2    7 5584.3 5618.4 -2785.1   5570.3 0.1426  2     0.9312</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="do">### There is no significantly different time in the Net grouping </span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_nlsg
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod4    6 5583.4 5612.6 -2785.7   5571.4                     
mod2    7 5584.3 5618.4 -2785.1   5570.3 1.0955  1     0.2953</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="do">### no significant p values for time period or gears, further comparisons not needed </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell column-page">

</div>
<div class="cell column-page">

</div>
</section>
<section id="trap" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="trap">Trap</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_trap_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_trap_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_trap_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_tr, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                        Sum Sq Mean Sq NumDF  DenDF F value  Pr(&gt;F)  
scale(FINAL_DATE)       40.959  40.959     1 474.43  4.7854 0.02919 *
LAND_STANDARD_GEAR_NAME 24.781   8.260     3 536.62  0.9651 0.40888  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  8 11813.57
mod2    8 11203.24</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="do">### Trap does not have any significantly different gears </span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_tr
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod3    5 11199 11227 -5594.3    11189                     
mod2    8 11203 11249 -5593.6    11187 1.3628  3     0.7143</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="do">### There is no significantly different time in the Trap grouping </span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_tr
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod4    7 11203 11243 -5594.4    11189                     
mod2    8 11203 11249 -5593.6    11187 1.4656  1      0.226</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No significant p values for time period or gears, further comparisons not needed </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="gear-density-plots" class="level1 page-columns page-full">
<h1>Gear Density Plots</h1>
<p>Filtered to years with 30 or more length records (regardless of gear) per year. STT and STJ records are grouped together.</p>
<section id="aggregated-density-plots" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="aggregated-density-plots">Aggregated density plots</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/agg_pdf_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>USVI TIP length comps by gear and interview type. Investigate if MARFIN and MRAG interview types can be used or should be dropped?</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="gear-grouping-investigation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="gear-grouping-investigation">Gear grouping investigation</h2>
<p>Filtered to minimum 30 fish per year</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_hl_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_trap_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_net_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_other_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="break-at-2005" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="break-at-2005">Break at 2005</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_plot_2005-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_hookandline_plot_2005-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_net_plot_2005-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_trap_plot_2005-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_other_plot_2005-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="annual-density-plots" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="annual-density-plots">Annual Density plots</h2>
<p>This will be split by final gear aggregations once these are decided, removes “other” gear types.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/annual_pdf_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell column-page">

</div>
</section>
</section>
<section id="stacked-bar-charts" class="level1 page-columns page-full">
<h1>Stacked bar charts</h1>
<section id="visual-representation-of-gear-distribution-within-groupings" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="visual-representation-of-gear-distribution-within-groupings">Visual representation of gear distribution within groupings</h4>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_plot-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
</section>
<section id="gear-distribution-across-time-by-gear-groupings" class="level1 page-columns page-full">
<h1>Gear distribution across time by gear groupings</h1>
<section id="all-gears-over-time" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="all-gears-over-time">All gears over time</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="1440"></p>
<figcaption class="figure-caption">Stoplight Parrotfish LAND_STANDARD_GEAR_NAME STX</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="hook-and-line-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="hook-and-line-gear-distribution-over-time-by-year">Hook and Line Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_hl_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell column-page">

</div>
</section>
<section id="trap-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="trap-gear-distribution-over-time-by-year">Trap Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_tr_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="diving-gear-distribution-over-time-by-year---no-gear-grouping" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="diving-gear-distribution-over-time-by-year---no-gear-grouping">Diving Gear Distribution Over Time by Year - NO GEAR GROUPING</h2>
<div class="cell column-page">

</div>
</section>
<section id="net-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="net-gear-distribution-over-time-by-year">Net Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_net_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="spear-gear-distribution-over-time-by-year---no-grouping" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="spear-gear-distribution-over-time-by-year---no-grouping">Spear Gear Distribution Over Time by Year - NO GROUPING</h2>
<div class="cell column-page">

</div>
</section>
<section id="other-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="other-gear-distribution-over-time-by-year">Other Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_ot_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
</section>
<section id="cummulative-density-plots" class="level1 page-columns page-full">
<h1>Cummulative Density Plots</h1>
<section id="aggregated-cdf" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="aggregated-cdf">Aggregated CDF</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/agg_cdf_plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="management-periods" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="management-periods">Management periods*</h2>
<p><strong>This section is optional and may be empty if there are not signifcant changes</strong></p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_cdf_plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="annual-cdf" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="annual-cdf">Annual CDF</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/annual_cdf_plot-1.png" class="img-fluid" width="864"></p>
</div>
</div>
</section>
</section>
<section id="island-density-plots" class="level1 page-columns page-full">
<h1>Island Density Plots</h1>
<section id="aggregated-density-plots-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="aggregated-density-plots-1">Aggregated density plots</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/agg_pdf_plot_reg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="management-periods-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="management-periods-1">Management periods*</h2>
<p><strong>This section is optional and may be empty if there are not significant changes</strong></p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_pdf_plot_reg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="annual-density-plots-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="annual-density-plots-1">Annual Density plots</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="sttj_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/annual_pdf_plot_reg-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<div class="cell column-page">

</div>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb128" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "sttj_yt_sedar84_sizecomp_landstdgearname"</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Katherine Godwin"</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="an">toc_expand:</span><span class="co"> true</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 4</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>This script will be expanding upon the length-comp script c1_nominal_len_comps.Rmd created by Molly Stevens.</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="fu"># Yellowtail Snapper STTJ</span></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up library </span></span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a>librarian<span class="sc">::</span><span class="fu">shelf</span>(here, tidyverse, ROracle, keyring, dotenv, reshape, openxlsx, janitor, DT, pander, knitr) <span class="co">#plyr</span></span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a><span class="co"># if conflicts in pkgs arise, use the following:</span></span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a><span class="co"># library(conflicted)</span></span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a><span class="co"># conflicted::conflicts_prefer(here::here)</span></span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a><span class="co">#pull data by island</span></span>
<span id="cb128-33"><a href="#cb128-33" aria-hidden="true" tabindex="-1"></a><span class="co"># cr_tip(state_codes = c('PR', 'VI'))</span></span>
<span id="cb128-34"><a href="#cb128-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-35"><a href="#cb128-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find out the date of the most recent extraction</span></span>
<span id="cb128-36"><a href="#cb128-36" aria-hidden="true" tabindex="-1"></a>tip_date <span class="ot">&lt;-</span> <span class="fu">max</span>(</span>
<span id="cb128-37"><a href="#cb128-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">".*?([0-9]+).RDS*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>,</span>
<span id="cb128-38"><a href="#cb128-38" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">list.files</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"raw"</span>),</span>
<span id="cb128-39"><a href="#cb128-39" aria-hidden="true" tabindex="-1"></a>                             <span class="at">pattern =</span> <span class="st">"com_tip_PR_VI"</span>))))</span>
<span id="cb128-40"><a href="#cb128-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-41"><a href="#cb128-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out the name of the most recent extraction</span></span>
<span id="cb128-42"><a href="#cb128-42" aria-hidden="true" tabindex="-1"></a>tip_file <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"raw"</span>),</span>
<span id="cb128-43"><a href="#cb128-43" aria-hidden="true" tabindex="-1"></a>                       <span class="at">pattern =</span> <span class="fu">paste0</span>(<span class="st">"^com_tip_PR_VI_+"</span>, tip_date))</span>
<span id="cb128-44"><a href="#cb128-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-45"><a href="#cb128-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-46"><a href="#cb128-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the most recent extraction</span></span>
<span id="cb128-47"><a href="#cb128-47" aria-hidden="true" tabindex="-1"></a>tip <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"raw"</span>, tip_file))</span>
<span id="cb128-48"><a href="#cb128-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-49"><a href="#cb128-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to STTJ and Yellowtail Snapper AND create new filterable date value </span></span>
<span id="cb128-50"><a href="#cb128-50" aria-hidden="true" tabindex="-1"></a>sttj_yt <span class="ot">&lt;-</span> tip <span class="sc">|&gt;</span> </span>
<span id="cb128-51"><a href="#cb128-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(COUNTY_LANDED <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"ST THOMAS"</span>, <span class="st">"ST JOHN"</span>),</span>
<span id="cb128-52"><a href="#cb128-52" aria-hidden="true" tabindex="-1"></a>         OBS_STANDARD_SPECIES_CODE <span class="sc">==</span> <span class="st">"168907"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb128-53"><a href="#cb128-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TEST_DATE =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(INTERVIEW_DATE)),</span>
<span id="cb128-54"><a href="#cb128-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">FINAL_DATE =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(TEST_DATE) <span class="sc">~</span> INTERVIEW_DATE, </span>
<span id="cb128-55"><a href="#cb128-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span> <span class="sc">~</span> TEST_DATE))</span>
<span id="cb128-56"><a href="#cb128-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-57"><a href="#cb128-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-58"><a href="#cb128-58" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/functions/len_len_convert.R"</span>)</span>
<span id="cb128-59"><a href="#cb128-59" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/functions/fig_format_export.R"</span>)</span>
<span id="cb128-60"><a href="#cb128-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-61"><a href="#cb128-61" aria-hidden="true" tabindex="-1"></a>LLconv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/CSVs/LLconversions.csv"</span>,</span>
<span id="cb128-62"><a href="#cb128-62" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-63"><a href="#cb128-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-64"><a href="#cb128-64" aria-hidden="true" tabindex="-1"></a>TIP_gears <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/CSVs/tip_gears_yts_sttj_landstdgearname.csv"</span>,</span>
<span id="cb128-65"><a href="#cb128-65" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-66"><a href="#cb128-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-67"><a href="#cb128-67" aria-hidden="true" tabindex="-1"></a>gearcols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Net"</span> <span class="ot">=</span> <span class="st">"#FF0000"</span>, <span class="st">"Trap"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"#5D057D"</span>, <span class="st">"Hook and Line"</span> <span class="ot">=</span><span class="st">"#046C9A"</span>, <span class="st">"Gill Net"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Haul Seine"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Lobster Trap"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Trammel Net"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Combined"</span> <span class="ot">=</span> <span class="st">"black"</span>)</span>
<span id="cb128-68"><a href="#cb128-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-69"><a href="#cb128-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-70"><a href="#cb128-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-71"><a href="#cb128-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-72"><a href="#cb128-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-73"><a href="#cb128-73" aria-hidden="true" tabindex="-1"></a><span class="fu">## Control Settings and Exploratory Frequency Tables</span></span>
<span id="cb128-74"><a href="#cb128-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-77"><a href="#cb128-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-78"><a href="#cb128-78" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-79"><a href="#cb128-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-80"><a href="#cb128-80" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="st">"YTS"</span></span>
<span id="cb128-81"><a href="#cb128-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-82"><a href="#cb128-82" aria-hidden="true" tabindex="-1"></a>region <span class="ot">&lt;-</span> <span class="st">"PUERTO RICO - USVI"</span></span>
<span id="cb128-83"><a href="#cb128-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-84"><a href="#cb128-84" aria-hidden="true" tabindex="-1"></a>county <span class="ot">&lt;-</span> <span class="st">"ST THOMAS/ST JOHN"</span></span>
<span id="cb128-85"><a href="#cb128-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-86"><a href="#cb128-86" aria-hidden="true" tabindex="-1"></a>bin_size <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb128-87"><a href="#cb128-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-88"><a href="#cb128-88" aria-hidden="true" tabindex="-1"></a>len_type <span class="ot">&lt;-</span> <span class="st">"FORK LENGTH"</span></span>
<span id="cb128-89"><a href="#cb128-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-90"><a href="#cb128-90" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LENGTH_TYPE1, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb128-91"><a href="#cb128-91" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LENGTH_TYPE2, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb128-92"><a href="#cb128-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-93"><a href="#cb128-93" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(sttj_yt<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-94"><a href="#cb128-94" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(sttj_yt<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-95"><a href="#cb128-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-96"><a href="#cb128-96" aria-hidden="true" tabindex="-1"></a>tip_range  <span class="ot">&lt;-</span> sttj_yt[<span class="fu">with</span>(sttj_yt,<span class="fu">order</span>(<span class="sc">-</span>LENGTH1_MM)),]</span>
<span id="cb128-97"><a href="#cb128-97" aria-hidden="true" tabindex="-1"></a>tip_range<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span>
<span id="cb128-98"><a href="#cb128-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-99"><a href="#cb128-99" aria-hidden="true" tabindex="-1"></a>tip_range2 <span class="ot">&lt;-</span> sttj_yt[<span class="fu">with</span>(sttj_yt,<span class="fu">order</span>(LENGTH1_MM)),]</span>
<span id="cb128-100"><a href="#cb128-100" aria-hidden="true" tabindex="-1"></a>tip_range2<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span>
<span id="cb128-101"><a href="#cb128-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-102"><a href="#cb128-102" aria-hidden="true" tabindex="-1"></a><span class="do">##range currently set to not drop any obs (centimeters)</span></span>
<span id="cb128-103"><a href="#cb128-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-104"><a href="#cb128-104" aria-hidden="true" tabindex="-1"></a>min_size <span class="ot">&lt;-</span> <span class="dv">14</span> </span>
<span id="cb128-105"><a href="#cb128-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-106"><a href="#cb128-106" aria-hidden="true" tabindex="-1"></a>max_size <span class="ot">&lt;-</span> <span class="dv">80</span>   </span>
<span id="cb128-107"><a href="#cb128-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-108"><a href="#cb128-108" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(sttj_yt<span class="sc">$</span>YEAR,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-109"><a href="#cb128-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-110"><a href="#cb128-110" aria-hidden="true" tabindex="-1"></a>min_year <span class="ot">&lt;-</span> <span class="dv">1983</span></span>
<span id="cb128-111"><a href="#cb128-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-112"><a href="#cb128-112" aria-hidden="true" tabindex="-1"></a>max_year <span class="ot">&lt;-</span> <span class="dv">2022</span> </span>
<span id="cb128-113"><a href="#cb128-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-114"><a href="#cb128-114" aria-hidden="true" tabindex="-1"></a>break_year <span class="ot">&lt;-</span> <span class="dv">2005</span> <span class="co"># this is an optional value to denote a change in management. inclusive on the upper bound. can be set to NA if not relevant.  2005 trap specifications were updated and many closures went into place</span></span>
<span id="cb128-115"><a href="#cb128-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-116"><a href="#cb128-116" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb128-117"><a href="#cb128-117" aria-hidden="true" tabindex="-1"></a><span class="do">##  TABLES START HERE </span></span>
<span id="cb128-118"><a href="#cb128-118" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb128-119"><a href="#cb128-119" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb128-120"><a href="#cb128-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-121"><a href="#cb128-121" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb128-122"><a href="#cb128-122" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, sttj_yt<span class="sc">$</span>STATE_LANDED, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb128-123"><a href="#cb128-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-124"><a href="#cb128-124" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>FISHING_MODE, sttj_yt<span class="sc">$</span>INT_TYPE, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb128-125"><a href="#cb128-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-126"><a href="#cb128-126" aria-hidden="true" tabindex="-1"></a><span class="co"># marfin &lt;- sttj_yt%&gt;%</span></span>
<span id="cb128-127"><a href="#cb128-127" aria-hidden="true" tabindex="-1"></a><span class="co">#             filter(INT_TYPE == "USVI MARFIN REEFFISH SAMPLING")</span></span>
<span id="cb128-128"><a href="#cb128-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-129"><a href="#cb128-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-130"><a href="#cb128-130" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>YEAR,sttj_yt<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb128-131"><a href="#cb128-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-132"><a href="#cb128-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-133"><a href="#cb128-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-136"><a href="#cb128-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-137"><a href="#cb128-137" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-138"><a href="#cb128-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-139"><a href="#cb128-139" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>COUNTY_LANDED,sttj_yt<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb128-140"><a href="#cb128-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-141"><a href="#cb128-141" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>YEAR,sttj_yt<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb128-142"><a href="#cb128-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-143"><a href="#cb128-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-144"><a href="#cb128-144" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Filter to Commercial samples</span></span>
<span id="cb128-145"><a href="#cb128-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-148"><a href="#cb128-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-149"><a href="#cb128-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-150"><a href="#cb128-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-151"><a href="#cb128-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-152"><a href="#cb128-152" aria-hidden="true" tabindex="-1"></a><span class="do">################## PICK VARIABLES THAT I NEED HERE ;</span></span>
<span id="cb128-153"><a href="#cb128-153" aria-hidden="true" tabindex="-1"></a><span class="do">################## ASSIGN GEARS, ETC. BASED ON FLOW CHART</span></span>
<span id="cb128-154"><a href="#cb128-154" aria-hidden="true" tabindex="-1"></a><span class="do">## FILTER OUT COMMERCIAL SAMPLES</span></span>
<span id="cb128-155"><a href="#cb128-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-156"><a href="#cb128-156" aria-hidden="true" tabindex="-1"></a>tip2 <span class="ot">&lt;-</span> <span class="co">#readRDS('./data_clean/tip_GOM.Rdata') %&gt;%</span></span>
<span id="cb128-157"><a href="#cb128-157" aria-hidden="true" tabindex="-1"></a>  sttj_yt <span class="sc">%&gt;%</span></span>
<span id="cb128-158"><a href="#cb128-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( <span class="co">#MULT_TRIP == '0')%&gt;%  ##no mult_trip in Caribbean TIP --&gt; ALL full catch samples</span></span>
<span id="cb128-159"><a href="#cb128-159" aria-hidden="true" tabindex="-1"></a>    FISHING_MODE<span class="sc">==</span><span class="st">'COMMERCIAL'</span>,</span>
<span id="cb128-160"><a href="#cb128-160" aria-hidden="true" tabindex="-1"></a>    LENGTH_TYPE1<span class="sc">!=</span><span class="st">'NO LENGTH'</span>,</span>
<span id="cb128-161"><a href="#cb128-161" aria-hidden="true" tabindex="-1"></a>    YEAR <span class="sc">&lt;=</span> <span class="dv">2023</span></span>
<span id="cb128-162"><a href="#cb128-162" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb128-163"><a href="#cb128-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type_convert</span>() <span class="sc">%&gt;%</span></span>
<span id="cb128-164"><a href="#cb128-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">REGION_NAME =</span> region,</span>
<span id="cb128-165"><a href="#cb128-165" aria-hidden="true" tabindex="-1"></a>         <span class="at">OBS_STANDARD_SPECIES_CODE =</span> <span class="fu">as.numeric</span>(OBS_STANDARD_SPECIES_CODE), </span>
<span id="cb128-166"><a href="#cb128-166" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb128-167"><a href="#cb128-167" aria-hidden="true" tabindex="-1"></a><span class="do">####################SARAH'S CORRECTIONS NOW FIXED IN TIP DATABASE   </span></span>
<span id="cb128-168"><a href="#cb128-168" aria-hidden="true" tabindex="-1"></a><span class="co">#         COUNTY_LANDED = ifelse((YEAR==2018 &amp; COUNTY_LANDED=='NOT CODED'), 'ST THOMAS',</span></span>
<span id="cb128-169"><a href="#cb128-169" aria-hidden="true" tabindex="-1"></a><span class="co">#                                ifelse((YEAR==2017 &amp; COUNTY_LANDED=='NOT CODED'), 'ST CROIX', COUNTY_LANDED)),</span></span>
<span id="cb128-170"><a href="#cb128-170" aria-hidden="true" tabindex="-1"></a><span class="co">#         LENGTH1     = ifelse(LENGTH1_MM&gt;2000, LENGTH1/10, LENGTH1),</span></span>
<span id="cb128-171"><a href="#cb128-171" aria-hidden="true" tabindex="-1"></a><span class="co">#         LENGTH1_MM  = ifelse(LENGTH1_MM&gt;2000, LENGTH1_MM/10,LENGTH1_MM),</span></span>
<span id="cb128-172"><a href="#cb128-172" aria-hidden="true" tabindex="-1"></a><span class="do">####################</span></span>
<span id="cb128-173"><a href="#cb128-173" aria-hidden="true" tabindex="-1"></a>         <span class="at">source      =</span> <span class="st">"TIP"</span>, </span>
<span id="cb128-174"><a href="#cb128-174" aria-hidden="true" tabindex="-1"></a>         <span class="at">YTS         =</span> <span class="fu">ifelse</span>(OBS_STANDARD_SPECIES_CODE<span class="sc">==</span><span class="dv">168907</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="co">#binary flag for queen triggerfish vs 'other'</span></span>
<span id="cb128-175"><a href="#cb128-175" aria-hidden="true" tabindex="-1"></a>         <span class="at">ISLAND      =</span> <span class="fu">ifelse</span>(STATE_LANDED<span class="sc">==</span><span class="st">'PUERTO RICO'</span>, STATE_LANDED, COUNTY_LANDED),</span>
<span id="cb128-176"><a href="#cb128-176" aria-hidden="true" tabindex="-1"></a>         <span class="co">#STAT_AREA = ifelse(STANDARDAREA_1&gt;1, STANDARDAREA_1, LAND_STANDARD_AREA_ID),</span></span>
<span id="cb128-177"><a href="#cb128-177" aria-hidden="true" tabindex="-1"></a>         <span class="at">OBS_ID      =</span> <span class="fu">as.character</span>(OBS_ID)</span>
<span id="cb128-178"><a href="#cb128-178" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb128-179"><a href="#cb128-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(REGION_NAME,</span>
<span id="cb128-180"><a href="#cb128-180" aria-hidden="true" tabindex="-1"></a>         source,</span>
<span id="cb128-181"><a href="#cb128-181" aria-hidden="true" tabindex="-1"></a>         ID,</span>
<span id="cb128-182"><a href="#cb128-182" aria-hidden="true" tabindex="-1"></a>         INTERVIEW_DATE,</span>
<span id="cb128-183"><a href="#cb128-183" aria-hidden="true" tabindex="-1"></a>         FINAL_DATE,</span>
<span id="cb128-184"><a href="#cb128-184" aria-hidden="true" tabindex="-1"></a>         FISHING_MODE,</span>
<span id="cb128-185"><a href="#cb128-185" aria-hidden="true" tabindex="-1"></a>         INT_TYPE,</span>
<span id="cb128-186"><a href="#cb128-186" aria-hidden="true" tabindex="-1"></a>         <span class="at">YEAR =</span> YEAR,</span>
<span id="cb128-187"><a href="#cb128-187" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITIS_CODE   =</span> OBS_STANDARD_SPECIES_CODE,</span>
<span id="cb128-188"><a href="#cb128-188" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPECIES     =</span> OBS_STANDARD_SPECIES_NAME,</span>
<span id="cb128-189"><a href="#cb128-189" aria-hidden="true" tabindex="-1"></a>         QUANTITY,</span>
<span id="cb128-190"><a href="#cb128-190" aria-hidden="true" tabindex="-1"></a>         YTS,</span>
<span id="cb128-191"><a href="#cb128-191" aria-hidden="true" tabindex="-1"></a>         STATE_LANDED,</span>
<span id="cb128-192"><a href="#cb128-192" aria-hidden="true" tabindex="-1"></a>         COUNTY_LANDED,</span>
<span id="cb128-193"><a href="#cb128-193" aria-hidden="true" tabindex="-1"></a>         <span class="at">COUNTY_CODE=</span>LANDING_AREA_COUNTY_CODE,</span>
<span id="cb128-194"><a href="#cb128-194" aria-hidden="true" tabindex="-1"></a>         PLACE_LANDED,</span>
<span id="cb128-195"><a href="#cb128-195" aria-hidden="true" tabindex="-1"></a>         DEALER,</span>
<span id="cb128-196"><a href="#cb128-196" aria-hidden="true" tabindex="-1"></a>         DEALER_CODE,</span>
<span id="cb128-197"><a href="#cb128-197" aria-hidden="true" tabindex="-1"></a>         ISLAND,</span>
<span id="cb128-198"><a href="#cb128-198" aria-hidden="true" tabindex="-1"></a>         OBS_WEIGHT_KG,</span>
<span id="cb128-199"><a href="#cb128-199" aria-hidden="true" tabindex="-1"></a>         LENGTH1_MM,</span>
<span id="cb128-200"><a href="#cb128-200" aria-hidden="true" tabindex="-1"></a>         LENGTH1,</span>
<span id="cb128-201"><a href="#cb128-201" aria-hidden="true" tabindex="-1"></a>         LENGTH_TYPE1,</span>
<span id="cb128-202"><a href="#cb128-202" aria-hidden="true" tabindex="-1"></a>         LENGTH_UNIT1,</span>
<span id="cb128-203"><a href="#cb128-203" aria-hidden="true" tabindex="-1"></a>         OBS_ID,</span>
<span id="cb128-204"><a href="#cb128-204" aria-hidden="true" tabindex="-1"></a>         LAND_STANDARD_GEAR_NAME,</span>
<span id="cb128-205"><a href="#cb128-205" aria-hidden="true" tabindex="-1"></a>         LAND_GEAR_NAME,</span>
<span id="cb128-206"><a href="#cb128-206" aria-hidden="true" tabindex="-1"></a>         LANDING_TYPE,</span>
<span id="cb128-207"><a href="#cb128-207" aria-hidden="true" tabindex="-1"></a>         BIAS_TYPE,</span>
<span id="cb128-208"><a href="#cb128-208" aria-hidden="true" tabindex="-1"></a>         VESSEL_ID,</span>
<span id="cb128-209"><a href="#cb128-209" aria-hidden="true" tabindex="-1"></a>         LICENSE,</span>
<span id="cb128-210"><a href="#cb128-210" aria-hidden="true" tabindex="-1"></a>         SAMPLE_ID,</span>
<span id="cb128-211"><a href="#cb128-211" aria-hidden="true" tabindex="-1"></a>         AREA_1,</span>
<span id="cb128-212"><a href="#cb128-212" aria-hidden="true" tabindex="-1"></a>         AREANAME_1,</span>
<span id="cb128-213"><a href="#cb128-213" aria-hidden="true" tabindex="-1"></a>         STANDARDAREA_1,</span>
<span id="cb128-214"><a href="#cb128-214" aria-hidden="true" tabindex="-1"></a>         STANDARDAREANAME_1,</span>
<span id="cb128-215"><a href="#cb128-215" aria-hidden="true" tabindex="-1"></a>         AGENT_USERNAME_ID,</span>
<span id="cb128-216"><a href="#cb128-216" aria-hidden="true" tabindex="-1"></a>         DEALER_CODE,</span>
<span id="cb128-217"><a href="#cb128-217" aria-hidden="true" tabindex="-1"></a>         VESSEL_ID</span>
<span id="cb128-218"><a href="#cb128-218" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb128-219"><a href="#cb128-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-220"><a href="#cb128-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-221"><a href="#cb128-221" aria-hidden="true" tabindex="-1"></a>Length composition after filtering to commercial records</span>
<span id="cb128-222"><a href="#cb128-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-225"><a href="#cb128-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-226"><a href="#cb128-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-227"><a href="#cb128-227" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-228"><a href="#cb128-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-229"><a href="#cb128-229" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>COUNTY_LANDED,tip2<span class="sc">$</span>ISLAND,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb128-230"><a href="#cb128-230" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>YEAR,tip2<span class="sc">$</span>ISLAND,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb128-231"><a href="#cb128-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-232"><a href="#cb128-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-233"><a href="#cb128-233" aria-hidden="true" tabindex="-1"></a>lencheck <span class="ot">&lt;-</span> tip2[tip2<span class="sc">$</span>LENGTH1_MM<span class="sc">&gt;</span><span class="dv">2000</span>,] <span class="co">#no lengths greater than 2000</span></span>
<span id="cb128-234"><a href="#cb128-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-235"><a href="#cb128-235" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range  &lt;- tip2[with(tip2,order(-LENGTH1_MM)),]</span></span>
<span id="cb128-236"><a href="#cb128-236" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range$LENGTH1_MM[1:25]</span></span>
<span id="cb128-237"><a href="#cb128-237" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-238"><a href="#cb128-238" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range2 &lt;- tip2[with(tip2,order(LENGTH1_MM)),]</span></span>
<span id="cb128-239"><a href="#cb128-239" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range2$LENGTH1_MM[1:25]</span></span>
<span id="cb128-240"><a href="#cb128-240" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>LENGTH_TYPE1,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb128-241"><a href="#cb128-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-242"><a href="#cb128-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-243"><a href="#cb128-243" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb128-244"><a href="#cb128-244" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-245"><a href="#cb128-245" aria-hidden="true" tabindex="-1"></a><span class="co"># table(tip2$ITIS_CODE,tip2$SPECIES,useNA='always')</span></span>
<span id="cb128-246"><a href="#cb128-246" aria-hidden="true" tabindex="-1"></a><span class="co"># table(tip2$SPECIES,tip2$YTS,useNA='always')</span></span>
<span id="cb128-247"><a href="#cb128-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-248"><a href="#cb128-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-249"><a href="#cb128-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-250"><a href="#cb128-250" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract marfin samples, look at island distribution</span></span>
<span id="cb128-251"><a href="#cb128-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-254"><a href="#cb128-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb128-255"><a href="#cb128-255" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-256"><a href="#cb128-256" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-257"><a href="#cb128-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-258"><a href="#cb128-258" aria-hidden="true" tabindex="-1"></a><span class="do">##extract marfin samples, look at island distribution</span></span>
<span id="cb128-259"><a href="#cb128-259" aria-hidden="true" tabindex="-1"></a>marfin <span class="ot">&lt;-</span> tip2<span class="sc">%&gt;%</span></span>
<span id="cb128-260"><a href="#cb128-260" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(INT_TYPE <span class="sc">==</span> <span class="st">"USVI MARFIN REEFFISH SAMPLING"</span>)</span>
<span id="cb128-261"><a href="#cb128-261" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(marfin<span class="sc">$</span>YEAR, marfin<span class="sc">$</span>ISLAND,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb128-262"><a href="#cb128-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-263"><a href="#cb128-263" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(marfin<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, marfin<span class="sc">$</span>ISLAND,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb128-264"><a href="#cb128-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-265"><a href="#cb128-265" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(marfin<span class="sc">$</span>LAND_STANDARD_GEAR_NAME,marfin<span class="sc">$</span>YEAR, marfin<span class="sc">$</span>ISLAND,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb128-266"><a href="#cb128-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-267"><a href="#cb128-267" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>YEAR,tip2<span class="sc">$</span>LENGTH_TYPE1,<span class="at">useNA=</span><span class="st">'always'</span>)  <span class="do">##TL more prevalent in recent years</span></span>
<span id="cb128-268"><a href="#cb128-268" aria-hidden="true" tabindex="-1"></a><span class="co"># table(tip2$LENGTH_TYPE1,tip2$LENGTH_TYPE2,useNA='always') </span></span>
<span id="cb128-269"><a href="#cb128-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-270"><a href="#cb128-270" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>ISLAND,tip2<span class="sc">$</span>STATE_LANDED)</span>
<span id="cb128-271"><a href="#cb128-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-272"><a href="#cb128-272" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tip2$LENGTH1_MM,tip2$OBS_WEIGHT_KG,color=tip2$LENGTH_TYPE1)</span></span>
<span id="cb128-273"><a href="#cb128-273" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tip2$LENGTH1_MM,tip2$SAMPLE_WEIGHT_KG)</span></span>
<span id="cb128-274"><a href="#cb128-274" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tip2$LENGTH1_MM,tip2$SUB_SAMPLE_WEIGHT_KG)</span></span>
<span id="cb128-275"><a href="#cb128-275" aria-hidden="true" tabindex="-1"></a>tip2<span class="sc">$</span>yearc <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tip2<span class="sc">$</span>YEAR)</span>
<span id="cb128-276"><a href="#cb128-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-277"><a href="#cb128-277" aria-hidden="true" tabindex="-1"></a><span class="do">##############export all plots starting w/ year&gt;=2015, all islands</span></span>
<span id="cb128-278"><a href="#cb128-278" aria-hidden="true" tabindex="-1"></a><span class="do">#### here, isolated ST THOMAS 2018 for bulk of problems w single port sampler</span></span>
<span id="cb128-279"><a href="#cb128-279" aria-hidden="true" tabindex="-1"></a><span class="do">#### create new RMarkdown script describing this issue for internal distribution</span></span>
<span id="cb128-280"><a href="#cb128-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-281"><a href="#cb128-281" aria-hidden="true" tabindex="-1"></a><span class="co"># tip2[(tip2$YEAR==2018 &amp; tip2$ISLAND=='ST THOMAS'),] %&gt;%</span></span>
<span id="cb128-282"><a href="#cb128-282" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(LENGTH1_MM,OBS_WEIGHT_KG))+</span></span>
<span id="cb128-283"><a href="#cb128-283" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(color = AGENT_USERNAME_ID))  +  ##fork length is splitting</span></span>
<span id="cb128-284"><a href="#cb128-284" aria-hidden="true" tabindex="-1"></a><span class="co">#   # geom_point(aes(color = ISLAND))  +</span></span>
<span id="cb128-285"><a href="#cb128-285" aria-hidden="true" tabindex="-1"></a><span class="co">#   #labs(title = paste0(tip2$ISLAND,  "\n", min(tip2$YEAR), "-", max(tip2$YEAR)))+</span></span>
<span id="cb128-286"><a href="#cb128-286" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span>
<span id="cb128-287"><a href="#cb128-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-288"><a href="#cb128-288" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################################</span></span>
<span id="cb128-289"><a href="#cb128-289" aria-hidden="true" tabindex="-1"></a><span class="do">##### merge in gear tables </span></span>
<span id="cb128-290"><a href="#cb128-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-291"><a href="#cb128-291" aria-hidden="true" tabindex="-1"></a><span class="do">##LOOK AT GEAR ASSIGNMENTS BY SPECIES</span></span>
<span id="cb128-292"><a href="#cb128-292" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sttj_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, sttj_yt<span class="sc">$</span>STANDARDGEARNAME_2)</span>
<span id="cb128-293"><a href="#cb128-293" aria-hidden="true" tabindex="-1"></a><span class="co">#table(sttj_yt$GEAR, useNA='always')  ##N gears?</span></span>
<span id="cb128-294"><a href="#cb128-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-295"><a href="#cb128-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-296"><a href="#cb128-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-297"><a href="#cb128-297" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Add gear groupings, NO length-length conversions available</span></span>
<span id="cb128-298"><a href="#cb128-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-299"><a href="#cb128-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb128-300"><a href="#cb128-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-301"><a href="#cb128-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-302"><a href="#cb128-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-303"><a href="#cb128-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-304"><a href="#cb128-304" aria-hidden="true" tabindex="-1"></a><span class="do">###add length-length conversions to helper_table ; </span></span>
<span id="cb128-305"><a href="#cb128-305" aria-hidden="true" tabindex="-1"></a>tip3 <span class="ot">&lt;-</span> <span class="fu">merge</span>(tip2, TIP_gears, <span class="at">by.x=</span><span class="st">"LAND_STANDARD_GEAR_NAME"</span>,<span class="at">all.x=</span>T)</span>
<span id="cb128-306"><a href="#cb128-306" aria-hidden="true" tabindex="-1"></a><span class="co">#gfin2a &lt;- merge(gfin, flc, by.x=c("State_Landed","County_Landed"),all.x=T)</span></span>
<span id="cb128-307"><a href="#cb128-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-308"><a href="#cb128-308" aria-hidden="true" tabindex="-1"></a>tip4 <span class="ot">&lt;-</span> tip3[tip3<span class="sc">$</span>YTS<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb128-309"><a href="#cb128-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-310"><a href="#cb128-310" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip3<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, tip3<span class="sc">$</span>gear, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb128-311"><a href="#cb128-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-312"><a href="#cb128-312" aria-hidden="true" tabindex="-1"></a><span class="co">#gear_groups &lt;- c("HAND LINE", "LONGLINE") </span></span>
<span id="cb128-313"><a href="#cb128-313" aria-hidden="true" tabindex="-1"></a>gear_groups <span class="ot">&lt;-</span> <span class="fu">unique</span>(TIP_gears<span class="sc">$</span>gear)</span>
<span id="cb128-314"><a href="#cb128-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-315"><a href="#cb128-315" aria-hidden="true" tabindex="-1"></a><span class="co"># antiforklength &lt;- tip4 |&gt;</span></span>
<span id="cb128-316"><a href="#cb128-316" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(LENGTH_TYPE1 != "FORK LENGTH")</span></span>
<span id="cb128-317"><a href="#cb128-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-318"><a href="#cb128-318" aria-hidden="true" tabindex="-1"></a><span class="do">##splitting here to more easily qa/qc above</span></span>
<span id="cb128-319"><a href="#cb128-319" aria-hidden="true" tabindex="-1"></a>join_length_dat <span class="ot">&lt;-</span> tip4 <span class="sc">%&gt;%</span> <span class="co">#bind_rows(tip3 , gfin2) %&gt;%</span></span>
<span id="cb128-320"><a href="#cb128-320" aria-hidden="true" tabindex="-1"></a>  <span class="co"># len_len_convert(params = LLconv, </span></span>
<span id="cb128-321"><a href="#cb128-321" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 raw_length = LENGTH1, </span></span>
<span id="cb128-322"><a href="#cb128-322" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 length_type =LENGTH_TYPE1, </span></span>
<span id="cb128-323"><a href="#cb128-323" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 length_units =  LENGTH_UNIT1, </span></span>
<span id="cb128-324"><a href="#cb128-324" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 desired_type = len_type) %&gt;%</span></span>
<span id="cb128-325"><a href="#cb128-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">untable</span>(<span class="at">num =</span> .<span class="sc">$</span>QUANTITY)  <span class="sc">%&gt;%</span></span>
<span id="cb128-326"><a href="#cb128-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(LENGTH_TYPE1 <span class="sc">==</span> <span class="st">"FORK LENGTH"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-327"><a href="#cb128-327" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(NEW_GEAR_NAME %in% c(gear_groups)) %&gt;%</span></span>
<span id="cb128-328"><a href="#cb128-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="co">#gear = ifelse(grepl("hand*", NEW_GEAR_NAME, ignore.case = T, fixed = F), "HL", "LL"), #this part will need to be generalized for more than 2 gear types ; ++HOOKLINE IS HANDLINE IN THIS FILE ; OVERWRITING ALL HL TO LL ; CHANGED "hook*" TO "hand*"</span></span>
<span id="cb128-329"><a href="#cb128-329" aria-hidden="true" tabindex="-1"></a>         <span class="co">#gear=GEAR_GRP,</span></span>
<span id="cb128-330"><a href="#cb128-330" aria-hidden="true" tabindex="-1"></a>         <span class="at">FL_CM =</span> LENGTH1_MM<span class="sc">/</span><span class="dv">10</span>, </span>
<span id="cb128-331"><a href="#cb128-331" aria-hidden="true" tabindex="-1"></a>         <span class="at">lbin =</span> <span class="fu">floor</span>(FL_CM <span class="sc">/</span> bin_size)<span class="sc">*</span>bin_size, </span>
<span id="cb128-332"><a href="#cb128-332" aria-hidden="true" tabindex="-1"></a>         <span class="at">mgt_period =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">&lt;=</span> break_year, <span class="fu">paste0</span>(min_year,<span class="st">" - "</span>, break_year), <span class="fu">paste0</span>( break_year<span class="sc">+</span><span class="dv">1</span>, <span class="st">" - "</span>, max_year)))</span>
<span id="cb128-333"><a href="#cb128-333" aria-hidden="true" tabindex="-1"></a><span class="co"># is "select" the problem, its #out </span></span>
<span id="cb128-334"><a href="#cb128-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-335"><a href="#cb128-335" aria-hidden="true" tabindex="-1"></a><span class="co"># FINAL dataset here ----</span></span>
<span id="cb128-336"><a href="#cb128-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-337"><a href="#cb128-337" aria-hidden="true" tabindex="-1"></a>length_data_final <span class="ot">&lt;-</span> join_length_dat <span class="sc">%&gt;%</span></span>
<span id="cb128-338"><a href="#cb128-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, INTERVIEW_DATE, FINAL_DATE, ID, OBS_ID, <span class="at">STATE =</span> STATE_LANDED, <span class="at">COUNTY=</span>COUNTY_LANDED, COUNTY_CODE, FL_CM, lbin, source, gear, gear_short, LAND_STANDARD_GEAR_NAME, LAND_GEAR_NAME, mgt_period, ISLAND, INT_TYPE, fleet, DEALER_CODE, VESSEL_ID, LICENSE) <span class="sc">%&gt;%</span>  <span class="co">#STAT_AREA</span></span>
<span id="cb128-339"><a href="#cb128-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(FL_CM , min_size, max_size),</span>
<span id="cb128-340"><a href="#cb128-340" aria-hidden="true" tabindex="-1"></a>         ISLAND <span class="sc">!=</span> <span class="st">'NOT CODED'</span>)</span>
<span id="cb128-341"><a href="#cb128-341" aria-hidden="true" tabindex="-1"></a>         <span class="co">#,</span></span>
<span id="cb128-342"><a href="#cb128-342" aria-hidden="true" tabindex="-1"></a>         <span class="co">#INT_TYPE != 'USVI MARFIN REEFFISH SAMPLING') </span></span>
<span id="cb128-343"><a href="#cb128-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-344"><a href="#cb128-344" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyst have asked for a record of dropped observations</span></span>
<span id="cb128-345"><a href="#cb128-345" aria-hidden="true" tabindex="-1"></a><span class="do">######### ADAPT THIS TO OUTPUT ALL DROPPED RECORDS ABOVE--MOVE HIGHER IN THE SCRIPT TO HAVE ALL VARS</span></span>
<span id="cb128-346"><a href="#cb128-346" aria-hidden="true" tabindex="-1"></a>dropped_obs <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(join_length_dat, length_data_final, <span class="at">by =</span> <span class="st">"OBS_ID"</span>)  </span>
<span id="cb128-347"><a href="#cb128-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-348"><a href="#cb128-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-349"><a href="#cb128-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-350"><a href="#cb128-350" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################DOCUMENT ALL DROPPED DATA</span></span>
<span id="cb128-351"><a href="#cb128-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-352"><a href="#cb128-352" aria-hidden="true" tabindex="-1"></a><span class="co"># drop &lt;- list()  ##++this creates an empty list for for loop</span></span>
<span id="cb128-353"><a href="#cb128-353" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-354"><a href="#cb128-354" aria-hidden="true" tabindex="-1"></a><span class="co"># # for loop generates binned length comps for each of the final gears. Stored in list. RUN:  View(comps[[1]]) to see in R</span></span>
<span id="cb128-355"><a href="#cb128-355" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-356"><a href="#cb128-356" aria-hidden="true" tabindex="-1"></a><span class="co">#  drop[[1]] &lt;-  NON-RANDOM SAMPLES</span></span>
<span id="cb128-357"><a href="#cb128-357" aria-hidden="true" tabindex="-1"></a><span class="co">#  drop[[2]] &lt;-  SIZE DATA</span></span>
<span id="cb128-358"><a href="#cb128-358" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(gear == final_gears[i]) %&gt;%</span></span>
<span id="cb128-359"><a href="#cb128-359" aria-hidden="true" tabindex="-1"></a><span class="co"># names(comps)[[1]] &lt;- paste0(final_gears[i], "_", bin_size, "cm") ##++tabs are named here ; could add _nom here if desired (instead of _lfd and _lfdw in main file)</span></span>
<span id="cb128-360"><a href="#cb128-360" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb128-361"><a href="#cb128-361" aria-hidden="true" tabindex="-1"></a><span class="do">################################################</span></span>
<span id="cb128-362"><a href="#cb128-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-363"><a href="#cb128-363" aria-hidden="true" tabindex="-1"></a><span class="do">###this is writing only size data issues (e.g. samples too small/large to be considered realistic)</span></span>
<span id="cb128-364"><a href="#cb128-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-365"><a href="#cb128-365" aria-hidden="true" tabindex="-1"></a><span class="co"># write.xlsx(dropped_obs, file = paste0("./outputs/", sp, "_size_dropped_observations_", gsub("-", "", Sys.Date()), ".xlsx"))</span></span>
<span id="cb128-366"><a href="#cb128-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-367"><a href="#cb128-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-368"><a href="#cb128-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-369"><a href="#cb128-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r maintain_empty_bins}</span></span>
<span id="cb128-370"><a href="#cb128-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-371"><a href="#cb128-371" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-372"><a href="#cb128-372" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-373"><a href="#cb128-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-374"><a href="#cb128-374" aria-hidden="true" tabindex="-1"></a><span class="co"># this is some funky code to make sure bins with no obervations are maintained in the data. Open to finding a more elegant solution but this works</span></span>
<span id="cb128-375"><a href="#cb128-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-376"><a href="#cb128-376" aria-hidden="true" tabindex="-1"></a>full_set <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">YEAR =</span> <span class="fu">seq</span>(<span class="at">from =</span> min_year, <span class="at">to =</span> max_year, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb128-377"><a href="#cb128-377" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lbin =</span> <span class="fu">seq</span>(<span class="at">from =</span> min_size, <span class="at">to =</span> max_size, <span class="at">by =</span> bin_size), </span>
<span id="cb128-378"><a href="#cb128-378" aria-hidden="true" tabindex="-1"></a>                     <span class="at">N =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-379"><a href="#cb128-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> lbin, <span class="at">values_from =</span> N)</span>
<span id="cb128-380"><a href="#cb128-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-381"><a href="#cb128-381" aria-hidden="true" tabindex="-1"></a>comp_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"YEAR"</span>, <span class="st">"ln_fish"</span>, <span class="st">"ln_trips"</span>, <span class="st">"ln_dealers"</span>,<span class="st">"ln_vessels"</span>, <span class="fu">names</span>(full_set)[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb128-382"><a href="#cb128-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-383"><a href="#cb128-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-384"><a href="#cb128-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-385"><a href="#cb128-385" aria-hidden="true" tabindex="-1"></a><span class="fu"># Filtration level investigation</span></span>
<span id="cb128-386"><a href="#cb128-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-387"><a href="#cb128-387" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unique trip ID vs gear by year investigation</span></span>
<span id="cb128-388"><a href="#cb128-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-389"><a href="#cb128-389" aria-hidden="true" tabindex="-1"></a><span class="fu">#### How many unique trip ID's per year?</span></span>
<span id="cb128-390"><a href="#cb128-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-391"><a href="#cb128-391" aria-hidden="true" tabindex="-1"></a>Group by year, count unique trip id's</span>
<span id="cb128-392"><a href="#cb128-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-393"><a href="#cb128-393" aria-hidden="true" tabindex="-1"></a>When we remove data from years with less than 10 unique trip ID's, we are left with 24 years of data.</span>
<span id="cb128-394"><a href="#cb128-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-395"><a href="#cb128-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb128-396"><a href="#cb128-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb128-397"><a href="#cb128-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-398"><a href="#cb128-398" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb128-399"><a href="#cb128-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb128-400"><a href="#cb128-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb128-401"><a href="#cb128-401" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_tripcount)</span>
<span id="cb128-402"><a href="#cb128-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-403"><a href="#cb128-403" aria-hidden="true" tabindex="-1"></a>length_data_trip30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb128-404"><a href="#cb128-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb128-405"><a href="#cb128-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(ID) <span class="sc">&gt;=</span> <span class="dv">10</span>)<span class="sc">|&gt;</span></span>
<span id="cb128-406"><a href="#cb128-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb128-407"><a href="#cb128-407" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_trip30)</span>
<span id="cb128-408"><a href="#cb128-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-409"><a href="#cb128-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-410"><a href="#cb128-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-411"><a href="#cb128-411" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unique length records per gear per year</span></span>
<span id="cb128-412"><a href="#cb128-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-413"><a href="#cb128-413" aria-hidden="true" tabindex="-1"></a><span class="fu">### How many length records per gear per year?</span></span>
<span id="cb128-414"><a href="#cb128-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-415"><a href="#cb128-415" aria-hidden="true" tabindex="-1"></a>Group by year, count occurrences of each gear</span>
<span id="cb128-416"><a href="#cb128-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-417"><a href="#cb128-417" aria-hidden="true" tabindex="-1"></a>There are years when individual gears occur less than 30 times but when grouped, the gear groups exceed 30 occurrences per year. Do we want to rely on gear groups with larger than 30 occurrences per year or individual gears with more than 30 occurrences?</span>
<span id="cb128-418"><a href="#cb128-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-419"><a href="#cb128-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb128-420"><a href="#cb128-420" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-421"><a href="#cb128-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-422"><a href="#cb128-422" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur each year</span></span>
<span id="cb128-423"><a href="#cb128-423" aria-hidden="true" tabindex="-1"></a>length_data_gearcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb128-424"><a href="#cb128-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb128-425"><a href="#cb128-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb128-426"><a href="#cb128-426" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gearcount)</span>
<span id="cb128-427"><a href="#cb128-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-428"><a href="#cb128-428" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur 30 or more times each year</span></span>
<span id="cb128-429"><a href="#cb128-429" aria-hidden="true" tabindex="-1"></a>length_data_gear30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb128-430"><a href="#cb128-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb128-431"><a href="#cb128-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb128-432"><a href="#cb128-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb128-433"><a href="#cb128-433" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear30)</span>
<span id="cb128-434"><a href="#cb128-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-435"><a href="#cb128-435" aria-hidden="true" tabindex="-1"></a><span class="co"># group gears that occur 30 or more times per year by gear grouping </span></span>
<span id="cb128-436"><a href="#cb128-436" aria-hidden="true" tabindex="-1"></a>length_data_geartogether30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb128-437"><a href="#cb128-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb128-438"><a href="#cb128-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb128-439"><a href="#cb128-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb128-440"><a href="#cb128-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span> </span>
<span id="cb128-441"><a href="#cb128-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb128-442"><a href="#cb128-442" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geartogether30)</span>
<span id="cb128-443"><a href="#cb128-443" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by specific gear per year</span></span>
<span id="cb128-444"><a href="#cb128-444" aria-hidden="true" tabindex="-1"></a><span class="co"># 26 years of data available </span></span>
<span id="cb128-445"><a href="#cb128-445" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geartogether30<span class="sc">$</span>YEAR, length_data_geartogether30<span class="sc">$</span>gear)</span>
<span id="cb128-446"><a href="#cb128-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-447"><a href="#cb128-447" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur each year</span></span>
<span id="cb128-448"><a href="#cb128-448" aria-hidden="true" tabindex="-1"></a>length_data_geargroupcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb128-449"><a href="#cb128-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb128-450"><a href="#cb128-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb128-451"><a href="#cb128-451" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroupcount)</span>
<span id="cb128-452"><a href="#cb128-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-453"><a href="#cb128-453" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur 30 or more times each year</span></span>
<span id="cb128-454"><a href="#cb128-454" aria-hidden="true" tabindex="-1"></a>length_data_geargroup30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb128-455"><a href="#cb128-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb128-456"><a href="#cb128-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb128-457"><a href="#cb128-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb128-458"><a href="#cb128-458" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup30)</span>
<span id="cb128-459"><a href="#cb128-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-460"><a href="#cb128-460" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by gear grouping per year</span></span>
<span id="cb128-461"><a href="#cb128-461" aria-hidden="true" tabindex="-1"></a><span class="co"># 26 years of data available </span></span>
<span id="cb128-462"><a href="#cb128-462" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geargroup30<span class="sc">$</span>YEAR, length_data_geargroup30<span class="sc">$</span>gear)</span>
<span id="cb128-463"><a href="#cb128-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-464"><a href="#cb128-464" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by individual gears </span></span>
<span id="cb128-465"><a href="#cb128-465" aria-hidden="true" tabindex="-1"></a>length_data_gear29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb128-466"><a href="#cb128-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb128-467"><a href="#cb128-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb128-468"><a href="#cb128-468" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb128-469"><a href="#cb128-469" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb128-470"><a href="#cb128-470" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb128-471"><a href="#cb128-471" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear29)</span>
<span id="cb128-472"><a href="#cb128-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-473"><a href="#cb128-473" aria-hidden="true" tabindex="-1"></a><span class="co"># VS </span></span>
<span id="cb128-474"><a href="#cb128-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-475"><a href="#cb128-475" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by gear groups </span></span>
<span id="cb128-476"><a href="#cb128-476" aria-hidden="true" tabindex="-1"></a>length_data_geargroup29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb128-477"><a href="#cb128-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb128-478"><a href="#cb128-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb128-479"><a href="#cb128-479" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb128-480"><a href="#cb128-480" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb128-481"><a href="#cb128-481" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb128-482"><a href="#cb128-482" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup29)</span>
<span id="cb128-483"><a href="#cb128-483" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-484"><a href="#cb128-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-485"><a href="#cb128-485" aria-hidden="true" tabindex="-1"></a><span class="fu"># GLM analysis</span></span>
<span id="cb128-486"><a href="#cb128-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-487"><a href="#cb128-487" aria-hidden="true" tabindex="-1"></a>No filtering based on number of trips/fish per year yet, analysis of all available data.</span>
<span id="cb128-488"><a href="#cb128-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-489"><a href="#cb128-489" aria-hidden="true" tabindex="-1"></a>123 records removed due to not being measured in fork length:</span>
<span id="cb128-490"><a href="#cb128-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-491"><a href="#cb128-491" aria-hidden="true" tabindex="-1"></a>20 GILL NETS; OTHER</span>
<span id="cb128-492"><a href="#cb128-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-493"><a href="#cb128-493" aria-hidden="true" tabindex="-1"></a>5 NOT CODED</span>
<span id="cb128-494"><a href="#cb128-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-495"><a href="#cb128-495" aria-hidden="true" tabindex="-1"></a>32 LINES HAND</span>
<span id="cb128-496"><a href="#cb128-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-497"><a href="#cb128-497" aria-hidden="true" tabindex="-1"></a>66 POTS AND TRAPS; FISH</span>
<span id="cb128-498"><a href="#cb128-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-499"><a href="#cb128-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_hookandline_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb128-500"><a href="#cb128-500" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(length_data_final<span class="sc">$</span>gear) <span class="co"># "Hook and Line", "Trap", "Other", "Net"</span></span>
<span id="cb128-501"><a href="#cb128-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-502"><a href="#cb128-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-503"><a href="#cb128-503" aria-hidden="true" tabindex="-1"></a><span class="fu">## All Gears</span></span>
<span id="cb128-504"><a href="#cb128-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-505"><a href="#cb128-505" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_allgear_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb128-506"><a href="#cb128-506" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-507"><a href="#cb128-507" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-508"><a href="#cb128-508" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-509"><a href="#cb128-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-510"><a href="#cb128-510" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb128-511"><a href="#cb128-511" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb128-512"><a href="#cb128-512" aria-hidden="true" tabindex="-1"></a>length_data_glm <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb128-513"><a href="#cb128-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb128-514"><a href="#cb128-514" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(gear == "Hook and Line") |&gt; </span></span>
<span id="cb128-515"><a href="#cb128-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb128-516"><a href="#cb128-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb128-517"><a href="#cb128-517" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb128-518"><a href="#cb128-518" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb128-519"><a href="#cb128-519" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(length_data_glm, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb128-520"><a href="#cb128-520" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb128-521"><a href="#cb128-521" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb128-522"><a href="#cb128-522" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb128-523"><a href="#cb128-523" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb128-524"><a href="#cb128-524" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(length_data_glm, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb128-525"><a href="#cb128-525" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb128-526"><a href="#cb128-526" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb128-527"><a href="#cb128-527" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb128-528"><a href="#cb128-528" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb128-529"><a href="#cb128-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-530"><a href="#cb128-530" aria-hidden="true" tabindex="-1"></a><span class="co">#table(length_data_glm$LAND_STANDARD_GEAR_NAME, length_data_glm$YEAR)</span></span>
<span id="cb128-531"><a href="#cb128-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-532"><a href="#cb128-532" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb128-533"><a href="#cb128-533" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb128-534"><a href="#cb128-534" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(length_data_glm, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb128-535"><a href="#cb128-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb128-536"><a href="#cb128-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb128-537"><a href="#cb128-537" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb128-538"><a href="#cb128-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb128-539"><a href="#cb128-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb128-540"><a href="#cb128-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb128-541"><a href="#cb128-541" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb128-542"><a href="#cb128-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb128-543"><a href="#cb128-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-544"><a href="#cb128-544" aria-hidden="true" tabindex="-1"></a><span class="co"># # run again but with only sig different gears</span></span>
<span id="cb128-545"><a href="#cb128-545" aria-hidden="true" tabindex="-1"></a><span class="co"># rodreelfishtraps &lt;- length_data_glm |&gt; </span></span>
<span id="cb128-546"><a href="#cb128-546" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(LAND_STANDARD_GEAR_NAME == c("LINES HAND", "POTS AND TRAPS; FISH", "ROD AND REEL"))</span></span>
<span id="cb128-547"><a href="#cb128-547" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-548"><a href="#cb128-548" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(rodreelfishtraps, aes(x = as.Date(FINAL_DATE), y = FL_CM)) +</span></span>
<span id="cb128-549"><a href="#cb128-549" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(colour = LAND_STANDARD_GEAR_NAME, shape = LAND_STANDARD_GEAR_NAME), size = 1, alpha = 0.5) +</span></span>
<span id="cb128-550"><a href="#cb128-550" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth(method = "lm", formula = "y ~ x", col = "black") +</span></span>
<span id="cb128-551"><a href="#cb128-551" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb128-552"><a href="#cb128-552" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "", y = "Length (cm)", colour = "", shape = "") +</span></span>
<span id="cb128-553"><a href="#cb128-553" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb128-554"><a href="#cb128-554" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = "bottom", legend.text = element_text(size = 10),</span></span>
<span id="cb128-555"><a href="#cb128-555" aria-hidden="true" tabindex="-1"></a><span class="co">#         legend.box.spacing = unit(0, "npc"), panel.grid = element_blank()) +</span></span>
<span id="cb128-556"><a href="#cb128-556" aria-hidden="true" tabindex="-1"></a><span class="co">#   guides(colour = guide_legend(override.aes = list(size = 2)))</span></span>
<span id="cb128-557"><a href="#cb128-557" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-558"><a href="#cb128-558" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot &lt;- ggdensity(rodreelfishtraps, x = "FL_CM",</span></span>
<span id="cb128-559"><a href="#cb128-559" aria-hidden="true" tabindex="-1"></a><span class="co">#                           add = "mean", rug = TRUE,</span></span>
<span id="cb128-560"><a href="#cb128-560" aria-hidden="true" tabindex="-1"></a><span class="co">#                           color = "LAND_STANDARD_GEAR_NAME", fill = "LAND_STANDARD_GEAR_NAME",</span></span>
<span id="cb128-561"><a href="#cb128-561" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ylab = "FL_CM", xlab = "Gear")</span></span>
<span id="cb128-562"><a href="#cb128-562" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot</span></span>
<span id="cb128-563"><a href="#cb128-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-564"><a href="#cb128-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-565"><a href="#cb128-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_allgear_analysis, fig.fullwidth}</span></span>
<span id="cb128-566"><a href="#cb128-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-567"><a href="#cb128-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen-inset  </span></span>
<span id="cb128-568"><a href="#cb128-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-569"><a href="#cb128-569" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb128-570"><a href="#cb128-570" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb128-571"><a href="#cb128-571" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb128-572"><a href="#cb128-572" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb128-573"><a href="#cb128-573" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb128-574"><a href="#cb128-574" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-575"><a href="#cb128-575" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb128-576"><a href="#cb128-576" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = length_data_glm, REML = FALSE)</span></span>
<span id="cb128-577"><a href="#cb128-577" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb128-578"><a href="#cb128-578" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-579"><a href="#cb128-579" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb128-580"><a href="#cb128-580" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb128-581"><a href="#cb128-581" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb128-582"><a href="#cb128-582" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb128-583"><a href="#cb128-583" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb128-584"><a href="#cb128-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-585"><a href="#cb128-585" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb128-586"><a href="#cb128-586" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-587"><a href="#cb128-587" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> length_data_glm, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-588"><a href="#cb128-588" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span>
<span id="cb128-589"><a href="#cb128-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-590"><a href="#cb128-590" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb128-591"><a href="#cb128-591" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-592"><a href="#cb128-592" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-593"><a href="#cb128-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-594"><a href="#cb128-594" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb128-595"><a href="#cb128-595" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb128-596"><a href="#cb128-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-597"><a href="#cb128-597" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb128-598"><a href="#cb128-598" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-599"><a href="#cb128-599" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-600"><a href="#cb128-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-601"><a href="#cb128-601" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-602"><a href="#cb128-602" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-603"><a href="#cb128-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-604"><a href="#cb128-604" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb128-605"><a href="#cb128-605" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-606"><a href="#cb128-606" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb128-607"><a href="#cb128-607" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb128-608"><a href="#cb128-608" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb128-609"><a href="#cb128-609" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb128-610"><a href="#cb128-610" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb128-611"><a href="#cb128-611" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb128-612"><a href="#cb128-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-613"><a href="#cb128-613" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb128-614"><a href="#cb128-614" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb128-615"><a href="#cb128-615" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb128-616"><a href="#cb128-616" aria-hidden="true" tabindex="-1"></a>mod_contr</span>
<span id="cb128-617"><a href="#cb128-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-618"><a href="#cb128-618" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb128-619"><a href="#cb128-619" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb128-620"><a href="#cb128-620" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb128-621"><a href="#cb128-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-622"><a href="#cb128-622" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld <span class="ot">&lt;-</span> multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb128-623"><a href="#cb128-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-624"><a href="#cb128-624" aria-hidden="true" tabindex="-1"></a>length_data_fishcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb128-625"><a href="#cb128-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb128-626"><a href="#cb128-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_fish =</span> <span class="fu">n</span>()) </span>
<span id="cb128-627"><a href="#cb128-627" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb128-628"><a href="#cb128-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb128-629"><a href="#cb128-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb128-630"><a href="#cb128-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-631"><a href="#cb128-631" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_fish <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld, length_data_fishcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb128-632"><a href="#cb128-632" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_trip <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_fish, length_data_tripcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb128-633"><a href="#cb128-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-634"><a href="#cb128-634" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_final <span class="ot">&lt;-</span> allgears_multcompcld_trip <span class="sc">|&gt;</span> </span>
<span id="cb128-635"><a href="#cb128-635" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="st">".group"</span>,</span>
<span id="cb128-636"><a href="#cb128-636" aria-hidden="true" tabindex="-1"></a>                <span class="st">"n_distinct_ID"</span> <span class="ot">=</span> <span class="st">"n_distinct(ID)"</span>)</span>
<span id="cb128-637"><a href="#cb128-637" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgears_multcompcld_final)</span>
<span id="cb128-638"><a href="#cb128-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-639"><a href="#cb128-639" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgears_multcompcld_final, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/sttj_yts_glm_allgears.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-640"><a href="#cb128-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-641"><a href="#cb128-641" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>, <span class="st">"3"</span>))</span>
<span id="cb128-642"><a href="#cb128-642" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_fish[i]))</span></span>
<span id="cb128-643"><a href="#cb128-643" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-644"><a href="#cb128-644" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_distinct_ID[i]))</span></span>
<span id="cb128-645"><a href="#cb128-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-646"><a href="#cb128-646" aria-hidden="true" tabindex="-1"></a>allgear_glm_totals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb128-647"><a href="#cb128-647" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_distinct_ID =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_final<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_final<span class="sc">$</span>n_distinct_ID[i]))),</span>
<span id="cb128-648"><a href="#cb128-648" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_fish =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_final<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_final<span class="sc">$</span>n_fish[i]))))</span>
<span id="cb128-649"><a href="#cb128-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-650"><a href="#cb128-650" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgear_glm_totals)</span>
<span id="cb128-651"><a href="#cb128-651" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgear_glm_totals, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/sttj_yts_glm_allgears_totals.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-652"><a href="#cb128-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-653"><a href="#cb128-653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-654"><a href="#cb128-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-655"><a href="#cb128-655" aria-hidden="true" tabindex="-1"></a><span class="fu">## All Gears 2012 and after </span></span>
<span id="cb128-656"><a href="#cb128-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-657"><a href="#cb128-657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_allgear2012_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb128-658"><a href="#cb128-658" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-659"><a href="#cb128-659" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-660"><a href="#cb128-660" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-661"><a href="#cb128-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-662"><a href="#cb128-662" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb128-663"><a href="#cb128-663" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb128-664"><a href="#cb128-664" aria-hidden="true" tabindex="-1"></a>length_data_glm_2012 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb128-665"><a href="#cb128-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(YEAR <span class="sc">&gt;=</span> <span class="dv">2012</span>) <span class="sc">|&gt;</span> </span>
<span id="cb128-666"><a href="#cb128-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb128-667"><a href="#cb128-667" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(gear == "Hook and Line") |&gt; </span></span>
<span id="cb128-668"><a href="#cb128-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb128-669"><a href="#cb128-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb128-670"><a href="#cb128-670" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb128-671"><a href="#cb128-671" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb128-672"><a href="#cb128-672" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(length_data_glm_2012, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb128-673"><a href="#cb128-673" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb128-674"><a href="#cb128-674" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb128-675"><a href="#cb128-675" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb128-676"><a href="#cb128-676" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb128-677"><a href="#cb128-677" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(length_data_glm_2012, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb128-678"><a href="#cb128-678" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb128-679"><a href="#cb128-679" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb128-680"><a href="#cb128-680" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb128-681"><a href="#cb128-681" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb128-682"><a href="#cb128-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-683"><a href="#cb128-683" aria-hidden="true" tabindex="-1"></a><span class="co">#table(length_data_glm$LAND_STANDARD_GEAR_NAME, length_data_glm$YEAR)</span></span>
<span id="cb128-684"><a href="#cb128-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-685"><a href="#cb128-685" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb128-686"><a href="#cb128-686" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb128-687"><a href="#cb128-687" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(length_data_glm_2012, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb128-688"><a href="#cb128-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb128-689"><a href="#cb128-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb128-690"><a href="#cb128-690" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb128-691"><a href="#cb128-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb128-692"><a href="#cb128-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb128-693"><a href="#cb128-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb128-694"><a href="#cb128-694" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb128-695"><a href="#cb128-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb128-696"><a href="#cb128-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-697"><a href="#cb128-697" aria-hidden="true" tabindex="-1"></a><span class="co"># # run again but with only sig different gears</span></span>
<span id="cb128-698"><a href="#cb128-698" aria-hidden="true" tabindex="-1"></a><span class="co"># rodreelfishtraps &lt;- length_data_glm |&gt; </span></span>
<span id="cb128-699"><a href="#cb128-699" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(LAND_STANDARD_GEAR_NAME == c("LINES HAND", "POTS AND TRAPS; FISH", "ROD AND REEL"))</span></span>
<span id="cb128-700"><a href="#cb128-700" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-701"><a href="#cb128-701" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(rodreelfishtraps, aes(x = as.Date(FINAL_DATE), y = FL_CM)) +</span></span>
<span id="cb128-702"><a href="#cb128-702" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(colour = LAND_STANDARD_GEAR_NAME, shape = LAND_STANDARD_GEAR_NAME), size = 1, alpha = 0.5) +</span></span>
<span id="cb128-703"><a href="#cb128-703" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth(method = "lm", formula = "y ~ x", col = "black") +</span></span>
<span id="cb128-704"><a href="#cb128-704" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb128-705"><a href="#cb128-705" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "", y = "Length (cm)", colour = "", shape = "") +</span></span>
<span id="cb128-706"><a href="#cb128-706" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb128-707"><a href="#cb128-707" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = "bottom", legend.text = element_text(size = 10),</span></span>
<span id="cb128-708"><a href="#cb128-708" aria-hidden="true" tabindex="-1"></a><span class="co">#         legend.box.spacing = unit(0, "npc"), panel.grid = element_blank()) +</span></span>
<span id="cb128-709"><a href="#cb128-709" aria-hidden="true" tabindex="-1"></a><span class="co">#   guides(colour = guide_legend(override.aes = list(size = 2)))</span></span>
<span id="cb128-710"><a href="#cb128-710" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-711"><a href="#cb128-711" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot &lt;- ggdensity(rodreelfishtraps, x = "FL_CM",</span></span>
<span id="cb128-712"><a href="#cb128-712" aria-hidden="true" tabindex="-1"></a><span class="co">#                           add = "mean", rug = TRUE,</span></span>
<span id="cb128-713"><a href="#cb128-713" aria-hidden="true" tabindex="-1"></a><span class="co">#                           color = "LAND_STANDARD_GEAR_NAME", fill = "LAND_STANDARD_GEAR_NAME",</span></span>
<span id="cb128-714"><a href="#cb128-714" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ylab = "FL_CM", xlab = "Gear")</span></span>
<span id="cb128-715"><a href="#cb128-715" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot</span></span>
<span id="cb128-716"><a href="#cb128-716" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-717"><a href="#cb128-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-718"><a href="#cb128-718" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_allgear2012_analysis, fig.fullwidth}</span></span>
<span id="cb128-719"><a href="#cb128-719" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-720"><a href="#cb128-720" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen-inset  </span></span>
<span id="cb128-721"><a href="#cb128-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-722"><a href="#cb128-722" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb128-723"><a href="#cb128-723" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb128-724"><a href="#cb128-724" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb128-725"><a href="#cb128-725" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb128-726"><a href="#cb128-726" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb128-727"><a href="#cb128-727" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-728"><a href="#cb128-728" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb128-729"><a href="#cb128-729" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = length_data_glm, REML = FALSE)</span></span>
<span id="cb128-730"><a href="#cb128-730" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb128-731"><a href="#cb128-731" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-732"><a href="#cb128-732" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb128-733"><a href="#cb128-733" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb128-734"><a href="#cb128-734" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb128-735"><a href="#cb128-735" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb128-736"><a href="#cb128-736" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb128-737"><a href="#cb128-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-738"><a href="#cb128-738" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb128-739"><a href="#cb128-739" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-740"><a href="#cb128-740" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> length_data_glm_2012, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-741"><a href="#cb128-741" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span>
<span id="cb128-742"><a href="#cb128-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-743"><a href="#cb128-743" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb128-744"><a href="#cb128-744" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-745"><a href="#cb128-745" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-746"><a href="#cb128-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-747"><a href="#cb128-747" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb128-748"><a href="#cb128-748" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb128-749"><a href="#cb128-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-750"><a href="#cb128-750" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb128-751"><a href="#cb128-751" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-752"><a href="#cb128-752" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-753"><a href="#cb128-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-754"><a href="#cb128-754" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-755"><a href="#cb128-755" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-756"><a href="#cb128-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-757"><a href="#cb128-757" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb128-758"><a href="#cb128-758" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-759"><a href="#cb128-759" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb128-760"><a href="#cb128-760" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb128-761"><a href="#cb128-761" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb128-762"><a href="#cb128-762" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb128-763"><a href="#cb128-763" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb128-764"><a href="#cb128-764" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb128-765"><a href="#cb128-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-766"><a href="#cb128-766" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb128-767"><a href="#cb128-767" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb128-768"><a href="#cb128-768" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb128-769"><a href="#cb128-769" aria-hidden="true" tabindex="-1"></a>mod_contr</span>
<span id="cb128-770"><a href="#cb128-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-771"><a href="#cb128-771" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb128-772"><a href="#cb128-772" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb128-773"><a href="#cb128-773" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb128-774"><a href="#cb128-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-775"><a href="#cb128-775" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_2012 <span class="ot">&lt;-</span> multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb128-776"><a href="#cb128-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-777"><a href="#cb128-777" aria-hidden="true" tabindex="-1"></a>length_data_fishcount <span class="ot">&lt;-</span> length_data_glm_2012 <span class="sc">|&gt;</span> </span>
<span id="cb128-778"><a href="#cb128-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb128-779"><a href="#cb128-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_fish =</span> <span class="fu">n</span>()) </span>
<span id="cb128-780"><a href="#cb128-780" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_glm_2012 <span class="sc">|&gt;</span> </span>
<span id="cb128-781"><a href="#cb128-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb128-782"><a href="#cb128-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb128-783"><a href="#cb128-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-784"><a href="#cb128-784" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_fish_2012 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_2012, length_data_fishcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb128-785"><a href="#cb128-785" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_trip_2012 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_fish_2012, length_data_tripcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb128-786"><a href="#cb128-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-787"><a href="#cb128-787" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_finaL_2012 <span class="ot">&lt;-</span> allgears_multcompcld_trip_2012 <span class="sc">|&gt;</span> </span>
<span id="cb128-788"><a href="#cb128-788" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="st">".group"</span>,</span>
<span id="cb128-789"><a href="#cb128-789" aria-hidden="true" tabindex="-1"></a>                <span class="st">"n_distinct_ID"</span> <span class="ot">=</span> <span class="st">"n_distinct(ID)"</span>)</span>
<span id="cb128-790"><a href="#cb128-790" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgears_multcompcld_finaL_2012)</span>
<span id="cb128-791"><a href="#cb128-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-792"><a href="#cb128-792" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgears_multcompcld_finaL_2012, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/sttj_yts_2012glm_allgears.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-793"><a href="#cb128-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-794"><a href="#cb128-794" aria-hidden="true" tabindex="-1"></a>group_2012 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>, <span class="st">"3"</span>))</span>
<span id="cb128-795"><a href="#cb128-795" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_fish[i]))</span></span>
<span id="cb128-796"><a href="#cb128-796" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-797"><a href="#cb128-797" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_distinct_ID[i]))</span></span>
<span id="cb128-798"><a href="#cb128-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-799"><a href="#cb128-799" aria-hidden="true" tabindex="-1"></a>allgear_glm_totals_2012 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb128-800"><a href="#cb128-800" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_distinct_ID =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group_2012<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_finaL_2012<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_finaL_2012<span class="sc">$</span>n_distinct_ID[i]))),</span>
<span id="cb128-801"><a href="#cb128-801" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_fish =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group_2012<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_finaL_2012<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_finaL_2012<span class="sc">$</span>n_fish[i]))))</span>
<span id="cb128-802"><a href="#cb128-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-803"><a href="#cb128-803" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgear_glm_totals_2012)</span>
<span id="cb128-804"><a href="#cb128-804" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgear_glm_totals_2012, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/sttj_yts_2012glm_allgears_totals.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-805"><a href="#cb128-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-806"><a href="#cb128-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-807"><a href="#cb128-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-808"><a href="#cb128-808" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hook and Line</span></span>
<span id="cb128-809"><a href="#cb128-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-810"><a href="#cb128-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_hookline_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb128-811"><a href="#cb128-811" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-812"><a href="#cb128-812" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-813"><a href="#cb128-813" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-814"><a href="#cb128-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-815"><a href="#cb128-815" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb128-816"><a href="#cb128-816" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb128-817"><a href="#cb128-817" aria-hidden="true" tabindex="-1"></a>use_gear_hl <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb128-818"><a href="#cb128-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb128-819"><a href="#cb128-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear <span class="sc">==</span> <span class="st">"Hook and Line"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb128-820"><a href="#cb128-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb128-821"><a href="#cb128-821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb128-822"><a href="#cb128-822" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb128-823"><a href="#cb128-823" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb128-824"><a href="#cb128-824" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(use_gear_hl, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb128-825"><a href="#cb128-825" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb128-826"><a href="#cb128-826" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb128-827"><a href="#cb128-827" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb128-828"><a href="#cb128-828" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb128-829"><a href="#cb128-829" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(use_gear_hl, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb128-830"><a href="#cb128-830" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb128-831"><a href="#cb128-831" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb128-832"><a href="#cb128-832" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb128-833"><a href="#cb128-833" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb128-834"><a href="#cb128-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-835"><a href="#cb128-835" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb128-836"><a href="#cb128-836" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb128-837"><a href="#cb128-837" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(use_gear_hl, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb128-838"><a href="#cb128-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb128-839"><a href="#cb128-839" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb128-840"><a href="#cb128-840" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb128-841"><a href="#cb128-841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb128-842"><a href="#cb128-842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb128-843"><a href="#cb128-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb128-844"><a href="#cb128-844" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb128-845"><a href="#cb128-845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb128-846"><a href="#cb128-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-847"><a href="#cb128-847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-848"><a href="#cb128-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-849"><a href="#cb128-849" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_hookandline_analysis, fig.fullwidth}</span></span>
<span id="cb128-850"><a href="#cb128-850" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-851"><a href="#cb128-851" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen-inset  </span></span>
<span id="cb128-852"><a href="#cb128-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-853"><a href="#cb128-853" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb128-854"><a href="#cb128-854" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb128-855"><a href="#cb128-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-856"><a href="#cb128-856" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb128-857"><a href="#cb128-857" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-858"><a href="#cb128-858" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_hl, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-859"><a href="#cb128-859" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span>
<span id="cb128-860"><a href="#cb128-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-861"><a href="#cb128-861" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb128-862"><a href="#cb128-862" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-863"><a href="#cb128-863" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-864"><a href="#cb128-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-865"><a href="#cb128-865" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb128-866"><a href="#cb128-866" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb128-867"><a href="#cb128-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-868"><a href="#cb128-868" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb128-869"><a href="#cb128-869" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-870"><a href="#cb128-870" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-871"><a href="#cb128-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-872"><a href="#cb128-872" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-873"><a href="#cb128-873" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-874"><a href="#cb128-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-875"><a href="#cb128-875" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb128-876"><a href="#cb128-876" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-877"><a href="#cb128-877" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb128-878"><a href="#cb128-878" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line gear p value is significant </span></span>
<span id="cb128-879"><a href="#cb128-879" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb128-880"><a href="#cb128-880" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb128-881"><a href="#cb128-881" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line date p value is significant </span></span>
<span id="cb128-882"><a href="#cb128-882" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb128-883"><a href="#cb128-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-884"><a href="#cb128-884" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb128-885"><a href="#cb128-885" aria-hidden="true" tabindex="-1"></a><span class="do">### lines hand vs rod and reel and lines power troll other vs rod and reel are signifficantly different </span></span>
<span id="cb128-886"><a href="#cb128-886" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb128-887"><a href="#cb128-887" aria-hidden="true" tabindex="-1"></a>mod_contr</span>
<span id="cb128-888"><a href="#cb128-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-889"><a href="#cb128-889" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb128-890"><a href="#cb128-890" aria-hidden="true" tabindex="-1"></a><span class="do">### suggestion: "lines power troll other", "lines hand" "rod and reel electric" and "reel electric or hydroulic" be grouped together</span></span>
<span id="cb128-891"><a href="#cb128-891" aria-hidden="true" tabindex="-1"></a><span class="do">### "rod and reel" be kept separate </span></span>
<span id="cb128-892"><a href="#cb128-892" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb128-893"><a href="#cb128-893" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-894"><a href="#cb128-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-895"><a href="#cb128-895" aria-hidden="true" tabindex="-1"></a><span class="fu">## Net</span></span>
<span id="cb128-896"><a href="#cb128-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-897"><a href="#cb128-897" aria-hidden="true" tabindex="-1"></a>"GILL NETS; OTHER" not included because all 20 records are measured in standard length, i didn't have a conversion for that</span>
<span id="cb128-898"><a href="#cb128-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-899"><a href="#cb128-899" aria-hidden="true" tabindex="-1"></a>Adyan - The "GILL NETS: GL 1-2 IN" AND "GILL NETS: GL 2-4 IN" records we were thinking of are in STX, I'll highlight those in the stx_yts document tomorrow.</span>
<span id="cb128-900"><a href="#cb128-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-901"><a href="#cb128-901" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_netstd_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb128-902"><a href="#cb128-902" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-903"><a href="#cb128-903" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-904"><a href="#cb128-904" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-905"><a href="#cb128-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-906"><a href="#cb128-906" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb128-907"><a href="#cb128-907" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb128-908"><a href="#cb128-908" aria-hidden="true" tabindex="-1"></a><span class="co"># net land_standard_gear_name</span></span>
<span id="cb128-909"><a href="#cb128-909" aria-hidden="true" tabindex="-1"></a>use_gear_nlsg <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb128-910"><a href="#cb128-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb128-911"><a href="#cb128-911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear <span class="sc">==</span> <span class="st">"Net"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb128-912"><a href="#cb128-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb128-913"><a href="#cb128-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb128-914"><a href="#cb128-914" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb128-915"><a href="#cb128-915" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb128-916"><a href="#cb128-916" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(use_gear_nlsg, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb128-917"><a href="#cb128-917" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb128-918"><a href="#cb128-918" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb128-919"><a href="#cb128-919" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb128-920"><a href="#cb128-920" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb128-921"><a href="#cb128-921" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(use_gear_nlsg, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb128-922"><a href="#cb128-922" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb128-923"><a href="#cb128-923" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb128-924"><a href="#cb128-924" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb128-925"><a href="#cb128-925" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb128-926"><a href="#cb128-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-927"><a href="#cb128-927" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb128-928"><a href="#cb128-928" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb128-929"><a href="#cb128-929" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(use_gear_nlsg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb128-930"><a href="#cb128-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb128-931"><a href="#cb128-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb128-932"><a href="#cb128-932" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb128-933"><a href="#cb128-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb128-934"><a href="#cb128-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb128-935"><a href="#cb128-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb128-936"><a href="#cb128-936" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb128-937"><a href="#cb128-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb128-938"><a href="#cb128-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-939"><a href="#cb128-939" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-940"><a href="#cb128-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-941"><a href="#cb128-941" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_netstd_analysis}</span></span>
<span id="cb128-942"><a href="#cb128-942" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-943"><a href="#cb128-943" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-944"><a href="#cb128-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-945"><a href="#cb128-945" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb128-946"><a href="#cb128-946" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb128-947"><a href="#cb128-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-948"><a href="#cb128-948" aria-hidden="true" tabindex="-1"></a><span class="do">### both fixed linear and glm models have warning message because ENTANGLING NETS (GILL) UNSPECIFIED only occur in one year, preventing convergence across timeline </span></span>
<span id="cb128-949"><a href="#cb128-949" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb128-950"><a href="#cb128-950" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-951"><a href="#cb128-951" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_nlsg, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-952"><a href="#cb128-952" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span>
<span id="cb128-953"><a href="#cb128-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-954"><a href="#cb128-954" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb128-955"><a href="#cb128-955" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-956"><a href="#cb128-956" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log)) </span>
<span id="cb128-957"><a href="#cb128-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-958"><a href="#cb128-958" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb128-959"><a href="#cb128-959" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb128-960"><a href="#cb128-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-961"><a href="#cb128-961" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb128-962"><a href="#cb128-962" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-963"><a href="#cb128-963" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-964"><a href="#cb128-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-965"><a href="#cb128-965" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-966"><a href="#cb128-966" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-967"><a href="#cb128-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-968"><a href="#cb128-968" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb128-969"><a href="#cb128-969" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb128-970"><a href="#cb128-970" aria-hidden="true" tabindex="-1"></a><span class="do">### net (using LAND_STANDARD_GEAR_NAME) does not have any significantly different gears </span></span>
<span id="cb128-971"><a href="#cb128-971" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3) </span>
<span id="cb128-972"><a href="#cb128-972" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope</span></span>
<span id="cb128-973"><a href="#cb128-973" aria-hidden="true" tabindex="-1"></a><span class="do">### There is no significantly different time in the Net grouping </span></span>
<span id="cb128-974"><a href="#cb128-974" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb128-975"><a href="#cb128-975" aria-hidden="true" tabindex="-1"></a><span class="do">### no significant p values for time period or gears, further comparisons not needed </span></span>
<span id="cb128-976"><a href="#cb128-976" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-977"><a href="#cb128-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-978"><a href="#cb128-978" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_net_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb128-979"><a href="#cb128-979" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-980"><a href="#cb128-980" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-981"><a href="#cb128-981" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-982"><a href="#cb128-982" aria-hidden="true" tabindex="-1"></a><span class="do">#### Net - LAND_GEAR_NAME</span></span>
<span id="cb128-983"><a href="#cb128-983" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb128-984"><a href="#cb128-984" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggplot2) </span></span>
<span id="cb128-985"><a href="#cb128-985" aria-hidden="true" tabindex="-1"></a><span class="co"># # net land_standard_gear_name</span></span>
<span id="cb128-986"><a href="#cb128-986" aria-hidden="true" tabindex="-1"></a><span class="co"># use_gear_nlg &lt;- length_data_final |&gt;</span></span>
<span id="cb128-987"><a href="#cb128-987" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_GEAR_NAME, gear) |&gt; </span></span>
<span id="cb128-988"><a href="#cb128-988" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(gear == "Net") |&gt; </span></span>
<span id="cb128-989"><a href="#cb128-989" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(ID = as.character(ID)) |&gt; </span></span>
<span id="cb128-990"><a href="#cb128-990" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-gear)</span></span>
<span id="cb128-991"><a href="#cb128-991" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggpubr)</span></span>
<span id="cb128-992"><a href="#cb128-992" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create box plot across years</span></span>
<span id="cb128-993"><a href="#cb128-993" aria-hidden="true" tabindex="-1"></a><span class="co"># box_plot &lt;- ggboxplot(use_gear_nlg, x = "LAND_GEAR_NAME", y = "FL_CM",</span></span>
<span id="cb128-994"><a href="#cb128-994" aria-hidden="true" tabindex="-1"></a><span class="co">#                  color = "LAND_GEAR_NAME",</span></span>
<span id="cb128-995"><a href="#cb128-995" aria-hidden="true" tabindex="-1"></a><span class="co">#                  ylab = "FL_CM", xlab = "LAND_GEAR_NAME")</span></span>
<span id="cb128-996"><a href="#cb128-996" aria-hidden="true" tabindex="-1"></a><span class="co"># box_plot</span></span>
<span id="cb128-997"><a href="#cb128-997" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create density plot across years</span></span>
<span id="cb128-998"><a href="#cb128-998" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot &lt;- ggdensity(use_gear_nlg, x = "FL_CM",</span></span>
<span id="cb128-999"><a href="#cb128-999" aria-hidden="true" tabindex="-1"></a><span class="co">#                           add = "mean", rug = TRUE,</span></span>
<span id="cb128-1000"><a href="#cb128-1000" aria-hidden="true" tabindex="-1"></a><span class="co">#                           color = "LAND_GEAR_NAME", fill = "LAND_GEAR_NAME",</span></span>
<span id="cb128-1001"><a href="#cb128-1001" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ylab = "FL_CM", xlab = "Gear")</span></span>
<span id="cb128-1002"><a href="#cb128-1002" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot</span></span>
<span id="cb128-1003"><a href="#cb128-1003" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1004"><a href="#cb128-1004" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot data</span></span>
<span id="cb128-1005"><a href="#cb128-1005" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggplot2)</span></span>
<span id="cb128-1006"><a href="#cb128-1006" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(use_gear_nlg, aes(x = as.Date(FINAL_DATE), y = FL_CM)) +</span></span>
<span id="cb128-1007"><a href="#cb128-1007" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(colour = LAND_GEAR_NAME, shape = LAND_GEAR_NAME), size = 1, alpha = 0.5) +</span></span>
<span id="cb128-1008"><a href="#cb128-1008" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth(method = "lm", formula = "y ~ x", col = "black") +</span></span>
<span id="cb128-1009"><a href="#cb128-1009" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb128-1010"><a href="#cb128-1010" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "", y = "Length (cm)", colour = "", shape = "") +</span></span>
<span id="cb128-1011"><a href="#cb128-1011" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb128-1012"><a href="#cb128-1012" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = "bottom", legend.text = element_text(size = 10),</span></span>
<span id="cb128-1013"><a href="#cb128-1013" aria-hidden="true" tabindex="-1"></a><span class="co">#         legend.box.spacing = unit(0, "npc"), panel.grid = element_blank()) +</span></span>
<span id="cb128-1014"><a href="#cb128-1014" aria-hidden="true" tabindex="-1"></a><span class="co">#   guides(colour = guide_legend(override.aes = list(size = 2)))</span></span>
<span id="cb128-1015"><a href="#cb128-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1016"><a href="#cb128-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1017"><a href="#cb128-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1018"><a href="#cb128-1018" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_net_analysis}</span></span>
<span id="cb128-1019"><a href="#cb128-1019" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1020"><a href="#cb128-1020" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1021"><a href="#cb128-1021" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1022"><a href="#cb128-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1023"><a href="#cb128-1023" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb128-1024"><a href="#cb128-1024" aria-hidden="true" tabindex="-1"></a><span class="co"># library(lmerTest)</span></span>
<span id="cb128-1025"><a href="#cb128-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1026"><a href="#cb128-1026" aria-hidden="true" tabindex="-1"></a><span class="do">########### initial testing to determine which variables are significant </span></span>
<span id="cb128-1027"><a href="#cb128-1027" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb128-1028"><a href="#cb128-1028" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = use_gear_nlg, REML = FALSE)</span></span>
<span id="cb128-1029"><a href="#cb128-1029" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb128-1030"><a href="#cb128-1030" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1031"><a href="#cb128-1031" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb128-1032"><a href="#cb128-1032" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = use_gear_nlg, REML = FALSE)</span></span>
<span id="cb128-1033"><a href="#cb128-1033" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb128-1034"><a href="#cb128-1034" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1035"><a href="#cb128-1035" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb128-1036"><a href="#cb128-1036" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb128-1037"><a href="#cb128-1037" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = use_gear_nlg, REML = FALSE)</span></span>
<span id="cb128-1038"><a href="#cb128-1038" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb128-1039"><a href="#cb128-1039" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb128-1040"><a href="#cb128-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1041"><a href="#cb128-1041" aria-hidden="true" tabindex="-1"></a><span class="do">########### START ANALYSIS HERE </span></span>
<span id="cb128-1042"><a href="#cb128-1042" aria-hidden="true" tabindex="-1"></a><span class="do">### both fixed linear and glm models have warning message because ENTANGLING NETS (GILL) UNSPECIFIED only occur in one year, preventing convergence across timeline </span></span>
<span id="cb128-1043"><a href="#cb128-1043" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb128-1044"><a href="#cb128-1044" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1.1 = lmer(FL_CM ~ scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb128-1045"><a href="#cb128-1045" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = use_gear_nlg, REML = FALSE)</span></span>
<span id="cb128-1046"><a href="#cb128-1046" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1.1)</span></span>
<span id="cb128-1047"><a href="#cb128-1047" aria-hidden="true" tabindex="-1"></a><span class="co"># # summary(mod1.1, correlation = FALSE)</span></span>
<span id="cb128-1048"><a href="#cb128-1048" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1049"><a href="#cb128-1049" aria-hidden="true" tabindex="-1"></a><span class="co"># # comparing length to date and gear in a gamma full model</span></span>
<span id="cb128-1050"><a href="#cb128-1050" aria-hidden="true" tabindex="-1"></a><span class="co"># mod2 = glmer(FL_CM ~ scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb128-1051"><a href="#cb128-1051" aria-hidden="true" tabindex="-1"></a><span class="co">#              data = use_gear_nlg, family = Gamma(link=log))</span></span>
<span id="cb128-1052"><a href="#cb128-1052" aria-hidden="true" tabindex="-1"></a><span class="co"># # anova(mod2) #no p value given for gamma model by itself </span></span>
<span id="cb128-1053"><a href="#cb128-1053" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1054"><a href="#cb128-1054" aria-hidden="true" tabindex="-1"></a><span class="co"># # check which number is lower, lower number is better fitting model </span></span>
<span id="cb128-1055"><a href="#cb128-1055" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC(mod1.1, mod2)</span></span>
<span id="cb128-1056"><a href="#cb128-1056" aria-hidden="true" tabindex="-1"></a><span class="co"># # glm is better fit</span></span>
<span id="cb128-1057"><a href="#cb128-1057" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1058"><a href="#cb128-1058" aria-hidden="true" tabindex="-1"></a><span class="co"># # gamma reduced model</span></span>
<span id="cb128-1059"><a href="#cb128-1059" aria-hidden="true" tabindex="-1"></a><span class="co"># mod3 = glmer(FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb128-1060"><a href="#cb128-1060" aria-hidden="true" tabindex="-1"></a><span class="co">#              data = use_gear_nlg, family = Gamma(link=log))</span></span>
<span id="cb128-1061"><a href="#cb128-1061" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1062"><a href="#cb128-1062" aria-hidden="true" tabindex="-1"></a><span class="co"># mod4 = glmer(FL_CM ~ LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb128-1063"><a href="#cb128-1063" aria-hidden="true" tabindex="-1"></a><span class="co">#              data = use_gear_nlg, family = Gamma(link=log))</span></span>
<span id="cb128-1064"><a href="#cb128-1064" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1065"><a href="#cb128-1065" aria-hidden="true" tabindex="-1"></a><span class="co"># # likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb128-1066"><a href="#cb128-1066" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod2, mod3) #gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb128-1067"><a href="#cb128-1067" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod2, mod4) #gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb128-1068"><a href="#cb128-1068" aria-hidden="true" tabindex="-1"></a><span class="co"># # No significant p values for time period or gears</span></span>
<span id="cb128-1069"><a href="#cb128-1069" aria-hidden="true" tabindex="-1"></a><span class="co"># # Further comparisons not needed </span></span>
<span id="cb128-1070"><a href="#cb128-1070" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1071"><a href="#cb128-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1072"><a href="#cb128-1072" aria-hidden="true" tabindex="-1"></a><span class="fu">## Trap</span></span>
<span id="cb128-1073"><a href="#cb128-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1074"><a href="#cb128-1074" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_trap_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb128-1075"><a href="#cb128-1075" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1076"><a href="#cb128-1076" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1077"><a href="#cb128-1077" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1078"><a href="#cb128-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1079"><a href="#cb128-1079" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb128-1080"><a href="#cb128-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) </span>
<span id="cb128-1081"><a href="#cb128-1081" aria-hidden="true" tabindex="-1"></a><span class="co"># net land_standard_gear_name</span></span>
<span id="cb128-1082"><a href="#cb128-1082" aria-hidden="true" tabindex="-1"></a>use_gear_tr <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb128-1083"><a href="#cb128-1083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb128-1084"><a href="#cb128-1084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear <span class="sc">==</span> <span class="st">"Trap"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb128-1085"><a href="#cb128-1085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb128-1086"><a href="#cb128-1086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb128-1087"><a href="#cb128-1087" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb128-1088"><a href="#cb128-1088" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb128-1089"><a href="#cb128-1089" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(use_gear_tr, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb128-1090"><a href="#cb128-1090" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb128-1091"><a href="#cb128-1091" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb128-1092"><a href="#cb128-1092" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb128-1093"><a href="#cb128-1093" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb128-1094"><a href="#cb128-1094" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(use_gear_tr, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb128-1095"><a href="#cb128-1095" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb128-1096"><a href="#cb128-1096" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb128-1097"><a href="#cb128-1097" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb128-1098"><a href="#cb128-1098" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb128-1099"><a href="#cb128-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1100"><a href="#cb128-1100" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb128-1101"><a href="#cb128-1101" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb128-1102"><a href="#cb128-1102" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(use_gear_tr, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb128-1103"><a href="#cb128-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb128-1104"><a href="#cb128-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb128-1105"><a href="#cb128-1105" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb128-1106"><a href="#cb128-1106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb128-1107"><a href="#cb128-1107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb128-1108"><a href="#cb128-1108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb128-1109"><a href="#cb128-1109" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb128-1110"><a href="#cb128-1110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb128-1111"><a href="#cb128-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1112"><a href="#cb128-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1113"><a href="#cb128-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1114"><a href="#cb128-1114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_trap_analysis}</span></span>
<span id="cb128-1115"><a href="#cb128-1115" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1116"><a href="#cb128-1116" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1117"><a href="#cb128-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1118"><a href="#cb128-1118" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb128-1119"><a href="#cb128-1119" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb128-1120"><a href="#cb128-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1121"><a href="#cb128-1121" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb128-1122"><a href="#cb128-1122" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-1123"><a href="#cb128-1123" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_tr, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-1124"><a href="#cb128-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span>
<span id="cb128-1125"><a href="#cb128-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1126"><a href="#cb128-1126" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb128-1127"><a href="#cb128-1127" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-1128"><a href="#cb128-1128" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-1129"><a href="#cb128-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1130"><a href="#cb128-1130" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb128-1131"><a href="#cb128-1131" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb128-1132"><a href="#cb128-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1133"><a href="#cb128-1133" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb128-1134"><a href="#cb128-1134" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-1135"><a href="#cb128-1135" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-1136"><a href="#cb128-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1137"><a href="#cb128-1137" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb128-1138"><a href="#cb128-1138" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb128-1139"><a href="#cb128-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1140"><a href="#cb128-1140" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb128-1141"><a href="#cb128-1141" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb128-1142"><a href="#cb128-1142" aria-hidden="true" tabindex="-1"></a><span class="do">### Trap does not have any significantly different gears </span></span>
<span id="cb128-1143"><a href="#cb128-1143" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb128-1144"><a href="#cb128-1144" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb128-1145"><a href="#cb128-1145" aria-hidden="true" tabindex="-1"></a><span class="do">### There is no significantly different time in the Trap grouping </span></span>
<span id="cb128-1146"><a href="#cb128-1146" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb128-1147"><a href="#cb128-1147" aria-hidden="true" tabindex="-1"></a><span class="co"># No significant p values for time period or gears, further comparisons not needed </span></span>
<span id="cb128-1148"><a href="#cb128-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1149"><a href="#cb128-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1150"><a href="#cb128-1150" aria-hidden="true" tabindex="-1"></a><span class="fu"># Gear Density Plots </span></span>
<span id="cb128-1151"><a href="#cb128-1151" aria-hidden="true" tabindex="-1"></a>Filtered to years with 30 or more length records (regardless of gear) per year.</span>
<span id="cb128-1152"><a href="#cb128-1152" aria-hidden="true" tabindex="-1"></a>STT and STJ records are grouped together. </span>
<span id="cb128-1153"><a href="#cb128-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1154"><a href="#cb128-1154" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aggregated density plots</span></span>
<span id="cb128-1155"><a href="#cb128-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1156"><a href="#cb128-1156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r agg_pdf_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1157"><a href="#cb128-1157" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1158"><a href="#cb128-1158" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1159"><a href="#cb128-1159" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1160"><a href="#cb128-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1161"><a href="#cb128-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1162"><a href="#cb128-1162" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################</span></span>
<span id="cb128-1163"><a href="#cb128-1163" aria-hidden="true" tabindex="-1"></a><span class="co"># dscounts = VLg %&gt;% group_by(source) %&gt;% filter(n() &gt;= 30) %&gt;% ungroup %&gt;% </span></span>
<span id="cb128-1164"><a href="#cb128-1164" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(source) %&gt;%</span></span>
<span id="cb128-1165"><a href="#cb128-1165" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(source, " (n= ", scales::comma(n), ")" ))</span></span>
<span id="cb128-1166"><a href="#cb128-1166" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1167"><a href="#cb128-1167" aria-hidden="true" tabindex="-1"></a><span class="co"># dscc &lt;- scales::seq_gradient_pal("#22D463", "red", "Lab")(seq(0,1,length.out=dim(dscounts)[1]))</span></span>
<span id="cb128-1168"><a href="#cb128-1168" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1169"><a href="#cb128-1169" aria-hidden="true" tabindex="-1"></a><span class="co">#  VLg %&gt;% group_by(source) %&gt;% filter(n() &gt;= 30) %&gt;% ungroup %&gt;% </span></span>
<span id="cb128-1170"><a href="#cb128-1170" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(FL_CM))+</span></span>
<span id="cb128-1171"><a href="#cb128-1171" aria-hidden="true" tabindex="-1"></a><span class="co"># #  geom_density( aes(color = "Combined"))+</span></span>
<span id="cb128-1172"><a href="#cb128-1172" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_density(aes(color = source))+</span></span>
<span id="cb128-1173"><a href="#cb128-1173" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_manual(values = dscc, labels = c(dscounts$n_labels))+</span></span>
<span id="cb128-1174"><a href="#cb128-1174" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Vertical Line Data Sources", x = "Fork Length (cm)", title = paste0(region,  " VL \n (N = ", scales::comma(sum(dscounts$n)), ")"))+</span></span>
<span id="cb128-1175"><a href="#cb128-1175" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()+ guides(colour=guide_legend(ncol=1))</span></span>
<span id="cb128-1176"><a href="#cb128-1176" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb128-1177"><a href="#cb128-1177" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb128-1178"><a href="#cb128-1178" aria-hidden="true" tabindex="-1"></a><span class="co"># table(VLg$YEAR,VLg$source)</span></span>
<span id="cb128-1179"><a href="#cb128-1179" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################</span></span>
<span id="cb128-1180"><a href="#cb128-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1181"><a href="#cb128-1181" aria-hidden="true" tabindex="-1"></a><span class="do">#####################EDIT HERE ; NOT WORKING BELOW (I don't think)</span></span>
<span id="cb128-1182"><a href="#cb128-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1183"><a href="#cb128-1183" aria-hidden="true" tabindex="-1"></a>ycounts <span class="ot">=</span>length_data_final <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1184"><a href="#cb128-1184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(gear) <span class="sc">%&gt;%</span></span>
<span id="cb128-1185"><a href="#cb128-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(gear, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1186"><a href="#cb128-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1187"><a href="#cb128-1187" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1188"><a href="#cb128-1188" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM))<span class="sc">+</span></span>
<span id="cb128-1189"><a href="#cb128-1189" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_density( aes(color = "Combined"),lwd=1.5)+</span></span>
<span id="cb128-1190"><a href="#cb128-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> gear), <span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb128-1191"><a href="#cb128-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>ycounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1192"><a href="#cb128-1192" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_hue(labels=c("Combined",ycounts$n_labels))+</span></span>
<span id="cb128-1193"><a href="#cb128-1193" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = gearcols, labels = c("Combined", counts$n_labels))+</span></span>
<span id="cb128-1194"><a href="#cb128-1194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(region,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1195"><a href="#cb128-1195" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1196"><a href="#cb128-1196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1197"><a href="#cb128-1197" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1198"><a href="#cb128-1198" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-1199"><a href="#cb128-1199" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-1200"><a href="#cb128-1200" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-1201"><a href="#cb128-1201" aria-hidden="true" tabindex="-1"></a><span class="co">#  filter to 30 or more of same gear each year </span></span>
<span id="cb128-1202"><a href="#cb128-1202" aria-hidden="true" tabindex="-1"></a><span class="co"># ygearcounts =length_data_final |&gt; </span></span>
<span id="cb128-1203"><a href="#cb128-1203" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(YEAR, LAND_STANDARD_GEAR_NAME) |&gt;</span></span>
<span id="cb128-1204"><a href="#cb128-1204" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(n() &gt;= 30)|&gt;</span></span>
<span id="cb128-1205"><a href="#cb128-1205" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb128-1206"><a href="#cb128-1206" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(gear) %&gt;%</span></span>
<span id="cb128-1207"><a href="#cb128-1207" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_gearlabels = paste0(gear, " (n= ", n, ")" ))</span></span>
<span id="cb128-1208"><a href="#cb128-1208" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1209"><a href="#cb128-1209" aria-hidden="true" tabindex="-1"></a><span class="co">#  length_data_final |&gt; </span></span>
<span id="cb128-1210"><a href="#cb128-1210" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(YEAR, LAND_STANDARD_GEAR_NAME) |&gt;</span></span>
<span id="cb128-1211"><a href="#cb128-1211" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(n() &gt;= 30)|&gt;</span></span>
<span id="cb128-1212"><a href="#cb128-1212" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb128-1213"><a href="#cb128-1213" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(FL_CM))+</span></span>
<span id="cb128-1214"><a href="#cb128-1214" aria-hidden="true" tabindex="-1"></a><span class="co">#  # geom_density( aes(color = "Combined"),lwd=1.5)+</span></span>
<span id="cb128-1215"><a href="#cb128-1215" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_density(aes(color = gear), size = 0.75)+</span></span>
<span id="cb128-1216"><a href="#cb128-1216" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_hue(labels=ygearcounts$n_gearlabels)+</span></span>
<span id="cb128-1217"><a href="#cb128-1217" aria-hidden="true" tabindex="-1"></a><span class="co">#  # scale_color_hue(labels=c("Combined",ycounts$n_labels))+</span></span>
<span id="cb128-1218"><a href="#cb128-1218" aria-hidden="true" tabindex="-1"></a><span class="co">#   #scale_color_manual(values = gearcols, labels = c("Combined", counts$n_labels))+</span></span>
<span id="cb128-1219"><a href="#cb128-1219" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Gear Type", x = "Fork Length (cm)", title = paste0(region,  "\n (N = ", sum(ygearcounts$n), ")"))+</span></span>
<span id="cb128-1220"><a href="#cb128-1220" aria-hidden="true" tabindex="-1"></a><span class="co">#   # theme_minimal()</span></span>
<span id="cb128-1221"><a href="#cb128-1221" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.title = element_text(size=14), </span></span>
<span id="cb128-1222"><a href="#cb128-1222" aria-hidden="true" tabindex="-1"></a><span class="co">#     legend.text = element_text(size=12))</span></span>
<span id="cb128-1223"><a href="#cb128-1223" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-1224"><a href="#cb128-1224" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-1225"><a href="#cb128-1225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1226"><a href="#cb128-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1227"><a href="#cb128-1227" aria-hidden="true" tabindex="-1"></a>USVI TIP length comps by gear and interview type. Investigate if MARFIN and MRAG interview types can be used or should be dropped?</span>
<span id="cb128-1228"><a href="#cb128-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1229"><a href="#cb128-1229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1230"><a href="#cb128-1230" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1231"><a href="#cb128-1231" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1232"><a href="#cb128-1232" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1233"><a href="#cb128-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1234"><a href="#cb128-1234" aria-hidden="true" tabindex="-1"></a><span class="co">#table(tip_CR$INT_TYPE,useNA='always')</span></span>
<span id="cb128-1235"><a href="#cb128-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1236"><a href="#cb128-1236" aria-hidden="true" tabindex="-1"></a>usvi <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>STATE<span class="sc">==</span><span class="st">'VIRGIN ISLANDS'</span>,]</span>
<span id="cb128-1237"><a href="#cb128-1237" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> usvi <span class="sc">%&gt;%</span></span>
<span id="cb128-1238"><a href="#cb128-1238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(INT_TYPE) <span class="sc">%&gt;%</span></span>
<span id="cb128-1239"><a href="#cb128-1239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(INT_TYPE, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1240"><a href="#cb128-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1241"><a href="#cb128-1241" aria-hidden="true" tabindex="-1"></a>  usvi <span class="sc">%&gt;%</span></span>
<span id="cb128-1242"><a href="#cb128-1242" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> INT_TYPE))<span class="sc">+</span></span>
<span id="cb128-1243"><a href="#cb128-1243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb128-1244"><a href="#cb128-1244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1245"><a href="#cb128-1245" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1246"><a href="#cb128-1246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Interview Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(usvi<span class="sc">$</span>STATE,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1247"><a href="#cb128-1247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>gear) <span class="sc">+</span></span>
<span id="cb128-1248"><a href="#cb128-1248" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1249"><a href="#cb128-1249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1250"><a href="#cb128-1250" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1251"><a href="#cb128-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1252"><a href="#cb128-1252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1253"><a href="#cb128-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1254"><a href="#cb128-1254" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gear grouping investigation</span></span>
<span id="cb128-1255"><a href="#cb128-1255" aria-hidden="true" tabindex="-1"></a>Filtered to minimum 30 fish per year</span>
<span id="cb128-1256"><a href="#cb128-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1257"><a href="#cb128-1257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1258"><a href="#cb128-1258" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1259"><a href="#cb128-1259" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1260"><a href="#cb128-1260" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1261"><a href="#cb128-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1262"><a href="#cb128-1262" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1263"><a href="#cb128-1263" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb128-1264"><a href="#cb128-1264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb128-1265"><a href="#cb128-1265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>ycounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1266"><a href="#cb128-1266" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1267"><a href="#cb128-1267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1268"><a href="#cb128-1268" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1269"><a href="#cb128-1269" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1270"><a href="#cb128-1270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1271"><a href="#cb128-1271" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1272"><a href="#cb128-1272" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-1273"><a href="#cb128-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1274"><a href="#cb128-1274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1275"><a href="#cb128-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1276"><a href="#cb128-1276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_hl_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1277"><a href="#cb128-1277" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1278"><a href="#cb128-1278" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1279"><a href="#cb128-1279" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1280"><a href="#cb128-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1281"><a href="#cb128-1281" aria-hidden="true" tabindex="-1"></a>hl<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'HL'</span>,]</span>
<span id="cb128-1282"><a href="#cb128-1282" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> hl <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1283"><a href="#cb128-1283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb128-1284"><a href="#cb128-1284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1285"><a href="#cb128-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1286"><a href="#cb128-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1287"><a href="#cb128-1287" aria-hidden="true" tabindex="-1"></a><span class="co"># hl_car &lt;-</span></span>
<span id="cb128-1288"><a href="#cb128-1288" aria-hidden="true" tabindex="-1"></a>hl <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1289"><a href="#cb128-1289" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb128-1290"><a href="#cb128-1290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb128-1291"><a href="#cb128-1291" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1292"><a href="#cb128-1292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1293"><a href="#cb128-1293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1294"><a href="#cb128-1294" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1295"><a href="#cb128-1295" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1296"><a href="#cb128-1296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1297"><a href="#cb128-1297" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1298"><a href="#cb128-1298" aria-hidden="true" tabindex="-1"></a><span class="co"># hl_car</span></span>
<span id="cb128-1299"><a href="#cb128-1299" aria-hidden="true" tabindex="-1"></a><span class="co"># export_fig(hl_car)</span></span>
<span id="cb128-1300"><a href="#cb128-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1301"><a href="#cb128-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1302"><a href="#cb128-1302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1303"><a href="#cb128-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1304"><a href="#cb128-1304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_trap_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1305"><a href="#cb128-1305" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1306"><a href="#cb128-1306" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1307"><a href="#cb128-1307" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1308"><a href="#cb128-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1309"><a href="#cb128-1309" aria-hidden="true" tabindex="-1"></a>trap <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'TR'</span>,]</span>
<span id="cb128-1310"><a href="#cb128-1310" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> trap <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1311"><a href="#cb128-1311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb128-1312"><a href="#cb128-1312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1313"><a href="#cb128-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1314"><a href="#cb128-1314" aria-hidden="true" tabindex="-1"></a>trap <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1315"><a href="#cb128-1315" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb128-1316"><a href="#cb128-1316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb128-1317"><a href="#cb128-1317" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1318"><a href="#cb128-1318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1319"><a href="#cb128-1319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1320"><a href="#cb128-1320" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1321"><a href="#cb128-1321" aria-hidden="true" tabindex="-1"></a> <span class="co"># theme_minimal()</span></span>
<span id="cb128-1322"><a href="#cb128-1322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1323"><a href="#cb128-1323" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1324"><a href="#cb128-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1325"><a href="#cb128-1325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1326"><a href="#cb128-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1327"><a href="#cb128-1327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_net_plot,fig.width=12, fig.height=8}</span></span>
<span id="cb128-1328"><a href="#cb128-1328" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1329"><a href="#cb128-1329" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1330"><a href="#cb128-1330" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1331"><a href="#cb128-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1332"><a href="#cb128-1332" aria-hidden="true" tabindex="-1"></a><span class="co">#nets might need to be another category because haul seines, trammel, and entangling (gill unsp) have too many occurances to be in other </span></span>
<span id="cb128-1333"><a href="#cb128-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1334"><a href="#cb128-1334" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'NT'</span>,]</span>
<span id="cb128-1335"><a href="#cb128-1335" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> net <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1336"><a href="#cb128-1336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb128-1337"><a href="#cb128-1337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1338"><a href="#cb128-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1339"><a href="#cb128-1339" aria-hidden="true" tabindex="-1"></a>net <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1340"><a href="#cb128-1340" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM,<span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb128-1341"><a href="#cb128-1341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb128-1342"><a href="#cb128-1342" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1343"><a href="#cb128-1343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1344"><a href="#cb128-1344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1345"><a href="#cb128-1345" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1346"><a href="#cb128-1346" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1347"><a href="#cb128-1347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1348"><a href="#cb128-1348" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1349"><a href="#cb128-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1350"><a href="#cb128-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1351"><a href="#cb128-1351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1352"><a href="#cb128-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1353"><a href="#cb128-1353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_other_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1354"><a href="#cb128-1354" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1355"><a href="#cb128-1355" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1356"><a href="#cb128-1356" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1357"><a href="#cb128-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1358"><a href="#cb128-1358" aria-hidden="true" tabindex="-1"></a>ot<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'OT'</span>,]</span>
<span id="cb128-1359"><a href="#cb128-1359" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> ot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1360"><a href="#cb128-1360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb128-1361"><a href="#cb128-1361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1362"><a href="#cb128-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1363"><a href="#cb128-1363" aria-hidden="true" tabindex="-1"></a>ot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1364"><a href="#cb128-1364" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb128-1365"><a href="#cb128-1365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb128-1366"><a href="#cb128-1366" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1367"><a href="#cb128-1367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1368"><a href="#cb128-1368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1369"><a href="#cb128-1369" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1370"><a href="#cb128-1370" aria-hidden="true" tabindex="-1"></a> <span class="co"># theme_minimal()</span></span>
<span id="cb128-1371"><a href="#cb128-1371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1372"><a href="#cb128-1372" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1373"><a href="#cb128-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1374"><a href="#cb128-1374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1375"><a href="#cb128-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1376"><a href="#cb128-1376" aria-hidden="true" tabindex="-1"></a><span class="fu">## Break at 2005</span></span>
<span id="cb128-1377"><a href="#cb128-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1378"><a href="#cb128-1378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_plot_2005, fig.width=15, fig.height=8}</span></span>
<span id="cb128-1379"><a href="#cb128-1379" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1380"><a href="#cb128-1380" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1381"><a href="#cb128-1381" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1382"><a href="#cb128-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1383"><a href="#cb128-1383" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> <span class="co"># filter(YEAR &gt; 2011) |&gt; </span></span>
<span id="cb128-1384"><a href="#cb128-1384" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb128-1385"><a href="#cb128-1385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb128-1386"><a href="#cb128-1386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>ycounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1387"><a href="#cb128-1387" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1388"><a href="#cb128-1388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1389"><a href="#cb128-1389" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1390"><a href="#cb128-1390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb128-1391"><a href="#cb128-1391" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1392"><a href="#cb128-1392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1393"><a href="#cb128-1393" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1394"><a href="#cb128-1394" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-1395"><a href="#cb128-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1396"><a href="#cb128-1396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1397"><a href="#cb128-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1398"><a href="#cb128-1398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_hookandline_plot_2005, fig.width=15, fig.height=8}</span></span>
<span id="cb128-1399"><a href="#cb128-1399" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1400"><a href="#cb128-1400" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1401"><a href="#cb128-1401" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1402"><a href="#cb128-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1403"><a href="#cb128-1403" aria-hidden="true" tabindex="-1"></a>HL <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'HL'</span>,]</span>
<span id="cb128-1404"><a href="#cb128-1404" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> HL <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1405"><a href="#cb128-1405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb128-1406"><a href="#cb128-1406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1407"><a href="#cb128-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1408"><a href="#cb128-1408" aria-hidden="true" tabindex="-1"></a>HL <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1409"><a href="#cb128-1409" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb128-1410"><a href="#cb128-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb128-1411"><a href="#cb128-1411" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1412"><a href="#cb128-1412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1413"><a href="#cb128-1413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1414"><a href="#cb128-1414" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1415"><a href="#cb128-1415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb128-1416"><a href="#cb128-1416" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1417"><a href="#cb128-1417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1418"><a href="#cb128-1418" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1419"><a href="#cb128-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1420"><a href="#cb128-1420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1421"><a href="#cb128-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1422"><a href="#cb128-1422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_net_plot_2005, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1423"><a href="#cb128-1423" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1424"><a href="#cb128-1424" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1425"><a href="#cb128-1425" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1426"><a href="#cb128-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1427"><a href="#cb128-1427" aria-hidden="true" tabindex="-1"></a><span class="co">#nets might need to be another category because haul seines, trammel, and entangling (gill unsp) have too many occurances to be in other </span></span>
<span id="cb128-1428"><a href="#cb128-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1429"><a href="#cb128-1429" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'NT'</span>,]</span>
<span id="cb128-1430"><a href="#cb128-1430" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> net <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1431"><a href="#cb128-1431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb128-1432"><a href="#cb128-1432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1433"><a href="#cb128-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1434"><a href="#cb128-1434" aria-hidden="true" tabindex="-1"></a>net <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1435"><a href="#cb128-1435" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM,<span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb128-1436"><a href="#cb128-1436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb128-1437"><a href="#cb128-1437" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1438"><a href="#cb128-1438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1439"><a href="#cb128-1439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1440"><a href="#cb128-1440" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1441"><a href="#cb128-1441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb128-1442"><a href="#cb128-1442" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1443"><a href="#cb128-1443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1444"><a href="#cb128-1444" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1445"><a href="#cb128-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1446"><a href="#cb128-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1447"><a href="#cb128-1447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1448"><a href="#cb128-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1449"><a href="#cb128-1449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_trap_plot_2005, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1450"><a href="#cb128-1450" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1451"><a href="#cb128-1451" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1452"><a href="#cb128-1452" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1453"><a href="#cb128-1453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1454"><a href="#cb128-1454" aria-hidden="true" tabindex="-1"></a>trap <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'TR'</span>,]</span>
<span id="cb128-1455"><a href="#cb128-1455" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> trap <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1456"><a href="#cb128-1456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb128-1457"><a href="#cb128-1457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1458"><a href="#cb128-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1459"><a href="#cb128-1459" aria-hidden="true" tabindex="-1"></a>trap <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1460"><a href="#cb128-1460" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM,<span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb128-1461"><a href="#cb128-1461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb128-1462"><a href="#cb128-1462" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1463"><a href="#cb128-1463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1464"><a href="#cb128-1464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1465"><a href="#cb128-1465" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1466"><a href="#cb128-1466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb128-1467"><a href="#cb128-1467" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1468"><a href="#cb128-1468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1469"><a href="#cb128-1469" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1470"><a href="#cb128-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1471"><a href="#cb128-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1472"><a href="#cb128-1472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1473"><a href="#cb128-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1474"><a href="#cb128-1474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_other_plot_2005, fig.width=15, fig.height=8}</span></span>
<span id="cb128-1475"><a href="#cb128-1475" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1476"><a href="#cb128-1476" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1477"><a href="#cb128-1477" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1478"><a href="#cb128-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1479"><a href="#cb128-1479" aria-hidden="true" tabindex="-1"></a>ot<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'OT'</span>,]</span>
<span id="cb128-1480"><a href="#cb128-1480" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> ot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1481"><a href="#cb128-1481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb128-1482"><a href="#cb128-1482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1483"><a href="#cb128-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1484"><a href="#cb128-1484" aria-hidden="true" tabindex="-1"></a>ot <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1485"><a href="#cb128-1485" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb128-1486"><a href="#cb128-1486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb128-1487"><a href="#cb128-1487" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1488"><a href="#cb128-1488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1489"><a href="#cb128-1489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1490"><a href="#cb128-1490" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1491"><a href="#cb128-1491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb128-1492"><a href="#cb128-1492" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1493"><a href="#cb128-1493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1494"><a href="#cb128-1494" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1495"><a href="#cb128-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1496"><a href="#cb128-1496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1497"><a href="#cb128-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1498"><a href="#cb128-1498" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual Density plots</span></span>
<span id="cb128-1499"><a href="#cb128-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1500"><a href="#cb128-1500" aria-hidden="true" tabindex="-1"></a>This will be split by final gear aggregations once these are decided, removes "other" gear types.</span>
<span id="cb128-1501"><a href="#cb128-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1502"><a href="#cb128-1502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual_pdf_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1503"><a href="#cb128-1503" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1504"><a href="#cb128-1504" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1505"><a href="#cb128-1505" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1506"><a href="#cb128-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1507"><a href="#cb128-1507" aria-hidden="true" tabindex="-1"></a>fleet_final <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>fleet<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb128-1508"><a href="#cb128-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1509"><a href="#cb128-1509" aria-hidden="true" tabindex="-1"></a>fcounts <span class="ot">=</span> fleet_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1510"><a href="#cb128-1510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(gear) <span class="sc">%&gt;%</span></span>
<span id="cb128-1511"><a href="#cb128-1511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(gear, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1512"><a href="#cb128-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1513"><a href="#cb128-1513" aria-hidden="true" tabindex="-1"></a>all_car <span class="ot">&lt;-</span></span>
<span id="cb128-1514"><a href="#cb128-1514" aria-hidden="true" tabindex="-1"></a> fleet_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1515"><a href="#cb128-1515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb128-1516"><a href="#cb128-1516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_labs =</span> <span class="fu">paste0</span>(YEAR, <span class="st">"</span><span class="sc">\n</span><span class="st"> n = "</span>, <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb128-1517"><a href="#cb128-1517" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb128-1518"><a href="#cb128-1518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb128-1519"><a href="#cb128-1519" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1520"><a href="#cb128-1520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>fcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1521"><a href="#cb128-1521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(fcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1522"><a href="#cb128-1522" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>year_labs)<span class="sc">+</span></span>
<span id="cb128-1523"><a href="#cb128-1523" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1524"><a href="#cb128-1524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1525"><a href="#cb128-1525" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1526"><a href="#cb128-1526" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-1527"><a href="#cb128-1527" aria-hidden="true" tabindex="-1"></a>all_car</span>
<span id="cb128-1528"><a href="#cb128-1528" aria-hidden="true" tabindex="-1"></a><span class="fu">export_fig_page</span>(all_car)</span>
<span id="cb128-1529"><a href="#cb128-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1530"><a href="#cb128-1530" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1531"><a href="#cb128-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1532"><a href="#cb128-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1533"><a href="#cb128-1533" aria-hidden="true" tabindex="-1"></a><span class="in">```{r STT}</span></span>
<span id="cb128-1534"><a href="#cb128-1534" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1535"><a href="#cb128-1535" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1536"><a href="#cb128-1536" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1537"><a href="#cb128-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1538"><a href="#cb128-1538" aria-hidden="true" tabindex="-1"></a><span class="co"># table(length_data_final$ISLAND)</span></span>
<span id="cb128-1539"><a href="#cb128-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1540"><a href="#cb128-1540" aria-hidden="true" tabindex="-1"></a>ST <span class="ot">&lt;-</span> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb128-1541"><a href="#cb128-1541" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(ISLAND<span class="sc">==</span><span class="st">'ST THOMAS'</span><span class="sc">|</span>ISLAND<span class="sc">==</span><span class="st">'ST JOHN'</span>)</span>
<span id="cb128-1542"><a href="#cb128-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1543"><a href="#cb128-1543" aria-hidden="true" tabindex="-1"></a>vessel_st <span class="ot">&lt;-</span> <span class="fu">distinct</span>(ST, VESSEL_ID, LICENSE)</span>
<span id="cb128-1544"><a href="#cb128-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1545"><a href="#cb128-1545" aria-hidden="true" tabindex="-1"></a>final_gears <span class="ot">&lt;-</span> <span class="fu">unique</span>(ST<span class="sc">$</span>gear_short)  <span class="do">##++this is where final length comps are generated ; could be aggregated above (e.g. via lookup table) &amp; should be 1 here </span></span>
<span id="cb128-1546"><a href="#cb128-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1547"><a href="#cb128-1547" aria-hidden="true" tabindex="-1"></a>ST_comps <span class="ot">&lt;-</span> <span class="fu">list</span>()  <span class="do">##++this creates an empty list for for loop</span></span>
<span id="cb128-1548"><a href="#cb128-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1549"><a href="#cb128-1549" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop generates binned length comps for each of the final gears. Stored in list. RUN:  View(comps[[1]]) to see in R</span></span>
<span id="cb128-1550"><a href="#cb128-1550" aria-hidden="true" tabindex="-1"></a><span class="co"># View(ST_comps[[1]])</span></span>
<span id="cb128-1551"><a href="#cb128-1551" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(final_gears)){</span>
<span id="cb128-1552"><a href="#cb128-1552" aria-hidden="true" tabindex="-1"></a> ST_comps[[i]] <span class="ot">&lt;-</span>  ST <span class="sc">%&gt;%</span></span>
<span id="cb128-1553"><a href="#cb128-1553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear_short <span class="sc">==</span> final_gears[i]) <span class="sc">%&gt;%</span></span>
<span id="cb128-1554"><a href="#cb128-1554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb128-1555"><a href="#cb128-1555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ln_fish =</span> <span class="fu">n</span>(),</span>
<span id="cb128-1556"><a href="#cb128-1556" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_trips =</span> <span class="fu">length</span>(<span class="fu">unique</span>(ID)),</span>
<span id="cb128-1557"><a href="#cb128-1557" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_dealers=</span><span class="fu">length</span>(<span class="fu">unique</span>(DEALER_CODE)),</span>
<span id="cb128-1558"><a href="#cb128-1558" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_vessels=</span><span class="fu">length</span>(<span class="fu">unique</span>(VESSEL_ID))) <span class="sc">%&gt;%</span></span>
<span id="cb128-1559"><a href="#cb128-1559" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb128-1560"><a href="#cb128-1560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels, lbin)<span class="sc">%&gt;%</span></span>
<span id="cb128-1561"><a href="#cb128-1561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">unique</span>(ln_fish)) <span class="sc">%&gt;%</span></span>
<span id="cb128-1562"><a href="#cb128-1562" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb128-1563"><a href="#cb128-1563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels), </span>
<span id="cb128-1564"><a href="#cb128-1564" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> lbin, </span>
<span id="cb128-1565"><a href="#cb128-1565" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> freq, </span>
<span id="cb128-1566"><a href="#cb128-1566" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">freq =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb128-1567"><a href="#cb128-1567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(full_set) <span class="sc">%&gt;%</span></span>
<span id="cb128-1568"><a href="#cb128-1568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comp_names)<span class="sc">%&gt;%</span></span>
<span id="cb128-1569"><a href="#cb128-1569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-1570"><a href="#cb128-1570" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">flag_n  =</span> <span class="fu">ifelse</span>(ln_fish <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">0</span>, </span>
<span id="cb128-1571"><a href="#cb128-1571" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(ln_fish <span class="sc">&lt;</span> <span class="dv">15</span>, <span class="dv">2</span>, <span class="dv">1</span>)))</span>
<span id="cb128-1572"><a href="#cb128-1572" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-1573"><a href="#cb128-1573" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(ST_comps)[[i]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(final_gears[i], <span class="st">"_"</span>, bin_size, <span class="st">"cm"</span>) <span class="do">##++tabs are named here ; could add _nom here if desired (instead of _lfd and _lfdw in main file)</span></span>
<span id="cb128-1574"><a href="#cb128-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1575"><a href="#cb128-1575" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb128-1576"><a href="#cb128-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1577"><a href="#cb128-1577" aria-hidden="true" tabindex="-1"></a><span class="co">#write.xlsx(ST_comps, file="./comps/ST_QTF_com_lfd_8319_20210827C.xlsx")</span></span>
<span id="cb128-1578"><a href="#cb128-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1579"><a href="#cb128-1579" aria-hidden="true" tabindex="-1"></a><span class="do">##NOT WORKING =(</span></span>
<span id="cb128-1580"><a href="#cb128-1580" aria-hidden="true" tabindex="-1"></a><span class="co">#write.xlsx(comps, file = paste0("./comps/", sp, "_com_lfd_", sprintf('%02d', min_year %% 100), sprintf('%02d', max_year %% 100), "_", gsub("-", "", Sys.Date()), ".xlsx"))</span></span>
<span id="cb128-1581"><a href="#cb128-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1582"><a href="#cb128-1582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1583"><a href="#cb128-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1584"><a href="#cb128-1584" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stacked bar charts</span></span>
<span id="cb128-1585"><a href="#cb128-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1586"><a href="#cb128-1586" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visual representation of gear distribution within groupings</span></span>
<span id="cb128-1587"><a href="#cb128-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1588"><a href="#cb128-1588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_plot, fig.width=10, fig.height=6}</span></span>
<span id="cb128-1589"><a href="#cb128-1589" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1590"><a href="#cb128-1590" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1591"><a href="#cb128-1591" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1592"><a href="#cb128-1592" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1593"><a href="#cb128-1593" aria-hidden="true" tabindex="-1"></a><span class="co"># counts =length_data_final %&gt;%</span></span>
<span id="cb128-1594"><a href="#cb128-1594" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(LAND_STANDARD_GEAR_NAME) %&gt;%</span></span>
<span id="cb128-1595"><a href="#cb128-1595" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(LAND_STANDARD_GEAR_NAME, " (n= ", n, ")" ))</span></span>
<span id="cb128-1596"><a href="#cb128-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1597"><a href="#cb128-1597" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-1598"><a href="#cb128-1598" aria-hidden="true" tabindex="-1"></a>  length_data_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb128-1599"><a href="#cb128-1599" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> LAND_STANDARD_GEAR_NAME, <span class="at">y =</span> FL_CM, <span class="at">x=</span> gear))<span class="sc">+</span></span>
<span id="cb128-1600"><a href="#cb128-1600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">stat=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb128-1601"><a href="#cb128-1601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1602"><a href="#cb128-1602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1603"><a href="#cb128-1603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb128-1604"><a href="#cb128-1604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))</span>
<span id="cb128-1605"><a href="#cb128-1605" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guides(color = guide_legend(override.aes = list(size = 0.5))) </span></span>
<span id="cb128-1606"><a href="#cb128-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1607"><a href="#cb128-1607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1608"><a href="#cb128-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1609"><a href="#cb128-1609" aria-hidden="true" tabindex="-1"></a><span class="fu"># Gear distribution across time by gear groupings</span></span>
<span id="cb128-1610"><a href="#cb128-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1611"><a href="#cb128-1611" aria-hidden="true" tabindex="-1"></a><span class="fu">## All gears over time</span></span>
<span id="cb128-1612"><a href="#cb128-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1613"><a href="#cb128-1613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=15, fig.height=15}</span></span>
<span id="cb128-1614"><a href="#cb128-1614" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1615"><a href="#cb128-1615" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Stoplight Parrotfish LAND_STANDARD_GEAR_NAME STX</span></span>
<span id="cb128-1616"><a href="#cb128-1616" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb128-1617"><a href="#cb128-1617" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1618"><a href="#cb128-1618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1619"><a href="#cb128-1619" aria-hidden="true" tabindex="-1"></a><span class="co"># create count of observed records by individual gear name</span></span>
<span id="cb128-1620"><a href="#cb128-1620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1621"><a href="#cb128-1621" aria-hidden="true" tabindex="-1"></a>sttj_count <span class="ot">&lt;-</span> length_data_final <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb128-1622"><a href="#cb128-1622" aria-hidden="true" tabindex="-1"></a>   <span class="fu">add_count</span>(COUNTY) <span class="sc">%&gt;%</span></span>
<span id="cb128-1623"><a href="#cb128-1623" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">COUNTYn =</span> <span class="fu">paste0</span>(COUNTY, <span class="st">' ('</span>, n, <span class="st">')'</span>)) </span>
<span id="cb128-1624"><a href="#cb128-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1625"><a href="#cb128-1625" aria-hidden="true" tabindex="-1"></a>sttj_gear_time <span class="ot">&lt;-</span> <span class="fu">subset</span>(sttj_count, <span class="at">select =</span> <span class="sc">-</span>n) <span class="sc">%&gt;%</span> </span>
<span id="cb128-1626"><a href="#cb128-1626" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_count</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb128-1627"><a href="#cb128-1627" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">LAND_STANDARD_GEAR_NAMEn =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">'('</span>, n, <span class="st">')'</span>)) </span>
<span id="cb128-1628"><a href="#cb128-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1629"><a href="#cb128-1629" aria-hidden="true" tabindex="-1"></a><span class="co"># plot    </span></span>
<span id="cb128-1630"><a href="#cb128-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1631"><a href="#cb128-1631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> sttj_gear_time, <span class="fu">aes</span>(<span class="at">x =</span> FINAL_DATE, <span class="at">y =</span> LAND_STANDARD_GEAR_NAMEn , <span class="at">group =</span> COUNTY ,<span class="at">color =</span> COUNTYn )) <span class="sc">+</span> </span>
<span id="cb128-1632"><a href="#cb128-1632" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(COUNTY), <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb128-1633"><a href="#cb128-1633" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb128-1634"><a href="#cb128-1634" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"STANDARDGEARNAME_1 (# obs)"</span>, </span>
<span id="cb128-1635"><a href="#cb128-1635" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Area-time distribution of landed gear STTJ"</span>, </span>
<span id="cb128-1636"><a href="#cb128-1636" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"COUNTY (# obs)"</span>,</span>
<span id="cb128-1637"><a href="#cb128-1637" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"N = "</span>, <span class="fu">nrow</span>(sttj_gear_time))) </span>
<span id="cb128-1638"><a href="#cb128-1638" aria-hidden="true" tabindex="-1"></a>    <span class="co"># theme(legend.position = "none")</span></span>
<span id="cb128-1639"><a href="#cb128-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1640"><a href="#cb128-1640" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1641"><a href="#cb128-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1642"><a href="#cb128-1642" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hook and Line Gear Distribution Over Time by Year</span></span>
<span id="cb128-1643"><a href="#cb128-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1644"><a href="#cb128-1644" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_hl_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1645"><a href="#cb128-1645" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1646"><a href="#cb128-1646" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1647"><a href="#cb128-1647" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1648"><a href="#cb128-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1649"><a href="#cb128-1649" aria-hidden="true" tabindex="-1"></a>hl2<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'HL'</span>,]</span>
<span id="cb128-1650"><a href="#cb128-1650" aria-hidden="true" tabindex="-1"></a>hl4<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(hl2<span class="sc">$</span>FL_CM, <span class="fu">list</span>(hl2<span class="sc">$</span>YEAR, hl2<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb128-1651"><a href="#cb128-1651" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(hl4) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb128-1652"><a href="#cb128-1652" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> hl2 <span class="sc">%&gt;%</span></span>
<span id="cb128-1653"><a href="#cb128-1653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb128-1654"><a href="#cb128-1654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1655"><a href="#cb128-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1656"><a href="#cb128-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1657"><a href="#cb128-1657" aria-hidden="true" tabindex="-1"></a><span class="co"># hl_car &lt;-</span></span>
<span id="cb128-1658"><a href="#cb128-1658" aria-hidden="true" tabindex="-1"></a>hl4 <span class="sc">%&gt;%</span></span>
<span id="cb128-1659"><a href="#cb128-1659" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb128-1660"><a href="#cb128-1660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb128-1661"><a href="#cb128-1661" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1662"><a href="#cb128-1662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1663"><a href="#cb128-1663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1664"><a href="#cb128-1664" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1665"><a href="#cb128-1665" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1666"><a href="#cb128-1666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1667"><a href="#cb128-1667" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1668"><a href="#cb128-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1669"><a href="#cb128-1669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1670"><a href="#cb128-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1671"><a href="#cb128-1671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_hl_plot_range, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1672"><a href="#cb128-1672" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1673"><a href="#cb128-1673" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1674"><a href="#cb128-1674" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1675"><a href="#cb128-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1676"><a href="#cb128-1676" aria-hidden="true" tabindex="-1"></a><span class="co"># display yearly values of gears in same group on same graph</span></span>
<span id="cb128-1677"><a href="#cb128-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1678"><a href="#cb128-1678" aria-hidden="true" tabindex="-1"></a><span class="co"># summary_hl2 &lt;- hl2 %&gt;% </span></span>
<span id="cb128-1679"><a href="#cb128-1679" aria-hidden="true" tabindex="-1"></a><span class="co">#     group_by(YEAR) %&gt;% </span></span>
<span id="cb128-1680"><a href="#cb128-1680" aria-hidden="true" tabindex="-1"></a><span class="co">#     summarise(lower = min(FL_CM), upper = max(FL_CM), p = median(FL_CM))</span></span>
<span id="cb128-1681"><a href="#cb128-1681" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1682"><a href="#cb128-1682" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(data = summary_hl2, mapping = aes(x = YEAR, y = p)) +</span></span>
<span id="cb128-1683"><a href="#cb128-1683" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_pointrange(mapping = aes(ymin = lower, ymax = upper)) # doesn't separate by gear, can we do that? </span></span>
<span id="cb128-1684"><a href="#cb128-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1685"><a href="#cb128-1685" aria-hidden="true" tabindex="-1"></a><span class="do">## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).</span></span>
<span id="cb128-1686"><a href="#cb128-1686" aria-hidden="true" tabindex="-1"></a><span class="do">##   data: a data frame.</span></span>
<span id="cb128-1687"><a href="#cb128-1687" aria-hidden="true" tabindex="-1"></a><span class="do">##   measurevar: the name of a column that contains the variable to be summariezed</span></span>
<span id="cb128-1688"><a href="#cb128-1688" aria-hidden="true" tabindex="-1"></a><span class="do">##   groupvars: a vector containing names of columns that contain grouping variables</span></span>
<span id="cb128-1689"><a href="#cb128-1689" aria-hidden="true" tabindex="-1"></a><span class="do">##   na.rm: a boolean that indicates whether to ignore NA's</span></span>
<span id="cb128-1690"><a href="#cb128-1690" aria-hidden="true" tabindex="-1"></a><span class="do">##   conf.interval: the percent range of the confidence interval (default is 95%)</span></span>
<span id="cb128-1691"><a href="#cb128-1691" aria-hidden="true" tabindex="-1"></a><span class="co"># summarySE &lt;- function(data=hl2, measurevar, groupvars=c("gear", "YEAR"), na.rm=FALSE,</span></span>
<span id="cb128-1692"><a href="#cb128-1692" aria-hidden="true" tabindex="-1"></a><span class="co">#                       conf.interval=.95, .drop=TRUE) {</span></span>
<span id="cb128-1693"><a href="#cb128-1693" aria-hidden="true" tabindex="-1"></a><span class="co">#     library(plyr)</span></span>
<span id="cb128-1694"><a href="#cb128-1694" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1695"><a href="#cb128-1695" aria-hidden="true" tabindex="-1"></a><span class="co">#     # New version of length which can handle NA's: if na.rm==T, don't count them</span></span>
<span id="cb128-1696"><a href="#cb128-1696" aria-hidden="true" tabindex="-1"></a><span class="co">#     length2 &lt;- function (x, na.rm=FALSE) {</span></span>
<span id="cb128-1697"><a href="#cb128-1697" aria-hidden="true" tabindex="-1"></a><span class="co">#         if (na.rm) sum(!is.na(x))</span></span>
<span id="cb128-1698"><a href="#cb128-1698" aria-hidden="true" tabindex="-1"></a><span class="co">#         else       length(x)</span></span>
<span id="cb128-1699"><a href="#cb128-1699" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb128-1700"><a href="#cb128-1700" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1701"><a href="#cb128-1701" aria-hidden="true" tabindex="-1"></a><span class="co">#     # This does the summary. For each group's data frame, return a vector with</span></span>
<span id="cb128-1702"><a href="#cb128-1702" aria-hidden="true" tabindex="-1"></a><span class="co">#     # N, mean, and sd</span></span>
<span id="cb128-1703"><a href="#cb128-1703" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac &lt;- ddply(data, groupvars, .drop=.drop,</span></span>
<span id="cb128-1704"><a href="#cb128-1704" aria-hidden="true" tabindex="-1"></a><span class="co">#       .fun = function(xx, col) {</span></span>
<span id="cb128-1705"><a href="#cb128-1705" aria-hidden="true" tabindex="-1"></a><span class="co">#         c(N    = length2(xx[[col]], na.rm=na.rm),</span></span>
<span id="cb128-1706"><a href="#cb128-1706" aria-hidden="true" tabindex="-1"></a><span class="co">#           mean = mean   (xx[[col]], na.rm=na.rm),</span></span>
<span id="cb128-1707"><a href="#cb128-1707" aria-hidden="true" tabindex="-1"></a><span class="co">#           sd   = sd     (xx[[col]], na.rm=na.rm)</span></span>
<span id="cb128-1708"><a href="#cb128-1708" aria-hidden="true" tabindex="-1"></a><span class="co">#         )</span></span>
<span id="cb128-1709"><a href="#cb128-1709" aria-hidden="true" tabindex="-1"></a><span class="co">#       },</span></span>
<span id="cb128-1710"><a href="#cb128-1710" aria-hidden="true" tabindex="-1"></a><span class="co">#       measurevar</span></span>
<span id="cb128-1711"><a href="#cb128-1711" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb128-1712"><a href="#cb128-1712" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1713"><a href="#cb128-1713" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Rename the "mean" column    </span></span>
<span id="cb128-1714"><a href="#cb128-1714" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac &lt;- rename(datac, c("mean" = measurevar))</span></span>
<span id="cb128-1715"><a href="#cb128-1715" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1716"><a href="#cb128-1716" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac$se &lt;- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean</span></span>
<span id="cb128-1717"><a href="#cb128-1717" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1718"><a href="#cb128-1718" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Confidence interval multiplier for standard error</span></span>
<span id="cb128-1719"><a href="#cb128-1719" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Calculate t-statistic for confidence interval: </span></span>
<span id="cb128-1720"><a href="#cb128-1720" aria-hidden="true" tabindex="-1"></a><span class="co">#     # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1</span></span>
<span id="cb128-1721"><a href="#cb128-1721" aria-hidden="true" tabindex="-1"></a><span class="co">#     ciMult &lt;- qt(conf.interval/2 + .5, datac$N-1)</span></span>
<span id="cb128-1722"><a href="#cb128-1722" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac$ci &lt;- datac$se * ciMult</span></span>
<span id="cb128-1723"><a href="#cb128-1723" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1724"><a href="#cb128-1724" aria-hidden="true" tabindex="-1"></a><span class="co">#     return(datac)</span></span>
<span id="cb128-1725"><a href="#cb128-1725" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb128-1726"><a href="#cb128-1726" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1727"><a href="#cb128-1727" aria-hidden="true" tabindex="-1"></a><span class="co"># hl2sum &lt;- summarySE(data=hl2, measurevar="FL_CM", groupvars=c("gear","year"), na.rm=FALSE, conf.interval=.95)</span></span>
<span id="cb128-1728"><a href="#cb128-1728" aria-hidden="true" tabindex="-1"></a><span class="co"># hl2sum &lt;- summarySE(hl2, measurevar="FL_CM", groupvars=c("gear","year"))</span></span>
<span id="cb128-1729"><a href="#cb128-1729" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1730"><a href="#cb128-1730" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(hl2, aes(x=YEAR, y=FL_CM, colour=gear)) + </span></span>
<span id="cb128-1731"><a href="#cb128-1731" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_errorbar(aes(ymin=FL_CM-se, ymax=FL_CM+se), width=.1) +</span></span>
<span id="cb128-1732"><a href="#cb128-1732" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_line() +</span></span>
<span id="cb128-1733"><a href="#cb128-1733" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_point()</span></span>
<span id="cb128-1734"><a href="#cb128-1734" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1735"><a href="#cb128-1735" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(hl2, aes(x=YEAR, y=FL_CM, colour=gear, group=gear)) + </span></span>
<span id="cb128-1736"><a href="#cb128-1736" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_errorbar(aes(ymin=FL_CM-se, ymax=FL_CM+se), colour="black", width=.1, position=pd) +</span></span>
<span id="cb128-1737"><a href="#cb128-1737" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_line(position=pd) +</span></span>
<span id="cb128-1738"><a href="#cb128-1738" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_point(position=pd, size=3, shape=21, fill="white") + # 21 is filled circle</span></span>
<span id="cb128-1739"><a href="#cb128-1739" aria-hidden="true" tabindex="-1"></a><span class="co">#     xlab("Year") +</span></span>
<span id="cb128-1740"><a href="#cb128-1740" aria-hidden="true" tabindex="-1"></a><span class="co">#     ylab("Fork Length (cm)") +</span></span>
<span id="cb128-1741"><a href="#cb128-1741" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_colour_hue(name="Gear type",    # Legend label, use darker colors</span></span>
<span id="cb128-1742"><a href="#cb128-1742" aria-hidden="true" tabindex="-1"></a><span class="co">#                      breaks=gear,</span></span>
<span id="cb128-1743"><a href="#cb128-1743" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels=gear,</span></span>
<span id="cb128-1744"><a href="#cb128-1744" aria-hidden="true" tabindex="-1"></a><span class="co">#                      l=40) +                    # Use darker colors, lightness=40</span></span>
<span id="cb128-1745"><a href="#cb128-1745" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggtitle("Average ") +</span></span>
<span id="cb128-1746"><a href="#cb128-1746" aria-hidden="true" tabindex="-1"></a><span class="co">#     expand_limits(y=0) +                        # Expand y range</span></span>
<span id="cb128-1747"><a href="#cb128-1747" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_y_continuous(breaks=0:20*4) +         # Set tick every 4</span></span>
<span id="cb128-1748"><a href="#cb128-1748" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme_bw() +</span></span>
<span id="cb128-1749"><a href="#cb128-1749" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(legend.justification=c(1,0),</span></span>
<span id="cb128-1750"><a href="#cb128-1750" aria-hidden="true" tabindex="-1"></a><span class="co">#           legend.position=c(1,0))               # Position legend in bottom right</span></span>
<span id="cb128-1751"><a href="#cb128-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1752"><a href="#cb128-1752" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1753"><a href="#cb128-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1754"><a href="#cb128-1754" aria-hidden="true" tabindex="-1"></a><span class="fu">## Trap Gear Distribution Over Time by Year</span></span>
<span id="cb128-1755"><a href="#cb128-1755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1756"><a href="#cb128-1756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_tr_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1757"><a href="#cb128-1757" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1758"><a href="#cb128-1758" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1759"><a href="#cb128-1759" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1760"><a href="#cb128-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1761"><a href="#cb128-1761" aria-hidden="true" tabindex="-1"></a>trap <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'TR'</span>,]</span>
<span id="cb128-1762"><a href="#cb128-1762" aria-hidden="true" tabindex="-1"></a>trap2<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(trap<span class="sc">$</span>FL_CM, <span class="fu">list</span>(trap<span class="sc">$</span>YEAR, trap<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb128-1763"><a href="#cb128-1763" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(trap2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb128-1764"><a href="#cb128-1764" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> trap <span class="sc">%&gt;%</span></span>
<span id="cb128-1765"><a href="#cb128-1765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb128-1766"><a href="#cb128-1766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1767"><a href="#cb128-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1768"><a href="#cb128-1768" aria-hidden="true" tabindex="-1"></a>trap2 <span class="sc">%&gt;%</span></span>
<span id="cb128-1769"><a href="#cb128-1769" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb128-1770"><a href="#cb128-1770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb128-1771"><a href="#cb128-1771" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1772"><a href="#cb128-1772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1773"><a href="#cb128-1773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1774"><a href="#cb128-1774" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1775"><a href="#cb128-1775" aria-hidden="true" tabindex="-1"></a> <span class="co"># theme_minimal()</span></span>
<span id="cb128-1776"><a href="#cb128-1776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1777"><a href="#cb128-1777" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1778"><a href="#cb128-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1779"><a href="#cb128-1779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1780"><a href="#cb128-1780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1781"><a href="#cb128-1781" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diving Gear Distribution Over Time by Year - NO GEAR GROUPING</span></span>
<span id="cb128-1782"><a href="#cb128-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1783"><a href="#cb128-1783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_DV_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1784"><a href="#cb128-1784" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1785"><a href="#cb128-1785" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1786"><a href="#cb128-1786" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1787"><a href="#cb128-1787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1788"><a href="#cb128-1788" aria-hidden="true" tabindex="-1"></a><span class="co"># diving &lt;- length_data_final[length_data_final$gear_short=='DV',]</span></span>
<span id="cb128-1789"><a href="#cb128-1789" aria-hidden="true" tabindex="-1"></a><span class="co"># diving2&lt;- aggregate(diving$FL_CM, list(diving$YEAR, diving$LAND_STANDARD_GEAR_NAME), mean)</span></span>
<span id="cb128-1790"><a href="#cb128-1790" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(diving2) &lt;- c('Year', 'LAND_STANDARD_GEAR_NAME', 'yearlyValue')</span></span>
<span id="cb128-1791"><a href="#cb128-1791" aria-hidden="true" tabindex="-1"></a><span class="co"># counts = diving %&gt;%</span></span>
<span id="cb128-1792"><a href="#cb128-1792" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(LAND_STANDARD_GEAR_NAME) %&gt;%</span></span>
<span id="cb128-1793"><a href="#cb128-1793" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(LAND_STANDARD_GEAR_NAME, " (n= ", n, ")" ))</span></span>
<span id="cb128-1794"><a href="#cb128-1794" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1795"><a href="#cb128-1795" aria-hidden="true" tabindex="-1"></a><span class="co"># diving2 %&gt;%</span></span>
<span id="cb128-1796"><a href="#cb128-1796" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(x = Year, y = yearlyValue, color = LAND_STANDARD_GEAR_NAME, group = 1))+</span></span>
<span id="cb128-1797"><a href="#cb128-1797" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(size = 2) +</span></span>
<span id="cb128-1798"><a href="#cb128-1798" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1799"><a href="#cb128-1799" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_hue(labels = counts$n_labels)+</span></span>
<span id="cb128-1800"><a href="#cb128-1800" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Gear Type", y = "Fork Length (cm)", x= "Year", title = paste0(region,  "\n (N = ", sum(counts$n), ")"))+</span></span>
<span id="cb128-1801"><a href="#cb128-1801" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1802"><a href="#cb128-1802" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span>
<span id="cb128-1803"><a href="#cb128-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1804"><a href="#cb128-1804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1805"><a href="#cb128-1805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1806"><a href="#cb128-1806" aria-hidden="true" tabindex="-1"></a><span class="fu">## Net Gear Distribution Over Time by Year</span></span>
<span id="cb128-1807"><a href="#cb128-1807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1808"><a href="#cb128-1808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_net_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1809"><a href="#cb128-1809" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1810"><a href="#cb128-1810" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1811"><a href="#cb128-1811" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1812"><a href="#cb128-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1813"><a href="#cb128-1813" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'NT'</span>,]</span>
<span id="cb128-1814"><a href="#cb128-1814" aria-hidden="true" tabindex="-1"></a>net2<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(net<span class="sc">$</span>FL_CM, <span class="fu">list</span>(net<span class="sc">$</span>YEAR, net<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb128-1815"><a href="#cb128-1815" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(net2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb128-1816"><a href="#cb128-1816" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> net <span class="sc">%&gt;%</span></span>
<span id="cb128-1817"><a href="#cb128-1817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb128-1818"><a href="#cb128-1818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1819"><a href="#cb128-1819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1820"><a href="#cb128-1820" aria-hidden="true" tabindex="-1"></a>net2 <span class="sc">%&gt;%</span></span>
<span id="cb128-1821"><a href="#cb128-1821" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb128-1822"><a href="#cb128-1822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb128-1823"><a href="#cb128-1823" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1824"><a href="#cb128-1824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1825"><a href="#cb128-1825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1826"><a href="#cb128-1826" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1827"><a href="#cb128-1827" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1828"><a href="#cb128-1828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1829"><a href="#cb128-1829" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1830"><a href="#cb128-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1831"><a href="#cb128-1831" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1832"><a href="#cb128-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1833"><a href="#cb128-1833" aria-hidden="true" tabindex="-1"></a><span class="fu">## Spear Gear Distribution Over Time by Year - NO GROUPING</span></span>
<span id="cb128-1834"><a href="#cb128-1834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1835"><a href="#cb128-1835" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_sp_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1836"><a href="#cb128-1836" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1837"><a href="#cb128-1837" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1838"><a href="#cb128-1838" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1839"><a href="#cb128-1839" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1840"><a href="#cb128-1840" aria-hidden="true" tabindex="-1"></a><span class="co"># sp&lt;- length_data_final[length_data_final$gear_short=='SP',]</span></span>
<span id="cb128-1841"><a href="#cb128-1841" aria-hidden="true" tabindex="-1"></a><span class="co"># sp2&lt;- aggregate(sp$FL_CM, list(sp$YEAR, sp$LAND_STANDARD_GEAR_NAME), mean)</span></span>
<span id="cb128-1842"><a href="#cb128-1842" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(sp2) &lt;- c('Year', 'LAND_STANDARD_GEAR_NAME', 'yearlyValue')</span></span>
<span id="cb128-1843"><a href="#cb128-1843" aria-hidden="true" tabindex="-1"></a><span class="co"># counts = sp %&gt;%</span></span>
<span id="cb128-1844"><a href="#cb128-1844" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(LAND_STANDARD_GEAR_NAME) %&gt;%</span></span>
<span id="cb128-1845"><a href="#cb128-1845" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(LAND_STANDARD_GEAR_NAME, " (n= ", n, ")" ))</span></span>
<span id="cb128-1846"><a href="#cb128-1846" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-1847"><a href="#cb128-1847" aria-hidden="true" tabindex="-1"></a><span class="co"># sp2 %&gt;%</span></span>
<span id="cb128-1848"><a href="#cb128-1848" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(x = Year, y = yearlyValue, color = LAND_STANDARD_GEAR_NAME, group = 1))+</span></span>
<span id="cb128-1849"><a href="#cb128-1849" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(size = 2) +</span></span>
<span id="cb128-1850"><a href="#cb128-1850" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1851"><a href="#cb128-1851" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_hue(labels = counts$n_labels)+</span></span>
<span id="cb128-1852"><a href="#cb128-1852" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Gear Type", y = "Fork Length (cm)", x= "Year", title = paste0(region,  "\n (N = ", sum(counts$n), ")"))+</span></span>
<span id="cb128-1853"><a href="#cb128-1853" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1854"><a href="#cb128-1854" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span>
<span id="cb128-1855"><a href="#cb128-1855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1856"><a href="#cb128-1856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1857"><a href="#cb128-1857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1858"><a href="#cb128-1858" aria-hidden="true" tabindex="-1"></a><span class="fu">## Other Gear Distribution Over Time by Year</span></span>
<span id="cb128-1859"><a href="#cb128-1859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1860"><a href="#cb128-1860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_ot_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb128-1861"><a href="#cb128-1861" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1862"><a href="#cb128-1862" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1863"><a href="#cb128-1863" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb128-1864"><a href="#cb128-1864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1865"><a href="#cb128-1865" aria-hidden="true" tabindex="-1"></a>ot<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'OT'</span>,]</span>
<span id="cb128-1866"><a href="#cb128-1866" aria-hidden="true" tabindex="-1"></a>ot2<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(ot<span class="sc">$</span>FL_CM, <span class="fu">list</span>(ot<span class="sc">$</span>YEAR, ot<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb128-1867"><a href="#cb128-1867" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ot2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb128-1868"><a href="#cb128-1868" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> ot <span class="sc">%&gt;%</span></span>
<span id="cb128-1869"><a href="#cb128-1869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb128-1870"><a href="#cb128-1870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1871"><a href="#cb128-1871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1872"><a href="#cb128-1872" aria-hidden="true" tabindex="-1"></a>ot2 <span class="sc">%&gt;%</span></span>
<span id="cb128-1873"><a href="#cb128-1873" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb128-1874"><a href="#cb128-1874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb128-1875"><a href="#cb128-1875" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1876"><a href="#cb128-1876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1877"><a href="#cb128-1877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1878"><a href="#cb128-1878" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb128-1879"><a href="#cb128-1879" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb128-1880"><a href="#cb128-1880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb128-1881"><a href="#cb128-1881" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb128-1882"><a href="#cb128-1882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1883"><a href="#cb128-1883" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1884"><a href="#cb128-1884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1885"><a href="#cb128-1885" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cummulative Density Plots</span></span>
<span id="cb128-1886"><a href="#cb128-1886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1887"><a href="#cb128-1887" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aggregated CDF</span></span>
<span id="cb128-1888"><a href="#cb128-1888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1889"><a href="#cb128-1889" aria-hidden="true" tabindex="-1"></a><span class="in">```{r agg_cdf_plot}</span></span>
<span id="cb128-1890"><a href="#cb128-1890" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1891"><a href="#cb128-1891" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1892"><a href="#cb128-1892" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1893"><a href="#cb128-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1894"><a href="#cb128-1894" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span>length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb128-1895"><a href="#cb128-1895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(gear) <span class="sc">%&gt;%</span></span>
<span id="cb128-1896"><a href="#cb128-1896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(gear, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1897"><a href="#cb128-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1898"><a href="#cb128-1898" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb128-1899"><a href="#cb128-1899" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-1900"><a href="#cb128-1900" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb128-1901"><a href="#cb128-1901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()<span class="sc">+</span></span>
<span id="cb128-1902"><a href="#cb128-1902" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1903"><a href="#cb128-1903" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1904"><a href="#cb128-1904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1905"><a href="#cb128-1905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb128-1906"><a href="#cb128-1906" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-1907"><a href="#cb128-1907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1908"><a href="#cb128-1908" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1909"><a href="#cb128-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1910"><a href="#cb128-1910" aria-hidden="true" tabindex="-1"></a><span class="fu">## Management periods\*</span></span>
<span id="cb128-1911"><a href="#cb128-1911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1912"><a href="#cb128-1912" aria-hidden="true" tabindex="-1"></a>**This section is optional and may be empty if there are not signifcant changes**</span>
<span id="cb128-1913"><a href="#cb128-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1914"><a href="#cb128-1914" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_cdf_plot, eval=!is.na(break_year)}</span></span>
<span id="cb128-1915"><a href="#cb128-1915" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1916"><a href="#cb128-1916" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1917"><a href="#cb128-1917" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1918"><a href="#cb128-1918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1919"><a href="#cb128-1919" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb128-1920"><a href="#cb128-1920" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-1921"><a href="#cb128-1921" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb128-1922"><a href="#cb128-1922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()<span class="sc">+</span></span>
<span id="cb128-1923"><a href="#cb128-1923" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1924"><a href="#cb128-1924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1925"><a href="#cb128-1925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1926"><a href="#cb128-1926" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb128-1927"><a href="#cb128-1927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb128-1928"><a href="#cb128-1928" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-1929"><a href="#cb128-1929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1930"><a href="#cb128-1930" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1931"><a href="#cb128-1931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1932"><a href="#cb128-1932" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual CDF</span></span>
<span id="cb128-1933"><a href="#cb128-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1934"><a href="#cb128-1934" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual_cdf_plot, fig.height=9, fig.width=9}</span></span>
<span id="cb128-1935"><a href="#cb128-1935" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1936"><a href="#cb128-1936" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1937"><a href="#cb128-1937" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1938"><a href="#cb128-1938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1939"><a href="#cb128-1939" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span> </span>
<span id="cb128-1940"><a href="#cb128-1940" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb128-1941"><a href="#cb128-1941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_labs =</span> <span class="fu">paste0</span>(YEAR, <span class="st">"</span><span class="sc">\n</span><span class="st"> n = "</span>, <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb128-1942"><a href="#cb128-1942" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-1943"><a href="#cb128-1943" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb128-1944"><a href="#cb128-1944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()<span class="sc">+</span></span>
<span id="cb128-1945"><a href="#cb128-1945" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb128-1946"><a href="#cb128-1946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1947"><a href="#cb128-1947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1948"><a href="#cb128-1948" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>year_labs)<span class="sc">+</span></span>
<span id="cb128-1949"><a href="#cb128-1949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb128-1950"><a href="#cb128-1950" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-1951"><a href="#cb128-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1952"><a href="#cb128-1952" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1953"><a href="#cb128-1953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1954"><a href="#cb128-1954" aria-hidden="true" tabindex="-1"></a><span class="fu"># Island Density Plots</span></span>
<span id="cb128-1955"><a href="#cb128-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1956"><a href="#cb128-1956" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aggregated density plots</span></span>
<span id="cb128-1957"><a href="#cb128-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1958"><a href="#cb128-1958" aria-hidden="true" tabindex="-1"></a><span class="in">```{r agg_pdf_plot_reg}</span></span>
<span id="cb128-1959"><a href="#cb128-1959" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1960"><a href="#cb128-1960" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1961"><a href="#cb128-1961" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1962"><a href="#cb128-1962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1963"><a href="#cb128-1963" aria-hidden="true" tabindex="-1"></a>srcounts <span class="ot">=</span>length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb128-1964"><a href="#cb128-1964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ISLAND) <span class="sc">%&gt;%</span></span>
<span id="cb128-1965"><a href="#cb128-1965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(ISLAND, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb128-1966"><a href="#cb128-1966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1967"><a href="#cb128-1967" aria-hidden="true" tabindex="-1"></a><span class="co">#srcounts &lt;- srcounts %&gt;% drop_na(SUBREGION)</span></span>
<span id="cb128-1968"><a href="#cb128-1968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1969"><a href="#cb128-1969" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb128-1970"><a href="#cb128-1970" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM))<span class="sc">+</span></span>
<span id="cb128-1971"><a href="#cb128-1971" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_density( aes(color = "Combined"))+</span></span>
<span id="cb128-1972"><a href="#cb128-1972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> ISLAND))<span class="sc">+</span></span>
<span id="cb128-1973"><a href="#cb128-1973" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = regcols, labels = c("Combined", srcounts$n_labels))+</span></span>
<span id="cb128-1974"><a href="#cb128-1974" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>srcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1975"><a href="#cb128-1975" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Island"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(srcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1976"><a href="#cb128-1976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb128-1977"><a href="#cb128-1977" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-1978"><a href="#cb128-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1979"><a href="#cb128-1979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-1980"><a href="#cb128-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1981"><a href="#cb128-1981" aria-hidden="true" tabindex="-1"></a><span class="fu">## Management periods\*</span></span>
<span id="cb128-1982"><a href="#cb128-1982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1983"><a href="#cb128-1983" aria-hidden="true" tabindex="-1"></a>**This section is optional and may be empty if there are not significant changes**</span>
<span id="cb128-1984"><a href="#cb128-1984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1985"><a href="#cb128-1985" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_pdf_plot_reg, eval=!is.na(break_year)}</span></span>
<span id="cb128-1986"><a href="#cb128-1986" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-1987"><a href="#cb128-1987" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-1988"><a href="#cb128-1988" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-1989"><a href="#cb128-1989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-1990"><a href="#cb128-1990" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb128-1991"><a href="#cb128-1991" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-1992"><a href="#cb128-1992" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> ISLAND))<span class="sc">+</span></span>
<span id="cb128-1993"><a href="#cb128-1993" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()<span class="sc">+</span></span>
<span id="cb128-1994"><a href="#cb128-1994" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = regcols, labels = srcounts$n_labels)+</span></span>
<span id="cb128-1995"><a href="#cb128-1995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> srcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-1996"><a href="#cb128-1996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Island"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(srcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-1997"><a href="#cb128-1997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb128-1998"><a href="#cb128-1998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb128-1999"><a href="#cb128-1999" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-2000"><a href="#cb128-2000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-2001"><a href="#cb128-2001" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-2002"><a href="#cb128-2002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-2003"><a href="#cb128-2003" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual Density plots</span></span>
<span id="cb128-2004"><a href="#cb128-2004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-2005"><a href="#cb128-2005" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual_pdf_plot_reg, fig.height=9, fig.width=9}</span></span>
<span id="cb128-2006"><a href="#cb128-2006" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-2007"><a href="#cb128-2007" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-2008"><a href="#cb128-2008" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-2009"><a href="#cb128-2009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-2010"><a href="#cb128-2010" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span> </span>
<span id="cb128-2011"><a href="#cb128-2011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb128-2012"><a href="#cb128-2012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_labs =</span> <span class="fu">paste0</span>(YEAR, <span class="st">"</span><span class="sc">\n</span><span class="st"> n = "</span>, <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb128-2013"><a href="#cb128-2013" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-2014"><a href="#cb128-2014" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> ISLAND))<span class="sc">+</span></span>
<span id="cb128-2015"><a href="#cb128-2015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()<span class="sc">+</span></span>
<span id="cb128-2016"><a href="#cb128-2016" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = regcols, labels = srcounts$n_labels)+</span></span>
<span id="cb128-2017"><a href="#cb128-2017" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> srcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb128-2018"><a href="#cb128-2018" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Subregion"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(srcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb128-2019"><a href="#cb128-2019" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>year_labs)<span class="sc">+</span></span>
<span id="cb128-2020"><a href="#cb128-2020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb128-2021"><a href="#cb128-2021" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb128-2022"><a href="#cb128-2022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-2023"><a href="#cb128-2023" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb128-2024"><a href="#cb128-2024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-2025"><a href="#cb128-2025" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb128-2026"><a href="#cb128-2026" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb128-2027"><a href="#cb128-2027" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb128-2028"><a href="#cb128-2028" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb128-2029"><a href="#cb128-2029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-2030"><a href="#cb128-2030" aria-hidden="true" tabindex="-1"></a>final_gears <span class="ot">&lt;-</span> <span class="fu">unique</span>(length_data_final<span class="sc">$</span>gear_short)  <span class="do">##++this is where final length comps are generated ; could be aggregated above (e.g. via lookup table) &amp; should be 1 here </span></span>
<span id="cb128-2031"><a href="#cb128-2031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-2032"><a href="#cb128-2032" aria-hidden="true" tabindex="-1"></a>comps <span class="ot">&lt;-</span> <span class="fu">list</span>()  <span class="do">##++this creates an empty list for for loop</span></span>
<span id="cb128-2033"><a href="#cb128-2033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-2034"><a href="#cb128-2034" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop generates binned length comps for each of the final gears. Stored in list. RUN:  View(comps[[1]]) to see in R</span></span>
<span id="cb128-2035"><a href="#cb128-2035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-2036"><a href="#cb128-2036" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(final_gears)){</span>
<span id="cb128-2037"><a href="#cb128-2037" aria-hidden="true" tabindex="-1"></a> comps[[i]] <span class="ot">&lt;-</span>  length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb128-2038"><a href="#cb128-2038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear_short <span class="sc">==</span> final_gears[i]) <span class="sc">%&gt;%</span></span>
<span id="cb128-2039"><a href="#cb128-2039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb128-2040"><a href="#cb128-2040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ln_fish =</span> <span class="fu">n</span>(),</span>
<span id="cb128-2041"><a href="#cb128-2041" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_trips =</span> <span class="fu">length</span>(<span class="fu">unique</span>(ID)),</span>
<span id="cb128-2042"><a href="#cb128-2042" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_dealers=</span><span class="fu">length</span>(<span class="fu">unique</span>(DEALER_CODE)),</span>
<span id="cb128-2043"><a href="#cb128-2043" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_vessels=</span><span class="fu">length</span>(<span class="fu">unique</span>(VESSEL_ID))) <span class="sc">%&gt;%</span></span>
<span id="cb128-2044"><a href="#cb128-2044" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb128-2045"><a href="#cb128-2045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels, lbin)<span class="sc">%&gt;%</span></span>
<span id="cb128-2046"><a href="#cb128-2046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">unique</span>(ln_fish)) <span class="sc">%&gt;%</span></span>
<span id="cb128-2047"><a href="#cb128-2047" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb128-2048"><a href="#cb128-2048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels), </span>
<span id="cb128-2049"><a href="#cb128-2049" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> lbin, </span>
<span id="cb128-2050"><a href="#cb128-2050" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> freq, </span>
<span id="cb128-2051"><a href="#cb128-2051" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">freq =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb128-2052"><a href="#cb128-2052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(full_set) <span class="sc">%&gt;%</span></span>
<span id="cb128-2053"><a href="#cb128-2053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comp_names)<span class="sc">%&gt;%</span></span>
<span id="cb128-2054"><a href="#cb128-2054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-2055"><a href="#cb128-2055" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">flag_n  =</span> <span class="fu">ifelse</span>(ln_fish <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">0</span>, </span>
<span id="cb128-2056"><a href="#cb128-2056" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(ln_fish <span class="sc">&lt;</span> <span class="dv">15</span>, <span class="dv">2</span>, <span class="dv">1</span>)))</span>
<span id="cb128-2057"><a href="#cb128-2057" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-2058"><a href="#cb128-2058" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(comps)[[i]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(final_gears[i], <span class="st">"_"</span>, bin_size, <span class="st">"cm"</span>) <span class="do">##++tabs are named here ; could add _nom here if desired (instead of _lfd and _lfdw in main file)</span></span>
<span id="cb128-2059"><a href="#cb128-2059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-2060"><a href="#cb128-2060" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb128-2061"><a href="#cb128-2061" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb128-2062"><a href="#cb128-2062" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb128-2063"><a href="#cb128-2063" aria-hidden="true" tabindex="-1"></a><span class="co"># write.xlsx(comps, file = paste0("./outputs/", sp, "_com_lfd_", sprintf('%02d', min_year %% 100), sprintf('%02d', max_year %% 100), "_", gsub("-", "", Sys.Date()), ".xlsx"))</span></span>
<span id="cb128-2064"><a href="#cb128-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-2065"><a href="#cb128-2065" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>