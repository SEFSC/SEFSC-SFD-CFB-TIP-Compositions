<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Katherine Godwin">

<title>pr_yt_sedar84_sizecomp_landstdgearname</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/clipboard/clipboard.min.js"></script>
<script src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/quarto.js"></script>
<script src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/popper.min.js"></script>
<script src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/anchor.min.js"></script>
<link href="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#yellowtail-snapper-pr" id="toc-yellowtail-snapper-pr" class="nav-link active" data-scroll-target="#yellowtail-snapper-pr">Yellowtail Snapper PR</a>
  <ul>
  <li><a href="#control-settings-and-exploratory-frequency-tables" id="toc-control-settings-and-exploratory-frequency-tables" class="nav-link" data-scroll-target="#control-settings-and-exploratory-frequency-tables">Control Settings and Exploratory Frequency Tables</a>
  <ul class="collapse">
  <li><a href="#filter-to-commercial-samples" id="toc-filter-to-commercial-samples" class="nav-link" data-scroll-target="#filter-to-commercial-samples">Filter to Commercial samples</a></li>
  <li><a href="#extract-marfin-samples-look-at-island-distribution" id="toc-extract-marfin-samples-look-at-island-distribution" class="nav-link" data-scroll-target="#extract-marfin-samples-look-at-island-distribution">Extract marfin samples, look at island distribution</a></li>
  <li><a href="#add-gear-groupings-no-length-length-conversions-available" id="toc-add-gear-groupings-no-length-length-conversions-available" class="nav-link" data-scroll-target="#add-gear-groupings-no-length-length-conversions-available">Add gear groupings, NO length-length conversions available</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#filtration-level-investigation" id="toc-filtration-level-investigation" class="nav-link" data-scroll-target="#filtration-level-investigation">Filtration level investigation</a>
  <ul>
  <li><a href="#unique-trip-id-vs-gear-by-year-investigation" id="toc-unique-trip-id-vs-gear-by-year-investigation" class="nav-link" data-scroll-target="#unique-trip-id-vs-gear-by-year-investigation">Unique trip ID vs gear by year investigation</a>
  <ul class="collapse">
  <li><a href="#how-many-unique-trip-ids-per-year" id="toc-how-many-unique-trip-ids-per-year" class="nav-link" data-scroll-target="#how-many-unique-trip-ids-per-year">How many unique trip ID’s per year?</a></li>
  </ul></li>
  <li><a href="#unique-length-records-per-gear-per-year" id="toc-unique-length-records-per-gear-per-year" class="nav-link" data-scroll-target="#unique-length-records-per-gear-per-year">Unique length records per gear per year</a>
  <ul class="collapse">
  <li><a href="#how-many-length-records-per-gear-per-year" id="toc-how-many-length-records-per-gear-per-year" class="nav-link" data-scroll-target="#how-many-length-records-per-gear-per-year">How many length records per gear per year?</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#glm-analysis" id="toc-glm-analysis" class="nav-link" data-scroll-target="#glm-analysis">GLM analysis</a>
  <ul>
  <li><a href="#all-gears" id="toc-all-gears" class="nav-link" data-scroll-target="#all-gears">All Gears</a></li>
  <li><a href="#all-gears-2012-and-after" id="toc-all-gears-2012-and-after" class="nav-link" data-scroll-target="#all-gears-2012-and-after">All Gears 2012 and after</a></li>
  <li><a href="#hook-and-line" id="toc-hook-and-line" class="nav-link" data-scroll-target="#hook-and-line">Hook and Line</a></li>
  <li><a href="#net" id="toc-net" class="nav-link" data-scroll-target="#net">Net</a></li>
  <li><a href="#trap" id="toc-trap" class="nav-link" data-scroll-target="#trap">Trap</a></li>
  </ul></li>
  <li><a href="#gear-density-plots" id="toc-gear-density-plots" class="nav-link" data-scroll-target="#gear-density-plots">Gear Density Plots</a>
  <ul>
  <li><a href="#aggregated-density-plots" id="toc-aggregated-density-plots" class="nav-link" data-scroll-target="#aggregated-density-plots">Aggregated density plots</a></li>
  <li><a href="#gear-grouping-investigation" id="toc-gear-grouping-investigation" class="nav-link" data-scroll-target="#gear-grouping-investigation">Gear grouping investigation</a></li>
  <li><a href="#break-at-2005" id="toc-break-at-2005" class="nav-link" data-scroll-target="#break-at-2005">Break at 2005</a></li>
  <li><a href="#annual-density-plots" id="toc-annual-density-plots" class="nav-link" data-scroll-target="#annual-density-plots">Annual Density plots</a></li>
  </ul></li>
  <li><a href="#stacked-bar-charts" id="toc-stacked-bar-charts" class="nav-link" data-scroll-target="#stacked-bar-charts">Stacked bar charts</a>
  <ul>
  <li><a href="#visual-representation-of-gear-distribution-within-groupings" id="toc-visual-representation-of-gear-distribution-within-groupings" class="nav-link" data-scroll-target="#visual-representation-of-gear-distribution-within-groupings">Visual representation of gear distribution within groupings</a></li>
  </ul></li>
  <li><a href="#gear-distribution-across-time-by-gear-groupings" id="toc-gear-distribution-across-time-by-gear-groupings" class="nav-link" data-scroll-target="#gear-distribution-across-time-by-gear-groupings">Gear distribution across time by gear groupings</a>
  <ul>
  <li><a href="#all-gears-over-time" id="toc-all-gears-over-time" class="nav-link" data-scroll-target="#all-gears-over-time">All gears over time</a></li>
  <li><a href="#hook-and-line-gear-distribution-over-time-by-year" id="toc-hook-and-line-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#hook-and-line-gear-distribution-over-time-by-year">Hook and Line Gear Distribution Over Time by Year</a></li>
  <li><a href="#trap-gear-distribution-over-time-by-year" id="toc-trap-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#trap-gear-distribution-over-time-by-year">Trap Gear Distribution Over Time by Year</a></li>
  <li><a href="#diving-gear-distribution-over-time-by-year---no-gear-grouping" id="toc-diving-gear-distribution-over-time-by-year---no-gear-grouping" class="nav-link" data-scroll-target="#diving-gear-distribution-over-time-by-year---no-gear-grouping">Diving Gear Distribution Over Time by Year - NO GEAR GROUPING</a></li>
  <li><a href="#net-gear-distribution-over-time-by-year" id="toc-net-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#net-gear-distribution-over-time-by-year">Net Gear Distribution Over Time by Year</a></li>
  <li><a href="#spear-gear-distribution-over-time-by-year---no-grouping" id="toc-spear-gear-distribution-over-time-by-year---no-grouping" class="nav-link" data-scroll-target="#spear-gear-distribution-over-time-by-year---no-grouping">Spear Gear Distribution Over Time by Year - NO GROUPING</a></li>
  <li><a href="#other-gear-distribution-over-time-by-year" id="toc-other-gear-distribution-over-time-by-year" class="nav-link" data-scroll-target="#other-gear-distribution-over-time-by-year">Other Gear Distribution Over Time by Year</a></li>
  </ul></li>
  <li><a href="#cummulative-density-plots" id="toc-cummulative-density-plots" class="nav-link" data-scroll-target="#cummulative-density-plots">Cummulative Density Plots</a>
  <ul>
  <li><a href="#aggregated-cdf" id="toc-aggregated-cdf" class="nav-link" data-scroll-target="#aggregated-cdf">Aggregated CDF</a></li>
  <li><a href="#management-periods" id="toc-management-periods" class="nav-link" data-scroll-target="#management-periods">Management periods*</a></li>
  <li><a href="#annual-cdf" id="toc-annual-cdf" class="nav-link" data-scroll-target="#annual-cdf">Annual CDF</a></li>
  </ul></li>
  <li><a href="#island-density-plots" id="toc-island-density-plots" class="nav-link" data-scroll-target="#island-density-plots">Island Density Plots</a>
  <ul>
  <li><a href="#aggregated-density-plots-1" id="toc-aggregated-density-plots-1" class="nav-link" data-scroll-target="#aggregated-density-plots-1">Aggregated density plots</a></li>
  <li><a href="#management-periods-1" id="toc-management-periods-1" class="nav-link" data-scroll-target="#management-periods-1">Management periods*</a></li>
  <li><a href="#annual-density-plots-1" id="toc-annual-density-plots-1" class="nav-link" data-scroll-target="#annual-density-plots-1">Annual Density plots</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">pr_yt_sedar84_sizecomp_landstdgearname</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Katherine Godwin </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>This script will be expanding upon the length-comp script c1_nominal_len_comps.Rmd created by Molly Stevens.</p>
<section id="yellowtail-snapper-pr" class="level1 page-columns page-full">
<h1>Yellowtail Snapper PR</h1>
<div class="cell column-page">

</div>
<section id="control-settings-and-exploratory-frequency-tables" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="control-settings-and-exploratory-frequency-tables">Control Settings and Exploratory Frequency Tables</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="st">"YTS"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>region <span class="ot">&lt;-</span> <span class="st">"PUERTO RICO - USVI"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>county <span class="ot">&lt;-</span> <span class="st">"PUERTO RICO"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>bin_size <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>len_type <span class="ot">&lt;-</span> <span class="st">"FORK LENGTH"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>LENGTH_TYPE1, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 FORK LENGTH    NO LENGTH TOTAL LENGTH         &lt;NA&gt; 
      103323           60          123            0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>LENGTH_TYPE2, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
NO LENGTH      &lt;NA&gt; 
   103506         0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(pr_yt<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># 6 SEEMS TO BE AN ERROR, NEXT SMALLEST IS 55</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(pr_yt<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1219</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tip_range  <span class="ot">&lt;-</span> pr_yt[<span class="fu">with</span>(pr_yt,<span class="fu">order</span>(<span class="sc">-</span>LENGTH1_MM)),]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tip_range<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1219.0 1111.0 1086.0 1030.0 1022.0 1001.6  962.0  960.0  957.0  944.0
[11]  930.0  925.0  925.0  925.0  925.0  923.0  914.0  914.0  909.0  905.0
[21]  901.0  900.0  876.0  876.0  875.0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tip_range2 <span class="ot">&lt;-</span> pr_yt[<span class="fu">with</span>(pr_yt,<span class="fu">order</span>(LENGTH1_MM)),]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>tip_range2<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1]   6.0  55.0  61.0  69.0  76.2  83.0  83.0  85.0  89.0  91.0  93.0  96.0
[13]  98.0 100.0 100.0 102.0 103.0 103.0 103.0 103.0 103.0 103.0 103.0 103.0
[25] 103.0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">##range currently set to not drop any obs (centimeters)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>min_size <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>max_size <span class="ot">&lt;-</span> <span class="dv">122</span>   </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(pr_yt<span class="sc">$</span>YEAR,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1983"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>min_year <span class="ot">&lt;-</span> <span class="dv">1983</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>max_year <span class="ot">&lt;-</span> <span class="dv">2022</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>break_year <span class="ot">&lt;-</span> <span class="dv">2005</span> <span class="co"># this is an optional value to denote a change in management. inclusive on the upper bound. can be set to NA if not relevant.  2005 trap specifications were updated and many closures went into place</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  TABLES START HERE </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
YELLOWTAIL SNAPPER,OCYURUS CHR                           &lt;NA&gt; 
                        103506                              0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
                      BY HAND          BY HAND; DIVING GEAR 
                           47                           556 
                    CAST NETS  ENTANGLING NETS (GILL) UNSPC 
                           32                          1340 
                  HAUL SEINES                    LINES HAND 
                         7213                         78957 
    LINES LONG SET WITH HOOKS         LINES LONG; REEF FISH 
                          635                            17 
      LINES POWER TROLL OTHER                     NOT CODED 
                          432                          5628 
         POTS AND TRAPS; FISH POTS AND TRAPS; SPINY LOBSTER 
                         7039                           235 
                 ROD AND REEL                   SKIN DIVING 
                          355                            20 
                 TRAMMEL NETS              UNSPECIFIED GEAR 
                          998                             2 
                         &lt;NA&gt; 
                            0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, pr_yt<span class="sc">$</span>STATE_LANDED, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                               
                                PUERTO RICO  &lt;NA&gt;
  BY HAND                                47     0
  BY HAND; DIVING GEAR                  556     0
  CAST NETS                              32     0
  ENTANGLING NETS (GILL) UNSPC         1340     0
  HAUL SEINES                          7213     0
  LINES HAND                          78957     0
  LINES LONG SET WITH HOOKS             635     0
  LINES LONG; REEF FISH                  17     0
  LINES POWER TROLL OTHER               432     0
  NOT CODED                            5628     0
  POTS AND TRAPS; FISH                 7039     0
  POTS AND TRAPS; SPINY LOBSTER         235     0
  ROD AND REEL                          355     0
  SKIN DIVING                            20     0
  TRAMMEL NETS                          998     0
  UNSPECIFIED GEAR                        2     0
  &lt;NA&gt;                                    0     0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table(pr_yt$LAND_GEAR_NAME, pr_yt$STATE_LANDED, useNA='always')</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>FISHING_MODE, pr_yt<span class="sc">$</span>INT_TYPE, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               
                DEALER SAMPLE FISHERMAN SAMPLE   &lt;NA&gt;
  COMMERCIAL             2748           100732      0
  PARTY/CHARTER             0               26      0
  &lt;NA&gt;                      0                0      0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># marfin &lt;- pr_yt%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#             filter(INT_TYPE == "USVI MARFIN REEFFISH SAMPLING")</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>YEAR,pr_yt<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       YELLOWTAIL SNAPPER,OCYURUS CHR &lt;NA&gt;
  1983                            462    0
  1984                           1775    0
  1985                           1559    0
  1986                           2513    0
  1987                           1018    0
  1988                           1488    0
  1989                           1062    0
  1990                           2121    0
  1991                           9351    0
  1992                           9914    0
  1993                           6865    0
  1994                           4194    0
  1995                           3547    0
  1996                            681    0
  1997                            844    0
  1998                           2207    0
  1999                           5542    0
  2000                           4875    0
  2001                           3309    0
  2002                           4643    0
  2003                           5349    0
  2004                           2913    0
  2005                           2576    0
  2006                           3044    0
  2007                           3499    0
  2008                           2188    0
  2009                           2391    0
  2010                           1812    0
  2011                            954    0
  2012                           1290    0
  2013                           1011    0
  2014                           2444    0
  2015                           1877    0
  2016                            993    0
  2017                            621    0
  2018                            542    0
  2019                           1128    0
  2020                             14    0
  2021                            116    0
  2022                            774    0
  &lt;NA&gt;                              0    0</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>COUNTY_LANDED,pr_yt<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              
               PUERTO RICO  &lt;NA&gt;
  AGUADA              1161     0
  AGUADILLA           2393     0
  ANASCO               162     0
  ARECIBO              447     0
  ARROYO               238     0
  BARCELONETA           11     0
  CABO ROJO           8695     0
  CAMUY                253     0
  CAROLINA              41     0
  CATANO                26     0
  CEIBA               5429     0
  CULEBRA               32     0
  DORADO                10     0
  FAJARDO            15335     0
  GUANICA             2677     0
  GUAYAMA            12200     0
  GUAYAMILLA            18     0
  HUMACAO             1482     0
  ISABELA               93     0
  JUANA DIAZ          1266     0
  LAJAS               3106     0
  LOIZA                667     0
  LUQUILLO               3     0
  MANATI                 2     0
  MAUNABO               87     0
  MAYAGUEZ            5413     0
  NAGUABO              597     0
  NOT CODED            547     0
  PATILLAS              93     0
  PENUELAS              94     0
  PONCE               2263     0
  RINCON               154     0
  RIO GRANDE            80     0
  SALINAS              264     0
  SAN JUAN           33566     0
  SANTA ISABEL          73     0
  TOA BAJA              83     0
  VEGA BAJA             32     0
  VIEQUES             2672     0
  YABUCOA             1741     0
  &lt;NA&gt;                   0     0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pr_rodandreel &lt;- pr_yt |&gt; </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(LAND_STANDARD_GEAR_NAME == "ROD AND REEL")</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>YEAR,pr_yt<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       PUERTO RICO &lt;NA&gt;
  1983         462    0
  1984        1775    0
  1985        1559    0
  1986        2513    0
  1987        1018    0
  1988        1488    0
  1989        1062    0
  1990        2121    0
  1991        9351    0
  1992        9914    0
  1993        6865    0
  1994        4194    0
  1995        3547    0
  1996         681    0
  1997         844    0
  1998        2207    0
  1999        5542    0
  2000        4875    0
  2001        3309    0
  2002        4643    0
  2003        5349    0
  2004        2913    0
  2005        2576    0
  2006        3044    0
  2007        3499    0
  2008        2188    0
  2009        2391    0
  2010        1812    0
  2011         954    0
  2012        1290    0
  2013        1011    0
  2014        2444    0
  2015        1877    0
  2016         993    0
  2017         621    0
  2018         542    0
  2019        1128    0
  2020          14    0
  2021         116    0
  2022         774    0
  &lt;NA&gt;           0    0</code></pre>
</div>
</div>
<section id="filter-to-commercial-samples" class="level4">
<h4 class="anchored" data-anchor-id="filter-to-commercial-samples">Filter to Commercial samples</h4>
<p>Length composition after filtering to commercial records</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>              
               PUERTO RICO  &lt;NA&gt;
  AGUADA              1161     0
  AGUADILLA           2391     0
  ANASCO               162     0
  ARECIBO              447     0
  ARROYO               238     0
  BARCELONETA           11     0
  CABO ROJO           8687     0
  CAMUY                253     0
  CAROLINA              41     0
  CATANO                26     0
  CEIBA               5426     0
  CULEBRA               32     0
  DORADO                10     0
  FAJARDO            15326     0
  GUANICA             2672     0
  GUAYAMA            12195     0
  GUAYAMILLA            18     0
  HUMACAO             1482     0
  ISABELA               93     0
  JUANA DIAZ          1265     0
  LAJAS               3096     0
  LOIZA                667     0
  LUQUILLO               3     0
  MANATI                 2     0
  MAUNABO               87     0
  MAYAGUEZ            5397     0
  NAGUABO              596     0
  NOT CODED            546     0
  PATILLAS              93     0
  PENUELAS              94     0
  PONCE               2263     0
  RINCON               154     0
  RIO GRANDE            80     0
  SALINAS              264     0
  SAN JUAN           33553     0
  SANTA ISABEL          73     0
  TOA BAJA              83     0
  VEGA BAJA             32     0
  VIEQUES             2672     0
  YABUCOA             1729     0
  &lt;NA&gt;                   0     0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      
       PUERTO RICO &lt;NA&gt;
  1983         461    0
  1984        1770    0
  1985        1558    0
  1986        2509    0
  1987        1015    0
  1988        1484    0
  1989        1062    0
  1990        2121    0
  1991        9344    0
  1992        9905    0
  1993        6864    0
  1994        4190    0
  1995        3546    0
  1996         681    0
  1997         838    0
  1998        2204    0
  1999        5541    0
  2000        4875    0
  2001        3308    0
  2002        4629    0
  2003        5348    0
  2004        2913    0
  2005        2564    0
  2006        3042    0
  2007        3493    0
  2008        2188    0
  2009        2391    0
  2010        1812    0
  2011         954    0
  2012        1290    0
  2013        1011    0
  2014        2444    0
  2015        1877    0
  2016         993    0
  2017         621    0
  2018         542    0
  2019        1128    0
  2020          14    0
  2021         116    0
  2022         774    0
  &lt;NA&gt;           0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 FORK LENGTH TOTAL LENGTH         &lt;NA&gt; 
      103297          123            0 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                      BY HAND          BY HAND; DIVING GEAR 
                           47                           556 
                    CAST NETS  ENTANGLING NETS (GILL) UNSPC 
                           32                          1340 
                  HAUL SEINES                    LINES HAND 
                         7213                         78957 
    LINES LONG SET WITH HOOKS         LINES LONG; REEF FISH 
                          635                            17 
      LINES POWER TROLL OTHER                     NOT CODED 
                          432                          5628 
         POTS AND TRAPS; FISH POTS AND TRAPS; SPINY LOBSTER 
                         7039                           235 
                 ROD AND REEL                   SKIN DIVING 
                          355                            20 
                 TRAMMEL NETS              UNSPECIFIED GEAR 
                          998                             2 
                         &lt;NA&gt; 
                            0 </code></pre>
</div>
</div>
</section>
<section id="extract-marfin-samples-look-at-island-distribution" class="level4">
<h4 class="anchored" data-anchor-id="extract-marfin-samples-look-at-island-distribution">Extract marfin samples, look at island distribution</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      
       FORK LENGTH TOTAL LENGTH &lt;NA&gt;
  1983         461            0    0
  1984        1770            0    0
  1985        1558            0    0
  1986        2509            0    0
  1987        1015            0    0
  1988        1484            0    0
  1989        1062            0    0
  1990        2121            0    0
  1991        9344            0    0
  1992        9905            0    0
  1993        6864            0    0
  1994        4190            0    0
  1995        3546            0    0
  1996         681            0    0
  1997         838            0    0
  1998        2204            0    0
  1999        5541            0    0
  2000        4875            0    0
  2001        3308            0    0
  2002        4629            0    0
  2003        5348            0    0
  2004        2913            0    0
  2005        2564            0    0
  2006        3042            0    0
  2007        3493            0    0
  2008        2188            0    0
  2009        2391            0    0
  2010        1812            0    0
  2011         954            0    0
  2012        1290            0    0
  2013        1011            0    0
  2014        2444            0    0
  2015        1857           20    0
  2016         892          101    0
  2017         621            0    0
  2018         542            0    0
  2019        1128            0    0
  2020          14            0    0
  2021         116            0    0
  2022         772            2    0
  &lt;NA&gt;           0            0    0</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>             
              PUERTO RICO
  PUERTO RICO      103420</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                               
                                BY HAND, DIVING GEAR
  BY HAND                                          0
  BY HAND; DIVING GEAR                             0
  CAST NETS                                        0
  ENTANGLING NETS (GILL) UNSPC                     0
  HAUL SEINES                                      0
  LINES HAND                                       0
  LINES LONG SET WITH HOOKS                        0
  LINES LONG; REEF FISH                            0
  LINES POWER TROLL OTHER                          0
  NOT CODED                                        2
  POTS AND TRAPS; FISH                             0
  POTS AND TRAPS; SPINY LOBSTER                    0
  ROD AND REEL                                     0
  SKIN DIVING                                      0
  TRAMMEL NETS                                     0
  UNSPECIFIED GEAR                                 0
                               
                                ENTANGLING NETS (GILL) UNSPC HAUL SEINES
  BY HAND                                                  0           0
  BY HAND; DIVING GEAR                                     0           0
  CAST NETS                                                0           0
  ENTANGLING NETS (GILL) UNSPC                             0           0
  HAUL SEINES                                              0          39
  LINES HAND                                               2           0
  LINES LONG SET WITH HOOKS                                0           0
  LINES LONG; REEF FISH                                    0           0
  LINES POWER TROLL OTHER                                  0           0
  NOT CODED                                                5           0
  POTS AND TRAPS; FISH                                     2           0
  POTS AND TRAPS; SPINY LOBSTER                            0           0
  ROD AND REEL                                             0           0
  SKIN DIVING                                              0           0
  TRAMMEL NETS                                             0           0
  UNSPECIFIED GEAR                                         0           0
                               
                                LINES HAND LINES LONG SET WITH HOOKS
  BY HAND                                0                         0
  BY HAND; DIVING GEAR                  12                         0
  CAST NETS                              0                         0
  ENTANGLING NETS (GILL) UNSPC          24                         0
  HAUL SEINES                            0                         0
  LINES HAND                            42                         0
  LINES LONG SET WITH HOOKS              0                        14
  LINES LONG; REEF FISH                  0                         0
  LINES POWER TROLL OTHER                0                         1
  NOT CODED                              0                         0
  POTS AND TRAPS; FISH                 290                         0
  POTS AND TRAPS; SPINY LOBSTER          0                         0
  ROD AND REEL                           0                         0
  SKIN DIVING                            0                         0
  TRAMMEL NETS                           5                         1
  UNSPECIFIED GEAR                       0                         0
                               
                                LINES POWER TROLL OTHER NOT CODED
  BY HAND                                             0         0
  BY HAND; DIVING GEAR                                0         0
  CAST NETS                                           0         0
  ENTANGLING NETS (GILL) UNSPC                        0         0
  HAUL SEINES                                         0         0
  LINES HAND                                         27         0
  LINES LONG SET WITH HOOKS                           0         0
  LINES LONG; REEF FISH                               0         0
  LINES POWER TROLL OTHER                             0         0
  NOT CODED                                          10      3000
  POTS AND TRAPS; FISH                               24         0
  POTS AND TRAPS; SPINY LOBSTER                       0         0
  ROD AND REEL                                        0         0
  SKIN DIVING                                         0         0
  TRAMMEL NETS                                        0         0
  UNSPECIFIED GEAR                                    0         0
                               
                                POTS AND TRAPS, FISH
  BY HAND                                          0
  BY HAND; DIVING GEAR                             7
  CAST NETS                                        0
  ENTANGLING NETS (GILL) UNSPC                     0
  HAUL SEINES                                      0
  LINES HAND                                      11
  LINES LONG SET WITH HOOKS                        0
  LINES LONG; REEF FISH                            0
  LINES POWER TROLL OTHER                          0
  NOT CODED                                       30
  POTS AND TRAPS; FISH                            50
  POTS AND TRAPS; SPINY LOBSTER                    0
  ROD AND REEL                                     0
  SKIN DIVING                                      0
  TRAMMEL NETS                                     0
  UNSPECIFIED GEAR                                 0
                               
                                POTS AND TRAPS, SPINY LOBSTER ROD AND REEL
  BY HAND                                                   0            0
  BY HAND; DIVING GEAR                                      0            0
  CAST NETS                                                 0            0
  ENTANGLING NETS (GILL) UNSPC                              0            0
  HAUL SEINES                                               0            0
  LINES HAND                                                0            8
  LINES LONG SET WITH HOOKS                                 0            0
  LINES LONG; REEF FISH                                     0            0
  LINES POWER TROLL OTHER                                   0            0
  NOT CODED                                                27            0
  POTS AND TRAPS; FISH                                    191            0
  POTS AND TRAPS; SPINY LOBSTER                             0            0
  ROD AND REEL                                              0            0
  SKIN DIVING                                               0            0
  TRAMMEL NETS                                              0            0
  UNSPECIFIED GEAR                                          0            0
                               
                                SKIN DIVING TRAMMEL NETS
  BY HAND                                 0            0
  BY HAND; DIVING GEAR                    0            0
  CAST NETS                               0            0
  ENTANGLING NETS (GILL) UNSPC            0            0
  HAUL SEINES                             0            0
  LINES HAND                              0            0
  LINES LONG SET WITH HOOKS               0            0
  LINES LONG; REEF FISH                   0            0
  LINES POWER TROLL OTHER                 0            0
  NOT CODED                               2            0
  POTS AND TRAPS; FISH                    2            1
  POTS AND TRAPS; SPINY LOBSTER           0            0
  ROD AND REEL                            0            0
  SKIN DIVING                             0            0
  TRAMMEL NETS                            0            1
  UNSPECIFIED GEAR                        0            0</code></pre>
</div>
</div>
</section>
<section id="add-gear-groupings-no-length-length-conversions-available" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="add-gear-groupings-no-length-length-conversions-available">Add gear groupings, NO length-length conversions available</h4>
<div class="cell column-page">
<div class="cell-output cell-output-stdout">
<pre><code>                               
                                Hook and Line   Net Other  Trap  &lt;NA&gt;
  BY HAND                                   0     0    47     0     0
  BY HAND; DIVING GEAR                      0     0   556     0     0
  CAST NETS                                 0    32     0     0     0
  ENTANGLING NETS (GILL) UNSPC              0  1336     0     0     0
  HAUL SEINES                               0  7209     0     0     0
  LINES HAND                            78911     0     0     0     0
  LINES LONG SET WITH HOOKS               634     0     0     0     0
  LINES LONG; REEF FISH                    17     0     0     0     0
  LINES POWER TROLL OTHER                 419     0     0     0     0
  NOT CODED                                 0     0  5627     0     0
  POTS AND TRAPS; FISH                      0     0     0  7023     0
  POTS AND TRAPS; SPINY LOBSTER             0     0     0   235     0
  ROD AND REEL                            355     0     0     0     0
  SKIN DIVING                               0     0    20     0     0
  TRAMMEL NETS                              0   997     0     0     0
  UNSPECIFIED GEAR                          0     0     2     0     0
  &lt;NA&gt;                                      0     0     0     0     0</code></pre>
</div>
</div>
<div class="cell column-page">

</div>
</section>
</section>
</section>
<section id="filtration-level-investigation" class="level1">
<h1>Filtration level investigation</h1>
<section id="unique-trip-id-vs-gear-by-year-investigation" class="level2">
<h2 class="anchored" data-anchor-id="unique-trip-id-vs-gear-by-year-investigation">Unique trip ID vs gear by year investigation</h2>
<section id="how-many-unique-trip-ids-per-year" class="level4">
<h4 class="anchored" data-anchor-id="how-many-unique-trip-ids-per-year">How many unique trip ID’s per year?</h4>
<p>Group by year, count unique trip id’s</p>
<p>When we remove data from years with less than 10 unique trip ID’s, we are left with 39years of data (vs 40 without filter, only removes 2020).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_tripcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR n_distinct(ID)
1  1983             83
2  1984            210
3  1985            157
4  1986            233
5  1987            146
6  1988            138
7  1989            138
8  1990            152
9  1991            403
10 1992            409
11 1993            229
12 1994            101
13 1995            148
14 1996             63
15 1997             76
16 1998             98
17 1999            150
18 2000            119
19 2001            102
20 2002            140
21 2003            135
22 2004            131
23 2005            107
24 2006            155
25 2007            129
26 2008            108
27 2009            142
28 2010             98
29 2011            101
30 2012             88
31 2013             74
32 2014            185
33 2015            119
34 2016             72
35 2017             37
36 2018             46
37 2019             46
38 2020              4
39 2021             15
40 2022             44</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>length_data_trip10 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(ID) <span class="sc">&gt;=</span> <span class="dv">10</span>)<span class="sc">|&gt;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_trip10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR n_distinct(ID)
1  1983             83
2  1984            210
3  1985            157
4  1986            233
5  1987            146
6  1988            138
7  1989            138
8  1990            152
9  1991            403
10 1992            409
11 1993            229
12 1994            101
13 1995            148
14 1996             63
15 1997             76
16 1998             98
17 1999            150
18 2000            119
19 2001            102
20 2002            140
21 2003            135
22 2004            131
23 2005            107
24 2006            155
25 2007            129
26 2008            108
27 2009            142
28 2010             98
29 2011            101
30 2012             88
31 2013             74
32 2014            185
33 2015            119
34 2016             72
35 2017             37
36 2018             46
37 2019             46
38 2021             15
39 2022             44</code></pre>
</div>
</div>
</section>
</section>
<section id="unique-length-records-per-gear-per-year" class="level2">
<h2 class="anchored" data-anchor-id="unique-length-records-per-gear-per-year">Unique length records per gear per year</h2>
<section id="how-many-length-records-per-gear-per-year" class="level3">
<h3 class="anchored" data-anchor-id="how-many-length-records-per-gear-per-year">How many length records per gear per year?</h3>
<p>Group by year, count occurrences of each gear</p>
<p>There are years when individual gears occur less than 30 times but when grouped, the gear groups exceed 30 occurrences per year. Do we want to rely on gear groups with larger than 30 occurrences per year or individual gears with more than 30 occurrences?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur each year</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>length_data_gearcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gearcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    YEAR       LAND_STANDARD_GEAR_NAME count
1   1983                   HAUL SEINES    36
2   1983                    LINES HAND    70
3   1983          POTS AND TRAPS; FISH   353
4   1983                  TRAMMEL NETS     2
5   1984                    LINES HAND   927
6   1984                     NOT CODED     7
7   1984          POTS AND TRAPS; FISH   835
8   1984 POTS AND TRAPS; SPINY LOBSTER     1
9   1985          BY HAND; DIVING GEAR     2
10  1985  ENTANGLING NETS (GILL) UNSPC     9
11  1985                    LINES HAND  1093
12  1985                     NOT CODED   137
13  1985          POTS AND TRAPS; FISH   317
14  1986          BY HAND; DIVING GEAR    14
15  1986  ENTANGLING NETS (GILL) UNSPC   431
16  1986                   HAUL SEINES   695
17  1986                    LINES HAND   463
18  1986          POTS AND TRAPS; FISH   845
19  1986                  TRAMMEL NETS    61
20  1987          BY HAND; DIVING GEAR     1
21  1987  ENTANGLING NETS (GILL) UNSPC    26
22  1987                   HAUL SEINES    62
23  1987                    LINES HAND   277
24  1987       LINES POWER TROLL OTHER     1
25  1987                     NOT CODED    28
26  1987          POTS AND TRAPS; FISH   564
27  1987                  ROD AND REEL    49
28  1987                  TRAMMEL NETS    12
29  1988                       BY HAND     1
30  1988  ENTANGLING NETS (GILL) UNSPC    46
31  1988                   HAUL SEINES    43
32  1988                    LINES HAND   842
33  1988     LINES LONG SET WITH HOOKS    24
34  1988       LINES POWER TROLL OTHER     5
35  1988          POTS AND TRAPS; FISH   216
36  1988 POTS AND TRAPS; SPINY LOBSTER     7
37  1988                  ROD AND REEL   240
38  1988                  TRAMMEL NETS    60
39  1989          BY HAND; DIVING GEAR     8
40  1989  ENTANGLING NETS (GILL) UNSPC    42
41  1989                   HAUL SEINES   153
42  1989                    LINES HAND   408
43  1989     LINES LONG SET WITH HOOKS    55
44  1989       LINES POWER TROLL OTHER     2
45  1989                     NOT CODED    10
46  1989          POTS AND TRAPS; FISH   321
47  1989                  TRAMMEL NETS    63
48  1990  ENTANGLING NETS (GILL) UNSPC    90
49  1990                   HAUL SEINES   428
50  1990                    LINES HAND  1189
51  1990     LINES LONG SET WITH HOOKS   126
52  1990       LINES POWER TROLL OTHER    54
53  1990          POTS AND TRAPS; FISH   212
54  1990                  TRAMMEL NETS    21
55  1990              UNSPECIFIED GEAR     1
56  1991                     CAST NETS    32
57  1991  ENTANGLING NETS (GILL) UNSPC    14
58  1991                   HAUL SEINES     2
59  1991                    LINES HAND  8774
60  1991     LINES LONG SET WITH HOOKS   154
61  1991       LINES POWER TROLL OTHER     6
62  1991          POTS AND TRAPS; FISH   334
63  1991 POTS AND TRAPS; SPINY LOBSTER     9
64  1991                  TRAMMEL NETS    19
65  1992          BY HAND; DIVING GEAR     1
66  1992  ENTANGLING NETS (GILL) UNSPC     7
67  1992                   HAUL SEINES   445
68  1992                    LINES HAND  9053
69  1992       LINES POWER TROLL OTHER     7
70  1992          POTS AND TRAPS; FISH   370
71  1992                  TRAMMEL NETS    22
72  1993  ENTANGLING NETS (GILL) UNSPC     1
73  1993                   HAUL SEINES   224
74  1993                    LINES HAND  6418
75  1993       LINES POWER TROLL OTHER     1
76  1993          POTS AND TRAPS; FISH   180
77  1993 POTS AND TRAPS; SPINY LOBSTER    32
78  1993                  TRAMMEL NETS     8
79  1994                   HAUL SEINES   132
80  1994                    LINES HAND  2695
81  1994       LINES POWER TROLL OTHER    38
82  1994                     NOT CODED  1260
83  1994          POTS AND TRAPS; FISH    59
84  1994                  TRAMMEL NETS     6
85  1995          BY HAND; DIVING GEAR     1
86  1995  ENTANGLING NETS (GILL) UNSPC    18
87  1995                   HAUL SEINES    20
88  1995                    LINES HAND  2453
89  1995     LINES LONG SET WITH HOOKS     6
90  1995                     NOT CODED   952
91  1995          POTS AND TRAPS; FISH    87
92  1995                  TRAMMEL NETS     9
93  1996                     NOT CODED   677
94  1996          POTS AND TRAPS; FISH     4
95  1997  ENTANGLING NETS (GILL) UNSPC    60
96  1997                   HAUL SEINES    27
97  1997                    LINES HAND   576
98  1997       LINES POWER TROLL OTHER     1
99  1997          POTS AND TRAPS; FISH   130
100 1997                  TRAMMEL NETS    44
101 1998          BY HAND; DIVING GEAR     5
102 1998  ENTANGLING NETS (GILL) UNSPC   125
103 1998                   HAUL SEINES   192
104 1998                    LINES HAND  1692
105 1998       LINES POWER TROLL OTHER     5
106 1998          POTS AND TRAPS; FISH   118
107 1998 POTS AND TRAPS; SPINY LOBSTER     1
108 1998                  TRAMMEL NETS    66
109 1999          BY HAND; DIVING GEAR    63
110 1999  ENTANGLING NETS (GILL) UNSPC    23
111 1999                   HAUL SEINES   433
112 1999                    LINES HAND  4573
113 1999          POTS AND TRAPS; FISH   380
114 1999 POTS AND TRAPS; SPINY LOBSTER     5
115 1999                  ROD AND REEL     4
116 1999                  TRAMMEL NETS    61
117 2000          BY HAND; DIVING GEAR    14
118 2000  ENTANGLING NETS (GILL) UNSPC    41
119 2000                   HAUL SEINES   157
120 2000                    LINES HAND  4314
121 2000       LINES POWER TROLL OTHER     1
122 2000          POTS AND TRAPS; FISH   200
123 2000                  TRAMMEL NETS   148
124 2001          BY HAND; DIVING GEAR     7
125 2001  ENTANGLING NETS (GILL) UNSPC   112
126 2001                   HAUL SEINES   967
127 2001                    LINES HAND  1900
128 2001     LINES LONG SET WITH HOOKS     1
129 2001          POTS AND TRAPS; FISH   216
130 2001 POTS AND TRAPS; SPINY LOBSTER    81
131 2001                  TRAMMEL NETS    24
132 2002                       BY HAND    46
133 2002          BY HAND; DIVING GEAR   165
134 2002  ENTANGLING NETS (GILL) UNSPC     2
135 2002                   HAUL SEINES   563
136 2002                    LINES HAND  3523
137 2002          POTS AND TRAPS; FISH   123
138 2002 POTS AND TRAPS; SPINY LOBSTER    97
139 2002                  TRAMMEL NETS   110
140 2003  ENTANGLING NETS (GILL) UNSPC    44
141 2003                   HAUL SEINES   639
142 2003                    LINES HAND  4498
143 2003          POTS AND TRAPS; FISH   120
144 2003                  TRAMMEL NETS    47
145 2004          BY HAND; DIVING GEAR     6
146 2004  ENTANGLING NETS (GILL) UNSPC    20
147 2004                   HAUL SEINES   350
148 2004                    LINES HAND  2381
149 2004          POTS AND TRAPS; FISH   133
150 2004                  TRAMMEL NETS    23
151 2005          BY HAND; DIVING GEAR    10
152 2005  ENTANGLING NETS (GILL) UNSPC     6
153 2005                   HAUL SEINES   230
154 2005                    LINES HAND  2189
155 2005       LINES POWER TROLL OTHER    83
156 2005          POTS AND TRAPS; FISH    21
157 2005 POTS AND TRAPS; SPINY LOBSTER     2
158 2005                  TRAMMEL NETS    23
159 2006          BY HAND; DIVING GEAR    42
160 2006  ENTANGLING NETS (GILL) UNSPC    22
161 2006                   HAUL SEINES   531
162 2006                    LINES HAND  2404
163 2006          POTS AND TRAPS; FISH    23
164 2006                  TRAMMEL NETS    20
165 2007          BY HAND; DIVING GEAR     2
166 2007  ENTANGLING NETS (GILL) UNSPC     5
167 2007                   HAUL SEINES   197
168 2007                    LINES HAND  3174
169 2007       LINES POWER TROLL OTHER    52
170 2007          POTS AND TRAPS; FISH    31
171 2007                  TRAMMEL NETS    32
172 2008          BY HAND; DIVING GEAR    28
173 2008  ENTANGLING NETS (GILL) UNSPC    78
174 2008                   HAUL SEINES     6
175 2008                    LINES HAND  2011
176 2008       LINES POWER TROLL OTHER    29
177 2008          POTS AND TRAPS; FISH    35
178 2008                  TRAMMEL NETS     3
179 2009          BY HAND; DIVING GEAR    13
180 2009  ENTANGLING NETS (GILL) UNSPC    31
181 2009                   HAUL SEINES    11
182 2009                    LINES HAND  2718
183 2009       LINES POWER TROLL OTHER    12
184 2009          POTS AND TRAPS; FISH    83
185 2009                  TRAMMEL NETS    45
186 2010          BY HAND; DIVING GEAR    21
187 2010  ENTANGLING NETS (GILL) UNSPC    10
188 2010                    LINES HAND  1969
189 2010          POTS AND TRAPS; FISH     2
190 2010                  TRAMMEL NETS    33
191 2011  ENTANGLING NETS (GILL) UNSPC     1
192 2011                    LINES HAND   166
193 2011     LINES LONG SET WITH HOOKS     7
194 2011                     NOT CODED   745
195 2011          POTS AND TRAPS; FISH    35
196 2012          BY HAND; DIVING GEAR    17
197 2012  ENTANGLING NETS (GILL) UNSPC     3
198 2012                   HAUL SEINES    66
199 2012                    LINES HAND   227
200 2012     LINES LONG SET WITH HOOKS    14
201 2012                     NOT CODED   911
202 2012          POTS AND TRAPS; FISH    43
203 2012                  ROD AND REEL     9
204 2013          BY HAND; DIVING GEAR    14
205 2013  ENTANGLING NETS (GILL) UNSPC     1
206 2013                   HAUL SEINES   241
207 2013                    LINES HAND   197
208 2013     LINES LONG SET WITH HOOKS    28
209 2013                     NOT CODED   520
210 2013          POTS AND TRAPS; FISH     2
211 2013                  TRAMMEL NETS     8
212 2014          BY HAND; DIVING GEAR    52
213 2014  ENTANGLING NETS (GILL) UNSPC    21
214 2014                   HAUL SEINES   176
215 2014                    LINES HAND  1376
216 2014     LINES LONG SET WITH HOOKS   111
217 2014       LINES POWER TROLL OTHER   122
218 2014                     NOT CODED   263
219 2014          POTS AND TRAPS; FISH   264
220 2014                  ROD AND REEL    43
221 2014                   SKIN DIVING    15
222 2014              UNSPECIFIED GEAR     1
223 2015          BY HAND; DIVING GEAR    26
224 2015  ENTANGLING NETS (GILL) UNSPC    10
225 2015                   HAUL SEINES    32
226 2015                    LINES HAND  1458
227 2015     LINES LONG SET WITH HOOKS    14
228 2015                     NOT CODED   117
229 2015          POTS AND TRAPS; FISH   156
230 2015                  ROD AND REEL     9
231 2015                  TRAMMEL NETS    35
232 2016          BY HAND; DIVING GEAR     5
233 2016                   HAUL SEINES    96
234 2016                    LINES HAND   595
235 2016     LINES LONG SET WITH HOOKS    94
236 2016         LINES LONG; REEF FISH    17
237 2016          POTS AND TRAPS; FISH    84
238 2016                   SKIN DIVING     1
239 2017          BY HAND; DIVING GEAR     5
240 2017  ENTANGLING NETS (GILL) UNSPC    12
241 2017                    LINES HAND   572
242 2017          POTS AND TRAPS; FISH    31
243 2017                   SKIN DIVING     1
244 2018          BY HAND; DIVING GEAR     6
245 2018                   HAUL SEINES    38
246 2018                    LINES HAND   478
247 2018          POTS AND TRAPS; FISH    20
248 2019          BY HAND; DIVING GEAR    12
249 2019  ENTANGLING NETS (GILL) UNSPC    11
250 2019                   HAUL SEINES    18
251 2019                    LINES HAND  1066
252 2019          POTS AND TRAPS; FISH    20
253 2019                   SKIN DIVING     1
254 2020          BY HAND; DIVING GEAR     1
255 2020                    LINES HAND    13
256 2021          BY HAND; DIVING GEAR     3
257 2021                    LINES HAND   104
258 2021          POTS AND TRAPS; FISH     8
259 2021                  ROD AND REEL     1
260 2022          BY HAND; DIVING GEAR    12
261 2022  ENTANGLING NETS (GILL) UNSPC    16
262 2022                   HAUL SEINES     4
263 2022                    LINES HAND   720
264 2022          POTS AND TRAPS; FISH    20</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur 30 or more times each year</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>length_data_gear30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    YEAR       LAND_STANDARD_GEAR_NAME count
1   1983                   HAUL SEINES    36
2   1983                    LINES HAND    70
3   1983          POTS AND TRAPS; FISH   353
4   1984                    LINES HAND   927
5   1984          POTS AND TRAPS; FISH   835
6   1985                    LINES HAND  1093
7   1985                     NOT CODED   137
8   1985          POTS AND TRAPS; FISH   317
9   1986  ENTANGLING NETS (GILL) UNSPC   431
10  1986                   HAUL SEINES   695
11  1986                    LINES HAND   463
12  1986          POTS AND TRAPS; FISH   845
13  1986                  TRAMMEL NETS    61
14  1987                   HAUL SEINES    62
15  1987                    LINES HAND   277
16  1987          POTS AND TRAPS; FISH   564
17  1987                  ROD AND REEL    49
18  1988  ENTANGLING NETS (GILL) UNSPC    46
19  1988                   HAUL SEINES    43
20  1988                    LINES HAND   842
21  1988          POTS AND TRAPS; FISH   216
22  1988                  ROD AND REEL   240
23  1988                  TRAMMEL NETS    60
24  1989  ENTANGLING NETS (GILL) UNSPC    42
25  1989                   HAUL SEINES   153
26  1989                    LINES HAND   408
27  1989     LINES LONG SET WITH HOOKS    55
28  1989          POTS AND TRAPS; FISH   321
29  1989                  TRAMMEL NETS    63
30  1990  ENTANGLING NETS (GILL) UNSPC    90
31  1990                   HAUL SEINES   428
32  1990                    LINES HAND  1189
33  1990     LINES LONG SET WITH HOOKS   126
34  1990       LINES POWER TROLL OTHER    54
35  1990          POTS AND TRAPS; FISH   212
36  1991                     CAST NETS    32
37  1991                    LINES HAND  8774
38  1991     LINES LONG SET WITH HOOKS   154
39  1991          POTS AND TRAPS; FISH   334
40  1992                   HAUL SEINES   445
41  1992                    LINES HAND  9053
42  1992          POTS AND TRAPS; FISH   370
43  1993                   HAUL SEINES   224
44  1993                    LINES HAND  6418
45  1993          POTS AND TRAPS; FISH   180
46  1993 POTS AND TRAPS; SPINY LOBSTER    32
47  1994                   HAUL SEINES   132
48  1994                    LINES HAND  2695
49  1994       LINES POWER TROLL OTHER    38
50  1994                     NOT CODED  1260
51  1994          POTS AND TRAPS; FISH    59
52  1995                    LINES HAND  2453
53  1995                     NOT CODED   952
54  1995          POTS AND TRAPS; FISH    87
55  1996                     NOT CODED   677
56  1997  ENTANGLING NETS (GILL) UNSPC    60
57  1997                    LINES HAND   576
58  1997          POTS AND TRAPS; FISH   130
59  1997                  TRAMMEL NETS    44
60  1998  ENTANGLING NETS (GILL) UNSPC   125
61  1998                   HAUL SEINES   192
62  1998                    LINES HAND  1692
63  1998          POTS AND TRAPS; FISH   118
64  1998                  TRAMMEL NETS    66
65  1999          BY HAND; DIVING GEAR    63
66  1999                   HAUL SEINES   433
67  1999                    LINES HAND  4573
68  1999          POTS AND TRAPS; FISH   380
69  1999                  TRAMMEL NETS    61
70  2000  ENTANGLING NETS (GILL) UNSPC    41
71  2000                   HAUL SEINES   157
72  2000                    LINES HAND  4314
73  2000          POTS AND TRAPS; FISH   200
74  2000                  TRAMMEL NETS   148
75  2001  ENTANGLING NETS (GILL) UNSPC   112
76  2001                   HAUL SEINES   967
77  2001                    LINES HAND  1900
78  2001          POTS AND TRAPS; FISH   216
79  2001 POTS AND TRAPS; SPINY LOBSTER    81
80  2002                       BY HAND    46
81  2002          BY HAND; DIVING GEAR   165
82  2002                   HAUL SEINES   563
83  2002                    LINES HAND  3523
84  2002          POTS AND TRAPS; FISH   123
85  2002 POTS AND TRAPS; SPINY LOBSTER    97
86  2002                  TRAMMEL NETS   110
87  2003  ENTANGLING NETS (GILL) UNSPC    44
88  2003                   HAUL SEINES   639
89  2003                    LINES HAND  4498
90  2003          POTS AND TRAPS; FISH   120
91  2003                  TRAMMEL NETS    47
92  2004                   HAUL SEINES   350
93  2004                    LINES HAND  2381
94  2004          POTS AND TRAPS; FISH   133
95  2005                   HAUL SEINES   230
96  2005                    LINES HAND  2189
97  2005       LINES POWER TROLL OTHER    83
98  2006          BY HAND; DIVING GEAR    42
99  2006                   HAUL SEINES   531
100 2006                    LINES HAND  2404
101 2007                   HAUL SEINES   197
102 2007                    LINES HAND  3174
103 2007       LINES POWER TROLL OTHER    52
104 2007          POTS AND TRAPS; FISH    31
105 2007                  TRAMMEL NETS    32
106 2008  ENTANGLING NETS (GILL) UNSPC    78
107 2008                    LINES HAND  2011
108 2008          POTS AND TRAPS; FISH    35
109 2009  ENTANGLING NETS (GILL) UNSPC    31
110 2009                    LINES HAND  2718
111 2009          POTS AND TRAPS; FISH    83
112 2009                  TRAMMEL NETS    45
113 2010                    LINES HAND  1969
114 2010                  TRAMMEL NETS    33
115 2011                    LINES HAND   166
116 2011                     NOT CODED   745
117 2011          POTS AND TRAPS; FISH    35
118 2012                   HAUL SEINES    66
119 2012                    LINES HAND   227
120 2012                     NOT CODED   911
121 2012          POTS AND TRAPS; FISH    43
122 2013                   HAUL SEINES   241
123 2013                    LINES HAND   197
124 2013                     NOT CODED   520
125 2014          BY HAND; DIVING GEAR    52
126 2014                   HAUL SEINES   176
127 2014                    LINES HAND  1376
128 2014     LINES LONG SET WITH HOOKS   111
129 2014       LINES POWER TROLL OTHER   122
130 2014                     NOT CODED   263
131 2014          POTS AND TRAPS; FISH   264
132 2014                  ROD AND REEL    43
133 2015                   HAUL SEINES    32
134 2015                    LINES HAND  1458
135 2015                     NOT CODED   117
136 2015          POTS AND TRAPS; FISH   156
137 2015                  TRAMMEL NETS    35
138 2016                   HAUL SEINES    96
139 2016                    LINES HAND   595
140 2016     LINES LONG SET WITH HOOKS    94
141 2016          POTS AND TRAPS; FISH    84
142 2017                    LINES HAND   572
143 2017          POTS AND TRAPS; FISH    31
144 2018                   HAUL SEINES    38
145 2018                    LINES HAND   478
146 2019                    LINES HAND  1066
147 2021                    LINES HAND   104
148 2022                    LINES HAND   720</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group gears that occur 30 or more times per year by gear grouping </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>length_data_geartogether30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span> </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geartogether30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    YEAR          gear count
1   1983 Hook and Line    70
2   1983           Net    36
3   1983          Trap   353
4   1984 Hook and Line   927
5   1984          Trap   835
6   1985 Hook and Line  1093
7   1985         Other   137
8   1985          Trap   317
9   1986 Hook and Line   463
10  1986           Net  1187
11  1986          Trap   845
12  1987 Hook and Line   326
13  1987           Net    62
14  1987          Trap   564
15  1988 Hook and Line  1082
16  1988           Net   149
17  1988          Trap   216
18  1989 Hook and Line   463
19  1989           Net   258
20  1989          Trap   321
21  1990 Hook and Line  1369
22  1990           Net   518
23  1990          Trap   212
24  1991 Hook and Line  8928
25  1991           Net    32
26  1991          Trap   334
27  1992 Hook and Line  9053
28  1992           Net   445
29  1992          Trap   370
30  1993 Hook and Line  6418
31  1993           Net   224
32  1993          Trap   212
33  1994 Hook and Line  2733
34  1994           Net   132
35  1994         Other  1260
36  1994          Trap    59
37  1995 Hook and Line  2453
38  1995         Other   952
39  1995          Trap    87
40  1996         Other   677
41  1997 Hook and Line   576
42  1997           Net   104
43  1997          Trap   130
44  1998 Hook and Line  1692
45  1998           Net   383
46  1998          Trap   118
47  1999 Hook and Line  4573
48  1999           Net   494
49  1999         Other    63
50  1999          Trap   380
51  2000 Hook and Line  4314
52  2000           Net   346
53  2000          Trap   200
54  2001 Hook and Line  1900
55  2001           Net  1079
56  2001          Trap   297
57  2002 Hook and Line  3523
58  2002           Net   673
59  2002         Other   211
60  2002          Trap   220
61  2003 Hook and Line  4498
62  2003           Net   730
63  2003          Trap   120
64  2004 Hook and Line  2381
65  2004           Net   350
66  2004          Trap   133
67  2005 Hook and Line  2272
68  2005           Net   230
69  2006 Hook and Line  2404
70  2006           Net   531
71  2006         Other    42
72  2007 Hook and Line  3226
73  2007           Net   229
74  2007          Trap    31
75  2008 Hook and Line  2011
76  2008           Net    78
77  2008          Trap    35
78  2009 Hook and Line  2718
79  2009           Net    76
80  2009          Trap    83
81  2010 Hook and Line  1969
82  2010           Net    33
83  2011 Hook and Line   166
84  2011         Other   745
85  2011          Trap    35
86  2012 Hook and Line   227
87  2012           Net    66
88  2012         Other   911
89  2012          Trap    43
90  2013 Hook and Line   197
91  2013           Net   241
92  2013         Other   520
93  2014 Hook and Line  1652
94  2014           Net   176
95  2014         Other   315
96  2014          Trap   264
97  2015 Hook and Line  1458
98  2015           Net    67
99  2015         Other   117
100 2015          Trap   156
101 2016 Hook and Line   689
102 2016           Net    96
103 2016          Trap    84
104 2017 Hook and Line   572
105 2017          Trap    31
106 2018 Hook and Line   478
107 2018           Net    38
108 2019 Hook and Line  1066
109 2021 Hook and Line   104
110 2022 Hook and Line   720</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by specific gear per year</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># only removes 2020</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geartogether30<span class="sc">$</span>YEAR, length_data_geartogether30<span class="sc">$</span>gear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       Hook and Line Net Other Trap
  1983             1   1     0    1
  1984             1   0     0    1
  1985             1   0     1    1
  1986             1   1     0    1
  1987             1   1     0    1
  1988             1   1     0    1
  1989             1   1     0    1
  1990             1   1     0    1
  1991             1   1     0    1
  1992             1   1     0    1
  1993             1   1     0    1
  1994             1   1     1    1
  1995             1   0     1    1
  1996             0   0     1    0
  1997             1   1     0    1
  1998             1   1     0    1
  1999             1   1     1    1
  2000             1   1     0    1
  2001             1   1     0    1
  2002             1   1     1    1
  2003             1   1     0    1
  2004             1   1     0    1
  2005             1   1     0    0
  2006             1   1     1    0
  2007             1   1     0    1
  2008             1   1     0    1
  2009             1   1     0    1
  2010             1   1     0    0
  2011             1   0     1    1
  2012             1   1     1    1
  2013             1   1     1    0
  2014             1   1     1    1
  2015             1   1     1    1
  2016             1   1     0    1
  2017             1   0     0    1
  2018             1   1     0    0
  2019             1   0     0    0
  2021             1   0     0    0
  2022             1   0     0    0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur each year</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>length_data_geargroupcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroupcount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    YEAR          gear count
1   1983 Hook and Line    70
2   1983           Net    38
3   1983          Trap   353
4   1984 Hook and Line   927
5   1984         Other     7
6   1984          Trap   836
7   1985 Hook and Line  1093
8   1985           Net     9
9   1985         Other   139
10  1985          Trap   317
11  1986 Hook and Line   463
12  1986           Net  1187
13  1986         Other    14
14  1986          Trap   845
15  1987 Hook and Line   327
16  1987           Net   100
17  1987         Other    29
18  1987          Trap   564
19  1988 Hook and Line  1111
20  1988           Net   149
21  1988         Other     1
22  1988          Trap   223
23  1989 Hook and Line   465
24  1989           Net   258
25  1989         Other    18
26  1989          Trap   321
27  1990 Hook and Line  1369
28  1990           Net   539
29  1990         Other     1
30  1990          Trap   212
31  1991 Hook and Line  8934
32  1991           Net    67
33  1991          Trap   343
34  1992 Hook and Line  9060
35  1992           Net   474
36  1992         Other     1
37  1992          Trap   370
38  1993 Hook and Line  6419
39  1993           Net   233
40  1993          Trap   212
41  1994 Hook and Line  2733
42  1994           Net   138
43  1994         Other  1260
44  1994          Trap    59
45  1995 Hook and Line  2459
46  1995           Net    47
47  1995         Other   953
48  1995          Trap    87
49  1996         Other   677
50  1996          Trap     4
51  1997 Hook and Line   577
52  1997           Net   131
53  1997          Trap   130
54  1998 Hook and Line  1697
55  1998           Net   383
56  1998         Other     5
57  1998          Trap   119
58  1999 Hook and Line  4577
59  1999           Net   517
60  1999         Other    63
61  1999          Trap   385
62  2000 Hook and Line  4315
63  2000           Net   346
64  2000         Other    14
65  2000          Trap   200
66  2001 Hook and Line  1901
67  2001           Net  1103
68  2001         Other     7
69  2001          Trap   297
70  2002 Hook and Line  3523
71  2002           Net   675
72  2002         Other   211
73  2002          Trap   220
74  2003 Hook and Line  4498
75  2003           Net   730
76  2003          Trap   120
77  2004 Hook and Line  2381
78  2004           Net   393
79  2004         Other     6
80  2004          Trap   133
81  2005 Hook and Line  2272
82  2005           Net   259
83  2005         Other    10
84  2005          Trap    23
85  2006 Hook and Line  2404
86  2006           Net   573
87  2006         Other    42
88  2006          Trap    23
89  2007 Hook and Line  3226
90  2007           Net   234
91  2007         Other     2
92  2007          Trap    31
93  2008 Hook and Line  2040
94  2008           Net    87
95  2008         Other    28
96  2008          Trap    35
97  2009 Hook and Line  2730
98  2009           Net    87
99  2009         Other    13
100 2009          Trap    83
101 2010 Hook and Line  1969
102 2010           Net    43
103 2010         Other    21
104 2010          Trap     2
105 2011 Hook and Line   173
106 2011           Net     1
107 2011         Other   745
108 2011          Trap    35
109 2012 Hook and Line   250
110 2012           Net    69
111 2012         Other   928
112 2012          Trap    43
113 2013 Hook and Line   225
114 2013           Net   250
115 2013         Other   534
116 2013          Trap     2
117 2014 Hook and Line  1652
118 2014           Net   197
119 2014         Other   331
120 2014          Trap   264
121 2015 Hook and Line  1481
122 2015           Net    77
123 2015         Other   143
124 2015          Trap   156
125 2016 Hook and Line   706
126 2016           Net    96
127 2016         Other     6
128 2016          Trap    84
129 2017 Hook and Line   572
130 2017           Net    12
131 2017         Other     6
132 2017          Trap    31
133 2018 Hook and Line   478
134 2018           Net    38
135 2018         Other     6
136 2018          Trap    20
137 2019 Hook and Line  1066
138 2019           Net    29
139 2019         Other    13
140 2019          Trap    20
141 2020 Hook and Line    13
142 2020         Other     1
143 2021 Hook and Line   105
144 2021         Other     3
145 2021          Trap     8
146 2022 Hook and Line   720
147 2022           Net    20
148 2022         Other    12
149 2022          Trap    20</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur 30 or more times each year</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>length_data_geargroup30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup30)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    YEAR          gear count
1   1983 Hook and Line    70
2   1983           Net    38
3   1983          Trap   353
4   1984 Hook and Line   927
5   1984          Trap   836
6   1985 Hook and Line  1093
7   1985         Other   139
8   1985          Trap   317
9   1986 Hook and Line   463
10  1986           Net  1187
11  1986          Trap   845
12  1987 Hook and Line   327
13  1987           Net   100
14  1987          Trap   564
15  1988 Hook and Line  1111
16  1988           Net   149
17  1988          Trap   223
18  1989 Hook and Line   465
19  1989           Net   258
20  1989          Trap   321
21  1990 Hook and Line  1369
22  1990           Net   539
23  1990          Trap   212
24  1991 Hook and Line  8934
25  1991           Net    67
26  1991          Trap   343
27  1992 Hook and Line  9060
28  1992           Net   474
29  1992          Trap   370
30  1993 Hook and Line  6419
31  1993           Net   233
32  1993          Trap   212
33  1994 Hook and Line  2733
34  1994           Net   138
35  1994         Other  1260
36  1994          Trap    59
37  1995 Hook and Line  2459
38  1995           Net    47
39  1995         Other   953
40  1995          Trap    87
41  1996         Other   677
42  1997 Hook and Line   577
43  1997           Net   131
44  1997          Trap   130
45  1998 Hook and Line  1697
46  1998           Net   383
47  1998          Trap   119
48  1999 Hook and Line  4577
49  1999           Net   517
50  1999         Other    63
51  1999          Trap   385
52  2000 Hook and Line  4315
53  2000           Net   346
54  2000          Trap   200
55  2001 Hook and Line  1901
56  2001           Net  1103
57  2001          Trap   297
58  2002 Hook and Line  3523
59  2002           Net   675
60  2002         Other   211
61  2002          Trap   220
62  2003 Hook and Line  4498
63  2003           Net   730
64  2003          Trap   120
65  2004 Hook and Line  2381
66  2004           Net   393
67  2004          Trap   133
68  2005 Hook and Line  2272
69  2005           Net   259
70  2006 Hook and Line  2404
71  2006           Net   573
72  2006         Other    42
73  2007 Hook and Line  3226
74  2007           Net   234
75  2007          Trap    31
76  2008 Hook and Line  2040
77  2008           Net    87
78  2008          Trap    35
79  2009 Hook and Line  2730
80  2009           Net    87
81  2009          Trap    83
82  2010 Hook and Line  1969
83  2010           Net    43
84  2011 Hook and Line   173
85  2011         Other   745
86  2011          Trap    35
87  2012 Hook and Line   250
88  2012           Net    69
89  2012         Other   928
90  2012          Trap    43
91  2013 Hook and Line   225
92  2013           Net   250
93  2013         Other   534
94  2014 Hook and Line  1652
95  2014           Net   197
96  2014         Other   331
97  2014          Trap   264
98  2015 Hook and Line  1481
99  2015           Net    77
100 2015         Other   143
101 2015          Trap   156
102 2016 Hook and Line   706
103 2016           Net    96
104 2016          Trap    84
105 2017 Hook and Line   572
106 2017          Trap    31
107 2018 Hook and Line   478
108 2018           Net    38
109 2019 Hook and Line  1066
110 2021 Hook and Line   105
111 2022 Hook and Line   720</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by gear grouping per year</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># only removes 2020</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geargroup30<span class="sc">$</span>YEAR, length_data_geargroup30<span class="sc">$</span>gear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       Hook and Line Net Other Trap
  1983             1   1     0    1
  1984             1   0     0    1
  1985             1   0     1    1
  1986             1   1     0    1
  1987             1   1     0    1
  1988             1   1     0    1
  1989             1   1     0    1
  1990             1   1     0    1
  1991             1   1     0    1
  1992             1   1     0    1
  1993             1   1     0    1
  1994             1   1     1    1
  1995             1   1     1    1
  1996             0   0     1    0
  1997             1   1     0    1
  1998             1   1     0    1
  1999             1   1     1    1
  2000             1   1     0    1
  2001             1   1     0    1
  2002             1   1     1    1
  2003             1   1     0    1
  2004             1   1     0    1
  2005             1   1     0    0
  2006             1   1     1    0
  2007             1   1     0    1
  2008             1   1     0    1
  2009             1   1     0    1
  2010             1   1     0    0
  2011             1   0     1    1
  2012             1   1     1    1
  2013             1   1     1    0
  2014             1   1     1    1
  2015             1   1     1    1
  2016             1   1     0    1
  2017             1   0     0    1
  2018             1   1     0    0
  2019             1   0     0    0
  2021             1   0     0    0
  2022             1   0     0    0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by individual gears </span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>length_data_gear29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear29)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    YEAR       LAND_STANDARD_GEAR_NAME count
1   1983                  TRAMMEL NETS     2
2   1984                     NOT CODED     7
3   1984 POTS AND TRAPS; SPINY LOBSTER     1
4   1985          BY HAND; DIVING GEAR     2
5   1985  ENTANGLING NETS (GILL) UNSPC     9
6   1986          BY HAND; DIVING GEAR    14
7   1987          BY HAND; DIVING GEAR     1
8   1987  ENTANGLING NETS (GILL) UNSPC    26
9   1987       LINES POWER TROLL OTHER     1
10  1987                     NOT CODED    28
11  1987                  TRAMMEL NETS    12
12  1988                       BY HAND     1
13  1988     LINES LONG SET WITH HOOKS    24
14  1988       LINES POWER TROLL OTHER     5
15  1988 POTS AND TRAPS; SPINY LOBSTER     7
16  1989          BY HAND; DIVING GEAR     8
17  1989       LINES POWER TROLL OTHER     2
18  1989                     NOT CODED    10
19  1990                  TRAMMEL NETS    21
20  1990              UNSPECIFIED GEAR     1
21  1991  ENTANGLING NETS (GILL) UNSPC    14
22  1991                   HAUL SEINES     2
23  1991       LINES POWER TROLL OTHER     6
24  1991 POTS AND TRAPS; SPINY LOBSTER     9
25  1991                  TRAMMEL NETS    19
26  1992          BY HAND; DIVING GEAR     1
27  1992  ENTANGLING NETS (GILL) UNSPC     7
28  1992       LINES POWER TROLL OTHER     7
29  1992                  TRAMMEL NETS    22
30  1993  ENTANGLING NETS (GILL) UNSPC     1
31  1993       LINES POWER TROLL OTHER     1
32  1993                  TRAMMEL NETS     8
33  1994                  TRAMMEL NETS     6
34  1995          BY HAND; DIVING GEAR     1
35  1995  ENTANGLING NETS (GILL) UNSPC    18
36  1995                   HAUL SEINES    20
37  1995     LINES LONG SET WITH HOOKS     6
38  1995                  TRAMMEL NETS     9
39  1996          POTS AND TRAPS; FISH     4
40  1997                   HAUL SEINES    27
41  1997       LINES POWER TROLL OTHER     1
42  1998          BY HAND; DIVING GEAR     5
43  1998       LINES POWER TROLL OTHER     5
44  1998 POTS AND TRAPS; SPINY LOBSTER     1
45  1999  ENTANGLING NETS (GILL) UNSPC    23
46  1999 POTS AND TRAPS; SPINY LOBSTER     5
47  1999                  ROD AND REEL     4
48  2000          BY HAND; DIVING GEAR    14
49  2000       LINES POWER TROLL OTHER     1
50  2001          BY HAND; DIVING GEAR     7
51  2001     LINES LONG SET WITH HOOKS     1
52  2001                  TRAMMEL NETS    24
53  2002  ENTANGLING NETS (GILL) UNSPC     2
54  2004          BY HAND; DIVING GEAR     6
55  2004  ENTANGLING NETS (GILL) UNSPC    20
56  2004                  TRAMMEL NETS    23
57  2005          BY HAND; DIVING GEAR    10
58  2005  ENTANGLING NETS (GILL) UNSPC     6
59  2005          POTS AND TRAPS; FISH    21
60  2005 POTS AND TRAPS; SPINY LOBSTER     2
61  2005                  TRAMMEL NETS    23
62  2006  ENTANGLING NETS (GILL) UNSPC    22
63  2006          POTS AND TRAPS; FISH    23
64  2006                  TRAMMEL NETS    20
65  2007          BY HAND; DIVING GEAR     2
66  2007  ENTANGLING NETS (GILL) UNSPC     5
67  2008          BY HAND; DIVING GEAR    28
68  2008                   HAUL SEINES     6
69  2008       LINES POWER TROLL OTHER    29
70  2008                  TRAMMEL NETS     3
71  2009          BY HAND; DIVING GEAR    13
72  2009                   HAUL SEINES    11
73  2009       LINES POWER TROLL OTHER    12
74  2010          BY HAND; DIVING GEAR    21
75  2010  ENTANGLING NETS (GILL) UNSPC    10
76  2010          POTS AND TRAPS; FISH     2
77  2011  ENTANGLING NETS (GILL) UNSPC     1
78  2011     LINES LONG SET WITH HOOKS     7
79  2012          BY HAND; DIVING GEAR    17
80  2012  ENTANGLING NETS (GILL) UNSPC     3
81  2012     LINES LONG SET WITH HOOKS    14
82  2012                  ROD AND REEL     9
83  2013          BY HAND; DIVING GEAR    14
84  2013  ENTANGLING NETS (GILL) UNSPC     1
85  2013     LINES LONG SET WITH HOOKS    28
86  2013          POTS AND TRAPS; FISH     2
87  2013                  TRAMMEL NETS     8
88  2014  ENTANGLING NETS (GILL) UNSPC    21
89  2014                   SKIN DIVING    15
90  2014              UNSPECIFIED GEAR     1
91  2015          BY HAND; DIVING GEAR    26
92  2015  ENTANGLING NETS (GILL) UNSPC    10
93  2015     LINES LONG SET WITH HOOKS    14
94  2015                  ROD AND REEL     9
95  2016          BY HAND; DIVING GEAR     5
96  2016         LINES LONG; REEF FISH    17
97  2016                   SKIN DIVING     1
98  2017          BY HAND; DIVING GEAR     5
99  2017  ENTANGLING NETS (GILL) UNSPC    12
100 2017                   SKIN DIVING     1
101 2018          BY HAND; DIVING GEAR     6
102 2018          POTS AND TRAPS; FISH    20
103 2019          BY HAND; DIVING GEAR    12
104 2019  ENTANGLING NETS (GILL) UNSPC    11
105 2019                   HAUL SEINES    18
106 2019          POTS AND TRAPS; FISH    20
107 2019                   SKIN DIVING     1
108 2020          BY HAND; DIVING GEAR     1
109 2020                    LINES HAND    13
110 2021          BY HAND; DIVING GEAR     3
111 2021          POTS AND TRAPS; FISH     8
112 2021                  ROD AND REEL     1
113 2022          BY HAND; DIVING GEAR    12
114 2022  ENTANGLING NETS (GILL) UNSPC    16
115 2022                   HAUL SEINES     4
116 2022          POTS AND TRAPS; FISH    20</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># VS </span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by gear groups </span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>length_data_geargroup29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup29)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   YEAR          gear count
1  1984         Other     7
2  1985           Net     9
3  1986         Other    14
4  1987         Other    29
5  1988         Other     1
6  1989         Other    18
7  1990         Other     1
8  1992         Other     1
9  1996          Trap     4
10 1998         Other     5
11 2000         Other    14
12 2001         Other     7
13 2004         Other     6
14 2005         Other    10
15 2005          Trap    23
16 2006          Trap    23
17 2007         Other     2
18 2008         Other    28
19 2009         Other    13
20 2010         Other    21
21 2010          Trap     2
22 2011           Net     1
23 2013          Trap     2
24 2016         Other     6
25 2017           Net    12
26 2017         Other     6
27 2018         Other     6
28 2018          Trap    20
29 2019           Net    29
30 2019         Other    13
31 2019          Trap    20
32 2020 Hook and Line    13
33 2020         Other     1
34 2021         Other     3
35 2021          Trap     8
36 2022           Net    20
37 2022         Other    12
38 2022          Trap    20</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="glm-analysis" class="level1 page-columns page-full">
<h1>GLM analysis</h1>
<p>No filtering based on number of trips/fish per year yet, analysis of all available data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(length_data_final<span class="sc">$</span>gear) <span class="co"># "Hook and Line", "Trap", "Other", "Net"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Other"         "Net"           "Hook and Line" "Trap"         </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># antiforklength &lt;- tip4 |&gt;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(LENGTH_TYPE1 != "FORK LENGTH")</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># table(antiforklength$LENGTH_TYPE1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="all-gears" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="all-gears">All Gears</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = length_data_glm, REML = FALSE)</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> length_data_glm, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                         Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
scale(FINAL_DATE)        2110.3  2110.2     1   43.5  91.117 3.112e-12 ***
LAND_STANDARD_GEAR_NAME 20934.1  1395.6    15 5183.2  60.260 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1 20 632204.8
mod2   20 610374.8</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: length_data_glm
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
mod3    5 610853 610901 -305422   610843                         
mod2   20 610375 610566 -305167   610335 508.22 15  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: length_data_glm
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
mod4   19 610422 610604 -305192   610384                         
mod2   20 610375 610566 -305167   610335 49.349  1  2.143e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>mod_contr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 LAND_STANDARD_GEAR_NAME       emmean       SE  df asymp.LCL asymp.UCL
 BY HAND                        3.226 0.140486 Inf     2.950     3.501
 BY HAND; DIVING GEAR           3.351 0.018336 Inf     3.315     3.387
 CAST NETS                      3.247 0.250374 Inf     2.757     3.738
 ENTANGLING NETS (GILL) UNSPC   3.277 0.017799 Inf     3.242     3.312
 HAUL SEINES                    3.175 0.016575 Inf     3.143     3.208
 LINES HAND                     3.383 0.007481 Inf     3.368     3.398
 LINES LONG SET WITH HOOKS      3.346 0.024710 Inf     3.297     3.394
 LINES LONG; REEF FISH          3.339 0.208776 Inf     2.930     3.748
 LINES POWER TROLL OTHER        3.384 0.032494 Inf     3.321     3.448
 NOT CODED                      3.319 0.012252 Inf     3.295     3.343
 POTS AND TRAPS; FISH           3.224 0.007417 Inf     3.210     3.239
 POTS AND TRAPS; SPINY LOBSTER  3.311 0.054786 Inf     3.203     3.418
 ROD AND REEL                   3.348 0.036019 Inf     3.277     3.418
 SKIN DIVING                    3.393 0.099009 Inf     3.199     3.587
 TRAMMEL NETS                   3.305 0.013312 Inf     3.279     3.331
 UNSPECIFIED GEAR               3.333 0.138118 Inf     3.062     3.604

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 

$contrasts
 contrast                                                     estimate      SE
 BY HAND - BY HAND; DIVING GEAR                               -0.12551 0.14154
 BY HAND - CAST NETS                                          -0.02152 0.28851
 BY HAND - ENTANGLING NETS (GILL) UNSPC                       -0.05161 0.14134
 BY HAND - HAUL SEINES                                         0.05043 0.14122
 BY HAND - LINES HAND                                         -0.15721 0.14048
 BY HAND - LINES LONG SET WITH HOOKS                          -0.12001 0.14234
 BY HAND - LINES LONG; REEF FISH                              -0.11300 0.25034
 BY HAND - LINES POWER TROLL OTHER                            -0.15866 0.14387
 BY HAND - NOT CODED                                          -0.09279 0.14092
 BY HAND - POTS AND TRAPS; FISH                                0.00137 0.14049
 BY HAND - POTS AND TRAPS; SPINY LOBSTER                      -0.08487 0.15064
 BY HAND - ROD AND REEL                                       -0.12202 0.14437
 BY HAND - SKIN DIVING                                        -0.16690 0.16954
 BY HAND - TRAMMEL NETS                                       -0.07924 0.14086
 BY HAND - UNSPECIFIED GEAR                                   -0.10744 0.19503
 BY HAND; DIVING GEAR - CAST NETS                              0.10399 0.25094
 BY HAND; DIVING GEAR - ENTANGLING NETS (GILL) UNSPC           0.07390 0.02471
 BY HAND; DIVING GEAR - HAUL SEINES                            0.17593 0.02356
 BY HAND; DIVING GEAR - LINES HAND                            -0.03171 0.01830
 BY HAND; DIVING GEAR - LINES LONG SET WITH HOOKS              0.00550 0.03006
 BY HAND; DIVING GEAR - LINES LONG; REEF FISH                  0.01251 0.20940
 BY HAND; DIVING GEAR - LINES POWER TROLL OTHER               -0.03316 0.03676
 BY HAND; DIVING GEAR - NOT CODED                              0.03272 0.02106
 BY HAND; DIVING GEAR - POTS AND TRAPS; FISH                   0.12688 0.01894
 BY HAND; DIVING GEAR - POTS AND TRAPS; SPINY LOBSTER          0.04063 0.05742
 BY HAND; DIVING GEAR - ROD AND REEL                           0.00349 0.03988
 BY HAND; DIVING GEAR - SKIN DIVING                           -0.04140 0.10033
 BY HAND; DIVING GEAR - TRAMMEL NETS                           0.04626 0.02168
 BY HAND; DIVING GEAR - UNSPECIFIED GEAR                       0.01806 0.13916
 CAST NETS - ENTANGLING NETS (GILL) UNSPC                     -0.03009 0.25087
 CAST NETS - HAUL SEINES                                       0.07194 0.25074
 CAST NETS - LINES HAND                                       -0.13569 0.25029
 CAST NETS - LINES LONG SET WITH HOOKS                        -0.09849 0.25137
 CAST NETS - LINES LONG; REEF FISH                            -0.09148 0.32199
 CAST NETS - LINES POWER TROLL OTHER                          -0.13715 0.25229
 CAST NETS - NOT CODED                                        -0.07127 0.25060
 CAST NETS - POTS AND TRAPS; FISH                              0.02289 0.25034
 CAST NETS - POTS AND TRAPS; SPINY LOBSTER                    -0.06336 0.25620
 CAST NETS - ROD AND REEL                                     -0.10050 0.25286
 CAST NETS - SKIN DIVING                                      -0.14539 0.26921
 CAST NETS - TRAMMEL NETS                                     -0.05773 0.25058
 CAST NETS - UNSPECIFIED GEAR                                 -0.08593 0.28564
 ENTANGLING NETS (GILL) UNSPC - HAUL SEINES                    0.10203 0.02295
 ENTANGLING NETS (GILL) UNSPC - LINES HAND                    -0.10560 0.01764
 ENTANGLING NETS (GILL) UNSPC - LINES LONG SET WITH HOOKS     -0.06840 0.02945
 ENTANGLING NETS (GILL) UNSPC - LINES LONG; REEF FISH         -0.06139 0.20942
 ENTANGLING NETS (GILL) UNSPC - LINES POWER TROLL OTHER       -0.10705 0.03622
 ENTANGLING NETS (GILL) UNSPC - NOT CODED                     -0.04118 0.02094
 ENTANGLING NETS (GILL) UNSPC - POTS AND TRAPS; FISH           0.05298 0.01784
 ENTANGLING NETS (GILL) UNSPC - POTS AND TRAPS; SPINY LOBSTER -0.03326 0.05712
 ENTANGLING NETS (GILL) UNSPC - ROD AND REEL                  -0.07041 0.03945
 ENTANGLING NETS (GILL) UNSPC - SKIN DIVING                   -0.11530 0.10047
 ENTANGLING NETS (GILL) UNSPC - TRAMMEL NETS                  -0.02763 0.02093
 ENTANGLING NETS (GILL) UNSPC - UNSPECIFIED GEAR              -0.05583 0.13906
 HAUL SEINES - LINES HAND                                     -0.20764 0.01589
 HAUL SEINES - LINES LONG SET WITH HOOKS                      -0.17043 0.02878
 HAUL SEINES - LINES LONG; REEF FISH                          -0.16342 0.20928
 HAUL SEINES - LINES POWER TROLL OTHER                        -0.20909 0.03557
 HAUL SEINES - NOT CODED                                      -0.14322 0.01971
 HAUL SEINES - POTS AND TRAPS; FISH                           -0.04905 0.01644
 HAUL SEINES - POTS AND TRAPS; SPINY LOBSTER                  -0.13530 0.05656
 HAUL SEINES - ROD AND REEL                                   -0.17244 0.03885
 HAUL SEINES - SKIN DIVING                                    -0.21733 0.10017
 HAUL SEINES - TRAMMEL NETS                                   -0.12967 0.01950
 HAUL SEINES - UNSPECIFIED GEAR                               -0.15787 0.13891
 LINES HAND - LINES LONG SET WITH HOOKS                        0.03721 0.02460
 LINES HAND - LINES LONG; REEF FISH                            0.04421 0.20875
 LINES HAND - LINES POWER TROLL OTHER                         -0.00145 0.03236
 LINES HAND - NOT CODED                                        0.06442 0.01301
 LINES HAND - POTS AND TRAPS; FISH                             0.15858 0.00748
 LINES HAND - POTS AND TRAPS; SPINY LOBSTER                    0.07234 0.05469
 LINES HAND - ROD AND REEL                                     0.03520 0.03600
 LINES HAND - SKIN DIVING                                     -0.00969 0.09905
 LINES HAND - TRAMMEL NETS                                     0.07797 0.01300
 LINES HAND - UNSPECIFIED GEAR                                 0.04977 0.13812
 LINES LONG SET WITH HOOKS - LINES LONG; REEF FISH             0.00701 0.21011
 LINES LONG SET WITH HOOKS - LINES POWER TROLL OTHER          -0.03866 0.03996
 LINES LONG SET WITH HOOKS - NOT CODED                         0.02722 0.02686
 LINES LONG SET WITH HOOKS - POTS AND TRAPS; FISH              0.12138 0.02484
 LINES LONG SET WITH HOOKS - POTS AND TRAPS; SPINY LOBSTER     0.03513 0.05967
 LINES LONG SET WITH HOOKS - ROD AND REEL                     -0.00201 0.04305
 LINES LONG SET WITH HOOKS - SKIN DIVING                      -0.04690 0.10185
 LINES LONG SET WITH HOOKS - TRAMMEL NETS                      0.04076 0.02717
 LINES LONG SET WITH HOOKS - UNSPECIFIED GEAR                  0.01256 0.14000
 LINES LONG; REEF FISH - LINES POWER TROLL OTHER              -0.04566 0.21126
 LINES LONG; REEF FISH - NOT CODED                             0.02021 0.20906
 LINES LONG; REEF FISH - POTS AND TRAPS; FISH                  0.11437 0.20882
 LINES LONG; REEF FISH - POTS AND TRAPS; SPINY LOBSTER         0.02813 0.21563
 LINES LONG; REEF FISH - ROD AND REEL                         -0.00902 0.21184
 LINES LONG; REEF FISH - SKIN DIVING                          -0.05391 0.23012
 LINES LONG; REEF FISH - TRAMMEL NETS                          0.03375 0.20912
 LINES LONG; REEF FISH - UNSPECIFIED GEAR                      0.00556 0.25035
 LINES POWER TROLL OTHER - NOT CODED                           0.06587 0.03435
 LINES POWER TROLL OTHER - POTS AND TRAPS; FISH                0.16004 0.03260
 LINES POWER TROLL OTHER - POTS AND TRAPS; SPINY LOBSTER       0.07379 0.06320
 LINES POWER TROLL OTHER - ROD AND REEL                        0.03665 0.04791
 LINES POWER TROLL OTHER - SKIN DIVING                        -0.00824 0.10408
 LINES POWER TROLL OTHER - TRAMMEL NETS                        0.07942 0.03429
 LINES POWER TROLL OTHER - UNSPECIFIED GEAR                    0.05122 0.14162
 NOT CODED - POTS AND TRAPS; FISH                              0.09416 0.01328
 NOT CODED - POTS AND TRAPS; SPINY LOBSTER                     0.00792 0.05593
 NOT CODED - ROD AND REEL                                     -0.02923 0.03759
 NOT CODED - SKIN DIVING                                      -0.07411 0.09956
 NOT CODED - TRAMMEL NETS                                      0.01355 0.01743
 NOT CODED - UNSPECIFIED GEAR                                 -0.01465 0.13852
 POTS AND TRAPS; FISH - POTS AND TRAPS; SPINY LOBSTER         -0.08625 0.05477
 POTS AND TRAPS; FISH - ROD AND REEL                          -0.12339 0.03599
 POTS AND TRAPS; FISH - SKIN DIVING                           -0.16828 0.09919
 POTS AND TRAPS; FISH - TRAMMEL NETS                          -0.08062 0.01352
 POTS AND TRAPS; FISH - UNSPECIFIED GEAR                      -0.10881 0.13817
 POTS AND TRAPS; SPINY LOBSTER - ROD AND REEL                 -0.03714 0.06485
 POTS AND TRAPS; SPINY LOBSTER - SKIN DIVING                  -0.08203 0.11307
 POTS AND TRAPS; SPINY LOBSTER - TRAMMEL NETS                  0.00563 0.05574
 POTS AND TRAPS; SPINY LOBSTER - UNSPECIFIED GEAR             -0.02257 0.14853
 ROD AND REEL - SKIN DIVING                                   -0.04489 0.10521
 ROD AND REEL - TRAMMEL NETS                                   0.04277 0.03766
 ROD AND REEL - UNSPECIFIED GEAR                               0.01457 0.14253
 SKIN DIVING - TRAMMEL NETS                                    0.08766 0.09978
 SKIN DIVING - UNSPECIFIED GEAR                                0.05946 0.16988
 TRAMMEL NETS - UNSPECIFIED GEAR                              -0.02820 0.13861
  df z.ratio p.value
 Inf  -0.887  1.0000
 Inf  -0.075  1.0000
 Inf  -0.365  1.0000
 Inf   0.357  1.0000
 Inf  -1.119  0.9993
 Inf  -0.843  1.0000
 Inf  -0.451  1.0000
 Inf  -1.103  0.9994
 Inf  -0.658  1.0000
 Inf   0.010  1.0000
 Inf  -0.563  1.0000
 Inf  -0.845  1.0000
 Inf  -0.984  0.9998
 Inf  -0.563  1.0000
 Inf  -0.551  1.0000
 Inf   0.414  1.0000
 Inf   2.991  0.1725
 Inf   7.467  &lt;.0001
 Inf  -1.733  0.9385
 Inf   0.183  1.0000
 Inf   0.060  1.0000
 Inf  -0.902  0.9999
 Inf   1.554  0.9760
 Inf   6.699  &lt;.0001
 Inf   0.708  1.0000
 Inf   0.088  1.0000
 Inf  -0.413  1.0000
 Inf   2.134  0.7430
 Inf   0.130  1.0000
 Inf  -0.120  1.0000
 Inf   0.287  1.0000
 Inf  -0.542  1.0000
 Inf  -0.392  1.0000
 Inf  -0.284  1.0000
 Inf  -0.544  1.0000
 Inf  -0.284  1.0000
 Inf   0.091  1.0000
 Inf  -0.247  1.0000
 Inf  -0.397  1.0000
 Inf  -0.540  1.0000
 Inf  -0.230  1.0000
 Inf  -0.301  1.0000
 Inf   4.446  0.0010
 Inf  -5.985  &lt;.0001
 Inf  -2.322  0.6069
 Inf  -0.293  1.0000
 Inf  -2.955  0.1883
 Inf  -1.966  0.8439
 Inf   2.969  0.1821
 Inf  -0.582  1.0000
 Inf  -1.785  0.9222
 Inf  -1.148  0.9990
 Inf  -1.320  0.9952
 Inf  -0.402  1.0000
 Inf -13.066  &lt;.0001
 Inf  -5.922  &lt;.0001
 Inf  -0.781  1.0000
 Inf  -5.878  &lt;.0001
 Inf  -7.266  &lt;.0001
 Inf  -2.983  0.1757
 Inf  -2.392  0.5534
 Inf  -4.438  0.0010
 Inf  -2.170  0.7188
 Inf  -6.651  &lt;.0001
 Inf  -1.136  0.9991
 Inf   1.512  0.9814
 Inf   0.212  1.0000
 Inf  -0.045  1.0000
 Inf   4.952  0.0001
 Inf  21.203  &lt;.0001
 Inf   1.323  0.9952
 Inf   0.978  0.9999
 Inf  -0.098  1.0000
 Inf   5.996  &lt;.0001
 Inf   0.360  1.0000
 Inf   0.033  1.0000
 Inf  -0.967  0.9999
 Inf   1.013  0.9998
 Inf   4.887  0.0001
 Inf   0.589  1.0000
 Inf  -0.047  1.0000
 Inf  -0.460  1.0000
 Inf   1.500  0.9827
 Inf   0.090  1.0000
 Inf  -0.216  1.0000
 Inf   0.097  1.0000
 Inf   0.548  1.0000
 Inf   0.130  1.0000
 Inf  -0.043  1.0000
 Inf  -0.234  1.0000
 Inf   0.161  1.0000
 Inf   0.022  1.0000
 Inf   1.918  0.8682
 Inf   4.909  0.0001
 Inf   1.168  0.9988
 Inf   0.765  1.0000
 Inf  -0.079  1.0000
 Inf   2.316  0.6118
 Inf   0.362  1.0000
 Inf   7.093  &lt;.0001
 Inf   0.142  1.0000
 Inf  -0.778  1.0000
 Inf  -0.744  1.0000
 Inf   0.777  1.0000
 Inf  -0.106  1.0000
 Inf  -1.575  0.9729
 Inf  -3.429  0.0496
 Inf  -1.696  0.9482
 Inf  -5.961  &lt;.0001
 Inf  -0.788  1.0000
 Inf  -0.573  1.0000
 Inf  -0.726  1.0000
 Inf   0.101  1.0000
 Inf  -0.152  1.0000
 Inf  -0.427  1.0000
 Inf   1.136  0.9991
 Inf   0.102  1.0000
 Inf   0.879  1.0000
 Inf   0.350  1.0000
 Inf  -0.203  1.0000

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 16 estimates </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME       emmean       SE  df asymp.LCL asymp.UCL .group
 HAUL SEINES                    3.175 0.016575 Inf     3.143     3.208  1    
 POTS AND TRAPS; FISH           3.224 0.007417 Inf     3.210     3.239  12   
 BY HAND                        3.226 0.140486 Inf     2.950     3.501  1234 
 CAST NETS                      3.247 0.250374 Inf     2.757     3.738  1234 
 ENTANGLING NETS (GILL) UNSPC   3.277 0.017799 Inf     3.242     3.312   23  
 TRAMMEL NETS                   3.305 0.013312 Inf     3.279     3.331    3  
 POTS AND TRAPS; SPINY LOBSTER  3.311 0.054786 Inf     3.203     3.418  1234 
 NOT CODED                      3.319 0.012252 Inf     3.295     3.343    3  
 UNSPECIFIED GEAR               3.333 0.138118 Inf     3.062     3.604  1234 
 LINES LONG; REEF FISH          3.339 0.208776 Inf     2.930     3.748  1234 
 LINES LONG SET WITH HOOKS      3.346 0.024710 Inf     3.297     3.394    34 
 ROD AND REEL                   3.348 0.036019 Inf     3.277     3.418    34 
 BY HAND; DIVING GEAR           3.351 0.018336 Inf     3.315     3.387    34 
 LINES HAND                     3.383 0.007481 Inf     3.368     3.398     4 
 LINES POWER TROLL OTHER        3.384 0.032494 Inf     3.321     3.448    34 
 SKIN DIVING                    3.393 0.099009 Inf     3.199     3.587  1234 

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 16 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld <span class="ot">&lt;-</span> multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>length_data_fishcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_fish =</span> <span class="fu">n</span>()) </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_fish <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld, length_data_fishcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_trip <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_fish, length_data_tripcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_final <span class="ot">&lt;-</span> allgears_multcompcld_trip <span class="sc">|&gt;</span> </span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="st">".group"</span>,</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"n_distinct_ID"</span> <span class="ot">=</span> <span class="st">"n_distinct(ID)"</span>)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgears_multcompcld_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME       emmean       SE  df asymp.LCL asymp.UCL group
 HAUL SEINES                    3.175 0.016575 Inf     3.143     3.208  1   
 POTS AND TRAPS; FISH           3.224 0.007417 Inf     3.210     3.239  12  
 BY HAND                        3.226 0.140486 Inf     2.950     3.501  1234
 CAST NETS                      3.247 0.250374 Inf     2.757     3.738  1234
 ENTANGLING NETS (GILL) UNSPC   3.277 0.017799 Inf     3.242     3.312   23 
 TRAMMEL NETS                   3.305 0.013312 Inf     3.279     3.331    3 
 POTS AND TRAPS; SPINY LOBSTER  3.311 0.054786 Inf     3.203     3.418  1234
 NOT CODED                      3.319 0.012252 Inf     3.295     3.343    3 
 UNSPECIFIED GEAR               3.333 0.138118 Inf     3.062     3.604  1234
 LINES LONG; REEF FISH          3.339 0.208776 Inf     2.930     3.748  1234
 LINES LONG SET WITH HOOKS      3.346 0.024710 Inf     3.297     3.394    34
 ROD AND REEL                   3.348 0.036019 Inf     3.277     3.418    34
 BY HAND; DIVING GEAR           3.351 0.018336 Inf     3.315     3.387    34
 LINES HAND                     3.383 0.007481 Inf     3.368     3.398     4
 LINES POWER TROLL OTHER        3.384 0.032494 Inf     3.321     3.448    34
 SKIN DIVING                    3.393 0.099009 Inf     3.199     3.587  1234
 n_fish n_distinct_ID
   7214           212
   6995          1282
     47             2
     32             1
   1338           123
   1005           224
    235            14
   5627           385
      2             2
     17             1
    634            61
    355            31
    556           116
  79556          2637
    419            36
     18             4

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 16 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgears_multcompcld_final, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/output/pr_yts_glm_allgears.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>, <span class="st">"3"</span>, <span class="st">"4"</span>))</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_fish[i]))</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_distinct_ID[i]))</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>allgear_glm_totals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_distinct_ID =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_final<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_final<span class="sc">$</span>n_distinct_ID[i]))),</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_fish =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_final<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_final<span class="sc">$</span>n_fish[i]))))</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgear_glm_totals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  group n_distinct_ID n_fish
1     1          1518  14560
2     2          1429   8684
3     3          1000  10285
4     4          2905  81871</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgear_glm_totals, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/output/pr_yts_glm_allgears_totals.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="all-gears-2012-and-after" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="all-gears-2012-and-after">All Gears 2012 and after</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear2012_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear2012_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_allgear2012_plot-3.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$colour
$title
list()
attr(,"class")
[1] "waiver"

$title.position
NULL

$title.theme
NULL

$title.hjust
NULL

$title.vjust
NULL

$label
[1] TRUE

$label.position
NULL

$label.theme
NULL

$label.hjust
NULL

$label.vjust
NULL

$keywidth
NULL

$keyheight
NULL

$direction
NULL

$override.aes
$override.aes$size
[1] 2


$nrow
NULL

$ncol
NULL

$byrow
[1] FALSE

$reverse
[1] FALSE

$order
[1] 0

$available_aes
[1] "any"

$name
[1] "legend"

attr(,"class")
[1] "guide"  "legend"

attr(,"class")
[1] "guides"</code></pre>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = length_data_glm, REML = FALSE)</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> length_data_glm_2012, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                         Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
scale(FINAL_DATE)        276.58  276.58     1 633.84 14.1090 0.0001884 ***
LAND_STANDARD_GEAR_NAME 2295.39  191.28    12 788.13  9.7578 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1 17 63442.68
mod2   17 61044.31</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: length_data_glm_2012
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
mod3    5 61105 61141 -30547    61095                         
mod2   17 61044 61168 -30505    61010 84.471 12  5.751e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: length_data_glm_2012
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)  
mod4   16 61048 61164 -30508    61016                       
mod2   17 61044 61168 -30505    61010 5.6293  1    0.01766 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>mod_contr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 LAND_STANDARD_GEAR_NAME      emmean      SE  df asymp.LCL asymp.UCL
 BY HAND; DIVING GEAR           3.42 0.01891 Inf      3.38      3.46
 ENTANGLING NETS (GILL) UNSPC   3.40 0.04973 Inf      3.30      3.50
 HAUL SEINES                    3.36 0.03877 Inf      3.29      3.44
 LINES HAND                     3.45 0.00916 Inf      3.43      3.47
 LINES LONG SET WITH HOOKS      3.43 0.04162 Inf      3.35      3.51
 LINES LONG; REEF FISH          3.41 0.17011 Inf      3.08      3.74
 LINES POWER TROLL OTHER        3.59 0.12998 Inf      3.34      3.85
 NOT CODED                      3.44 0.01533 Inf      3.41      3.47
 POTS AND TRAPS; FISH           3.30 0.01374 Inf      3.28      3.33
 ROD AND REEL                   3.47 0.05427 Inf      3.37      3.58
 SKIN DIVING                    3.47 0.08287 Inf      3.31      3.64
 TRAMMEL NETS                   3.42 0.06831 Inf      3.28      3.55
 UNSPECIFIED GEAR               3.38 0.16688 Inf      3.05      3.71

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 

$contrasts
 contrast                                                  estimate     SE  df
 BY HAND; DIVING GEAR - ENTANGLING NETS (GILL) UNSPC       0.016630 0.0532 Inf
 BY HAND; DIVING GEAR - HAUL SEINES                        0.056082 0.0431 Inf
 BY HAND; DIVING GEAR - LINES HAND                        -0.031834 0.0210 Inf
 BY HAND; DIVING GEAR - LINES LONG SET WITH HOOKS         -0.010547 0.0457 Inf
 BY HAND; DIVING GEAR - LINES LONG; REEF FISH              0.009044 0.1712 Inf
 BY HAND; DIVING GEAR - LINES POWER TROLL OTHER           -0.174948 0.1314 Inf
 BY HAND; DIVING GEAR - NOT CODED                         -0.024042 0.0245 Inf
 BY HAND; DIVING GEAR - POTS AND TRAPS; FISH               0.116179 0.0234 Inf
 BY HAND; DIVING GEAR - ROD AND REEL                      -0.055333 0.0575 Inf
 BY HAND; DIVING GEAR - SKIN DIVING                       -0.054069 0.0850 Inf
 BY HAND; DIVING GEAR - TRAMMEL NETS                       0.000283 0.0709 Inf
 BY HAND; DIVING GEAR - UNSPECIFIED GEAR                   0.038226 0.1680 Inf
 ENTANGLING NETS (GILL) UNSPC - HAUL SEINES                0.039452 0.0631 Inf
 ENTANGLING NETS (GILL) UNSPC - LINES HAND                -0.048463 0.0506 Inf
 ENTANGLING NETS (GILL) UNSPC - LINES LONG SET WITH HOOKS -0.027177 0.0649 Inf
 ENTANGLING NETS (GILL) UNSPC - LINES LONG; REEF FISH     -0.007586 0.1772 Inf
 ENTANGLING NETS (GILL) UNSPC - LINES POWER TROLL OTHER   -0.191578 0.1392 Inf
 ENTANGLING NETS (GILL) UNSPC - NOT CODED                 -0.040672 0.0521 Inf
 ENTANGLING NETS (GILL) UNSPC - POTS AND TRAPS; FISH       0.099549 0.0516 Inf
 ENTANGLING NETS (GILL) UNSPC - ROD AND REEL              -0.071963 0.0736 Inf
 ENTANGLING NETS (GILL) UNSPC - SKIN DIVING               -0.070699 0.0966 Inf
 ENTANGLING NETS (GILL) UNSPC - TRAMMEL NETS              -0.016347 0.0845 Inf
 ENTANGLING NETS (GILL) UNSPC - UNSPECIFIED GEAR           0.021596 0.1741 Inf
 HAUL SEINES - LINES HAND                                 -0.087916 0.0399 Inf
 HAUL SEINES - LINES LONG SET WITH HOOKS                  -0.066630 0.0569 Inf
 HAUL SEINES - LINES LONG; REEF FISH                      -0.047038 0.1745 Inf
 HAUL SEINES - LINES POWER TROLL OTHER                    -0.231030 0.1356 Inf
 HAUL SEINES - NOT CODED                                  -0.080124 0.0417 Inf
 HAUL SEINES - POTS AND TRAPS; FISH                        0.060096 0.0411 Inf
 HAUL SEINES - ROD AND REEL                               -0.111416 0.0667 Inf
 HAUL SEINES - SKIN DIVING                                -0.110151 0.0915 Inf
 HAUL SEINES - TRAMMEL NETS                               -0.055800 0.0785 Inf
 HAUL SEINES - UNSPECIFIED GEAR                           -0.017856 0.1713 Inf
 LINES HAND - LINES LONG SET WITH HOOKS                    0.021286 0.0428 Inf
 LINES HAND - LINES LONG; REEF FISH                        0.040877 0.1703 Inf
 LINES HAND - LINES POWER TROLL OTHER                     -0.143114 0.1304 Inf
 LINES HAND - NOT CODED                                    0.007792 0.0186 Inf
 LINES HAND - POTS AND TRAPS; FISH                         0.148012 0.0167 Inf
 LINES HAND - ROD AND REEL                                -0.023500 0.0551 Inf
 LINES HAND - SKIN DIVING                                 -0.022235 0.0833 Inf
 LINES HAND - TRAMMEL NETS                                 0.032116 0.0691 Inf
 LINES HAND - UNSPECIFIED GEAR                             0.070060 0.1672 Inf
 LINES LONG SET WITH HOOKS - LINES LONG; REEF FISH         0.019591 0.1752 Inf
 LINES LONG SET WITH HOOKS - LINES POWER TROLL OTHER      -0.164401 0.1364 Inf
 LINES LONG SET WITH HOOKS - NOT CODED                    -0.013495 0.0439 Inf
 LINES LONG SET WITH HOOKS - POTS AND TRAPS; FISH          0.126726 0.0437 Inf
 LINES LONG SET WITH HOOKS - ROD AND REEL                 -0.044786 0.0683 Inf
 LINES LONG SET WITH HOOKS - SKIN DIVING                  -0.043522 0.0928 Inf
 LINES LONG SET WITH HOOKS - TRAMMEL NETS                  0.010830 0.0798 Inf
 LINES LONG SET WITH HOOKS - UNSPECIFIED GEAR              0.048774 0.1719 Inf
 LINES LONG; REEF FISH - LINES POWER TROLL OTHER          -0.183992 0.2141 Inf
 LINES LONG; REEF FISH - NOT CODED                        -0.033086 0.1709 Inf
 LINES LONG; REEF FISH - POTS AND TRAPS; FISH              0.107135 0.1707 Inf
 LINES LONG; REEF FISH - ROD AND REEL                     -0.064377 0.1786 Inf
 LINES LONG; REEF FISH - SKIN DIVING                      -0.063113 0.1892 Inf
 LINES LONG; REEF FISH - TRAMMEL NETS                     -0.008761 0.1834 Inf
 LINES LONG; REEF FISH - UNSPECIFIED GEAR                  0.029182 0.2383 Inf
 LINES POWER TROLL OTHER - NOT CODED                       0.150906 0.1306 Inf
 LINES POWER TROLL OTHER - POTS AND TRAPS; FISH            0.291126 0.1307 Inf
 LINES POWER TROLL OTHER - ROD AND REEL                    0.119614 0.1408 Inf
 LINES POWER TROLL OTHER - SKIN DIVING                     0.120879 0.1542 Inf
 LINES POWER TROLL OTHER - TRAMMEL NETS                    0.175230 0.1466 Inf
 LINES POWER TROLL OTHER - UNSPECIFIED GEAR                0.213174 0.2114 Inf
 NOT CODED - POTS AND TRAPS; FISH                          0.140221 0.0202 Inf
 NOT CODED - ROD AND REEL                                 -0.031291 0.0562 Inf
 NOT CODED - SKIN DIVING                                  -0.030027 0.0845 Inf
 NOT CODED - TRAMMEL NETS                                  0.024325 0.0695 Inf
 NOT CODED - UNSPECIFIED GEAR                              0.062268 0.1674 Inf
 POTS AND TRAPS; FISH - ROD AND REEL                      -0.171512 0.0559 Inf
 POTS AND TRAPS; FISH - SKIN DIVING                       -0.170248 0.0840 Inf
 POTS AND TRAPS; FISH - TRAMMEL NETS                      -0.115896 0.0696 Inf
 POTS AND TRAPS; FISH - UNSPECIFIED GEAR                  -0.077952 0.1674 Inf
 ROD AND REEL - SKIN DIVING                                0.001264 0.0991 Inf
 ROD AND REEL - TRAMMEL NETS                               0.055616 0.0871 Inf
 ROD AND REEL - UNSPECIFIED GEAR                           0.093560 0.1754 Inf
 SKIN DIVING - TRAMMEL NETS                                0.054352 0.1075 Inf
 SKIN DIVING - UNSPECIFIED GEAR                            0.092295 0.1864 Inf
 TRAMMEL NETS - UNSPECIFIED GEAR                           0.037944 0.1802 Inf
 z.ratio p.value
   0.313  1.0000
   1.300  0.9862
  -1.518  0.9524
  -0.231  1.0000
   0.053  1.0000
  -1.332  0.9831
  -0.983  0.9990
   4.966  0.0001
  -0.963  0.9992
  -0.636  1.0000
   0.004  1.0000
   0.228  1.0000
   0.626  1.0000
  -0.959  0.9992
  -0.419  1.0000
  -0.043  1.0000
  -1.377  0.9778
  -0.781  0.9999
   1.929  0.7783
  -0.978  0.9990
  -0.732  1.0000
  -0.193  1.0000
   0.124  1.0000
  -2.206  0.5867
  -1.172  0.9945
  -0.270  1.0000
  -1.703  0.8938
  -1.923  0.7820
   1.461  0.9644
  -1.671  0.9066
  -1.204  0.9930
  -0.711  1.0000
  -0.104  1.0000
   0.498  1.0000
   0.240  1.0000
  -1.098  0.9970
   0.420  1.0000
   8.883  &lt;.0001
  -0.426  1.0000
  -0.267  1.0000
   0.465  1.0000
   0.419  1.0000
   0.112  1.0000
  -1.206  0.9929
  -0.307  1.0000
   2.897  0.1600
  -0.656  1.0000
  -0.469  1.0000
   0.136  1.0000
   0.284  1.0000
  -0.859  0.9997
  -0.194  1.0000
   0.628  1.0000
  -0.360  1.0000
  -0.334  1.0000
  -0.048  1.0000
   0.122  1.0000
   1.155  0.9952
   2.228  0.5702
   0.850  0.9998
   0.784  0.9999
   1.195  0.9934
   1.008  0.9987
   6.942  &lt;.0001
  -0.557  1.0000
  -0.355  1.0000
   0.350  1.0000
   0.372  1.0000
  -3.066  0.1029
  -2.026  0.7160
  -1.666  0.9083
  -0.466  1.0000
   0.013  1.0000
   0.638  1.0000
   0.533  1.0000
   0.505  1.0000
   0.495  1.0000
   0.211  1.0000

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 13 estimates </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME      emmean      SE  df asymp.LCL asymp.UCL .group
 POTS AND TRAPS; FISH           3.30 0.01374 Inf      3.28      3.33  1    
 HAUL SEINES                    3.36 0.03877 Inf      3.29      3.44  12   
 UNSPECIFIED GEAR               3.38 0.16688 Inf      3.05      3.71  12   
 ENTANGLING NETS (GILL) UNSPC   3.40 0.04973 Inf      3.30      3.50  12   
 LINES LONG; REEF FISH          3.41 0.17011 Inf      3.08      3.74  12   
 TRAMMEL NETS                   3.42 0.06831 Inf      3.28      3.55  12   
 BY HAND; DIVING GEAR           3.42 0.01891 Inf      3.38      3.46   2   
 LINES LONG SET WITH HOOKS      3.43 0.04162 Inf      3.35      3.51  12   
 NOT CODED                      3.44 0.01533 Inf      3.41      3.47   2   
 LINES HAND                     3.45 0.00916 Inf      3.43      3.47   2   
 SKIN DIVING                    3.47 0.08287 Inf      3.31      3.64  12   
 ROD AND REEL                   3.47 0.05427 Inf      3.37      3.58  12   
 LINES POWER TROLL OTHER        3.59 0.12998 Inf      3.34      3.85  12   

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 13 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_2012 <span class="ot">&lt;-</span> multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>length_data_fishcount <span class="ot">&lt;-</span> length_data_glm_2012 <span class="sc">|&gt;</span> </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_fish =</span> <span class="fu">n</span>()) </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_glm_2012 <span class="sc">|&gt;</span> </span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_fish_2012 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_2012, length_data_fishcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_trip_2012 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_fish_2012, length_data_tripcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_finaL_2012 <span class="ot">&lt;-</span> allgears_multcompcld_trip_2012 <span class="sc">|&gt;</span> </span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="st">".group"</span>,</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"n_distinct_ID"</span> <span class="ot">=</span> <span class="st">"n_distinct(ID)"</span>)</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgears_multcompcld_finaL_2012)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME      emmean      SE  df asymp.LCL asymp.UCL group
 POTS AND TRAPS; FISH           3.30 0.01374 Inf      3.28      3.33  1   
 HAUL SEINES                    3.36 0.03877 Inf      3.29      3.44  12  
 UNSPECIFIED GEAR               3.38 0.16688 Inf      3.05      3.71  12  
 ENTANGLING NETS (GILL) UNSPC   3.40 0.04973 Inf      3.30      3.50  12  
 LINES LONG; REEF FISH          3.41 0.17011 Inf      3.08      3.74  12  
 TRAMMEL NETS                   3.42 0.06831 Inf      3.28      3.55  12  
 BY HAND; DIVING GEAR           3.42 0.01891 Inf      3.38      3.46   2  
 LINES LONG SET WITH HOOKS      3.43 0.04162 Inf      3.35      3.51  12  
 NOT CODED                      3.44 0.01533 Inf      3.41      3.47   2  
 LINES HAND                     3.45 0.00916 Inf      3.43      3.47   2  
 SKIN DIVING                    3.47 0.08287 Inf      3.31      3.64  12  
 ROD AND REEL                   3.47 0.05427 Inf      3.37      3.58  12  
 LINES POWER TROLL OTHER        3.59 0.12998 Inf      3.34      3.85  12  
 n_fish n_distinct_ID
    648           119
    671            21
      1             1
     74             9
     17             1
     43             5
    153            67
    261            15
   1811           128
   6806           350
     18             4
     62             8
    122             2

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 13 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgears_multcompcld_finaL_2012, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/output/pr_yts_2012glm_allgears.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>group_2012 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>, <span class="st">"3"</span>))</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_fish[i]))</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_distinct_ID[i]))</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>allgear_glm_totals_2012 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_distinct_ID =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group_2012<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_finaL_2012<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_finaL_2012<span class="sc">$</span>n_distinct_ID[i]))),</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_fish =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group_2012<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_finaL_2012<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_finaL_2012<span class="sc">$</span>n_fish[i]))))</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgear_glm_totals_2012)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  group n_distinct_ID n_fish
1     1           185   1917
2     2           611  10039
3     3             0      0</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgear_glm_totals_2012, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/output/pr_yts_2012glm_allgears_totals.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="hook-and-line" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="hook-and-line">Hook and Line</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_hookline_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_hookline_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_hookline_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_hl, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                        Sum Sq Mean Sq NumDF   DenDF F value    Pr(&gt;F)    
scale(FINAL_DATE)       1048.4 1048.39     1   44.05 41.6672 7.188e-08 ***
LAND_STANDARD_GEAR_NAME  126.1   31.52     4 2912.71  1.2529    0.2864    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  9 497750.8
mod2    9 482624.1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line gear p value are not significant </span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_hl
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
mod3    5 482618 482665 -241304   482608                     
mod2    9 482624 482708 -241303   482606 2.1922  4     0.7004</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="do">### There is significantly different size over time in the Hook and Line grouping </span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_hl
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
mod4    8 482646 482720 -241315   482630                         
mod2    9 482624 482708 -241303   482606 23.731  1  1.108e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="do">### no significant p values for gears, further comparisons not needed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="net" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="net">Net</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_netstd_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_netstd_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_netstd_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="do">### both fixed linear and glm models have warning message because ENTANGLING NETS (GILL) UNSPECIFIED only occur in one year, preventing convergence across timeline </span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_nlsg, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                         Sum Sq Mean Sq NumDF  DenDF F value    Pr(&gt;F)    
scale(FINAL_DATE)        399.06  399.06     1  51.21  27.648 2.871e-06 ***
LAND_STANDARD_GEAR_NAME 1059.21  353.07     3 459.67  24.462 1.058e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log)) </span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  8 53830.43
mod2    8 52333.26</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="do">### net (using LAND_STANDARD_GEAR_NAME) does have significantly different gears </span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_nlsg
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
mod3    5 52364 52400 -26177    52354                         
mod2    8 52333 52391 -26159    52317 36.583  3  5.639e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="do">### There is significantly different size over time in the Net grouping </span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_nlsg
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC logLik deviance Chisq Df Pr(&gt;Chisq)   
mod4    7 52339 52389 -26162    52325                       
mod2    8 52333 52391 -26159    52317 7.513  1   0.006125 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="do">### lines hand vs rod and reel and lines power troll other vs rod and reel are signifficantly different</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>mod_contr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 LAND_STANDARD_GEAR_NAME      emmean     SE  df asymp.LCL asymp.UCL
 CAST NETS                      3.14 0.2473 Inf      2.66      3.63
 ENTANGLING NETS (GILL) UNSPC   3.28 0.0194 Inf      3.24      3.32
 HAUL SEINES                    3.20 0.0207 Inf      3.16      3.24
 TRAMMEL NETS                   3.32 0.0155 Inf      3.29      3.35

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 

$contrasts
 contrast                                    estimate     SE  df z.ratio
 CAST NETS - ENTANGLING NETS (GILL) UNSPC     -0.1385 0.2473 Inf  -0.560
 CAST NETS - HAUL SEINES                      -0.0589 0.2476 Inf  -0.238
 CAST NETS - TRAMMEL NETS                     -0.1782 0.2469 Inf  -0.722
 ENTANGLING NETS (GILL) UNSPC - HAUL SEINES    0.0796 0.0233 Inf   3.410
 ENTANGLING NETS (GILL) UNSPC - TRAMMEL NETS  -0.0398 0.0205 Inf  -1.944
 HAUL SEINES - TRAMMEL NETS                   -0.1194 0.0191 Inf  -6.239
 p.value
  0.9439
  0.9953
  0.8884
  0.0036
  0.2098
  &lt;.0001

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="do">### suggestion: "lines power troll other", "lines hand" "rod and reel electric" and "reel electric or hydroulic" be grouped together</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="do">### "rod and reel" be kept separate</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> LAND_STANDARD_GEAR_NAME      emmean     SE  df asymp.LCL asymp.UCL .group
 CAST NETS                      3.14 0.2473 Inf      2.66      3.63  12   
 HAUL SEINES                    3.20 0.0207 Inf      3.16      3.24  1    
 ENTANGLING NETS (GILL) UNSPC   3.28 0.0194 Inf      3.24      3.32   2   
 TRAMMEL NETS                   3.32 0.0155 Inf      3.29      3.35   2   

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<div class="cell column-page">

</div>
<div class="cell column-page">

</div>
</section>
<section id="trap" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="trap">Trap</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_trap_plot-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_trap_plot-2.png" class="img-fluid" width="1440"></p>
</div>
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/glm_trap_plot-3.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell column-page">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_tr, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Type III Analysis of Variance Table with Satterthwaite's method
                         Sum Sq Mean Sq NumDF  DenDF F value   Pr(&gt;F)    
scale(FINAL_DATE)       1232.76 1232.76     1  23.11 84.1861 3.62e-09 ***
LAND_STANDARD_GEAR_NAME  113.63  113.63     1 893.51  7.7596 0.005456 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       df      AIC
mod1.1  6 41734.89
mod2    6 39322.64</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a><span class="do">### Trap does not have any significantly different gears </span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_tr
Models:
mod3: FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)
mod3    5 39322 39356 -19656    39312                     
mod2    6 39323 39364 -19655    39311 1.1698  1     0.2795</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="do">### There is significantly different size over time in the Trap grouping </span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: use_gear_tr
Models:
mod4: FL_CM ~ LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
mod2: FL_CM ~ scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID)
     npar   AIC   BIC logLik deviance  Chisq Df Pr(&gt;Chisq)    
mod4    5 39351 39386 -19671    39341                         
mod2    6 39323 39364 -19655    39311 30.764  1  2.914e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No significant p values for gears, further comparisons not needed </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="gear-density-plots" class="level1 page-columns page-full">
<h1>Gear Density Plots</h1>
<p>Filtered to years with 30 or more length records (regardless of gear) per year. STT and STJ records are grouped together.</p>
<section id="aggregated-density-plots" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="aggregated-density-plots">Aggregated density plots</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/agg_pdf_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="gear-grouping-investigation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="gear-grouping-investigation">Gear grouping investigation</h2>
<p>Filtered to minimum 30 fish per year</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_hl_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_trap_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_net_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_other_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="break-at-2005" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="break-at-2005">Break at 2005</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_plot_2005-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_hookandline_plot_2005-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_net_plot_2005-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_trap_plot_2005-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_other_plot_2005-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
</section>
<section id="annual-density-plots" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="annual-density-plots">Annual Density plots</h2>
<p>This will be split by final gear aggregations once these are decided, removes “other” gear types.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/annual_pdf_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell column-page">
<div class="cell-output cell-output-stdout">
<pre><code>
PUERTO RICO 
     104050 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2947</code></pre>
</div>
</div>
</section>
</section>
<section id="stacked-bar-charts" class="level1 page-columns page-full">
<h1>Stacked bar charts</h1>
<section id="visual-representation-of-gear-distribution-within-groupings" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="visual-representation-of-gear-distribution-within-groupings">Visual representation of gear distribution within groupings</h4>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_plot-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
</section>
<section id="gear-distribution-across-time-by-gear-groupings" class="level1 page-columns page-full">
<h1>Gear distribution across time by gear groupings</h1>
<section id="all-gears-over-time" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="all-gears-over-time">All gears over time</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1440"></p>
<figcaption class="figure-caption">Stoplight Parrotfish LAND_STANDARD_GEAR_NAME STX</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="hook-and-line-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="hook-and-line-gear-distribution-over-time-by-year">Hook and Line Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_hl_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell column-page">

</div>
</section>
<section id="trap-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="trap-gear-distribution-over-time-by-year">Trap Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_tr_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="diving-gear-distribution-over-time-by-year---no-gear-grouping" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="diving-gear-distribution-over-time-by-year---no-gear-grouping">Diving Gear Distribution Over Time by Year - NO GEAR GROUPING</h2>
<div class="cell column-page">

</div>
</section>
<section id="net-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="net-gear-distribution-over-time-by-year">Net Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_net_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="spear-gear-distribution-over-time-by-year---no-grouping" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="spear-gear-distribution-over-time-by-year---no-grouping">Spear Gear Distribution Over Time by Year - NO GROUPING</h2>
<div class="cell column-page">

</div>
</section>
<section id="other-gear-distribution-over-time-by-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="other-gear-distribution-over-time-by-year">Other Gear Distribution Over Time by Year</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/gear_distribution_yr_ot_plot-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
</section>
<section id="cummulative-density-plots" class="level1 page-columns page-full">
<h1>Cummulative Density Plots</h1>
<section id="aggregated-cdf" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="aggregated-cdf">Aggregated CDF</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/agg_cdf_plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="management-periods" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="management-periods">Management periods*</h2>
<p><strong>This section is optional and may be empty if there are not signifcant changes</strong></p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_cdf_plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="annual-cdf" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="annual-cdf">Annual CDF</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/annual_cdf_plot-1.png" class="img-fluid" width="864"></p>
</div>
</div>
</section>
</section>
<section id="island-density-plots" class="level1 page-columns page-full">
<h1>Island Density Plots</h1>
<section id="aggregated-density-plots-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="aggregated-density-plots-1">Aggregated density plots</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/agg_pdf_plot_reg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="management-periods-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="management-periods-1">Management periods*</h2>
<p><strong>This section is optional and may be empty if there are not significant changes</strong></p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/mgt_period_pdf_plot_reg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="annual-density-plots-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="annual-density-plots-1">Annual Density plots</h2>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<p><img src="pr_yt_sedar84_sizecomp_landstandardgr_30fish_files/figure-html/annual_pdf_plot_reg-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<div class="cell column-page">

</div>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb129" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "pr_yt_sedar84_sizecomp_landstdgearname"</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Katherine Godwin"</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="an">toc_expand:</span><span class="co"> true</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 4</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>This script will be expanding upon the length-comp script c1_nominal_len_comps.Rmd created by Molly Stevens.</span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a><span class="fu"># Yellowtail Snapper PR</span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up library </span></span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a>librarian<span class="sc">::</span><span class="fu">shelf</span>(here, tidyverse, ROracle, keyring, dotenv, reshape, openxlsx, janitor, DT, pander, knitr) <span class="co">#plyr</span></span>
<span id="cb129-27"><a href="#cb129-27" aria-hidden="true" tabindex="-1"></a><span class="co"># if conflicts in pkgs arise, use the following:</span></span>
<span id="cb129-28"><a href="#cb129-28" aria-hidden="true" tabindex="-1"></a><span class="co"># library(conflicted)</span></span>
<span id="cb129-29"><a href="#cb129-29" aria-hidden="true" tabindex="-1"></a><span class="co"># conflicted::conflicts_prefer(here::here)</span></span>
<span id="cb129-30"><a href="#cb129-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-31"><a href="#cb129-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-32"><a href="#cb129-32" aria-hidden="true" tabindex="-1"></a><span class="co">#pull data by island</span></span>
<span id="cb129-33"><a href="#cb129-33" aria-hidden="true" tabindex="-1"></a><span class="co"># cr_tip(state_codes = c('PR', 'VI'))</span></span>
<span id="cb129-34"><a href="#cb129-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-35"><a href="#cb129-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find out the date of the most recent extraction</span></span>
<span id="cb129-36"><a href="#cb129-36" aria-hidden="true" tabindex="-1"></a>tip_date <span class="ot">&lt;-</span> <span class="fu">max</span>(</span>
<span id="cb129-37"><a href="#cb129-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">".*?([0-9]+).RDS*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>,</span>
<span id="cb129-38"><a href="#cb129-38" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">list.files</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"raw"</span>),</span>
<span id="cb129-39"><a href="#cb129-39" aria-hidden="true" tabindex="-1"></a>                             <span class="at">pattern =</span> <span class="st">"com_tip_PR_VI"</span>))))</span>
<span id="cb129-40"><a href="#cb129-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-41"><a href="#cb129-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out the name of the most recent extraction</span></span>
<span id="cb129-42"><a href="#cb129-42" aria-hidden="true" tabindex="-1"></a>tip_file <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"raw"</span>),</span>
<span id="cb129-43"><a href="#cb129-43" aria-hidden="true" tabindex="-1"></a>                       <span class="at">pattern =</span> <span class="fu">paste0</span>(<span class="st">"^com_tip_PR_VI_+"</span>, tip_date))</span>
<span id="cb129-44"><a href="#cb129-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-45"><a href="#cb129-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-46"><a href="#cb129-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the most recent extraction</span></span>
<span id="cb129-47"><a href="#cb129-47" aria-hidden="true" tabindex="-1"></a>tip <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"raw"</span>, tip_file))</span>
<span id="cb129-48"><a href="#cb129-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-49"><a href="#cb129-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to PR and Yellowtail Snapper AND create new filterable date value </span></span>
<span id="cb129-50"><a href="#cb129-50" aria-hidden="true" tabindex="-1"></a>pr_yt <span class="ot">&lt;-</span> tip <span class="sc">|&gt;</span> </span>
<span id="cb129-51"><a href="#cb129-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(STATE_LANDED <span class="sc">==</span> <span class="st">"PUERTO RICO"</span>,</span>
<span id="cb129-52"><a href="#cb129-52" aria-hidden="true" tabindex="-1"></a>         OBS_STANDARD_SPECIES_CODE <span class="sc">==</span> <span class="st">"168907"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-53"><a href="#cb129-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TEST_DATE =</span> <span class="fu">as.Date</span>(<span class="fu">ymd_hms</span>(INTERVIEW_DATE)),</span>
<span id="cb129-54"><a href="#cb129-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">FINAL_DATE =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(TEST_DATE) <span class="sc">~</span> INTERVIEW_DATE, </span>
<span id="cb129-55"><a href="#cb129-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">TRUE</span> <span class="sc">~</span> TEST_DATE))</span>
<span id="cb129-56"><a href="#cb129-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-57"><a href="#cb129-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-58"><a href="#cb129-58" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/functions/len_len_convert.R"</span>)</span>
<span id="cb129-59"><a href="#cb129-59" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/functions/fig_format_export.R"</span>)</span>
<span id="cb129-60"><a href="#cb129-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb129-61"><a href="#cb129-61" aria-hidden="true" tabindex="-1"></a>LLconv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/CSVs/LLconversions.csv"</span>,</span>
<span id="cb129-62"><a href="#cb129-62" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb129-63"><a href="#cb129-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb129-64"><a href="#cb129-64" aria-hidden="true" tabindex="-1"></a>TIP_gears <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/data/CSVs/tip_gears_yts_pr_landstdgearname2.csv"</span>,</span>
<span id="cb129-65"><a href="#cb129-65" aria-hidden="true" tabindex="-1"></a>                   <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb129-66"><a href="#cb129-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-67"><a href="#cb129-67" aria-hidden="true" tabindex="-1"></a>gearcols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Net"</span> <span class="ot">=</span> <span class="st">"#FF0000"</span>, <span class="st">"Trap"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"#5D057D"</span>, <span class="st">"Hook and Line"</span> <span class="ot">=</span><span class="st">"#046C9A"</span>, <span class="st">"Gill Net"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Haul Seine"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Lobster Trap"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Trammel Net"</span> <span class="ot">=</span> <span class="st">"#00A08A"</span> , <span class="st">"Combined"</span> <span class="ot">=</span> <span class="st">"black"</span>)</span>
<span id="cb129-68"><a href="#cb129-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-69"><a href="#cb129-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-70"><a href="#cb129-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-71"><a href="#cb129-71" aria-hidden="true" tabindex="-1"></a><span class="fu">## Control Settings and Exploratory Frequency Tables</span></span>
<span id="cb129-72"><a href="#cb129-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-75"><a href="#cb129-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-76"><a href="#cb129-76" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-77"><a href="#cb129-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-78"><a href="#cb129-78" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="st">"YTS"</span></span>
<span id="cb129-79"><a href="#cb129-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-80"><a href="#cb129-80" aria-hidden="true" tabindex="-1"></a>region <span class="ot">&lt;-</span> <span class="st">"PUERTO RICO - USVI"</span></span>
<span id="cb129-81"><a href="#cb129-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-82"><a href="#cb129-82" aria-hidden="true" tabindex="-1"></a>county <span class="ot">&lt;-</span> <span class="st">"PUERTO RICO"</span></span>
<span id="cb129-83"><a href="#cb129-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-84"><a href="#cb129-84" aria-hidden="true" tabindex="-1"></a>bin_size <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb129-85"><a href="#cb129-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-86"><a href="#cb129-86" aria-hidden="true" tabindex="-1"></a>len_type <span class="ot">&lt;-</span> <span class="st">"FORK LENGTH"</span></span>
<span id="cb129-87"><a href="#cb129-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-88"><a href="#cb129-88" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>LENGTH_TYPE1, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb129-89"><a href="#cb129-89" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>LENGTH_TYPE2, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb129-90"><a href="#cb129-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-91"><a href="#cb129-91" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(pr_yt<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># 6 SEEMS TO BE AN ERROR, NEXT SMALLEST IS 55</span></span>
<span id="cb129-92"><a href="#cb129-92" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(pr_yt<span class="sc">$</span>LENGTH1_MM,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb129-93"><a href="#cb129-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-94"><a href="#cb129-94" aria-hidden="true" tabindex="-1"></a>tip_range  <span class="ot">&lt;-</span> pr_yt[<span class="fu">with</span>(pr_yt,<span class="fu">order</span>(<span class="sc">-</span>LENGTH1_MM)),]</span>
<span id="cb129-95"><a href="#cb129-95" aria-hidden="true" tabindex="-1"></a>tip_range<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span>
<span id="cb129-96"><a href="#cb129-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-97"><a href="#cb129-97" aria-hidden="true" tabindex="-1"></a>tip_range2 <span class="ot">&lt;-</span> pr_yt[<span class="fu">with</span>(pr_yt,<span class="fu">order</span>(LENGTH1_MM)),]</span>
<span id="cb129-98"><a href="#cb129-98" aria-hidden="true" tabindex="-1"></a>tip_range2<span class="sc">$</span>LENGTH1_MM[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span>
<span id="cb129-99"><a href="#cb129-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-100"><a href="#cb129-100" aria-hidden="true" tabindex="-1"></a><span class="do">##range currently set to not drop any obs (centimeters)</span></span>
<span id="cb129-101"><a href="#cb129-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-102"><a href="#cb129-102" aria-hidden="true" tabindex="-1"></a>min_size <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb129-103"><a href="#cb129-103" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb129-104"><a href="#cb129-104" aria-hidden="true" tabindex="-1"></a>max_size <span class="ot">&lt;-</span> <span class="dv">122</span>   </span>
<span id="cb129-105"><a href="#cb129-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-106"><a href="#cb129-106" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(pr_yt<span class="sc">$</span>YEAR,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb129-107"><a href="#cb129-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-108"><a href="#cb129-108" aria-hidden="true" tabindex="-1"></a>min_year <span class="ot">&lt;-</span> <span class="dv">1983</span></span>
<span id="cb129-109"><a href="#cb129-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-110"><a href="#cb129-110" aria-hidden="true" tabindex="-1"></a>max_year <span class="ot">&lt;-</span> <span class="dv">2022</span> </span>
<span id="cb129-111"><a href="#cb129-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-112"><a href="#cb129-112" aria-hidden="true" tabindex="-1"></a>break_year <span class="ot">&lt;-</span> <span class="dv">2005</span> <span class="co"># this is an optional value to denote a change in management. inclusive on the upper bound. can be set to NA if not relevant.  2005 trap specifications were updated and many closures went into place</span></span>
<span id="cb129-113"><a href="#cb129-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-114"><a href="#cb129-114" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb129-115"><a href="#cb129-115" aria-hidden="true" tabindex="-1"></a><span class="do">##  TABLES START HERE </span></span>
<span id="cb129-116"><a href="#cb129-116" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################### </span></span>
<span id="cb129-117"><a href="#cb129-117" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb129-118"><a href="#cb129-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-119"><a href="#cb129-119" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb129-120"><a href="#cb129-120" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, pr_yt<span class="sc">$</span>STATE_LANDED, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb129-121"><a href="#cb129-121" aria-hidden="true" tabindex="-1"></a><span class="co"># table(pr_yt$LAND_GEAR_NAME, pr_yt$STATE_LANDED, useNA='always')</span></span>
<span id="cb129-122"><a href="#cb129-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-123"><a href="#cb129-123" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>FISHING_MODE, pr_yt<span class="sc">$</span>INT_TYPE, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb129-124"><a href="#cb129-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-125"><a href="#cb129-125" aria-hidden="true" tabindex="-1"></a><span class="co"># marfin &lt;- pr_yt%&gt;%</span></span>
<span id="cb129-126"><a href="#cb129-126" aria-hidden="true" tabindex="-1"></a><span class="co">#             filter(INT_TYPE == "USVI MARFIN REEFFISH SAMPLING")</span></span>
<span id="cb129-127"><a href="#cb129-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-128"><a href="#cb129-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-129"><a href="#cb129-129" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>YEAR,pr_yt<span class="sc">$</span>OBS_STANDARD_SPECIES_NAME, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb129-130"><a href="#cb129-130" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-131"><a href="#cb129-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-132"><a href="#cb129-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-135"><a href="#cb129-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-136"><a href="#cb129-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-137"><a href="#cb129-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-138"><a href="#cb129-138" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>COUNTY_LANDED,pr_yt<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb129-139"><a href="#cb129-139" aria-hidden="true" tabindex="-1"></a><span class="co"># pr_rodandreel &lt;- pr_yt |&gt; </span></span>
<span id="cb129-140"><a href="#cb129-140" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(LAND_STANDARD_GEAR_NAME == "ROD AND REEL")</span></span>
<span id="cb129-141"><a href="#cb129-141" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>YEAR,pr_yt<span class="sc">$</span>STATE_LANDED,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb129-142"><a href="#cb129-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-143"><a href="#cb129-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-144"><a href="#cb129-144" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Filter to Commercial samples</span></span>
<span id="cb129-145"><a href="#cb129-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-148"><a href="#cb129-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-149"><a href="#cb129-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-150"><a href="#cb129-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-151"><a href="#cb129-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-152"><a href="#cb129-152" aria-hidden="true" tabindex="-1"></a><span class="do">################## PICK VARIABLES THAT I NEED HERE ;</span></span>
<span id="cb129-153"><a href="#cb129-153" aria-hidden="true" tabindex="-1"></a><span class="do">################## ASSIGN GEARS, ETC. BASED ON FLOW CHART</span></span>
<span id="cb129-154"><a href="#cb129-154" aria-hidden="true" tabindex="-1"></a><span class="do">## FILTER OUT COMMERCIAL SAMPLES</span></span>
<span id="cb129-155"><a href="#cb129-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-156"><a href="#cb129-156" aria-hidden="true" tabindex="-1"></a>tip2 <span class="ot">&lt;-</span> <span class="co">#readRDS('./data_clean/tip_GOM.Rdata') %&gt;%</span></span>
<span id="cb129-157"><a href="#cb129-157" aria-hidden="true" tabindex="-1"></a>  pr_yt <span class="sc">%&gt;%</span></span>
<span id="cb129-158"><a href="#cb129-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( <span class="co">#MULT_TRIP == '0')%&gt;%  ##no mult_trip in Caribbean TIP --&gt; ALL full catch samples</span></span>
<span id="cb129-159"><a href="#cb129-159" aria-hidden="true" tabindex="-1"></a>    FISHING_MODE<span class="sc">==</span><span class="st">'COMMERCIAL'</span>,</span>
<span id="cb129-160"><a href="#cb129-160" aria-hidden="true" tabindex="-1"></a>    LENGTH_TYPE1<span class="sc">!=</span><span class="st">'NO LENGTH'</span>,</span>
<span id="cb129-161"><a href="#cb129-161" aria-hidden="true" tabindex="-1"></a>    YEAR <span class="sc">&lt;=</span> <span class="dv">2023</span></span>
<span id="cb129-162"><a href="#cb129-162" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb129-163"><a href="#cb129-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">type_convert</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-164"><a href="#cb129-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">REGION_NAME =</span> region,</span>
<span id="cb129-165"><a href="#cb129-165" aria-hidden="true" tabindex="-1"></a>         <span class="at">OBS_STANDARD_SPECIES_CODE =</span> <span class="fu">as.numeric</span>(OBS_STANDARD_SPECIES_CODE), </span>
<span id="cb129-166"><a href="#cb129-166" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb129-167"><a href="#cb129-167" aria-hidden="true" tabindex="-1"></a><span class="do">####################SARAH'S CORRECTIONS NOW FIXED IN TIP DATABASE   </span></span>
<span id="cb129-168"><a href="#cb129-168" aria-hidden="true" tabindex="-1"></a><span class="co">#         COUNTY_LANDED = ifelse((YEAR==2018 &amp; COUNTY_LANDED=='NOT CODED'), 'ST THOMAS',</span></span>
<span id="cb129-169"><a href="#cb129-169" aria-hidden="true" tabindex="-1"></a><span class="co">#                                ifelse((YEAR==2017 &amp; COUNTY_LANDED=='NOT CODED'), 'ST CROIX', COUNTY_LANDED)),</span></span>
<span id="cb129-170"><a href="#cb129-170" aria-hidden="true" tabindex="-1"></a><span class="co">#         LENGTH1     = ifelse(LENGTH1_MM&gt;2000, LENGTH1/10, LENGTH1),</span></span>
<span id="cb129-171"><a href="#cb129-171" aria-hidden="true" tabindex="-1"></a><span class="co">#         LENGTH1_MM  = ifelse(LENGTH1_MM&gt;2000, LENGTH1_MM/10,LENGTH1_MM),</span></span>
<span id="cb129-172"><a href="#cb129-172" aria-hidden="true" tabindex="-1"></a><span class="do">####################</span></span>
<span id="cb129-173"><a href="#cb129-173" aria-hidden="true" tabindex="-1"></a>         <span class="at">source      =</span> <span class="st">"TIP"</span>, </span>
<span id="cb129-174"><a href="#cb129-174" aria-hidden="true" tabindex="-1"></a>         <span class="at">YTS         =</span> <span class="fu">ifelse</span>(OBS_STANDARD_SPECIES_CODE<span class="sc">==</span><span class="dv">168907</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="co">#binary flag for queen triggerfish vs 'other'</span></span>
<span id="cb129-175"><a href="#cb129-175" aria-hidden="true" tabindex="-1"></a>         <span class="at">ISLAND      =</span> <span class="fu">ifelse</span>(STATE_LANDED<span class="sc">==</span><span class="st">'PUERTO RICO'</span>, STATE_LANDED, COUNTY_LANDED),</span>
<span id="cb129-176"><a href="#cb129-176" aria-hidden="true" tabindex="-1"></a>         <span class="co">#STAT_AREA = ifelse(STANDARDAREA_1&gt;1, STANDARDAREA_1, LAND_STANDARD_AREA_ID),</span></span>
<span id="cb129-177"><a href="#cb129-177" aria-hidden="true" tabindex="-1"></a>         <span class="at">OBS_ID      =</span> <span class="fu">as.character</span>(OBS_ID)</span>
<span id="cb129-178"><a href="#cb129-178" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb129-179"><a href="#cb129-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(REGION_NAME,</span>
<span id="cb129-180"><a href="#cb129-180" aria-hidden="true" tabindex="-1"></a>         source,</span>
<span id="cb129-181"><a href="#cb129-181" aria-hidden="true" tabindex="-1"></a>         ID,</span>
<span id="cb129-182"><a href="#cb129-182" aria-hidden="true" tabindex="-1"></a>         INTERVIEW_DATE,</span>
<span id="cb129-183"><a href="#cb129-183" aria-hidden="true" tabindex="-1"></a>         FINAL_DATE,</span>
<span id="cb129-184"><a href="#cb129-184" aria-hidden="true" tabindex="-1"></a>         FISHING_MODE,</span>
<span id="cb129-185"><a href="#cb129-185" aria-hidden="true" tabindex="-1"></a>         INT_TYPE,</span>
<span id="cb129-186"><a href="#cb129-186" aria-hidden="true" tabindex="-1"></a>         <span class="at">YEAR =</span> YEAR,</span>
<span id="cb129-187"><a href="#cb129-187" aria-hidden="true" tabindex="-1"></a>         <span class="at">ITIS_CODE   =</span> OBS_STANDARD_SPECIES_CODE,</span>
<span id="cb129-188"><a href="#cb129-188" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPECIES     =</span> OBS_STANDARD_SPECIES_NAME,</span>
<span id="cb129-189"><a href="#cb129-189" aria-hidden="true" tabindex="-1"></a>         QUANTITY,</span>
<span id="cb129-190"><a href="#cb129-190" aria-hidden="true" tabindex="-1"></a>         YTS,</span>
<span id="cb129-191"><a href="#cb129-191" aria-hidden="true" tabindex="-1"></a>         STATE_LANDED,</span>
<span id="cb129-192"><a href="#cb129-192" aria-hidden="true" tabindex="-1"></a>         COUNTY_LANDED,</span>
<span id="cb129-193"><a href="#cb129-193" aria-hidden="true" tabindex="-1"></a>         <span class="at">COUNTY_CODE=</span>LANDING_AREA_COUNTY_CODE,</span>
<span id="cb129-194"><a href="#cb129-194" aria-hidden="true" tabindex="-1"></a>         PLACE_LANDED,</span>
<span id="cb129-195"><a href="#cb129-195" aria-hidden="true" tabindex="-1"></a>         DEALER,</span>
<span id="cb129-196"><a href="#cb129-196" aria-hidden="true" tabindex="-1"></a>         DEALER_CODE,</span>
<span id="cb129-197"><a href="#cb129-197" aria-hidden="true" tabindex="-1"></a>         ISLAND,</span>
<span id="cb129-198"><a href="#cb129-198" aria-hidden="true" tabindex="-1"></a>         OBS_WEIGHT_KG,</span>
<span id="cb129-199"><a href="#cb129-199" aria-hidden="true" tabindex="-1"></a>         LENGTH1_MM,</span>
<span id="cb129-200"><a href="#cb129-200" aria-hidden="true" tabindex="-1"></a>         LENGTH1,</span>
<span id="cb129-201"><a href="#cb129-201" aria-hidden="true" tabindex="-1"></a>         LENGTH_TYPE1,</span>
<span id="cb129-202"><a href="#cb129-202" aria-hidden="true" tabindex="-1"></a>         LENGTH_UNIT1,</span>
<span id="cb129-203"><a href="#cb129-203" aria-hidden="true" tabindex="-1"></a>         OBS_ID,</span>
<span id="cb129-204"><a href="#cb129-204" aria-hidden="true" tabindex="-1"></a>         LAND_STANDARD_GEAR_NAME,</span>
<span id="cb129-205"><a href="#cb129-205" aria-hidden="true" tabindex="-1"></a>         LAND_GEAR_NAME,</span>
<span id="cb129-206"><a href="#cb129-206" aria-hidden="true" tabindex="-1"></a>         LANDING_TYPE,</span>
<span id="cb129-207"><a href="#cb129-207" aria-hidden="true" tabindex="-1"></a>         BIAS_TYPE,</span>
<span id="cb129-208"><a href="#cb129-208" aria-hidden="true" tabindex="-1"></a>         VESSEL_ID,</span>
<span id="cb129-209"><a href="#cb129-209" aria-hidden="true" tabindex="-1"></a>         LICENSE,</span>
<span id="cb129-210"><a href="#cb129-210" aria-hidden="true" tabindex="-1"></a>         SAMPLE_ID,</span>
<span id="cb129-211"><a href="#cb129-211" aria-hidden="true" tabindex="-1"></a>         AREA_1,</span>
<span id="cb129-212"><a href="#cb129-212" aria-hidden="true" tabindex="-1"></a>         AREANAME_1,</span>
<span id="cb129-213"><a href="#cb129-213" aria-hidden="true" tabindex="-1"></a>         STANDARDAREA_1,</span>
<span id="cb129-214"><a href="#cb129-214" aria-hidden="true" tabindex="-1"></a>         STANDARDAREANAME_1,</span>
<span id="cb129-215"><a href="#cb129-215" aria-hidden="true" tabindex="-1"></a>         AGENT_USERNAME_ID,</span>
<span id="cb129-216"><a href="#cb129-216" aria-hidden="true" tabindex="-1"></a>         DEALER_CODE,</span>
<span id="cb129-217"><a href="#cb129-217" aria-hidden="true" tabindex="-1"></a>         VESSEL_ID</span>
<span id="cb129-218"><a href="#cb129-218" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb129-219"><a href="#cb129-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-220"><a href="#cb129-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-221"><a href="#cb129-221" aria-hidden="true" tabindex="-1"></a>Length composition after filtering to commercial records</span>
<span id="cb129-222"><a href="#cb129-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-225"><a href="#cb129-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-226"><a href="#cb129-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-227"><a href="#cb129-227" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-228"><a href="#cb129-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-229"><a href="#cb129-229" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>COUNTY_LANDED,tip2<span class="sc">$</span>ISLAND,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb129-230"><a href="#cb129-230" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>YEAR,tip2<span class="sc">$</span>ISLAND,<span class="at">useNA =</span> <span class="st">'always'</span>)</span>
<span id="cb129-231"><a href="#cb129-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-232"><a href="#cb129-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-233"><a href="#cb129-233" aria-hidden="true" tabindex="-1"></a>lencheck <span class="ot">&lt;-</span> tip2[tip2<span class="sc">$</span>LENGTH1_MM<span class="sc">&gt;</span><span class="dv">2000</span>,] <span class="co">#no lengths greater than 2000</span></span>
<span id="cb129-234"><a href="#cb129-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-235"><a href="#cb129-235" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range  &lt;- tip2[with(tip2,order(-LENGTH1_MM)),]</span></span>
<span id="cb129-236"><a href="#cb129-236" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range$LENGTH1_MM[1:25]</span></span>
<span id="cb129-237"><a href="#cb129-237" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-238"><a href="#cb129-238" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range2 &lt;- tip2[with(tip2,order(LENGTH1_MM)),]</span></span>
<span id="cb129-239"><a href="#cb129-239" aria-hidden="true" tabindex="-1"></a><span class="co"># tip_range2$LENGTH1_MM[1:25]</span></span>
<span id="cb129-240"><a href="#cb129-240" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>LENGTH_TYPE1,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb129-241"><a href="#cb129-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-242"><a href="#cb129-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-243"><a href="#cb129-243" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME,<span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb129-244"><a href="#cb129-244" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-245"><a href="#cb129-245" aria-hidden="true" tabindex="-1"></a><span class="co"># table(tip2$ITIS_CODE,tip2$SPECIES,useNA='always')</span></span>
<span id="cb129-246"><a href="#cb129-246" aria-hidden="true" tabindex="-1"></a><span class="co"># table(tip2$SPECIES,tip2$YTS,useNA='always')</span></span>
<span id="cb129-247"><a href="#cb129-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-248"><a href="#cb129-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-249"><a href="#cb129-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-250"><a href="#cb129-250" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract marfin samples, look at island distribution</span></span>
<span id="cb129-251"><a href="#cb129-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-254"><a href="#cb129-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-255"><a href="#cb129-255" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-256"><a href="#cb129-256" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-257"><a href="#cb129-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-258"><a href="#cb129-258" aria-hidden="true" tabindex="-1"></a><span class="co"># there are no marfin samples in PR</span></span>
<span id="cb129-259"><a href="#cb129-259" aria-hidden="true" tabindex="-1"></a><span class="do">##extract marfin samples, look at island distribution</span></span>
<span id="cb129-260"><a href="#cb129-260" aria-hidden="true" tabindex="-1"></a><span class="co"># marfin &lt;- tip2%&gt;%</span></span>
<span id="cb129-261"><a href="#cb129-261" aria-hidden="true" tabindex="-1"></a><span class="co">#             filter(INT_TYPE == "USVI MARFIN REEFFISH SAMPLING")</span></span>
<span id="cb129-262"><a href="#cb129-262" aria-hidden="true" tabindex="-1"></a><span class="co"># table(marfin$YEAR, marfin$ISLAND,useNA='always')</span></span>
<span id="cb129-263"><a href="#cb129-263" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-264"><a href="#cb129-264" aria-hidden="true" tabindex="-1"></a><span class="co"># table(marfin$LAND_STANDARD_GEAR_NAME, marfin$ISLAND,useNA='always')</span></span>
<span id="cb129-265"><a href="#cb129-265" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-266"><a href="#cb129-266" aria-hidden="true" tabindex="-1"></a><span class="co"># table(marfin$LAND_STANDARD_GEAR_NAME,marfin$YEAR, marfin$ISLAND,useNA='always')</span></span>
<span id="cb129-267"><a href="#cb129-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-268"><a href="#cb129-268" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>YEAR,tip2<span class="sc">$</span>LENGTH_TYPE1,<span class="at">useNA=</span><span class="st">'always'</span>)  <span class="do">##TL more prevalent in recent years</span></span>
<span id="cb129-269"><a href="#cb129-269" aria-hidden="true" tabindex="-1"></a><span class="co"># table(tip2$LENGTH_TYPE1,tip2$LENGTH_TYPE2,useNA='always') </span></span>
<span id="cb129-270"><a href="#cb129-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-271"><a href="#cb129-271" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip2<span class="sc">$</span>ISLAND,tip2<span class="sc">$</span>STATE_LANDED)</span>
<span id="cb129-272"><a href="#cb129-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-273"><a href="#cb129-273" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tip2$LENGTH1_MM,tip2$OBS_WEIGHT_KG,color=tip2$LENGTH_TYPE1)</span></span>
<span id="cb129-274"><a href="#cb129-274" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tip2$LENGTH1_MM,tip2$SAMPLE_WEIGHT_KG)</span></span>
<span id="cb129-275"><a href="#cb129-275" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(tip2$LENGTH1_MM,tip2$SUB_SAMPLE_WEIGHT_KG)</span></span>
<span id="cb129-276"><a href="#cb129-276" aria-hidden="true" tabindex="-1"></a>tip2<span class="sc">$</span>yearc <span class="ot">&lt;-</span> <span class="fu">as.character</span>(tip2<span class="sc">$</span>YEAR)</span>
<span id="cb129-277"><a href="#cb129-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-278"><a href="#cb129-278" aria-hidden="true" tabindex="-1"></a><span class="do">##############export all plots starting w/ year&gt;=2015, all islands</span></span>
<span id="cb129-279"><a href="#cb129-279" aria-hidden="true" tabindex="-1"></a><span class="do">#### here, isolated ST THOMAS 2018 for bulk of problems w single port sampler</span></span>
<span id="cb129-280"><a href="#cb129-280" aria-hidden="true" tabindex="-1"></a><span class="do">#### create new RMarkdown script describing this issue for internal distribution</span></span>
<span id="cb129-281"><a href="#cb129-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-282"><a href="#cb129-282" aria-hidden="true" tabindex="-1"></a><span class="co"># tip2[(tip2$YEAR==2018 &amp; tip2$ISLAND=='ST THOMAS'),] %&gt;%</span></span>
<span id="cb129-283"><a href="#cb129-283" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(LENGTH1_MM,OBS_WEIGHT_KG))+</span></span>
<span id="cb129-284"><a href="#cb129-284" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(color = AGENT_USERNAME_ID))  +  ##fork length is splitting</span></span>
<span id="cb129-285"><a href="#cb129-285" aria-hidden="true" tabindex="-1"></a><span class="co">#   # geom_point(aes(color = ISLAND))  +</span></span>
<span id="cb129-286"><a href="#cb129-286" aria-hidden="true" tabindex="-1"></a><span class="co">#   #labs(title = paste0(tip2$ISLAND,  "\n", min(tip2$YEAR), "-", max(tip2$YEAR)))+</span></span>
<span id="cb129-287"><a href="#cb129-287" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span>
<span id="cb129-288"><a href="#cb129-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-289"><a href="#cb129-289" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################################</span></span>
<span id="cb129-290"><a href="#cb129-290" aria-hidden="true" tabindex="-1"></a><span class="do">##### merge in gear tables </span></span>
<span id="cb129-291"><a href="#cb129-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-292"><a href="#cb129-292" aria-hidden="true" tabindex="-1"></a><span class="do">##LOOK AT GEAR ASSIGNMENTS BY SPECIES</span></span>
<span id="cb129-293"><a href="#cb129-293" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pr_yt<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, pr_yt<span class="sc">$</span>STANDARDGEARNAME_2)</span>
<span id="cb129-294"><a href="#cb129-294" aria-hidden="true" tabindex="-1"></a><span class="co">#table(pr_yt$GEAR, useNA='always')  ##N gears?</span></span>
<span id="cb129-295"><a href="#cb129-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-296"><a href="#cb129-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-297"><a href="#cb129-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-298"><a href="#cb129-298" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Add gear groupings, NO length-length conversions available</span></span>
<span id="cb129-299"><a href="#cb129-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-300"><a href="#cb129-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb129-301"><a href="#cb129-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-302"><a href="#cb129-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-303"><a href="#cb129-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-304"><a href="#cb129-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-305"><a href="#cb129-305" aria-hidden="true" tabindex="-1"></a><span class="do">###add length-length conversions to helper_table ; </span></span>
<span id="cb129-306"><a href="#cb129-306" aria-hidden="true" tabindex="-1"></a>tip3 <span class="ot">&lt;-</span> <span class="fu">merge</span>(tip2, TIP_gears, <span class="at">by.x=</span><span class="st">"LAND_STANDARD_GEAR_NAME"</span>,<span class="at">all.x=</span>T)</span>
<span id="cb129-307"><a href="#cb129-307" aria-hidden="true" tabindex="-1"></a><span class="co">#gfin2a &lt;- merge(gfin, flc, by.x=c("State_Landed","County_Landed"),all.x=T)</span></span>
<span id="cb129-308"><a href="#cb129-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-309"><a href="#cb129-309" aria-hidden="true" tabindex="-1"></a>tip4 <span class="ot">&lt;-</span> tip3[tip3<span class="sc">$</span>YTS<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb129-310"><a href="#cb129-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-311"><a href="#cb129-311" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tip3<span class="sc">$</span>LAND_STANDARD_GEAR_NAME, tip3<span class="sc">$</span>gear, <span class="at">useNA=</span><span class="st">'always'</span>)</span>
<span id="cb129-312"><a href="#cb129-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-313"><a href="#cb129-313" aria-hidden="true" tabindex="-1"></a><span class="co">#gear_groups &lt;- c("HAND LINE", "LONGLINE") </span></span>
<span id="cb129-314"><a href="#cb129-314" aria-hidden="true" tabindex="-1"></a>gear_groups <span class="ot">&lt;-</span> <span class="fu">unique</span>(TIP_gears<span class="sc">$</span>gear)</span>
<span id="cb129-315"><a href="#cb129-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-316"><a href="#cb129-316" aria-hidden="true" tabindex="-1"></a><span class="do">##splitting here to more easily qa/qc above</span></span>
<span id="cb129-317"><a href="#cb129-317" aria-hidden="true" tabindex="-1"></a>join_length_dat <span class="ot">&lt;-</span> tip4 <span class="sc">%&gt;%</span> <span class="co">#bind_rows(tip3 , gfin2) %&gt;%</span></span>
<span id="cb129-318"><a href="#cb129-318" aria-hidden="true" tabindex="-1"></a>  <span class="co"># len_len_convert(params = LLconv, </span></span>
<span id="cb129-319"><a href="#cb129-319" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 raw_length = LENGTH1, </span></span>
<span id="cb129-320"><a href="#cb129-320" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 length_type =LENGTH_TYPE1, </span></span>
<span id="cb129-321"><a href="#cb129-321" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 length_units =  LENGTH_UNIT1, </span></span>
<span id="cb129-322"><a href="#cb129-322" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 desired_type = len_type) %&gt;%</span></span>
<span id="cb129-323"><a href="#cb129-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">untable</span>(<span class="at">num =</span> .<span class="sc">$</span>QUANTITY)  <span class="sc">%&gt;%</span></span>
<span id="cb129-324"><a href="#cb129-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(LENGTH_TYPE1 <span class="sc">==</span> <span class="st">"FORK LENGTH"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-325"><a href="#cb129-325" aria-hidden="true" tabindex="-1"></a><span class="co"># filter(NEW_GEAR_NAME %in% c(gear_groups)) %&gt;%</span></span>
<span id="cb129-326"><a href="#cb129-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="co">#gear = ifelse(grepl("hand*", NEW_GEAR_NAME, ignore.case = T, fixed = F), "HL", "LL"), #this part will need to be generalized for more than 2 gear types ; ++HOOKLINE IS HANDLINE IN THIS FILE ; OVERWRITING ALL HL TO LL ; CHANGED "hook*" TO "hand*"</span></span>
<span id="cb129-327"><a href="#cb129-327" aria-hidden="true" tabindex="-1"></a>         <span class="co">#gear=GEAR_GRP,</span></span>
<span id="cb129-328"><a href="#cb129-328" aria-hidden="true" tabindex="-1"></a>         <span class="at">FL_CM =</span> LENGTH1_MM<span class="sc">/</span><span class="dv">10</span>, </span>
<span id="cb129-329"><a href="#cb129-329" aria-hidden="true" tabindex="-1"></a>         <span class="at">lbin =</span> <span class="fu">floor</span>(FL_CM <span class="sc">/</span> bin_size)<span class="sc">*</span>bin_size, </span>
<span id="cb129-330"><a href="#cb129-330" aria-hidden="true" tabindex="-1"></a>         <span class="at">mgt_period =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">&lt;=</span> break_year, <span class="fu">paste0</span>(min_year,<span class="st">" - "</span>, break_year), <span class="fu">paste0</span>( break_year<span class="sc">+</span><span class="dv">1</span>, <span class="st">" - "</span>, max_year)))</span>
<span id="cb129-331"><a href="#cb129-331" aria-hidden="true" tabindex="-1"></a><span class="co"># is "select" the problem, its #out </span></span>
<span id="cb129-332"><a href="#cb129-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-333"><a href="#cb129-333" aria-hidden="true" tabindex="-1"></a><span class="co"># FINAL dataset here ----</span></span>
<span id="cb129-334"><a href="#cb129-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-335"><a href="#cb129-335" aria-hidden="true" tabindex="-1"></a>length_data_final <span class="ot">&lt;-</span> join_length_dat <span class="sc">%&gt;%</span></span>
<span id="cb129-336"><a href="#cb129-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, INTERVIEW_DATE, FINAL_DATE, ID, OBS_ID, <span class="at">STATE =</span> STATE_LANDED, <span class="at">COUNTY=</span>COUNTY_LANDED, COUNTY_CODE, FL_CM, lbin, source, gear, gear_short, LAND_STANDARD_GEAR_NAME, LAND_GEAR_NAME, mgt_period, ISLAND, INT_TYPE, fleet, DEALER_CODE, VESSEL_ID, LICENSE) <span class="sc">%&gt;%</span>  <span class="co">#STAT_AREA</span></span>
<span id="cb129-337"><a href="#cb129-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(FL_CM , min_size, max_size),</span>
<span id="cb129-338"><a href="#cb129-338" aria-hidden="true" tabindex="-1"></a>         ISLAND <span class="sc">!=</span> <span class="st">'NOT CODED'</span>)</span>
<span id="cb129-339"><a href="#cb129-339" aria-hidden="true" tabindex="-1"></a>         <span class="co">#,</span></span>
<span id="cb129-340"><a href="#cb129-340" aria-hidden="true" tabindex="-1"></a>         <span class="co">#INT_TYPE != 'USVI MARFIN REEFFISH SAMPLING') </span></span>
<span id="cb129-341"><a href="#cb129-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-342"><a href="#cb129-342" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyst have asked for a record of dropped observations</span></span>
<span id="cb129-343"><a href="#cb129-343" aria-hidden="true" tabindex="-1"></a><span class="do">######### ADAPT THIS TO OUTPUT ALL DROPPED RECORDS ABOVE--MOVE HIGHER IN THE SCRIPT TO HAVE ALL VARS</span></span>
<span id="cb129-344"><a href="#cb129-344" aria-hidden="true" tabindex="-1"></a>dropped_obs <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(join_length_dat, length_data_final, <span class="at">by =</span> <span class="st">"OBS_ID"</span>)  </span>
<span id="cb129-345"><a href="#cb129-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-346"><a href="#cb129-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-347"><a href="#cb129-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-348"><a href="#cb129-348" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################DOCUMENT ALL DROPPED DATA</span></span>
<span id="cb129-349"><a href="#cb129-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-350"><a href="#cb129-350" aria-hidden="true" tabindex="-1"></a><span class="co"># drop &lt;- list()  ##++this creates an empty list for for loop</span></span>
<span id="cb129-351"><a href="#cb129-351" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-352"><a href="#cb129-352" aria-hidden="true" tabindex="-1"></a><span class="co"># # for loop generates binned length comps for each of the final gears. Stored in list. RUN:  View(comps[[1]]) to see in R</span></span>
<span id="cb129-353"><a href="#cb129-353" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-354"><a href="#cb129-354" aria-hidden="true" tabindex="-1"></a><span class="co">#  drop[[1]] &lt;-  NON-RANDOM SAMPLES</span></span>
<span id="cb129-355"><a href="#cb129-355" aria-hidden="true" tabindex="-1"></a><span class="co">#  drop[[2]] &lt;-  SIZE DATA</span></span>
<span id="cb129-356"><a href="#cb129-356" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(gear == final_gears[i]) %&gt;%</span></span>
<span id="cb129-357"><a href="#cb129-357" aria-hidden="true" tabindex="-1"></a><span class="co"># names(comps)[[1]] &lt;- paste0(final_gears[i], "_", bin_size, "cm") ##++tabs are named here ; could add _nom here if desired (instead of _lfd and _lfdw in main file)</span></span>
<span id="cb129-358"><a href="#cb129-358" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb129-359"><a href="#cb129-359" aria-hidden="true" tabindex="-1"></a><span class="do">################################################</span></span>
<span id="cb129-360"><a href="#cb129-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-361"><a href="#cb129-361" aria-hidden="true" tabindex="-1"></a><span class="do">###this is writing only size data issues (e.g. samples too small/large to be considered realistic)</span></span>
<span id="cb129-362"><a href="#cb129-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-363"><a href="#cb129-363" aria-hidden="true" tabindex="-1"></a><span class="co"># write.xlsx(dropped_obs, file = paste0("./outputs/", sp, "_size_dropped_observations_", gsub("-", "", Sys.Date()), ".xlsx"))</span></span>
<span id="cb129-364"><a href="#cb129-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-365"><a href="#cb129-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-366"><a href="#cb129-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-367"><a href="#cb129-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r maintain_empty_bins}</span></span>
<span id="cb129-368"><a href="#cb129-368" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-369"><a href="#cb129-369" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-370"><a href="#cb129-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-371"><a href="#cb129-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-372"><a href="#cb129-372" aria-hidden="true" tabindex="-1"></a><span class="co"># this is some funky code to make sure bins with no obervations are maintained in the data. Open to finding a more elegant solution but this works</span></span>
<span id="cb129-373"><a href="#cb129-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-374"><a href="#cb129-374" aria-hidden="true" tabindex="-1"></a>full_set <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">YEAR =</span> <span class="fu">seq</span>(<span class="at">from =</span> min_year, <span class="at">to =</span> max_year, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb129-375"><a href="#cb129-375" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lbin =</span> <span class="fu">seq</span>(<span class="at">from =</span> min_size, <span class="at">to =</span> max_size, <span class="at">by =</span> bin_size), </span>
<span id="cb129-376"><a href="#cb129-376" aria-hidden="true" tabindex="-1"></a>                     <span class="at">N =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-377"><a href="#cb129-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> lbin, <span class="at">values_from =</span> N)</span>
<span id="cb129-378"><a href="#cb129-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-379"><a href="#cb129-379" aria-hidden="true" tabindex="-1"></a>comp_names <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"YEAR"</span>, <span class="st">"ln_fish"</span>, <span class="st">"ln_trips"</span>, <span class="st">"ln_dealers"</span>,<span class="st">"ln_vessels"</span>, <span class="fu">names</span>(full_set)[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb129-380"><a href="#cb129-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-381"><a href="#cb129-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-382"><a href="#cb129-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-383"><a href="#cb129-383" aria-hidden="true" tabindex="-1"></a><span class="fu"># Filtration level investigation</span></span>
<span id="cb129-384"><a href="#cb129-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-385"><a href="#cb129-385" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unique trip ID vs gear by year investigation</span></span>
<span id="cb129-386"><a href="#cb129-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-387"><a href="#cb129-387" aria-hidden="true" tabindex="-1"></a><span class="fu">#### How many unique trip ID's per year?</span></span>
<span id="cb129-388"><a href="#cb129-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-389"><a href="#cb129-389" aria-hidden="true" tabindex="-1"></a>Group by year, count unique trip id's</span>
<span id="cb129-390"><a href="#cb129-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-391"><a href="#cb129-391" aria-hidden="true" tabindex="-1"></a>When we remove data from years with less than 10 unique trip ID's, we are left with 39years of data (vs 40 without filter, only removes 2020).</span>
<span id="cb129-392"><a href="#cb129-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-393"><a href="#cb129-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb129-394"><a href="#cb129-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb129-395"><a href="#cb129-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-396"><a href="#cb129-396" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb129-397"><a href="#cb129-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb129-398"><a href="#cb129-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb129-399"><a href="#cb129-399" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_tripcount)</span>
<span id="cb129-400"><a href="#cb129-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-401"><a href="#cb129-401" aria-hidden="true" tabindex="-1"></a>length_data_trip10 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb129-402"><a href="#cb129-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb129-403"><a href="#cb129-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(ID) <span class="sc">&gt;=</span> <span class="dv">10</span>)<span class="sc">|&gt;</span></span>
<span id="cb129-404"><a href="#cb129-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb129-405"><a href="#cb129-405" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_trip10)</span>
<span id="cb129-406"><a href="#cb129-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-407"><a href="#cb129-407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-408"><a href="#cb129-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-409"><a href="#cb129-409" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unique length records per gear per year</span></span>
<span id="cb129-410"><a href="#cb129-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-411"><a href="#cb129-411" aria-hidden="true" tabindex="-1"></a><span class="fu">### How many length records per gear per year?</span></span>
<span id="cb129-412"><a href="#cb129-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-413"><a href="#cb129-413" aria-hidden="true" tabindex="-1"></a>Group by year, count occurrences of each gear</span>
<span id="cb129-414"><a href="#cb129-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-415"><a href="#cb129-415" aria-hidden="true" tabindex="-1"></a>There are years when individual gears occur less than 30 times but when grouped, the gear groups exceed 30 occurrences per year. Do we want to rely on gear groups with larger than 30 occurrences per year or individual gears with more than 30 occurrences?</span>
<span id="cb129-416"><a href="#cb129-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-417"><a href="#cb129-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb129-418"><a href="#cb129-418" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-419"><a href="#cb129-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-420"><a href="#cb129-420" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur each year</span></span>
<span id="cb129-421"><a href="#cb129-421" aria-hidden="true" tabindex="-1"></a>length_data_gearcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb129-422"><a href="#cb129-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb129-423"><a href="#cb129-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb129-424"><a href="#cb129-424" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gearcount)</span>
<span id="cb129-425"><a href="#cb129-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-426"><a href="#cb129-426" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear name occur 30 or more times each year</span></span>
<span id="cb129-427"><a href="#cb129-427" aria-hidden="true" tabindex="-1"></a>length_data_gear30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb129-428"><a href="#cb129-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb129-429"><a href="#cb129-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb129-430"><a href="#cb129-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb129-431"><a href="#cb129-431" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear30)</span>
<span id="cb129-432"><a href="#cb129-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-433"><a href="#cb129-433" aria-hidden="true" tabindex="-1"></a><span class="co"># group gears that occur 30 or more times per year by gear grouping </span></span>
<span id="cb129-434"><a href="#cb129-434" aria-hidden="true" tabindex="-1"></a>length_data_geartogether30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb129-435"><a href="#cb129-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb129-436"><a href="#cb129-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb129-437"><a href="#cb129-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-438"><a href="#cb129-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span> </span>
<span id="cb129-439"><a href="#cb129-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb129-440"><a href="#cb129-440" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geartogether30)</span>
<span id="cb129-441"><a href="#cb129-441" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by specific gear per year</span></span>
<span id="cb129-442"><a href="#cb129-442" aria-hidden="true" tabindex="-1"></a><span class="co"># only removes 2020</span></span>
<span id="cb129-443"><a href="#cb129-443" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geartogether30<span class="sc">$</span>YEAR, length_data_geartogether30<span class="sc">$</span>gear)</span>
<span id="cb129-444"><a href="#cb129-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-445"><a href="#cb129-445" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur each year</span></span>
<span id="cb129-446"><a href="#cb129-446" aria-hidden="true" tabindex="-1"></a>length_data_geargroupcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb129-447"><a href="#cb129-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb129-448"><a href="#cb129-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb129-449"><a href="#cb129-449" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroupcount)</span>
<span id="cb129-450"><a href="#cb129-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-451"><a href="#cb129-451" aria-hidden="true" tabindex="-1"></a><span class="co"># count how many of each gear grouping occur 30 or more times each year</span></span>
<span id="cb129-452"><a href="#cb129-452" aria-hidden="true" tabindex="-1"></a>length_data_geargroup30 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb129-453"><a href="#cb129-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb129-454"><a href="#cb129-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb129-455"><a href="#cb129-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb129-456"><a href="#cb129-456" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup30)</span>
<span id="cb129-457"><a href="#cb129-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-458"><a href="#cb129-458" aria-hidden="true" tabindex="-1"></a><span class="co"># frequency of gear groupings when records are counted by gear grouping per year</span></span>
<span id="cb129-459"><a href="#cb129-459" aria-hidden="true" tabindex="-1"></a><span class="co"># only removes 2020</span></span>
<span id="cb129-460"><a href="#cb129-460" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_geargroup30<span class="sc">$</span>YEAR, length_data_geargroup30<span class="sc">$</span>gear)</span>
<span id="cb129-461"><a href="#cb129-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-462"><a href="#cb129-462" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by individual gears </span></span>
<span id="cb129-463"><a href="#cb129-463" aria-hidden="true" tabindex="-1"></a>length_data_gear29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb129-464"><a href="#cb129-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb129-465"><a href="#cb129-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb129-466"><a href="#cb129-466" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb129-467"><a href="#cb129-467" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb129-468"><a href="#cb129-468" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb129-469"><a href="#cb129-469" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_gear29)</span>
<span id="cb129-470"><a href="#cb129-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-471"><a href="#cb129-471" aria-hidden="true" tabindex="-1"></a><span class="co"># VS </span></span>
<span id="cb129-472"><a href="#cb129-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-473"><a href="#cb129-473" aria-hidden="true" tabindex="-1"></a><span class="co"># count number of records that are removed if counted by gear groups </span></span>
<span id="cb129-474"><a href="#cb129-474" aria-hidden="true" tabindex="-1"></a>length_data_geargroup29 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb129-475"><a href="#cb129-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, gear) <span class="sc">|&gt;</span></span>
<span id="cb129-476"><a href="#cb129-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&lt;</span> <span class="dv">30</span>)<span class="sc">|&gt;</span></span>
<span id="cb129-477"><a href="#cb129-477" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ungroup() |&gt; </span></span>
<span id="cb129-478"><a href="#cb129-478" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, gear) |&gt; </span></span>
<span id="cb129-479"><a href="#cb129-479" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb129-480"><a href="#cb129-480" aria-hidden="true" tabindex="-1"></a><span class="fu">print.data.frame</span>(length_data_geargroup29)</span>
<span id="cb129-481"><a href="#cb129-481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-482"><a href="#cb129-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-483"><a href="#cb129-483" aria-hidden="true" tabindex="-1"></a><span class="fu"># GLM analysis</span></span>
<span id="cb129-484"><a href="#cb129-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-485"><a href="#cb129-485" aria-hidden="true" tabindex="-1"></a>No filtering based on number of trips/fish per year yet, analysis of all available data.</span>
<span id="cb129-486"><a href="#cb129-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-487"><a href="#cb129-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_hookandline_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb129-488"><a href="#cb129-488" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(length_data_final<span class="sc">$</span>gear) <span class="co"># "Hook and Line", "Trap", "Other", "Net"</span></span>
<span id="cb129-489"><a href="#cb129-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-490"><a href="#cb129-490" aria-hidden="true" tabindex="-1"></a><span class="co"># antiforklength &lt;- tip4 |&gt;</span></span>
<span id="cb129-491"><a href="#cb129-491" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(LENGTH_TYPE1 != "FORK LENGTH")</span></span>
<span id="cb129-492"><a href="#cb129-492" aria-hidden="true" tabindex="-1"></a><span class="co"># table(antiforklength$LENGTH_TYPE1)</span></span>
<span id="cb129-493"><a href="#cb129-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-494"><a href="#cb129-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-495"><a href="#cb129-495" aria-hidden="true" tabindex="-1"></a><span class="fu">## All Gears</span></span>
<span id="cb129-496"><a href="#cb129-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-497"><a href="#cb129-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_allgear_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb129-498"><a href="#cb129-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-499"><a href="#cb129-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-500"><a href="#cb129-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-501"><a href="#cb129-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-502"><a href="#cb129-502" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb129-503"><a href="#cb129-503" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb129-504"><a href="#cb129-504" aria-hidden="true" tabindex="-1"></a>length_data_glm <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb129-505"><a href="#cb129-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb129-506"><a href="#cb129-506" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(gear == "Hook and Line") |&gt; </span></span>
<span id="cb129-507"><a href="#cb129-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb129-508"><a href="#cb129-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb129-509"><a href="#cb129-509" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb129-510"><a href="#cb129-510" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb129-511"><a href="#cb129-511" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(length_data_glm, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb129-512"><a href="#cb129-512" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb129-513"><a href="#cb129-513" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb129-514"><a href="#cb129-514" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb129-515"><a href="#cb129-515" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb129-516"><a href="#cb129-516" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(length_data_glm, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb129-517"><a href="#cb129-517" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb129-518"><a href="#cb129-518" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb129-519"><a href="#cb129-519" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb129-520"><a href="#cb129-520" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb129-521"><a href="#cb129-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-522"><a href="#cb129-522" aria-hidden="true" tabindex="-1"></a><span class="co">#table(length_data_glm$LAND_STANDARD_GEAR_NAME, length_data_glm$YEAR)</span></span>
<span id="cb129-523"><a href="#cb129-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-524"><a href="#cb129-524" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb129-525"><a href="#cb129-525" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb129-526"><a href="#cb129-526" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(length_data_glm, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb129-527"><a href="#cb129-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb129-528"><a href="#cb129-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb129-529"><a href="#cb129-529" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb129-530"><a href="#cb129-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb129-531"><a href="#cb129-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb129-532"><a href="#cb129-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb129-533"><a href="#cb129-533" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb129-534"><a href="#cb129-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb129-535"><a href="#cb129-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-536"><a href="#cb129-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-537"><a href="#cb129-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-538"><a href="#cb129-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_allgear_analysis, fig.fullwidth}</span></span>
<span id="cb129-539"><a href="#cb129-539" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-540"><a href="#cb129-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page  </span></span>
<span id="cb129-541"><a href="#cb129-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-542"><a href="#cb129-542" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb129-543"><a href="#cb129-543" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb129-544"><a href="#cb129-544" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb129-545"><a href="#cb129-545" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb129-546"><a href="#cb129-546" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb129-547"><a href="#cb129-547" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-548"><a href="#cb129-548" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb129-549"><a href="#cb129-549" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = length_data_glm, REML = FALSE)</span></span>
<span id="cb129-550"><a href="#cb129-550" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb129-551"><a href="#cb129-551" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-552"><a href="#cb129-552" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb129-553"><a href="#cb129-553" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb129-554"><a href="#cb129-554" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb129-555"><a href="#cb129-555" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb129-556"><a href="#cb129-556" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb129-557"><a href="#cb129-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-558"><a href="#cb129-558" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb129-559"><a href="#cb129-559" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-560"><a href="#cb129-560" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> length_data_glm, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb129-561"><a href="#cb129-561" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span>
<span id="cb129-562"><a href="#cb129-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-563"><a href="#cb129-563" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb129-564"><a href="#cb129-564" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-565"><a href="#cb129-565" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-566"><a href="#cb129-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-567"><a href="#cb129-567" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb129-568"><a href="#cb129-568" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb129-569"><a href="#cb129-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-570"><a href="#cb129-570" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb129-571"><a href="#cb129-571" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-572"><a href="#cb129-572" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-573"><a href="#cb129-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-574"><a href="#cb129-574" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-575"><a href="#cb129-575" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-576"><a href="#cb129-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-577"><a href="#cb129-577" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb129-578"><a href="#cb129-578" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-579"><a href="#cb129-579" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb129-580"><a href="#cb129-580" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb129-581"><a href="#cb129-581" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb129-582"><a href="#cb129-582" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb129-583"><a href="#cb129-583" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb129-584"><a href="#cb129-584" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb129-585"><a href="#cb129-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-586"><a href="#cb129-586" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb129-587"><a href="#cb129-587" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb129-588"><a href="#cb129-588" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb129-589"><a href="#cb129-589" aria-hidden="true" tabindex="-1"></a>mod_contr</span>
<span id="cb129-590"><a href="#cb129-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-591"><a href="#cb129-591" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb129-592"><a href="#cb129-592" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb129-593"><a href="#cb129-593" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb129-594"><a href="#cb129-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-595"><a href="#cb129-595" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld <span class="ot">&lt;-</span> multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb129-596"><a href="#cb129-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-597"><a href="#cb129-597" aria-hidden="true" tabindex="-1"></a>length_data_fishcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb129-598"><a href="#cb129-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb129-599"><a href="#cb129-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_fish =</span> <span class="fu">n</span>()) </span>
<span id="cb129-600"><a href="#cb129-600" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span> </span>
<span id="cb129-601"><a href="#cb129-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb129-602"><a href="#cb129-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb129-603"><a href="#cb129-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-604"><a href="#cb129-604" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_fish <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld, length_data_fishcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb129-605"><a href="#cb129-605" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_trip <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_fish, length_data_tripcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb129-606"><a href="#cb129-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-607"><a href="#cb129-607" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_final <span class="ot">&lt;-</span> allgears_multcompcld_trip <span class="sc">|&gt;</span> </span>
<span id="cb129-608"><a href="#cb129-608" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="st">".group"</span>,</span>
<span id="cb129-609"><a href="#cb129-609" aria-hidden="true" tabindex="-1"></a>                <span class="st">"n_distinct_ID"</span> <span class="ot">=</span> <span class="st">"n_distinct(ID)"</span>)</span>
<span id="cb129-610"><a href="#cb129-610" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgears_multcompcld_final)</span>
<span id="cb129-611"><a href="#cb129-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-612"><a href="#cb129-612" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgears_multcompcld_final, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/output/pr_yts_glm_allgears.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb129-613"><a href="#cb129-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-614"><a href="#cb129-614" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>, <span class="st">"3"</span>, <span class="st">"4"</span>))</span>
<span id="cb129-615"><a href="#cb129-615" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_fish[i]))</span></span>
<span id="cb129-616"><a href="#cb129-616" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-617"><a href="#cb129-617" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_distinct_ID[i]))</span></span>
<span id="cb129-618"><a href="#cb129-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-619"><a href="#cb129-619" aria-hidden="true" tabindex="-1"></a>allgear_glm_totals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb129-620"><a href="#cb129-620" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_distinct_ID =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_final<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_final<span class="sc">$</span>n_distinct_ID[i]))),</span>
<span id="cb129-621"><a href="#cb129-621" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_fish =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_final<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_final<span class="sc">$</span>n_fish[i]))))</span>
<span id="cb129-622"><a href="#cb129-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-623"><a href="#cb129-623" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgear_glm_totals)</span>
<span id="cb129-624"><a href="#cb129-624" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgear_glm_totals, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/output/pr_yts_glm_allgears_totals.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb129-625"><a href="#cb129-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-626"><a href="#cb129-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-627"><a href="#cb129-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-628"><a href="#cb129-628" aria-hidden="true" tabindex="-1"></a><span class="fu">## All Gears 2012 and after</span></span>
<span id="cb129-629"><a href="#cb129-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-630"><a href="#cb129-630" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_allgear2012_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb129-631"><a href="#cb129-631" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-632"><a href="#cb129-632" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-633"><a href="#cb129-633" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-634"><a href="#cb129-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-635"><a href="#cb129-635" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb129-636"><a href="#cb129-636" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb129-637"><a href="#cb129-637" aria-hidden="true" tabindex="-1"></a>length_data_glm_2012 <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb129-638"><a href="#cb129-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(YEAR <span class="sc">&gt;=</span> <span class="dv">2012</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-639"><a href="#cb129-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb129-640"><a href="#cb129-640" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(gear == "Hook and Line") |&gt; </span></span>
<span id="cb129-641"><a href="#cb129-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb129-642"><a href="#cb129-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb129-643"><a href="#cb129-643" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb129-644"><a href="#cb129-644" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb129-645"><a href="#cb129-645" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(length_data_glm_2012, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb129-646"><a href="#cb129-646" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb129-647"><a href="#cb129-647" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb129-648"><a href="#cb129-648" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb129-649"><a href="#cb129-649" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb129-650"><a href="#cb129-650" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(length_data_glm_2012, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb129-651"><a href="#cb129-651" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb129-652"><a href="#cb129-652" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb129-653"><a href="#cb129-653" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb129-654"><a href="#cb129-654" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb129-655"><a href="#cb129-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-656"><a href="#cb129-656" aria-hidden="true" tabindex="-1"></a><span class="co">#table(length_data_glm$LAND_STANDARD_GEAR_NAME, length_data_glm$YEAR)</span></span>
<span id="cb129-657"><a href="#cb129-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-658"><a href="#cb129-658" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb129-659"><a href="#cb129-659" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb129-660"><a href="#cb129-660" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(length_data_glm_2012, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb129-661"><a href="#cb129-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb129-662"><a href="#cb129-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb129-663"><a href="#cb129-663" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb129-664"><a href="#cb129-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb129-665"><a href="#cb129-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb129-666"><a href="#cb129-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb129-667"><a href="#cb129-667" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="co"># +</span></span>
<span id="cb129-668"><a href="#cb129-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb129-669"><a href="#cb129-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-670"><a href="#cb129-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-671"><a href="#cb129-671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-672"><a href="#cb129-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-673"><a href="#cb129-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_allgear2012_analysis, fig.fullwidth}</span></span>
<span id="cb129-674"><a href="#cb129-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-675"><a href="#cb129-675" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page  </span></span>
<span id="cb129-676"><a href="#cb129-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-677"><a href="#cb129-677" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb129-678"><a href="#cb129-678" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb129-679"><a href="#cb129-679" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb129-680"><a href="#cb129-680" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb129-681"><a href="#cb129-681" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb129-682"><a href="#cb129-682" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-683"><a href="#cb129-683" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb129-684"><a href="#cb129-684" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = length_data_glm, REML = FALSE)</span></span>
<span id="cb129-685"><a href="#cb129-685" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb129-686"><a href="#cb129-686" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-687"><a href="#cb129-687" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb129-688"><a href="#cb129-688" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_STANDARD_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb129-689"><a href="#cb129-689" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = length_data_glm, REML = FALSE)</span></span>
<span id="cb129-690"><a href="#cb129-690" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb129-691"><a href="#cb129-691" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb129-692"><a href="#cb129-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-693"><a href="#cb129-693" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb129-694"><a href="#cb129-694" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-695"><a href="#cb129-695" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> length_data_glm_2012, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb129-696"><a href="#cb129-696" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span>
<span id="cb129-697"><a href="#cb129-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-698"><a href="#cb129-698" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb129-699"><a href="#cb129-699" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-700"><a href="#cb129-700" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-701"><a href="#cb129-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-702"><a href="#cb129-702" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb129-703"><a href="#cb129-703" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb129-704"><a href="#cb129-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-705"><a href="#cb129-705" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb129-706"><a href="#cb129-706" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-707"><a href="#cb129-707" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-708"><a href="#cb129-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-709"><a href="#cb129-709" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-710"><a href="#cb129-710" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> length_data_glm_2012, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-711"><a href="#cb129-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-712"><a href="#cb129-712" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb129-713"><a href="#cb129-713" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-714"><a href="#cb129-714" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb129-715"><a href="#cb129-715" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb129-716"><a href="#cb129-716" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb129-717"><a href="#cb129-717" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb129-718"><a href="#cb129-718" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb129-719"><a href="#cb129-719" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb129-720"><a href="#cb129-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-721"><a href="#cb129-721" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb129-722"><a href="#cb129-722" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb129-723"><a href="#cb129-723" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb129-724"><a href="#cb129-724" aria-hidden="true" tabindex="-1"></a>mod_contr</span>
<span id="cb129-725"><a href="#cb129-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-726"><a href="#cb129-726" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other </span></span>
<span id="cb129-727"><a href="#cb129-727" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb129-728"><a href="#cb129-728" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb129-729"><a href="#cb129-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-730"><a href="#cb129-730" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_2012 <span class="ot">&lt;-</span> multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb129-731"><a href="#cb129-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-732"><a href="#cb129-732" aria-hidden="true" tabindex="-1"></a>length_data_fishcount <span class="ot">&lt;-</span> length_data_glm_2012 <span class="sc">|&gt;</span> </span>
<span id="cb129-733"><a href="#cb129-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb129-734"><a href="#cb129-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_fish =</span> <span class="fu">n</span>()) </span>
<span id="cb129-735"><a href="#cb129-735" aria-hidden="true" tabindex="-1"></a>length_data_tripcount <span class="ot">&lt;-</span> length_data_glm_2012 <span class="sc">|&gt;</span> </span>
<span id="cb129-736"><a href="#cb129-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">|&gt;</span></span>
<span id="cb129-737"><a href="#cb129-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">n_distinct</span>(ID)) </span>
<span id="cb129-738"><a href="#cb129-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-739"><a href="#cb129-739" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_fish_2012 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_2012, length_data_fishcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb129-740"><a href="#cb129-740" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_trip_2012 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(allgears_multcompcld_fish_2012, length_data_tripcount, <span class="at">by =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb129-741"><a href="#cb129-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-742"><a href="#cb129-742" aria-hidden="true" tabindex="-1"></a>allgears_multcompcld_finaL_2012 <span class="ot">&lt;-</span> allgears_multcompcld_trip_2012 <span class="sc">|&gt;</span> </span>
<span id="cb129-743"><a href="#cb129-743" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"group"</span> <span class="ot">=</span> <span class="st">".group"</span>,</span>
<span id="cb129-744"><a href="#cb129-744" aria-hidden="true" tabindex="-1"></a>                <span class="st">"n_distinct_ID"</span> <span class="ot">=</span> <span class="st">"n_distinct(ID)"</span>)</span>
<span id="cb129-745"><a href="#cb129-745" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgears_multcompcld_finaL_2012)</span>
<span id="cb129-746"><a href="#cb129-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-747"><a href="#cb129-747" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgears_multcompcld_finaL_2012, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/output/pr_yts_2012glm_allgears.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb129-748"><a href="#cb129-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-749"><a href="#cb129-749" aria-hidden="true" tabindex="-1"></a>group_2012 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>, <span class="st">"3"</span>))</span>
<span id="cb129-750"><a href="#cb129-750" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_fish[i]))</span></span>
<span id="cb129-751"><a href="#cb129-751" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-752"><a href="#cb129-752" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(sapply(as.character(group$group), function(i) grep(i, allgears_multcompcld_final$group)), function(i) sum(allgears_multcompcld_final$n_distinct_ID[i]))</span></span>
<span id="cb129-753"><a href="#cb129-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-754"><a href="#cb129-754" aria-hidden="true" tabindex="-1"></a>allgear_glm_totals_2012 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb129-755"><a href="#cb129-755" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_distinct_ID =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group_2012<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_finaL_2012<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_finaL_2012<span class="sc">$</span>n_distinct_ID[i]))),</span>
<span id="cb129-756"><a href="#cb129-756" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">n_fish =</span> (<span class="fu">sapply</span>(<span class="fu">sapply</span>(<span class="fu">as.character</span>(group_2012<span class="sc">$</span>group), <span class="cf">function</span>(i) <span class="fu">grep</span>(i, allgears_multcompcld_finaL_2012<span class="sc">$</span>group)), <span class="cf">function</span>(i) <span class="fu">sum</span>(allgears_multcompcld_finaL_2012<span class="sc">$</span>n_fish[i]))))</span>
<span id="cb129-757"><a href="#cb129-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-758"><a href="#cb129-758" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(allgear_glm_totals_2012)</span>
<span id="cb129-759"><a href="#cb129-759" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(allgear_glm_totals_2012, <span class="at">file =</span> <span class="st">"~/SEFSC-SFD-CFB-TIP-Compositions/tools/output/pr_yts_2012glm_allgears_totals.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb129-760"><a href="#cb129-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-761"><a href="#cb129-761" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-762"><a href="#cb129-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-763"><a href="#cb129-763" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hook and Line</span></span>
<span id="cb129-764"><a href="#cb129-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-765"><a href="#cb129-765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_hookline_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb129-766"><a href="#cb129-766" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-767"><a href="#cb129-767" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-768"><a href="#cb129-768" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-769"><a href="#cb129-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-770"><a href="#cb129-770" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb129-771"><a href="#cb129-771" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb129-772"><a href="#cb129-772" aria-hidden="true" tabindex="-1"></a>use_gear_hl <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb129-773"><a href="#cb129-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb129-774"><a href="#cb129-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear <span class="sc">==</span> <span class="st">"Hook and Line"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-775"><a href="#cb129-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb129-776"><a href="#cb129-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb129-777"><a href="#cb129-777" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb129-778"><a href="#cb129-778" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb129-779"><a href="#cb129-779" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(use_gear_hl, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb129-780"><a href="#cb129-780" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb129-781"><a href="#cb129-781" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb129-782"><a href="#cb129-782" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb129-783"><a href="#cb129-783" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb129-784"><a href="#cb129-784" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(use_gear_hl, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb129-785"><a href="#cb129-785" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb129-786"><a href="#cb129-786" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb129-787"><a href="#cb129-787" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb129-788"><a href="#cb129-788" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb129-789"><a href="#cb129-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-790"><a href="#cb129-790" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb129-791"><a href="#cb129-791" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb129-792"><a href="#cb129-792" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(use_gear_hl, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb129-793"><a href="#cb129-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb129-794"><a href="#cb129-794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb129-795"><a href="#cb129-795" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb129-796"><a href="#cb129-796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb129-797"><a href="#cb129-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb129-798"><a href="#cb129-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb129-799"><a href="#cb129-799" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb129-800"><a href="#cb129-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb129-801"><a href="#cb129-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-802"><a href="#cb129-802" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-803"><a href="#cb129-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-804"><a href="#cb129-804" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_hookandline_analysis, fig.fullwidth}</span></span>
<span id="cb129-805"><a href="#cb129-805" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-806"><a href="#cb129-806" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page  </span></span>
<span id="cb129-807"><a href="#cb129-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-808"><a href="#cb129-808" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb129-809"><a href="#cb129-809" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb129-810"><a href="#cb129-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-811"><a href="#cb129-811" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a linear model</span></span>
<span id="cb129-812"><a href="#cb129-812" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-813"><a href="#cb129-813" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_hl, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb129-814"><a href="#cb129-814" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>) <span class="co"># both date and gear are significant in linear model</span></span>
<span id="cb129-815"><a href="#cb129-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-816"><a href="#cb129-816" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb129-817"><a href="#cb129-817" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-818"><a href="#cb129-818" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-819"><a href="#cb129-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-820"><a href="#cb129-820" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb129-821"><a href="#cb129-821" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb129-822"><a href="#cb129-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-823"><a href="#cb129-823" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb129-824"><a href="#cb129-824" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-825"><a href="#cb129-825" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-826"><a href="#cb129-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-827"><a href="#cb129-827" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-828"><a href="#cb129-828" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_hl, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-829"><a href="#cb129-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-830"><a href="#cb129-830" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb129-831"><a href="#cb129-831" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-832"><a href="#cb129-832" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb129-833"><a href="#cb129-833" aria-hidden="true" tabindex="-1"></a><span class="do">### hook and line gear p value are not significant </span></span>
<span id="cb129-834"><a href="#cb129-834" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb129-835"><a href="#cb129-835" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb129-836"><a href="#cb129-836" aria-hidden="true" tabindex="-1"></a><span class="do">### There is significantly different size over time in the Hook and Line grouping </span></span>
<span id="cb129-837"><a href="#cb129-837" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb129-838"><a href="#cb129-838" aria-hidden="true" tabindex="-1"></a><span class="do">### no significant p values for gears, further comparisons not needed</span></span>
<span id="cb129-839"><a href="#cb129-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-840"><a href="#cb129-840" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-841"><a href="#cb129-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-842"><a href="#cb129-842" aria-hidden="true" tabindex="-1"></a><span class="fu">## Net</span></span>
<span id="cb129-843"><a href="#cb129-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-844"><a href="#cb129-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-845"><a href="#cb129-845" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_netstd_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb129-846"><a href="#cb129-846" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-847"><a href="#cb129-847" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-848"><a href="#cb129-848" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-849"><a href="#cb129-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-850"><a href="#cb129-850" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb129-851"><a href="#cb129-851" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb129-852"><a href="#cb129-852" aria-hidden="true" tabindex="-1"></a><span class="co"># net land_standard_gear_name</span></span>
<span id="cb129-853"><a href="#cb129-853" aria-hidden="true" tabindex="-1"></a>use_gear_nlsg <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb129-854"><a href="#cb129-854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb129-855"><a href="#cb129-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear <span class="sc">==</span> <span class="st">"Net"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-856"><a href="#cb129-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb129-857"><a href="#cb129-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb129-858"><a href="#cb129-858" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb129-859"><a href="#cb129-859" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb129-860"><a href="#cb129-860" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(use_gear_nlsg, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb129-861"><a href="#cb129-861" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb129-862"><a href="#cb129-862" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb129-863"><a href="#cb129-863" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb129-864"><a href="#cb129-864" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb129-865"><a href="#cb129-865" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(use_gear_nlsg, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb129-866"><a href="#cb129-866" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb129-867"><a href="#cb129-867" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb129-868"><a href="#cb129-868" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb129-869"><a href="#cb129-869" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb129-870"><a href="#cb129-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-871"><a href="#cb129-871" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb129-872"><a href="#cb129-872" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb129-873"><a href="#cb129-873" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(use_gear_nlsg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb129-874"><a href="#cb129-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb129-875"><a href="#cb129-875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb129-876"><a href="#cb129-876" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb129-877"><a href="#cb129-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb129-878"><a href="#cb129-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb129-879"><a href="#cb129-879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb129-880"><a href="#cb129-880" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb129-881"><a href="#cb129-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb129-882"><a href="#cb129-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-883"><a href="#cb129-883" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-884"><a href="#cb129-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-885"><a href="#cb129-885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_netstd_analysis}</span></span>
<span id="cb129-886"><a href="#cb129-886" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-887"><a href="#cb129-887" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-888"><a href="#cb129-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-889"><a href="#cb129-889" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb129-890"><a href="#cb129-890" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb129-891"><a href="#cb129-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-892"><a href="#cb129-892" aria-hidden="true" tabindex="-1"></a><span class="do">### both fixed linear and glm models have warning message because ENTANGLING NETS (GILL) UNSPECIFIED only occur in one year, preventing convergence across timeline </span></span>
<span id="cb129-893"><a href="#cb129-893" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb129-894"><a href="#cb129-894" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-895"><a href="#cb129-895" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_nlsg, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb129-896"><a href="#cb129-896" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span>
<span id="cb129-897"><a href="#cb129-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-898"><a href="#cb129-898" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb129-899"><a href="#cb129-899" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-900"><a href="#cb129-900" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log)) </span>
<span id="cb129-901"><a href="#cb129-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-902"><a href="#cb129-902" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb129-903"><a href="#cb129-903" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb129-904"><a href="#cb129-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-905"><a href="#cb129-905" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb129-906"><a href="#cb129-906" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-907"><a href="#cb129-907" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-908"><a href="#cb129-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-909"><a href="#cb129-909" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-910"><a href="#cb129-910" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_nlsg, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-911"><a href="#cb129-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-912"><a href="#cb129-912" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb129-913"><a href="#cb129-913" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb129-914"><a href="#cb129-914" aria-hidden="true" tabindex="-1"></a><span class="do">### net (using LAND_STANDARD_GEAR_NAME) does have significantly different gears </span></span>
<span id="cb129-915"><a href="#cb129-915" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3) </span>
<span id="cb129-916"><a href="#cb129-916" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope</span></span>
<span id="cb129-917"><a href="#cb129-917" aria-hidden="true" tabindex="-1"></a><span class="do">### There is significantly different size over time in the Net grouping </span></span>
<span id="cb129-918"><a href="#cb129-918" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb129-919"><a href="#cb129-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-920"><a href="#cb129-920" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise comparisons (if needed)(needed for Hook and Line)</span></span>
<span id="cb129-921"><a href="#cb129-921" aria-hidden="true" tabindex="-1"></a><span class="do">### lines hand vs rod and reel and lines power troll other vs rod and reel are signifficantly different</span></span>
<span id="cb129-922"><a href="#cb129-922" aria-hidden="true" tabindex="-1"></a>mod_contr <span class="ot">=</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(<span class="at">object =</span> mod2, pairwise <span class="sc">~</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb129-923"><a href="#cb129-923" aria-hidden="true" tabindex="-1"></a>mod_contr</span>
<span id="cb129-924"><a href="#cb129-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-925"><a href="#cb129-925" aria-hidden="true" tabindex="-1"></a><span class="co"># cld provides gear groupings based on which gears are similar vs significantly different from each other</span></span>
<span id="cb129-926"><a href="#cb129-926" aria-hidden="true" tabindex="-1"></a><span class="do">### suggestion: "lines power troll other", "lines hand" "rod and reel electric" and "reel electric or hydroulic" be grouped together</span></span>
<span id="cb129-927"><a href="#cb129-927" aria-hidden="true" tabindex="-1"></a><span class="do">### "rod and reel" be kept separate</span></span>
<span id="cb129-928"><a href="#cb129-928" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(<span class="at">object =</span> mod_contr<span class="sc">$</span>emmeans)</span>
<span id="cb129-929"><a href="#cb129-929" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-930"><a href="#cb129-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-931"><a href="#cb129-931" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_net_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb129-932"><a href="#cb129-932" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-933"><a href="#cb129-933" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-934"><a href="#cb129-934" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-935"><a href="#cb129-935" aria-hidden="true" tabindex="-1"></a><span class="do">#### Net - LAND_GEAR_NAME</span></span>
<span id="cb129-936"><a href="#cb129-936" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb129-937"><a href="#cb129-937" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggplot2) </span></span>
<span id="cb129-938"><a href="#cb129-938" aria-hidden="true" tabindex="-1"></a><span class="co"># # net land_standard_gear_name</span></span>
<span id="cb129-939"><a href="#cb129-939" aria-hidden="true" tabindex="-1"></a><span class="co"># use_gear_nlg &lt;- length_data_final |&gt;</span></span>
<span id="cb129-940"><a href="#cb129-940" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_GEAR_NAME, gear) |&gt; </span></span>
<span id="cb129-941"><a href="#cb129-941" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(gear == "Net") |&gt; </span></span>
<span id="cb129-942"><a href="#cb129-942" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(ID = as.character(ID)) |&gt; </span></span>
<span id="cb129-943"><a href="#cb129-943" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-gear)</span></span>
<span id="cb129-944"><a href="#cb129-944" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggpubr)</span></span>
<span id="cb129-945"><a href="#cb129-945" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create box plot across years</span></span>
<span id="cb129-946"><a href="#cb129-946" aria-hidden="true" tabindex="-1"></a><span class="co"># box_plot &lt;- ggboxplot(use_gear_nlg, x = "LAND_GEAR_NAME", y = "FL_CM",</span></span>
<span id="cb129-947"><a href="#cb129-947" aria-hidden="true" tabindex="-1"></a><span class="co">#                  color = "LAND_GEAR_NAME",</span></span>
<span id="cb129-948"><a href="#cb129-948" aria-hidden="true" tabindex="-1"></a><span class="co">#                  ylab = "FL_CM", xlab = "LAND_GEAR_NAME")</span></span>
<span id="cb129-949"><a href="#cb129-949" aria-hidden="true" tabindex="-1"></a><span class="co"># box_plot</span></span>
<span id="cb129-950"><a href="#cb129-950" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create density plot across years</span></span>
<span id="cb129-951"><a href="#cb129-951" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot &lt;- ggdensity(use_gear_nlg, x = "FL_CM",</span></span>
<span id="cb129-952"><a href="#cb129-952" aria-hidden="true" tabindex="-1"></a><span class="co">#                           add = "mean", rug = TRUE,</span></span>
<span id="cb129-953"><a href="#cb129-953" aria-hidden="true" tabindex="-1"></a><span class="co">#                           color = "LAND_GEAR_NAME", fill = "LAND_GEAR_NAME",</span></span>
<span id="cb129-954"><a href="#cb129-954" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ylab = "FL_CM", xlab = "Gear")</span></span>
<span id="cb129-955"><a href="#cb129-955" aria-hidden="true" tabindex="-1"></a><span class="co"># density_plot</span></span>
<span id="cb129-956"><a href="#cb129-956" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-957"><a href="#cb129-957" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot data</span></span>
<span id="cb129-958"><a href="#cb129-958" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggplot2)</span></span>
<span id="cb129-959"><a href="#cb129-959" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(use_gear_nlg, aes(x = as.Date(FINAL_DATE), y = FL_CM)) +</span></span>
<span id="cb129-960"><a href="#cb129-960" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(colour = LAND_GEAR_NAME, shape = LAND_GEAR_NAME), size = 1, alpha = 0.5) +</span></span>
<span id="cb129-961"><a href="#cb129-961" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth(method = "lm", formula = "y ~ x", col = "black") +</span></span>
<span id="cb129-962"><a href="#cb129-962" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb129-963"><a href="#cb129-963" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x = "", y = "Length (cm)", colour = "", shape = "") +</span></span>
<span id="cb129-964"><a href="#cb129-964" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb129-965"><a href="#cb129-965" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = "bottom", legend.text = element_text(size = 10),</span></span>
<span id="cb129-966"><a href="#cb129-966" aria-hidden="true" tabindex="-1"></a><span class="co">#         legend.box.spacing = unit(0, "npc"), panel.grid = element_blank()) +</span></span>
<span id="cb129-967"><a href="#cb129-967" aria-hidden="true" tabindex="-1"></a><span class="co">#   guides(colour = guide_legend(override.aes = list(size = 2)))</span></span>
<span id="cb129-968"><a href="#cb129-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-969"><a href="#cb129-969" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-970"><a href="#cb129-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-971"><a href="#cb129-971" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_net_analysis}</span></span>
<span id="cb129-972"><a href="#cb129-972" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-973"><a href="#cb129-973" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-974"><a href="#cb129-974" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-975"><a href="#cb129-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-976"><a href="#cb129-976" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb129-977"><a href="#cb129-977" aria-hidden="true" tabindex="-1"></a><span class="co"># library(lmerTest)</span></span>
<span id="cb129-978"><a href="#cb129-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-979"><a href="#cb129-979" aria-hidden="true" tabindex="-1"></a><span class="do">########### initial testing to determine which variables are significant </span></span>
<span id="cb129-980"><a href="#cb129-980" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0 = lmer(FL_CM ~ COUNTY * scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb129-981"><a href="#cb129-981" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = use_gear_nlg, REML = FALSE)</span></span>
<span id="cb129-982"><a href="#cb129-982" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0)</span></span>
<span id="cb129-983"><a href="#cb129-983" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-984"><a href="#cb129-984" aria-hidden="true" tabindex="-1"></a><span class="co"># mod0.1 = lmer(FL_CM ~ COUNTY + scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb129-985"><a href="#cb129-985" aria-hidden="true" tabindex="-1"></a><span class="co">#                data = use_gear_nlg, REML = FALSE)</span></span>
<span id="cb129-986"><a href="#cb129-986" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod0.1)</span></span>
<span id="cb129-987"><a href="#cb129-987" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-988"><a href="#cb129-988" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gaussian full model - not using county landed because it is effectively one island</span></span>
<span id="cb129-989"><a href="#cb129-989" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1 = lmer(FL_CM ~ COUNTY + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb129-990"><a href="#cb129-990" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = use_gear_nlg, REML = FALSE)</span></span>
<span id="cb129-991"><a href="#cb129-991" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1)</span></span>
<span id="cb129-992"><a href="#cb129-992" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mod1, correlation = FALSE)</span></span>
<span id="cb129-993"><a href="#cb129-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-994"><a href="#cb129-994" aria-hidden="true" tabindex="-1"></a><span class="do">########### START ANALYSIS HERE </span></span>
<span id="cb129-995"><a href="#cb129-995" aria-hidden="true" tabindex="-1"></a><span class="do">### both fixed linear and glm models have warning message because ENTANGLING NETS (GILL) UNSPECIFIED only occur in one year, preventing convergence across timeline </span></span>
<span id="cb129-996"><a href="#cb129-996" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb129-997"><a href="#cb129-997" aria-hidden="true" tabindex="-1"></a><span class="co"># mod1.1 = lmer(FL_CM ~ scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb129-998"><a href="#cb129-998" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = use_gear_nlg, REML = FALSE)</span></span>
<span id="cb129-999"><a href="#cb129-999" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod1.1)</span></span>
<span id="cb129-1000"><a href="#cb129-1000" aria-hidden="true" tabindex="-1"></a><span class="co"># # summary(mod1.1, correlation = FALSE)</span></span>
<span id="cb129-1001"><a href="#cb129-1001" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1002"><a href="#cb129-1002" aria-hidden="true" tabindex="-1"></a><span class="co"># # comparing length to date and gear in a gamma full model</span></span>
<span id="cb129-1003"><a href="#cb129-1003" aria-hidden="true" tabindex="-1"></a><span class="co"># mod2 = glmer(FL_CM ~ scale(FINAL_DATE) + LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb129-1004"><a href="#cb129-1004" aria-hidden="true" tabindex="-1"></a><span class="co">#              data = use_gear_nlg, family = Gamma(link=log))</span></span>
<span id="cb129-1005"><a href="#cb129-1005" aria-hidden="true" tabindex="-1"></a><span class="co"># # anova(mod2) #no p value given for gamma model by itself </span></span>
<span id="cb129-1006"><a href="#cb129-1006" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1007"><a href="#cb129-1007" aria-hidden="true" tabindex="-1"></a><span class="co"># # check which number is lower, lower number is better fitting model </span></span>
<span id="cb129-1008"><a href="#cb129-1008" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC(mod1.1, mod2)</span></span>
<span id="cb129-1009"><a href="#cb129-1009" aria-hidden="true" tabindex="-1"></a><span class="co"># # glm is better fit</span></span>
<span id="cb129-1010"><a href="#cb129-1010" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1011"><a href="#cb129-1011" aria-hidden="true" tabindex="-1"></a><span class="co"># # gamma reduced model</span></span>
<span id="cb129-1012"><a href="#cb129-1012" aria-hidden="true" tabindex="-1"></a><span class="co"># mod3 = glmer(FL_CM ~ scale(FINAL_DATE) + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb129-1013"><a href="#cb129-1013" aria-hidden="true" tabindex="-1"></a><span class="co">#              data = use_gear_nlg, family = Gamma(link=log))</span></span>
<span id="cb129-1014"><a href="#cb129-1014" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1015"><a href="#cb129-1015" aria-hidden="true" tabindex="-1"></a><span class="co"># mod4 = glmer(FL_CM ~ LAND_GEAR_NAME + (1 | YEAR) + (1 | ID),</span></span>
<span id="cb129-1016"><a href="#cb129-1016" aria-hidden="true" tabindex="-1"></a><span class="co">#              data = use_gear_nlg, family = Gamma(link=log))</span></span>
<span id="cb129-1017"><a href="#cb129-1017" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1018"><a href="#cb129-1018" aria-hidden="true" tabindex="-1"></a><span class="co"># # likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb129-1019"><a href="#cb129-1019" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod2, mod3) #gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb129-1020"><a href="#cb129-1020" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(mod2, mod4) #gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb129-1021"><a href="#cb129-1021" aria-hidden="true" tabindex="-1"></a><span class="co"># # No significant p values for time period or gears</span></span>
<span id="cb129-1022"><a href="#cb129-1022" aria-hidden="true" tabindex="-1"></a><span class="co"># # Further comparisons not needed </span></span>
<span id="cb129-1023"><a href="#cb129-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1024"><a href="#cb129-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1025"><a href="#cb129-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">## Trap</span></span>
<span id="cb129-1026"><a href="#cb129-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1027"><a href="#cb129-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_trap_plot, fig.width=15, fig.height=8}</span></span>
<span id="cb129-1028"><a href="#cb129-1028" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1029"><a href="#cb129-1029" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1030"><a href="#cb129-1030" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1031"><a href="#cb129-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1032"><a href="#cb129-1032" aria-hidden="true" tabindex="-1"></a><span class="co"># str(length_data_final)</span></span>
<span id="cb129-1033"><a href="#cb129-1033" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) </span>
<span id="cb129-1034"><a href="#cb129-1034" aria-hidden="true" tabindex="-1"></a><span class="co"># net land_standard_gear_name</span></span>
<span id="cb129-1035"><a href="#cb129-1035" aria-hidden="true" tabindex="-1"></a>use_gear_tr <span class="ot">&lt;-</span> length_data_final <span class="sc">|&gt;</span></span>
<span id="cb129-1036"><a href="#cb129-1036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(YEAR, FINAL_DATE, ID, COUNTY, FL_CM, LAND_STANDARD_GEAR_NAME, gear) <span class="sc">|&gt;</span> </span>
<span id="cb129-1037"><a href="#cb129-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear <span class="sc">==</span> <span class="st">"Trap"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-1038"><a href="#cb129-1038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(ID)) <span class="sc">|&gt;</span> </span>
<span id="cb129-1039"><a href="#cb129-1039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gear)</span>
<span id="cb129-1040"><a href="#cb129-1040" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb129-1041"><a href="#cb129-1041" aria-hidden="true" tabindex="-1"></a><span class="co"># Create box plot across years</span></span>
<span id="cb129-1042"><a href="#cb129-1042" aria-hidden="true" tabindex="-1"></a>box_plot <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(use_gear_tr, <span class="at">x =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">y =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb129-1043"><a href="#cb129-1043" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb129-1044"><a href="#cb129-1044" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>)</span>
<span id="cb129-1045"><a href="#cb129-1045" aria-hidden="true" tabindex="-1"></a>box_plot</span>
<span id="cb129-1046"><a href="#cb129-1046" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot across years</span></span>
<span id="cb129-1047"><a href="#cb129-1047" aria-hidden="true" tabindex="-1"></a>density_plot <span class="ot">&lt;-</span> <span class="fu">ggdensity</span>(use_gear_tr, <span class="at">x =</span> <span class="st">"FL_CM"</span>,</span>
<span id="cb129-1048"><a href="#cb129-1048" aria-hidden="true" tabindex="-1"></a>                          <span class="at">add =</span> <span class="st">"mean"</span>, <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb129-1049"><a href="#cb129-1049" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>, <span class="at">fill =</span> <span class="st">"LAND_STANDARD_GEAR_NAME"</span>,</span>
<span id="cb129-1050"><a href="#cb129-1050" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">"FL_CM"</span>, <span class="at">xlab =</span> <span class="st">"Gear"</span>)</span>
<span id="cb129-1051"><a href="#cb129-1051" aria-hidden="true" tabindex="-1"></a>density_plot</span>
<span id="cb129-1052"><a href="#cb129-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1053"><a href="#cb129-1053" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb129-1054"><a href="#cb129-1054" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb129-1055"><a href="#cb129-1055" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(use_gear_tr, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(FINAL_DATE), <span class="at">y =</span> FL_CM)) <span class="sc">+</span></span>
<span id="cb129-1056"><a href="#cb129-1056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> LAND_STANDARD_GEAR_NAME, <span class="at">shape =</span> LAND_STANDARD_GEAR_NAME), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb129-1057"><a href="#cb129-1057" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb129-1058"><a href="#cb129-1058" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ COUNTY_LANDED) +</span></span>
<span id="cb129-1059"><a href="#cb129-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>, <span class="at">colour =</span> <span class="st">""</span>, <span class="at">shape =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb129-1060"><a href="#cb129-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb129-1061"><a href="#cb129-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb129-1062"><a href="#cb129-1062" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"npc"</span>), <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb129-1063"><a href="#cb129-1063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb129-1064"><a href="#cb129-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1065"><a href="#cb129-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1066"><a href="#cb129-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1067"><a href="#cb129-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_trap_analysis}</span></span>
<span id="cb129-1068"><a href="#cb129-1068" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1069"><a href="#cb129-1069" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1070"><a href="#cb129-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1071"><a href="#cb129-1071" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb129-1072"><a href="#cb129-1072" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb129-1073"><a href="#cb129-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1074"><a href="#cb129-1074" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a liner model</span></span>
<span id="cb129-1075"><a href="#cb129-1075" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-1076"><a href="#cb129-1076" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> use_gear_tr, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb129-1077"><a href="#cb129-1077" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1<span class="fl">.1</span>)</span>
<span id="cb129-1078"><a href="#cb129-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1079"><a href="#cb129-1079" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing length to date and gear in a gamma full model</span></span>
<span id="cb129-1080"><a href="#cb129-1080" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-1081"><a href="#cb129-1081" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-1082"><a href="#cb129-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1083"><a href="#cb129-1083" aria-hidden="true" tabindex="-1"></a><span class="co"># check which number is lower, lower number is better fitting model </span></span>
<span id="cb129-1084"><a href="#cb129-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod1<span class="fl">.1</span>, mod2) <span class="co"># glm is better fit</span></span>
<span id="cb129-1085"><a href="#cb129-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1086"><a href="#cb129-1086" aria-hidden="true" tabindex="-1"></a><span class="co"># gamma reduced model</span></span>
<span id="cb129-1087"><a href="#cb129-1087" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> <span class="fu">scale</span>(FINAL_DATE) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-1088"><a href="#cb129-1088" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-1089"><a href="#cb129-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1090"><a href="#cb129-1090" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">=</span> <span class="fu">glmer</span>(FL_CM <span class="sc">~</span> LAND_STANDARD_GEAR_NAME <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> YEAR) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb129-1091"><a href="#cb129-1091" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> use_gear_tr, <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span>log))</span>
<span id="cb129-1092"><a href="#cb129-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1093"><a href="#cb129-1093" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test - compare gamma full model to reduced model to find p-value of value excluded from reduced model </span></span>
<span id="cb129-1094"><a href="#cb129-1094" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of gear - significant p value shows one of the gears present is significantly different from the others</span></span>
<span id="cb129-1095"><a href="#cb129-1095" aria-hidden="true" tabindex="-1"></a><span class="do">### Trap does not have any significantly different gears </span></span>
<span id="cb129-1096"><a href="#cb129-1096" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod3)</span>
<span id="cb129-1097"><a href="#cb129-1097" aria-hidden="true" tabindex="-1"></a><span class="co"># gives p value of date - significant p value shows the slope of the line of fit across time is significantly different from a 0(zero) slope </span></span>
<span id="cb129-1098"><a href="#cb129-1098" aria-hidden="true" tabindex="-1"></a><span class="do">### There is significantly different size over time in the Trap grouping </span></span>
<span id="cb129-1099"><a href="#cb129-1099" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2, mod4)</span>
<span id="cb129-1100"><a href="#cb129-1100" aria-hidden="true" tabindex="-1"></a><span class="co"># No significant p values for gears, further comparisons not needed </span></span>
<span id="cb129-1101"><a href="#cb129-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1102"><a href="#cb129-1102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1103"><a href="#cb129-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1104"><a href="#cb129-1104" aria-hidden="true" tabindex="-1"></a><span class="fu"># Gear Density Plots</span></span>
<span id="cb129-1105"><a href="#cb129-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1106"><a href="#cb129-1106" aria-hidden="true" tabindex="-1"></a>Filtered to years with 30 or more length records (regardless of gear) per year. STT and STJ records are grouped together.</span>
<span id="cb129-1107"><a href="#cb129-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1108"><a href="#cb129-1108" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aggregated density plots</span></span>
<span id="cb129-1109"><a href="#cb129-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1110"><a href="#cb129-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r agg_pdf_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1111"><a href="#cb129-1111" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1112"><a href="#cb129-1112" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1113"><a href="#cb129-1113" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1114"><a href="#cb129-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1115"><a href="#cb129-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1116"><a href="#cb129-1116" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################</span></span>
<span id="cb129-1117"><a href="#cb129-1117" aria-hidden="true" tabindex="-1"></a><span class="co"># dscounts = VLg %&gt;% group_by(source) %&gt;% filter(n() &gt;= 30) %&gt;% ungroup %&gt;% </span></span>
<span id="cb129-1118"><a href="#cb129-1118" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(source) %&gt;%</span></span>
<span id="cb129-1119"><a href="#cb129-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(source, " (n= ", scales::comma(n), ")" ))</span></span>
<span id="cb129-1120"><a href="#cb129-1120" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1121"><a href="#cb129-1121" aria-hidden="true" tabindex="-1"></a><span class="co"># dscc &lt;- scales::seq_gradient_pal("#22D463", "red", "Lab")(seq(0,1,length.out=dim(dscounts)[1]))</span></span>
<span id="cb129-1122"><a href="#cb129-1122" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1123"><a href="#cb129-1123" aria-hidden="true" tabindex="-1"></a><span class="co">#  VLg %&gt;% group_by(source) %&gt;% filter(n() &gt;= 30) %&gt;% ungroup %&gt;% </span></span>
<span id="cb129-1124"><a href="#cb129-1124" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(FL_CM))+</span></span>
<span id="cb129-1125"><a href="#cb129-1125" aria-hidden="true" tabindex="-1"></a><span class="co"># #  geom_density( aes(color = "Combined"))+</span></span>
<span id="cb129-1126"><a href="#cb129-1126" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_density(aes(color = source))+</span></span>
<span id="cb129-1127"><a href="#cb129-1127" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_manual(values = dscc, labels = c(dscounts$n_labels))+</span></span>
<span id="cb129-1128"><a href="#cb129-1128" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Vertical Line Data Sources", x = "Fork Length (cm)", title = paste0(region,  " VL \n (N = ", scales::comma(sum(dscounts$n)), ")"))+</span></span>
<span id="cb129-1129"><a href="#cb129-1129" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()+ guides(colour=guide_legend(ncol=1))</span></span>
<span id="cb129-1130"><a href="#cb129-1130" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb129-1131"><a href="#cb129-1131" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb129-1132"><a href="#cb129-1132" aria-hidden="true" tabindex="-1"></a><span class="co"># table(VLg$YEAR,VLg$source)</span></span>
<span id="cb129-1133"><a href="#cb129-1133" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################</span></span>
<span id="cb129-1134"><a href="#cb129-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1135"><a href="#cb129-1135" aria-hidden="true" tabindex="-1"></a><span class="do">#####################EDIT HERE ; NOT WORKING BELOW (I don't think)</span></span>
<span id="cb129-1136"><a href="#cb129-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1137"><a href="#cb129-1137" aria-hidden="true" tabindex="-1"></a>ycounts <span class="ot">=</span>length_data_final <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1138"><a href="#cb129-1138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(gear) <span class="sc">%&gt;%</span></span>
<span id="cb129-1139"><a href="#cb129-1139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(gear, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1140"><a href="#cb129-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1141"><a href="#cb129-1141" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1142"><a href="#cb129-1142" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM))<span class="sc">+</span></span>
<span id="cb129-1143"><a href="#cb129-1143" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_density( aes(color = "Combined"),lwd=1.5)+</span></span>
<span id="cb129-1144"><a href="#cb129-1144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> gear), <span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb129-1145"><a href="#cb129-1145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>ycounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1146"><a href="#cb129-1146" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_hue(labels=c("Combined",ycounts$n_labels))+</span></span>
<span id="cb129-1147"><a href="#cb129-1147" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = gearcols, labels = c("Combined", counts$n_labels))+</span></span>
<span id="cb129-1148"><a href="#cb129-1148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(region,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1149"><a href="#cb129-1149" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb129-1150"><a href="#cb129-1150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1151"><a href="#cb129-1151" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1152"><a href="#cb129-1152" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-1153"><a href="#cb129-1153" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-1154"><a href="#cb129-1154" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-1155"><a href="#cb129-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#  filter to 30 or more of same gear each year </span></span>
<span id="cb129-1156"><a href="#cb129-1156" aria-hidden="true" tabindex="-1"></a><span class="co"># ygearcounts =length_data_final |&gt; </span></span>
<span id="cb129-1157"><a href="#cb129-1157" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(YEAR, LAND_STANDARD_GEAR_NAME) |&gt;</span></span>
<span id="cb129-1158"><a href="#cb129-1158" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(n() &gt;= 30)|&gt;</span></span>
<span id="cb129-1159"><a href="#cb129-1159" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb129-1160"><a href="#cb129-1160" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(gear) %&gt;%</span></span>
<span id="cb129-1161"><a href="#cb129-1161" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_gearlabels = paste0(gear, " (n= ", n, ")" ))</span></span>
<span id="cb129-1162"><a href="#cb129-1162" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1163"><a href="#cb129-1163" aria-hidden="true" tabindex="-1"></a><span class="co">#  length_data_final |&gt; </span></span>
<span id="cb129-1164"><a href="#cb129-1164" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(YEAR, LAND_STANDARD_GEAR_NAME) |&gt;</span></span>
<span id="cb129-1165"><a href="#cb129-1165" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(n() &gt;= 30)|&gt;</span></span>
<span id="cb129-1166"><a href="#cb129-1166" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() |&gt; </span></span>
<span id="cb129-1167"><a href="#cb129-1167" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(FL_CM))+</span></span>
<span id="cb129-1168"><a href="#cb129-1168" aria-hidden="true" tabindex="-1"></a><span class="co">#  # geom_density( aes(color = "Combined"),lwd=1.5)+</span></span>
<span id="cb129-1169"><a href="#cb129-1169" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_density(aes(color = gear), size = 0.75)+</span></span>
<span id="cb129-1170"><a href="#cb129-1170" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_hue(labels=ygearcounts$n_gearlabels)+</span></span>
<span id="cb129-1171"><a href="#cb129-1171" aria-hidden="true" tabindex="-1"></a><span class="co">#  # scale_color_hue(labels=c("Combined",ycounts$n_labels))+</span></span>
<span id="cb129-1172"><a href="#cb129-1172" aria-hidden="true" tabindex="-1"></a><span class="co">#   #scale_color_manual(values = gearcols, labels = c("Combined", counts$n_labels))+</span></span>
<span id="cb129-1173"><a href="#cb129-1173" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Gear Type", x = "Fork Length (cm)", title = paste0(region,  "\n (N = ", sum(ygearcounts$n), ")"))+</span></span>
<span id="cb129-1174"><a href="#cb129-1174" aria-hidden="true" tabindex="-1"></a><span class="co">#   # theme_minimal()</span></span>
<span id="cb129-1175"><a href="#cb129-1175" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.title = element_text(size=14), </span></span>
<span id="cb129-1176"><a href="#cb129-1176" aria-hidden="true" tabindex="-1"></a><span class="co">#     legend.text = element_text(size=12))</span></span>
<span id="cb129-1177"><a href="#cb129-1177" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-1178"><a href="#cb129-1178" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-1179"><a href="#cb129-1179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1180"><a href="#cb129-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1181"><a href="#cb129-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1182"><a href="#cb129-1182" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gear grouping investigation</span></span>
<span id="cb129-1183"><a href="#cb129-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1184"><a href="#cb129-1184" aria-hidden="true" tabindex="-1"></a>Filtered to minimum 30 fish per year</span>
<span id="cb129-1185"><a href="#cb129-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1186"><a href="#cb129-1186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1187"><a href="#cb129-1187" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1188"><a href="#cb129-1188" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1189"><a href="#cb129-1189" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1190"><a href="#cb129-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1191"><a href="#cb129-1191" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1192"><a href="#cb129-1192" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb129-1193"><a href="#cb129-1193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb129-1194"><a href="#cb129-1194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>ycounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1195"><a href="#cb129-1195" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1196"><a href="#cb129-1196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1197"><a href="#cb129-1197" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1198"><a href="#cb129-1198" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb129-1199"><a href="#cb129-1199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1200"><a href="#cb129-1200" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1201"><a href="#cb129-1201" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1202"><a href="#cb129-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1203"><a href="#cb129-1203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1204"><a href="#cb129-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1205"><a href="#cb129-1205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_hl_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1206"><a href="#cb129-1206" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1207"><a href="#cb129-1207" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1208"><a href="#cb129-1208" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1209"><a href="#cb129-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1210"><a href="#cb129-1210" aria-hidden="true" tabindex="-1"></a>hl<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'HL'</span>,]</span>
<span id="cb129-1211"><a href="#cb129-1211" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> hl <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1212"><a href="#cb129-1212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb129-1213"><a href="#cb129-1213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1214"><a href="#cb129-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1215"><a href="#cb129-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1216"><a href="#cb129-1216" aria-hidden="true" tabindex="-1"></a><span class="co"># hl_car &lt;-</span></span>
<span id="cb129-1217"><a href="#cb129-1217" aria-hidden="true" tabindex="-1"></a>hl <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1218"><a href="#cb129-1218" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb129-1219"><a href="#cb129-1219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb129-1220"><a href="#cb129-1220" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1221"><a href="#cb129-1221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1222"><a href="#cb129-1222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1223"><a href="#cb129-1223" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1224"><a href="#cb129-1224" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb129-1225"><a href="#cb129-1225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1226"><a href="#cb129-1226" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1227"><a href="#cb129-1227" aria-hidden="true" tabindex="-1"></a><span class="co"># hl_car</span></span>
<span id="cb129-1228"><a href="#cb129-1228" aria-hidden="true" tabindex="-1"></a><span class="co"># export_fig(hl_car)</span></span>
<span id="cb129-1229"><a href="#cb129-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1230"><a href="#cb129-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1231"><a href="#cb129-1231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1232"><a href="#cb129-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1233"><a href="#cb129-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_trap_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1234"><a href="#cb129-1234" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1235"><a href="#cb129-1235" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1236"><a href="#cb129-1236" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1237"><a href="#cb129-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1238"><a href="#cb129-1238" aria-hidden="true" tabindex="-1"></a>trap <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'TR'</span>,]</span>
<span id="cb129-1239"><a href="#cb129-1239" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> trap <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1240"><a href="#cb129-1240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb129-1241"><a href="#cb129-1241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1242"><a href="#cb129-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1243"><a href="#cb129-1243" aria-hidden="true" tabindex="-1"></a>trap <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1244"><a href="#cb129-1244" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb129-1245"><a href="#cb129-1245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb129-1246"><a href="#cb129-1246" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1247"><a href="#cb129-1247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1248"><a href="#cb129-1248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1249"><a href="#cb129-1249" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1250"><a href="#cb129-1250" aria-hidden="true" tabindex="-1"></a> <span class="co"># theme_minimal()</span></span>
<span id="cb129-1251"><a href="#cb129-1251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1252"><a href="#cb129-1252" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1253"><a href="#cb129-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1254"><a href="#cb129-1254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1255"><a href="#cb129-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1256"><a href="#cb129-1256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_net_plot,fig.width=12, fig.height=8}</span></span>
<span id="cb129-1257"><a href="#cb129-1257" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1258"><a href="#cb129-1258" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1259"><a href="#cb129-1259" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1260"><a href="#cb129-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1261"><a href="#cb129-1261" aria-hidden="true" tabindex="-1"></a><span class="co">#nets might need to be another category because haul seines, trammel, and entangling (gill unsp) have too many occurances to be in other </span></span>
<span id="cb129-1262"><a href="#cb129-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1263"><a href="#cb129-1263" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'NT'</span>,]</span>
<span id="cb129-1264"><a href="#cb129-1264" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> net <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1265"><a href="#cb129-1265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb129-1266"><a href="#cb129-1266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1267"><a href="#cb129-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1268"><a href="#cb129-1268" aria-hidden="true" tabindex="-1"></a>net <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1269"><a href="#cb129-1269" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM,<span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb129-1270"><a href="#cb129-1270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb129-1271"><a href="#cb129-1271" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1272"><a href="#cb129-1272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1273"><a href="#cb129-1273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1274"><a href="#cb129-1274" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1275"><a href="#cb129-1275" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb129-1276"><a href="#cb129-1276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1277"><a href="#cb129-1277" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1278"><a href="#cb129-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1279"><a href="#cb129-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1280"><a href="#cb129-1280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1281"><a href="#cb129-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1282"><a href="#cb129-1282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_other_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1283"><a href="#cb129-1283" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1284"><a href="#cb129-1284" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1285"><a href="#cb129-1285" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1286"><a href="#cb129-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1287"><a href="#cb129-1287" aria-hidden="true" tabindex="-1"></a>ot<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'OT'</span>,]</span>
<span id="cb129-1288"><a href="#cb129-1288" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> ot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1289"><a href="#cb129-1289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb129-1290"><a href="#cb129-1290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1291"><a href="#cb129-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1292"><a href="#cb129-1292" aria-hidden="true" tabindex="-1"></a>ot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1293"><a href="#cb129-1293" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb129-1294"><a href="#cb129-1294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb129-1295"><a href="#cb129-1295" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1296"><a href="#cb129-1296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1297"><a href="#cb129-1297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1298"><a href="#cb129-1298" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1299"><a href="#cb129-1299" aria-hidden="true" tabindex="-1"></a> <span class="co"># theme_minimal()</span></span>
<span id="cb129-1300"><a href="#cb129-1300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1301"><a href="#cb129-1301" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1302"><a href="#cb129-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1303"><a href="#cb129-1303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1304"><a href="#cb129-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1305"><a href="#cb129-1305" aria-hidden="true" tabindex="-1"></a><span class="fu">## Break at 2005</span></span>
<span id="cb129-1306"><a href="#cb129-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1307"><a href="#cb129-1307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_plot_2005, fig.width=15, fig.height=8}</span></span>
<span id="cb129-1308"><a href="#cb129-1308" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1309"><a href="#cb129-1309" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1310"><a href="#cb129-1310" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1311"><a href="#cb129-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1312"><a href="#cb129-1312" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> <span class="co"># filter(YEAR &gt; 2011) |&gt; </span></span>
<span id="cb129-1313"><a href="#cb129-1313" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb129-1314"><a href="#cb129-1314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb129-1315"><a href="#cb129-1315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>ycounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1316"><a href="#cb129-1316" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1317"><a href="#cb129-1317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1318"><a href="#cb129-1318" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1319"><a href="#cb129-1319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb129-1320"><a href="#cb129-1320" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb129-1321"><a href="#cb129-1321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1322"><a href="#cb129-1322" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1323"><a href="#cb129-1323" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1324"><a href="#cb129-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1325"><a href="#cb129-1325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1326"><a href="#cb129-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1327"><a href="#cb129-1327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_hookandline_plot_2005, fig.width=15, fig.height=8}</span></span>
<span id="cb129-1328"><a href="#cb129-1328" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1329"><a href="#cb129-1329" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1330"><a href="#cb129-1330" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1331"><a href="#cb129-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1332"><a href="#cb129-1332" aria-hidden="true" tabindex="-1"></a>HL <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'HL'</span>,]</span>
<span id="cb129-1333"><a href="#cb129-1333" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> HL <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1334"><a href="#cb129-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb129-1335"><a href="#cb129-1335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1336"><a href="#cb129-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1337"><a href="#cb129-1337" aria-hidden="true" tabindex="-1"></a>HL <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1338"><a href="#cb129-1338" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb129-1339"><a href="#cb129-1339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb129-1340"><a href="#cb129-1340" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1341"><a href="#cb129-1341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1342"><a href="#cb129-1342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1343"><a href="#cb129-1343" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1344"><a href="#cb129-1344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb129-1345"><a href="#cb129-1345" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb129-1346"><a href="#cb129-1346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1347"><a href="#cb129-1347" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1348"><a href="#cb129-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1349"><a href="#cb129-1349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1350"><a href="#cb129-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1351"><a href="#cb129-1351" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_net_plot_2005, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1352"><a href="#cb129-1352" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1353"><a href="#cb129-1353" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1354"><a href="#cb129-1354" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1355"><a href="#cb129-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1356"><a href="#cb129-1356" aria-hidden="true" tabindex="-1"></a><span class="co">#nets might need to be another category because haul seines, trammel, and entangling (gill unsp) have too many occurances to be in other </span></span>
<span id="cb129-1357"><a href="#cb129-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1358"><a href="#cb129-1358" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'NT'</span>,]</span>
<span id="cb129-1359"><a href="#cb129-1359" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> net <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1360"><a href="#cb129-1360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb129-1361"><a href="#cb129-1361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1362"><a href="#cb129-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1363"><a href="#cb129-1363" aria-hidden="true" tabindex="-1"></a>net <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1364"><a href="#cb129-1364" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM,<span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb129-1365"><a href="#cb129-1365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb129-1366"><a href="#cb129-1366" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1367"><a href="#cb129-1367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1368"><a href="#cb129-1368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1369"><a href="#cb129-1369" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1370"><a href="#cb129-1370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb129-1371"><a href="#cb129-1371" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb129-1372"><a href="#cb129-1372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1373"><a href="#cb129-1373" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1374"><a href="#cb129-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1375"><a href="#cb129-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1376"><a href="#cb129-1376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1377"><a href="#cb129-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1378"><a href="#cb129-1378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_trap_plot_2005, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1379"><a href="#cb129-1379" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1380"><a href="#cb129-1380" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1381"><a href="#cb129-1381" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1382"><a href="#cb129-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1383"><a href="#cb129-1383" aria-hidden="true" tabindex="-1"></a>trap <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'TR'</span>,]</span>
<span id="cb129-1384"><a href="#cb129-1384" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> trap <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1385"><a href="#cb129-1385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb129-1386"><a href="#cb129-1386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1387"><a href="#cb129-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1388"><a href="#cb129-1388" aria-hidden="true" tabindex="-1"></a>trap <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1389"><a href="#cb129-1389" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM,<span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb129-1390"><a href="#cb129-1390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb129-1391"><a href="#cb129-1391" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1392"><a href="#cb129-1392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1393"><a href="#cb129-1393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1394"><a href="#cb129-1394" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1395"><a href="#cb129-1395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb129-1396"><a href="#cb129-1396" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb129-1397"><a href="#cb129-1397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1398"><a href="#cb129-1398" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1399"><a href="#cb129-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1400"><a href="#cb129-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1401"><a href="#cb129-1401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1402"><a href="#cb129-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1403"><a href="#cb129-1403" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_other_plot_2005, fig.width=15, fig.height=8}</span></span>
<span id="cb129-1404"><a href="#cb129-1404" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1405"><a href="#cb129-1405" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1406"><a href="#cb129-1406" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1407"><a href="#cb129-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1408"><a href="#cb129-1408" aria-hidden="true" tabindex="-1"></a>ot<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'OT'</span>,]</span>
<span id="cb129-1409"><a href="#cb129-1409" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> ot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1410"><a href="#cb129-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb129-1411"><a href="#cb129-1411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1412"><a href="#cb129-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1413"><a href="#cb129-1413" aria-hidden="true" tabindex="-1"></a>ot <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1414"><a href="#cb129-1414" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME))<span class="sc">+</span></span>
<span id="cb129-1415"><a href="#cb129-1415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb129-1416"><a href="#cb129-1416" aria-hidden="true" tabindex="-1"></a> <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1417"><a href="#cb129-1417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1418"><a href="#cb129-1418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1419"><a href="#cb129-1419" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1420"><a href="#cb129-1420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb129-1421"><a href="#cb129-1421" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb129-1422"><a href="#cb129-1422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1423"><a href="#cb129-1423" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1424"><a href="#cb129-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1425"><a href="#cb129-1425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1426"><a href="#cb129-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1427"><a href="#cb129-1427" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual Density plots</span></span>
<span id="cb129-1428"><a href="#cb129-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1429"><a href="#cb129-1429" aria-hidden="true" tabindex="-1"></a>This will be split by final gear aggregations once these are decided, removes "other" gear types.</span>
<span id="cb129-1430"><a href="#cb129-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1431"><a href="#cb129-1431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual_pdf_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1432"><a href="#cb129-1432" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1433"><a href="#cb129-1433" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1434"><a href="#cb129-1434" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1435"><a href="#cb129-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1436"><a href="#cb129-1436" aria-hidden="true" tabindex="-1"></a>fleet_final <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>fleet<span class="sc">==</span><span class="dv">1</span>,]</span>
<span id="cb129-1437"><a href="#cb129-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1438"><a href="#cb129-1438" aria-hidden="true" tabindex="-1"></a>fcounts <span class="ot">=</span> fleet_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1439"><a href="#cb129-1439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(gear) <span class="sc">%&gt;%</span></span>
<span id="cb129-1440"><a href="#cb129-1440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(gear, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1441"><a href="#cb129-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1442"><a href="#cb129-1442" aria-hidden="true" tabindex="-1"></a>all_car <span class="ot">&lt;-</span></span>
<span id="cb129-1443"><a href="#cb129-1443" aria-hidden="true" tabindex="-1"></a> fleet_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1444"><a href="#cb129-1444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb129-1445"><a href="#cb129-1445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_labs =</span> <span class="fu">paste0</span>(YEAR, <span class="st">"</span><span class="sc">\n</span><span class="st"> n = "</span>, <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb129-1446"><a href="#cb129-1446" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb129-1447"><a href="#cb129-1447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb129-1448"><a href="#cb129-1448" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1449"><a href="#cb129-1449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>fcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1450"><a href="#cb129-1450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(fcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1451"><a href="#cb129-1451" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>year_labs)<span class="sc">+</span></span>
<span id="cb129-1452"><a href="#cb129-1452" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb129-1453"><a href="#cb129-1453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1454"><a href="#cb129-1454" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1455"><a href="#cb129-1455" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1456"><a href="#cb129-1456" aria-hidden="true" tabindex="-1"></a>all_car</span>
<span id="cb129-1457"><a href="#cb129-1457" aria-hidden="true" tabindex="-1"></a><span class="fu">export_fig_page</span>(all_car)</span>
<span id="cb129-1458"><a href="#cb129-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1459"><a href="#cb129-1459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1460"><a href="#cb129-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1461"><a href="#cb129-1461" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PR}</span></span>
<span id="cb129-1462"><a href="#cb129-1462" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1463"><a href="#cb129-1463" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1464"><a href="#cb129-1464" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1465"><a href="#cb129-1465" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(length_data_final<span class="sc">$</span>ISLAND)</span>
<span id="cb129-1466"><a href="#cb129-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1467"><a href="#cb129-1467" aria-hidden="true" tabindex="-1"></a>PR <span class="ot">&lt;-</span> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb129-1468"><a href="#cb129-1468" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(ISLAND<span class="sc">==</span><span class="st">'PUERTO RICO'</span>)</span>
<span id="cb129-1469"><a href="#cb129-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1470"><a href="#cb129-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1471"><a href="#cb129-1471" aria-hidden="true" tabindex="-1"></a>vessel_pr     <span class="ot">&lt;-</span> <span class="fu">distinct</span>(PR, VESSEL_ID, LICENSE)  <span class="do">##vessel never recorded, only use license</span></span>
<span id="cb129-1472"><a href="#cb129-1472" aria-hidden="true" tabindex="-1"></a>dealer_pr     <span class="ot">&lt;-</span> <span class="fu">distinct</span>(PR, DEALER_CODE, COUNTY)</span>
<span id="cb129-1473"><a href="#cb129-1473" aria-hidden="true" tabindex="-1"></a>interviews_pr <span class="ot">&lt;-</span> <span class="fu">distinct</span>(PR, INTERVIEW_DATE, YEAR, gear)</span>
<span id="cb129-1474"><a href="#cb129-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1475"><a href="#cb129-1475" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(PR<span class="sc">$</span>INTERVIEW_DATE))</span>
<span id="cb129-1476"><a href="#cb129-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1477"><a href="#cb129-1477" aria-hidden="true" tabindex="-1"></a>final_gears <span class="ot">&lt;-</span> <span class="fu">unique</span>(PR<span class="sc">$</span>gear_short)  <span class="do">##++this is where final length comps are generated ; could be aggregated above (e.g. via lookup table) &amp; should be 1 here </span></span>
<span id="cb129-1478"><a href="#cb129-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1479"><a href="#cb129-1479" aria-hidden="true" tabindex="-1"></a>PR_comps <span class="ot">&lt;-</span> <span class="fu">list</span>()  <span class="do">##++this creates an empty list for for loop</span></span>
<span id="cb129-1480"><a href="#cb129-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1481"><a href="#cb129-1481" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop generates binned length comps for each of the final gears. Stored in list. RUN:  View(comps[[1]]) to see in R</span></span>
<span id="cb129-1482"><a href="#cb129-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1483"><a href="#cb129-1483" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(final_gears)){</span>
<span id="cb129-1484"><a href="#cb129-1484" aria-hidden="true" tabindex="-1"></a> PR_comps[[i]] <span class="ot">&lt;-</span>  PR <span class="sc">%&gt;%</span></span>
<span id="cb129-1485"><a href="#cb129-1485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear_short <span class="sc">==</span> final_gears[i]) <span class="sc">%&gt;%</span></span>
<span id="cb129-1486"><a href="#cb129-1486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb129-1487"><a href="#cb129-1487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ln_fish =</span> <span class="fu">n</span>(),</span>
<span id="cb129-1488"><a href="#cb129-1488" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_trips =</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">na.omit</span>(ID))),</span>
<span id="cb129-1489"><a href="#cb129-1489" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_dealers=</span><span class="fu">length</span>(<span class="fu">unique</span>(DEALER_CODE)),</span>
<span id="cb129-1490"><a href="#cb129-1490" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ln_dealers=length(unique(COUNTY_CODE)),</span></span>
<span id="cb129-1491"><a href="#cb129-1491" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ln_dealers=dim(na.omit(distinct(PR,YEAR,DEALER_CODE,COUNTY_CODE)))[1],</span></span>
<span id="cb129-1492"><a href="#cb129-1492" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_vessels=</span><span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">na.omit</span>(LICENSE)))) <span class="sc">%&gt;%</span>   <span class="do">##check vessel_pr to confirm </span></span>
<span id="cb129-1493"><a href="#cb129-1493" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-1494"><a href="#cb129-1494" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_by(YEAR, COUNTY) %&gt;%</span></span>
<span id="cb129-1495"><a href="#cb129-1495" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  </span></span>
<span id="cb129-1496"><a href="#cb129-1496" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  ungroup() %&gt;%</span></span>
<span id="cb129-1497"><a href="#cb129-1497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels, lbin)<span class="sc">%&gt;%</span></span>
<span id="cb129-1498"><a href="#cb129-1498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">unique</span>(ln_fish)) <span class="sc">%&gt;%</span></span>
<span id="cb129-1499"><a href="#cb129-1499" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-1500"><a href="#cb129-1500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels), </span>
<span id="cb129-1501"><a href="#cb129-1501" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> lbin, </span>
<span id="cb129-1502"><a href="#cb129-1502" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> freq, </span>
<span id="cb129-1503"><a href="#cb129-1503" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">freq =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb129-1504"><a href="#cb129-1504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(full_set) <span class="sc">%&gt;%</span></span>
<span id="cb129-1505"><a href="#cb129-1505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comp_names)<span class="sc">%&gt;%</span></span>
<span id="cb129-1506"><a href="#cb129-1506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-1507"><a href="#cb129-1507" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">flag_n  =</span> <span class="fu">ifelse</span>(ln_fish <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">0</span>, </span>
<span id="cb129-1508"><a href="#cb129-1508" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(ln_fish <span class="sc">&lt;</span> <span class="dv">15</span>, <span class="dv">2</span>, <span class="dv">1</span>)))</span>
<span id="cb129-1509"><a href="#cb129-1509" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-1510"><a href="#cb129-1510" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(PR_comps)[[i]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(final_gears[i], <span class="st">"_"</span>, bin_size, <span class="st">"cm"</span>) <span class="do">##++tabs are named here ; could add _nom here if desired (instead of _lfd and _lfdw in main file)</span></span>
<span id="cb129-1511"><a href="#cb129-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1512"><a href="#cb129-1512" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb129-1513"><a href="#cb129-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1514"><a href="#cb129-1514" aria-hidden="true" tabindex="-1"></a><span class="co"># PR_comps$HL_1cm</span></span>
<span id="cb129-1515"><a href="#cb129-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1516"><a href="#cb129-1516" aria-hidden="true" tabindex="-1"></a><span class="co"># length(unique(na.omit(PR$DEALER_CODE)))</span></span>
<span id="cb129-1517"><a href="#cb129-1517" aria-hidden="true" tabindex="-1"></a><span class="co"># #dim(na.omit(distinct(PR,DEALER_CODE)))[1]</span></span>
<span id="cb129-1518"><a href="#cb129-1518" aria-hidden="true" tabindex="-1"></a><span class="co"># length(unique(PR$VESSEL_ID))</span></span>
<span id="cb129-1519"><a href="#cb129-1519" aria-hidden="true" tabindex="-1"></a><span class="co"># length(unique(PR$LICENSE))</span></span>
<span id="cb129-1520"><a href="#cb129-1520" aria-hidden="true" tabindex="-1"></a><span class="co"># length(unique(PR$COUNTY_CODE))</span></span>
<span id="cb129-1521"><a href="#cb129-1521" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1522"><a href="#cb129-1522" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(na.omit(distinct(PR,DEALER_CODE)))[1]</span></span>
<span id="cb129-1523"><a href="#cb129-1523" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(na.omit(distinct(PR,COUNTY_CODE)))[1]</span></span>
<span id="cb129-1524"><a href="#cb129-1524" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(na.omit(distinct(PR,DEALER_CODE,COUNTY_CODE)))[1]</span></span>
<span id="cb129-1525"><a href="#cb129-1525" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1526"><a href="#cb129-1526" aria-hidden="true" tabindex="-1"></a><span class="co"># distinct(PR, VESSEL_ID, LICENSE)</span></span>
<span id="cb129-1527"><a href="#cb129-1527" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1528"><a href="#cb129-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1529"><a href="#cb129-1529" aria-hidden="true" tabindex="-1"></a><span class="co">#write.xlsx(PR_comps, file="./comps/PR_QTF_com_lfd_8319_20210915C.xlsx")</span></span>
<span id="cb129-1530"><a href="#cb129-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1531"><a href="#cb129-1531" aria-hidden="true" tabindex="-1"></a><span class="do">##NOT WORKING =(</span></span>
<span id="cb129-1532"><a href="#cb129-1532" aria-hidden="true" tabindex="-1"></a><span class="co">#write.xlsx(comps, file = paste0("./comps/", sp, "_com_lfd_", sprintf('%02d', min_year %% 100), sprintf('%02d', max_year %% 100), "_", gsub("-", "", Sys.Date()), ".xlsx"))</span></span>
<span id="cb129-1533"><a href="#cb129-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1534"><a href="#cb129-1534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1535"><a href="#cb129-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1536"><a href="#cb129-1536" aria-hidden="true" tabindex="-1"></a><span class="fu"># Stacked bar charts</span></span>
<span id="cb129-1537"><a href="#cb129-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1538"><a href="#cb129-1538" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visual representation of gear distribution within groupings</span></span>
<span id="cb129-1539"><a href="#cb129-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1540"><a href="#cb129-1540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_plot, fig.width=10, fig.height=6}</span></span>
<span id="cb129-1541"><a href="#cb129-1541" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1542"><a href="#cb129-1542" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1543"><a href="#cb129-1543" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1544"><a href="#cb129-1544" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1545"><a href="#cb129-1545" aria-hidden="true" tabindex="-1"></a><span class="co"># counts =length_data_final %&gt;%</span></span>
<span id="cb129-1546"><a href="#cb129-1546" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(LAND_STANDARD_GEAR_NAME) %&gt;%</span></span>
<span id="cb129-1547"><a href="#cb129-1547" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(LAND_STANDARD_GEAR_NAME, " (n= ", n, ")" ))</span></span>
<span id="cb129-1548"><a href="#cb129-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1549"><a href="#cb129-1549" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-1550"><a href="#cb129-1550" aria-hidden="true" tabindex="-1"></a>  length_data_final <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb129-1551"><a href="#cb129-1551" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> LAND_STANDARD_GEAR_NAME, <span class="at">y =</span> FL_CM, <span class="at">x=</span> gear))<span class="sc">+</span></span>
<span id="cb129-1552"><a href="#cb129-1552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">stat=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb129-1553"><a href="#cb129-1553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1554"><a href="#cb129-1554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(ycounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1555"><a href="#cb129-1555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb129-1556"><a href="#cb129-1556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))</span>
<span id="cb129-1557"><a href="#cb129-1557" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guides(color = guide_legend(override.aes = list(size = 0.5))) </span></span>
<span id="cb129-1558"><a href="#cb129-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1559"><a href="#cb129-1559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1560"><a href="#cb129-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1561"><a href="#cb129-1561" aria-hidden="true" tabindex="-1"></a><span class="fu"># Gear distribution across time by gear groupings</span></span>
<span id="cb129-1562"><a href="#cb129-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1563"><a href="#cb129-1563" aria-hidden="true" tabindex="-1"></a><span class="fu">## All gears over time</span></span>
<span id="cb129-1564"><a href="#cb129-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1565"><a href="#cb129-1565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=15, fig.height=20}</span></span>
<span id="cb129-1566"><a href="#cb129-1566" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1567"><a href="#cb129-1567" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Stoplight Parrotfish LAND_STANDARD_GEAR_NAME STX</span></span>
<span id="cb129-1568"><a href="#cb129-1568" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false </span></span>
<span id="cb129-1569"><a href="#cb129-1569" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1570"><a href="#cb129-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1571"><a href="#cb129-1571" aria-hidden="true" tabindex="-1"></a><span class="co"># create count of observed records by individual gear name</span></span>
<span id="cb129-1572"><a href="#cb129-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1573"><a href="#cb129-1573" aria-hidden="true" tabindex="-1"></a>pr_count <span class="ot">&lt;-</span> length_data_final <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> ungroup <span class="sc">%&gt;%</span></span>
<span id="cb129-1574"><a href="#cb129-1574" aria-hidden="true" tabindex="-1"></a>   <span class="fu">add_count</span>(COUNTY) <span class="sc">%&gt;%</span></span>
<span id="cb129-1575"><a href="#cb129-1575" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">COUNTYn =</span> <span class="fu">paste0</span>(COUNTY, <span class="st">' ('</span>, n, <span class="st">')'</span>)) </span>
<span id="cb129-1576"><a href="#cb129-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1577"><a href="#cb129-1577" aria-hidden="true" tabindex="-1"></a>pr_gear_time <span class="ot">&lt;-</span> <span class="fu">subset</span>(pr_count, <span class="at">select =</span> <span class="sc">-</span>n) <span class="sc">%&gt;%</span> </span>
<span id="cb129-1578"><a href="#cb129-1578" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_count</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb129-1579"><a href="#cb129-1579" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">LAND_STANDARD_GEAR_NAMEn =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">'('</span>, n, <span class="st">')'</span>)) </span>
<span id="cb129-1580"><a href="#cb129-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1581"><a href="#cb129-1581" aria-hidden="true" tabindex="-1"></a><span class="co"># plot    </span></span>
<span id="cb129-1582"><a href="#cb129-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1583"><a href="#cb129-1583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> pr_gear_time, <span class="fu">aes</span>(<span class="at">x =</span> FINAL_DATE, <span class="at">y =</span> LAND_STANDARD_GEAR_NAMEn , <span class="at">group =</span> COUNTY ,<span class="at">color =</span> COUNTYn )) <span class="sc">+</span> </span>
<span id="cb129-1584"><a href="#cb129-1584" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(COUNTY), <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb129-1585"><a href="#cb129-1585" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb129-1586"><a href="#cb129-1586" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"STANDARDGEARNAME_1 (# obs)"</span>, </span>
<span id="cb129-1587"><a href="#cb129-1587" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Area-time distribution of landed gear pr"</span>, </span>
<span id="cb129-1588"><a href="#cb129-1588" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"COUNTY (# obs)"</span>,</span>
<span id="cb129-1589"><a href="#cb129-1589" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"N = "</span>, <span class="fu">nrow</span>(pr_gear_time)))<span class="sc">+</span> </span>
<span id="cb129-1590"><a href="#cb129-1590" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb129-1591"><a href="#cb129-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1592"><a href="#cb129-1592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1593"><a href="#cb129-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1594"><a href="#cb129-1594" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hook and Line Gear Distribution Over Time by Year</span></span>
<span id="cb129-1595"><a href="#cb129-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1596"><a href="#cb129-1596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_hl_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1597"><a href="#cb129-1597" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1598"><a href="#cb129-1598" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1599"><a href="#cb129-1599" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1600"><a href="#cb129-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1601"><a href="#cb129-1601" aria-hidden="true" tabindex="-1"></a>hl2<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'HL'</span>,]</span>
<span id="cb129-1602"><a href="#cb129-1602" aria-hidden="true" tabindex="-1"></a>hl4<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(hl2<span class="sc">$</span>FL_CM, <span class="fu">list</span>(hl2<span class="sc">$</span>YEAR, hl2<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb129-1603"><a href="#cb129-1603" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(hl4) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb129-1604"><a href="#cb129-1604" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> hl2 <span class="sc">%&gt;%</span></span>
<span id="cb129-1605"><a href="#cb129-1605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb129-1606"><a href="#cb129-1606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1607"><a href="#cb129-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1608"><a href="#cb129-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1609"><a href="#cb129-1609" aria-hidden="true" tabindex="-1"></a><span class="co"># hl_car &lt;-</span></span>
<span id="cb129-1610"><a href="#cb129-1610" aria-hidden="true" tabindex="-1"></a>hl4 <span class="sc">%&gt;%</span></span>
<span id="cb129-1611"><a href="#cb129-1611" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb129-1612"><a href="#cb129-1612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb129-1613"><a href="#cb129-1613" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1614"><a href="#cb129-1614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1615"><a href="#cb129-1615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1616"><a href="#cb129-1616" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1617"><a href="#cb129-1617" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb129-1618"><a href="#cb129-1618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1619"><a href="#cb129-1619" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1620"><a href="#cb129-1620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1621"><a href="#cb129-1621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1622"><a href="#cb129-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1623"><a href="#cb129-1623" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_hl_plot_range, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1624"><a href="#cb129-1624" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1625"><a href="#cb129-1625" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1626"><a href="#cb129-1626" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1627"><a href="#cb129-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1628"><a href="#cb129-1628" aria-hidden="true" tabindex="-1"></a><span class="co"># display yearly values of gears in same group on same graph</span></span>
<span id="cb129-1629"><a href="#cb129-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1630"><a href="#cb129-1630" aria-hidden="true" tabindex="-1"></a><span class="co"># summary_hl2 &lt;- hl2 %&gt;% </span></span>
<span id="cb129-1631"><a href="#cb129-1631" aria-hidden="true" tabindex="-1"></a><span class="co">#     group_by(YEAR) %&gt;% </span></span>
<span id="cb129-1632"><a href="#cb129-1632" aria-hidden="true" tabindex="-1"></a><span class="co">#     summarise(lower = min(FL_CM), upper = max(FL_CM), p = median(FL_CM))</span></span>
<span id="cb129-1633"><a href="#cb129-1633" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1634"><a href="#cb129-1634" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(data = summary_hl2, mapping = aes(x = YEAR, y = p)) +</span></span>
<span id="cb129-1635"><a href="#cb129-1635" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_pointrange(mapping = aes(ymin = lower, ymax = upper)) # doesn't separate by gear, can we do that? </span></span>
<span id="cb129-1636"><a href="#cb129-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1637"><a href="#cb129-1637" aria-hidden="true" tabindex="-1"></a><span class="do">## Gives count, mean, standard deviation, standard error of the mean, and confidence interval (default 95%).</span></span>
<span id="cb129-1638"><a href="#cb129-1638" aria-hidden="true" tabindex="-1"></a><span class="do">##   data: a data frame.</span></span>
<span id="cb129-1639"><a href="#cb129-1639" aria-hidden="true" tabindex="-1"></a><span class="do">##   measurevar: the name of a column that contains the variable to be summariezed</span></span>
<span id="cb129-1640"><a href="#cb129-1640" aria-hidden="true" tabindex="-1"></a><span class="do">##   groupvars: a vector containing names of columns that contain grouping variables</span></span>
<span id="cb129-1641"><a href="#cb129-1641" aria-hidden="true" tabindex="-1"></a><span class="do">##   na.rm: a boolean that indicates whether to ignore NA's</span></span>
<span id="cb129-1642"><a href="#cb129-1642" aria-hidden="true" tabindex="-1"></a><span class="do">##   conf.interval: the percent range of the confidence interval (default is 95%)</span></span>
<span id="cb129-1643"><a href="#cb129-1643" aria-hidden="true" tabindex="-1"></a><span class="co"># summarySE &lt;- function(data=hl2, measurevar, groupvars=c("gear", "YEAR"), na.rm=FALSE,</span></span>
<span id="cb129-1644"><a href="#cb129-1644" aria-hidden="true" tabindex="-1"></a><span class="co">#                       conf.interval=.95, .drop=TRUE) {</span></span>
<span id="cb129-1645"><a href="#cb129-1645" aria-hidden="true" tabindex="-1"></a><span class="co">#     library(plyr)</span></span>
<span id="cb129-1646"><a href="#cb129-1646" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1647"><a href="#cb129-1647" aria-hidden="true" tabindex="-1"></a><span class="co">#     # New version of length which can handle NA's: if na.rm==T, don't count them</span></span>
<span id="cb129-1648"><a href="#cb129-1648" aria-hidden="true" tabindex="-1"></a><span class="co">#     length2 &lt;- function (x, na.rm=FALSE) {</span></span>
<span id="cb129-1649"><a href="#cb129-1649" aria-hidden="true" tabindex="-1"></a><span class="co">#         if (na.rm) sum(!is.na(x))</span></span>
<span id="cb129-1650"><a href="#cb129-1650" aria-hidden="true" tabindex="-1"></a><span class="co">#         else       length(x)</span></span>
<span id="cb129-1651"><a href="#cb129-1651" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb129-1652"><a href="#cb129-1652" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1653"><a href="#cb129-1653" aria-hidden="true" tabindex="-1"></a><span class="co">#     # This does the summary. For each group's data frame, return a vector with</span></span>
<span id="cb129-1654"><a href="#cb129-1654" aria-hidden="true" tabindex="-1"></a><span class="co">#     # N, mean, and sd</span></span>
<span id="cb129-1655"><a href="#cb129-1655" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac &lt;- ddply(data, groupvars, .drop=.drop,</span></span>
<span id="cb129-1656"><a href="#cb129-1656" aria-hidden="true" tabindex="-1"></a><span class="co">#       .fun = function(xx, col) {</span></span>
<span id="cb129-1657"><a href="#cb129-1657" aria-hidden="true" tabindex="-1"></a><span class="co">#         c(N    = length2(xx[[col]], na.rm=na.rm),</span></span>
<span id="cb129-1658"><a href="#cb129-1658" aria-hidden="true" tabindex="-1"></a><span class="co">#           mean = mean   (xx[[col]], na.rm=na.rm),</span></span>
<span id="cb129-1659"><a href="#cb129-1659" aria-hidden="true" tabindex="-1"></a><span class="co">#           sd   = sd     (xx[[col]], na.rm=na.rm)</span></span>
<span id="cb129-1660"><a href="#cb129-1660" aria-hidden="true" tabindex="-1"></a><span class="co">#         )</span></span>
<span id="cb129-1661"><a href="#cb129-1661" aria-hidden="true" tabindex="-1"></a><span class="co">#       },</span></span>
<span id="cb129-1662"><a href="#cb129-1662" aria-hidden="true" tabindex="-1"></a><span class="co">#       measurevar</span></span>
<span id="cb129-1663"><a href="#cb129-1663" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb129-1664"><a href="#cb129-1664" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1665"><a href="#cb129-1665" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Rename the "mean" column    </span></span>
<span id="cb129-1666"><a href="#cb129-1666" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac &lt;- rename(datac, c("mean" = measurevar))</span></span>
<span id="cb129-1667"><a href="#cb129-1667" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1668"><a href="#cb129-1668" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac$se &lt;- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean</span></span>
<span id="cb129-1669"><a href="#cb129-1669" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1670"><a href="#cb129-1670" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Confidence interval multiplier for standard error</span></span>
<span id="cb129-1671"><a href="#cb129-1671" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Calculate t-statistic for confidence interval: </span></span>
<span id="cb129-1672"><a href="#cb129-1672" aria-hidden="true" tabindex="-1"></a><span class="co">#     # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1</span></span>
<span id="cb129-1673"><a href="#cb129-1673" aria-hidden="true" tabindex="-1"></a><span class="co">#     ciMult &lt;- qt(conf.interval/2 + .5, datac$N-1)</span></span>
<span id="cb129-1674"><a href="#cb129-1674" aria-hidden="true" tabindex="-1"></a><span class="co">#     datac$ci &lt;- datac$se * ciMult</span></span>
<span id="cb129-1675"><a href="#cb129-1675" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1676"><a href="#cb129-1676" aria-hidden="true" tabindex="-1"></a><span class="co">#     return(datac)</span></span>
<span id="cb129-1677"><a href="#cb129-1677" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb129-1678"><a href="#cb129-1678" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1679"><a href="#cb129-1679" aria-hidden="true" tabindex="-1"></a><span class="co"># hl2sum &lt;- summarySE(data=hl2, measurevar="FL_CM", groupvars=c("gear","year"), na.rm=FALSE, conf.interval=.95)</span></span>
<span id="cb129-1680"><a href="#cb129-1680" aria-hidden="true" tabindex="-1"></a><span class="co"># hl2sum &lt;- summarySE(hl2, measurevar="FL_CM", groupvars=c("gear","year"))</span></span>
<span id="cb129-1681"><a href="#cb129-1681" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1682"><a href="#cb129-1682" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(hl2, aes(x=YEAR, y=FL_CM, colour=gear)) + </span></span>
<span id="cb129-1683"><a href="#cb129-1683" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_errorbar(aes(ymin=FL_CM-se, ymax=FL_CM+se), width=.1) +</span></span>
<span id="cb129-1684"><a href="#cb129-1684" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_line() +</span></span>
<span id="cb129-1685"><a href="#cb129-1685" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_point()</span></span>
<span id="cb129-1686"><a href="#cb129-1686" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1687"><a href="#cb129-1687" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(hl2, aes(x=YEAR, y=FL_CM, colour=gear, group=gear)) + </span></span>
<span id="cb129-1688"><a href="#cb129-1688" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_errorbar(aes(ymin=FL_CM-se, ymax=FL_CM+se), colour="black", width=.1, position=pd) +</span></span>
<span id="cb129-1689"><a href="#cb129-1689" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_line(position=pd) +</span></span>
<span id="cb129-1690"><a href="#cb129-1690" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_point(position=pd, size=3, shape=21, fill="white") + # 21 is filled circle</span></span>
<span id="cb129-1691"><a href="#cb129-1691" aria-hidden="true" tabindex="-1"></a><span class="co">#     xlab("Year") +</span></span>
<span id="cb129-1692"><a href="#cb129-1692" aria-hidden="true" tabindex="-1"></a><span class="co">#     ylab("Fork Length (cm)") +</span></span>
<span id="cb129-1693"><a href="#cb129-1693" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_colour_hue(name="Gear type",    # Legend label, use darker colors</span></span>
<span id="cb129-1694"><a href="#cb129-1694" aria-hidden="true" tabindex="-1"></a><span class="co">#                      breaks=gear,</span></span>
<span id="cb129-1695"><a href="#cb129-1695" aria-hidden="true" tabindex="-1"></a><span class="co">#                      labels=gear,</span></span>
<span id="cb129-1696"><a href="#cb129-1696" aria-hidden="true" tabindex="-1"></a><span class="co">#                      l=40) +                    # Use darker colors, lightness=40</span></span>
<span id="cb129-1697"><a href="#cb129-1697" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggtitle("Average ") +</span></span>
<span id="cb129-1698"><a href="#cb129-1698" aria-hidden="true" tabindex="-1"></a><span class="co">#     expand_limits(y=0) +                        # Expand y range</span></span>
<span id="cb129-1699"><a href="#cb129-1699" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_y_continuous(breaks=0:20*4) +         # Set tick every 4</span></span>
<span id="cb129-1700"><a href="#cb129-1700" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme_bw() +</span></span>
<span id="cb129-1701"><a href="#cb129-1701" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(legend.justification=c(1,0),</span></span>
<span id="cb129-1702"><a href="#cb129-1702" aria-hidden="true" tabindex="-1"></a><span class="co">#           legend.position=c(1,0))               # Position legend in bottom right</span></span>
<span id="cb129-1703"><a href="#cb129-1703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1704"><a href="#cb129-1704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1705"><a href="#cb129-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1706"><a href="#cb129-1706" aria-hidden="true" tabindex="-1"></a><span class="fu">## Trap Gear Distribution Over Time by Year</span></span>
<span id="cb129-1707"><a href="#cb129-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1708"><a href="#cb129-1708" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_tr_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1709"><a href="#cb129-1709" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1710"><a href="#cb129-1710" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1711"><a href="#cb129-1711" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1712"><a href="#cb129-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1713"><a href="#cb129-1713" aria-hidden="true" tabindex="-1"></a>trap <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'TR'</span>,]</span>
<span id="cb129-1714"><a href="#cb129-1714" aria-hidden="true" tabindex="-1"></a>trap2<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(trap<span class="sc">$</span>FL_CM, <span class="fu">list</span>(trap<span class="sc">$</span>YEAR, trap<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb129-1715"><a href="#cb129-1715" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(trap2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb129-1716"><a href="#cb129-1716" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> trap <span class="sc">%&gt;%</span></span>
<span id="cb129-1717"><a href="#cb129-1717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb129-1718"><a href="#cb129-1718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1719"><a href="#cb129-1719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1720"><a href="#cb129-1720" aria-hidden="true" tabindex="-1"></a>trap2 <span class="sc">%&gt;%</span></span>
<span id="cb129-1721"><a href="#cb129-1721" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb129-1722"><a href="#cb129-1722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb129-1723"><a href="#cb129-1723" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1724"><a href="#cb129-1724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1725"><a href="#cb129-1725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1726"><a href="#cb129-1726" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1727"><a href="#cb129-1727" aria-hidden="true" tabindex="-1"></a> <span class="co"># theme_minimal()</span></span>
<span id="cb129-1728"><a href="#cb129-1728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1729"><a href="#cb129-1729" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1730"><a href="#cb129-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1731"><a href="#cb129-1731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1732"><a href="#cb129-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1733"><a href="#cb129-1733" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diving Gear Distribution Over Time by Year - NO GEAR GROUPING</span></span>
<span id="cb129-1734"><a href="#cb129-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1735"><a href="#cb129-1735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_DV_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1736"><a href="#cb129-1736" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1737"><a href="#cb129-1737" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1738"><a href="#cb129-1738" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1739"><a href="#cb129-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1740"><a href="#cb129-1740" aria-hidden="true" tabindex="-1"></a><span class="co"># diving &lt;- length_data_final[length_data_final$gear_short=='DV',]</span></span>
<span id="cb129-1741"><a href="#cb129-1741" aria-hidden="true" tabindex="-1"></a><span class="co"># diving2&lt;- aggregate(diving$FL_CM, list(diving$YEAR, diving$LAND_STANDARD_GEAR_NAME), mean)</span></span>
<span id="cb129-1742"><a href="#cb129-1742" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(diving2) &lt;- c('Year', 'LAND_STANDARD_GEAR_NAME', 'yearlyValue')</span></span>
<span id="cb129-1743"><a href="#cb129-1743" aria-hidden="true" tabindex="-1"></a><span class="co"># counts = diving %&gt;%</span></span>
<span id="cb129-1744"><a href="#cb129-1744" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(LAND_STANDARD_GEAR_NAME) %&gt;%</span></span>
<span id="cb129-1745"><a href="#cb129-1745" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(LAND_STANDARD_GEAR_NAME, " (n= ", n, ")" ))</span></span>
<span id="cb129-1746"><a href="#cb129-1746" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1747"><a href="#cb129-1747" aria-hidden="true" tabindex="-1"></a><span class="co"># diving2 %&gt;%</span></span>
<span id="cb129-1748"><a href="#cb129-1748" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(x = Year, y = yearlyValue, color = LAND_STANDARD_GEAR_NAME, group = 1))+</span></span>
<span id="cb129-1749"><a href="#cb129-1749" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(size = 2) +</span></span>
<span id="cb129-1750"><a href="#cb129-1750" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1751"><a href="#cb129-1751" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_hue(labels = counts$n_labels)+</span></span>
<span id="cb129-1752"><a href="#cb129-1752" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Gear Type", y = "Fork Length (cm)", x= "Year", title = paste0(region,  "\n (N = ", sum(counts$n), ")"))+</span></span>
<span id="cb129-1753"><a href="#cb129-1753" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1754"><a href="#cb129-1754" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span>
<span id="cb129-1755"><a href="#cb129-1755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1756"><a href="#cb129-1756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1757"><a href="#cb129-1757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1758"><a href="#cb129-1758" aria-hidden="true" tabindex="-1"></a><span class="fu">## Net Gear Distribution Over Time by Year</span></span>
<span id="cb129-1759"><a href="#cb129-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1760"><a href="#cb129-1760" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_net_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1761"><a href="#cb129-1761" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1762"><a href="#cb129-1762" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1763"><a href="#cb129-1763" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1764"><a href="#cb129-1764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1765"><a href="#cb129-1765" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'NT'</span>,]</span>
<span id="cb129-1766"><a href="#cb129-1766" aria-hidden="true" tabindex="-1"></a>net2<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(net<span class="sc">$</span>FL_CM, <span class="fu">list</span>(net<span class="sc">$</span>YEAR, net<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb129-1767"><a href="#cb129-1767" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(net2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb129-1768"><a href="#cb129-1768" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> net <span class="sc">%&gt;%</span></span>
<span id="cb129-1769"><a href="#cb129-1769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb129-1770"><a href="#cb129-1770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1771"><a href="#cb129-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1772"><a href="#cb129-1772" aria-hidden="true" tabindex="-1"></a>net2 <span class="sc">%&gt;%</span></span>
<span id="cb129-1773"><a href="#cb129-1773" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb129-1774"><a href="#cb129-1774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb129-1775"><a href="#cb129-1775" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1776"><a href="#cb129-1776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1777"><a href="#cb129-1777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1778"><a href="#cb129-1778" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1779"><a href="#cb129-1779" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb129-1780"><a href="#cb129-1780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1781"><a href="#cb129-1781" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1782"><a href="#cb129-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1783"><a href="#cb129-1783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1784"><a href="#cb129-1784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1785"><a href="#cb129-1785" aria-hidden="true" tabindex="-1"></a><span class="fu">## Spear Gear Distribution Over Time by Year - NO GROUPING</span></span>
<span id="cb129-1786"><a href="#cb129-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1787"><a href="#cb129-1787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_sp_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1788"><a href="#cb129-1788" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1789"><a href="#cb129-1789" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1790"><a href="#cb129-1790" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1791"><a href="#cb129-1791" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1792"><a href="#cb129-1792" aria-hidden="true" tabindex="-1"></a><span class="co"># sp&lt;- length_data_final[length_data_final$gear_short=='SP',]</span></span>
<span id="cb129-1793"><a href="#cb129-1793" aria-hidden="true" tabindex="-1"></a><span class="co"># sp2&lt;- aggregate(sp$FL_CM, list(sp$YEAR, sp$LAND_STANDARD_GEAR_NAME), mean)</span></span>
<span id="cb129-1794"><a href="#cb129-1794" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(sp2) &lt;- c('Year', 'LAND_STANDARD_GEAR_NAME', 'yearlyValue')</span></span>
<span id="cb129-1795"><a href="#cb129-1795" aria-hidden="true" tabindex="-1"></a><span class="co"># counts = sp %&gt;%</span></span>
<span id="cb129-1796"><a href="#cb129-1796" aria-hidden="true" tabindex="-1"></a><span class="co">#   tabyl(LAND_STANDARD_GEAR_NAME) %&gt;%</span></span>
<span id="cb129-1797"><a href="#cb129-1797" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(n_labels = paste0(LAND_STANDARD_GEAR_NAME, " (n= ", n, ")" ))</span></span>
<span id="cb129-1798"><a href="#cb129-1798" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-1799"><a href="#cb129-1799" aria-hidden="true" tabindex="-1"></a><span class="co"># sp2 %&gt;%</span></span>
<span id="cb129-1800"><a href="#cb129-1800" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(aes(x = Year, y = yearlyValue, color = LAND_STANDARD_GEAR_NAME, group = 1))+</span></span>
<span id="cb129-1801"><a href="#cb129-1801" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(size = 2) +</span></span>
<span id="cb129-1802"><a href="#cb129-1802" aria-hidden="true" tabindex="-1"></a><span class="co">#   # scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1803"><a href="#cb129-1803" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_color_hue(labels = counts$n_labels)+</span></span>
<span id="cb129-1804"><a href="#cb129-1804" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(color = "Gear Type", y = "Fork Length (cm)", x= "Year", title = paste0(region,  "\n (N = ", sum(counts$n), ")"))+</span></span>
<span id="cb129-1805"><a href="#cb129-1805" aria-hidden="true" tabindex="-1"></a><span class="co">#   # facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1806"><a href="#cb129-1806" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span>
<span id="cb129-1807"><a href="#cb129-1807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1808"><a href="#cb129-1808" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1809"><a href="#cb129-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1810"><a href="#cb129-1810" aria-hidden="true" tabindex="-1"></a><span class="fu">## Other Gear Distribution Over Time by Year</span></span>
<span id="cb129-1811"><a href="#cb129-1811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1812"><a href="#cb129-1812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gear_distribution_yr_ot_plot, fig.width=12, fig.height=8}</span></span>
<span id="cb129-1813"><a href="#cb129-1813" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1814"><a href="#cb129-1814" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1815"><a href="#cb129-1815" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb129-1816"><a href="#cb129-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1817"><a href="#cb129-1817" aria-hidden="true" tabindex="-1"></a>ot<span class="ot">&lt;-</span> length_data_final[length_data_final<span class="sc">$</span>gear_short<span class="sc">==</span><span class="st">'OT'</span>,]</span>
<span id="cb129-1818"><a href="#cb129-1818" aria-hidden="true" tabindex="-1"></a>ot2<span class="ot">&lt;-</span> <span class="fu">aggregate</span>(ot<span class="sc">$</span>FL_CM, <span class="fu">list</span>(ot<span class="sc">$</span>YEAR, ot<span class="sc">$</span>LAND_STANDARD_GEAR_NAME), mean)</span>
<span id="cb129-1819"><a href="#cb129-1819" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ot2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Year'</span>, <span class="st">'LAND_STANDARD_GEAR_NAME'</span>, <span class="st">'yearlyValue'</span>)</span>
<span id="cb129-1820"><a href="#cb129-1820" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span> ot <span class="sc">%&gt;%</span></span>
<span id="cb129-1821"><a href="#cb129-1821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(LAND_STANDARD_GEAR_NAME) <span class="sc">%&gt;%</span></span>
<span id="cb129-1822"><a href="#cb129-1822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(LAND_STANDARD_GEAR_NAME, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1823"><a href="#cb129-1823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1824"><a href="#cb129-1824" aria-hidden="true" tabindex="-1"></a>ot2 <span class="sc">%&gt;%</span></span>
<span id="cb129-1825"><a href="#cb129-1825" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> yearlyValue, <span class="at">color =</span> LAND_STANDARD_GEAR_NAME, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb129-1826"><a href="#cb129-1826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb129-1827"><a href="#cb129-1827" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual( values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1828"><a href="#cb129-1828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1829"><a href="#cb129-1829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">y =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">x=</span> <span class="st">"Year"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1830"><a href="#cb129-1830" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet_wrap(~ISLAND,ncol=1) +</span></span>
<span id="cb129-1831"><a href="#cb129-1831" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_minimal()</span></span>
<span id="cb129-1832"><a href="#cb129-1832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), </span>
<span id="cb129-1833"><a href="#cb129-1833" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb129-1834"><a href="#cb129-1834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1835"><a href="#cb129-1835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1836"><a href="#cb129-1836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1837"><a href="#cb129-1837" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cummulative Density Plots</span></span>
<span id="cb129-1838"><a href="#cb129-1838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1839"><a href="#cb129-1839" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aggregated CDF</span></span>
<span id="cb129-1840"><a href="#cb129-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1841"><a href="#cb129-1841" aria-hidden="true" tabindex="-1"></a><span class="in">```{r agg_cdf_plot}</span></span>
<span id="cb129-1842"><a href="#cb129-1842" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1843"><a href="#cb129-1843" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1844"><a href="#cb129-1844" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1845"><a href="#cb129-1845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1846"><a href="#cb129-1846" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">=</span>length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb129-1847"><a href="#cb129-1847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(gear) <span class="sc">%&gt;%</span></span>
<span id="cb129-1848"><a href="#cb129-1848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(gear, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1849"><a href="#cb129-1849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1850"><a href="#cb129-1850" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb129-1851"><a href="#cb129-1851" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1852"><a href="#cb129-1852" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb129-1853"><a href="#cb129-1853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()<span class="sc">+</span></span>
<span id="cb129-1854"><a href="#cb129-1854" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1855"><a href="#cb129-1855" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1856"><a href="#cb129-1856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1857"><a href="#cb129-1857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb129-1858"><a href="#cb129-1858" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1859"><a href="#cb129-1859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1860"><a href="#cb129-1860" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1861"><a href="#cb129-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1862"><a href="#cb129-1862" aria-hidden="true" tabindex="-1"></a><span class="fu">## Management periods\*</span></span>
<span id="cb129-1863"><a href="#cb129-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1864"><a href="#cb129-1864" aria-hidden="true" tabindex="-1"></a>**This section is optional and may be empty if there are not signifcant changes**</span>
<span id="cb129-1865"><a href="#cb129-1865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1866"><a href="#cb129-1866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_cdf_plot, eval=!is.na(break_year)}</span></span>
<span id="cb129-1867"><a href="#cb129-1867" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1868"><a href="#cb129-1868" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1869"><a href="#cb129-1869" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1870"><a href="#cb129-1870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1871"><a href="#cb129-1871" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb129-1872"><a href="#cb129-1872" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1873"><a href="#cb129-1873" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb129-1874"><a href="#cb129-1874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()<span class="sc">+</span></span>
<span id="cb129-1875"><a href="#cb129-1875" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1876"><a href="#cb129-1876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1877"><a href="#cb129-1877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1878"><a href="#cb129-1878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb129-1879"><a href="#cb129-1879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb129-1880"><a href="#cb129-1880" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1881"><a href="#cb129-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1882"><a href="#cb129-1882" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1883"><a href="#cb129-1883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1884"><a href="#cb129-1884" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual CDF</span></span>
<span id="cb129-1885"><a href="#cb129-1885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1886"><a href="#cb129-1886" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual_cdf_plot, fig.height=9, fig.width=9}</span></span>
<span id="cb129-1887"><a href="#cb129-1887" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1888"><a href="#cb129-1888" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1889"><a href="#cb129-1889" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1890"><a href="#cb129-1890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1891"><a href="#cb129-1891" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span> </span>
<span id="cb129-1892"><a href="#cb129-1892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb129-1893"><a href="#cb129-1893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_labs =</span> <span class="fu">paste0</span>(YEAR, <span class="st">"</span><span class="sc">\n</span><span class="st"> n = "</span>, <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb129-1894"><a href="#cb129-1894" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1895"><a href="#cb129-1895" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> gear))<span class="sc">+</span></span>
<span id="cb129-1896"><a href="#cb129-1896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>()<span class="sc">+</span></span>
<span id="cb129-1897"><a href="#cb129-1897" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_manual(values = gearcols, labels = counts$n_labels)+</span></span>
<span id="cb129-1898"><a href="#cb129-1898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> counts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1899"><a href="#cb129-1899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Gear Type"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(counts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1900"><a href="#cb129-1900" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>year_labs)<span class="sc">+</span></span>
<span id="cb129-1901"><a href="#cb129-1901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb129-1902"><a href="#cb129-1902" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1903"><a href="#cb129-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1904"><a href="#cb129-1904" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1905"><a href="#cb129-1905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1906"><a href="#cb129-1906" aria-hidden="true" tabindex="-1"></a><span class="fu"># Island Density Plots</span></span>
<span id="cb129-1907"><a href="#cb129-1907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1908"><a href="#cb129-1908" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aggregated density plots</span></span>
<span id="cb129-1909"><a href="#cb129-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1910"><a href="#cb129-1910" aria-hidden="true" tabindex="-1"></a><span class="in">```{r agg_pdf_plot_reg}</span></span>
<span id="cb129-1911"><a href="#cb129-1911" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1912"><a href="#cb129-1912" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1913"><a href="#cb129-1913" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1914"><a href="#cb129-1914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1915"><a href="#cb129-1915" aria-hidden="true" tabindex="-1"></a>srcounts <span class="ot">=</span>length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb129-1916"><a href="#cb129-1916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(ISLAND) <span class="sc">%&gt;%</span></span>
<span id="cb129-1917"><a href="#cb129-1917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_labels =</span> <span class="fu">paste0</span>(ISLAND, <span class="st">" (n= "</span>, n, <span class="st">")"</span> ))</span>
<span id="cb129-1918"><a href="#cb129-1918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1919"><a href="#cb129-1919" aria-hidden="true" tabindex="-1"></a><span class="co">#srcounts &lt;- srcounts %&gt;% drop_na(SUBREGION)</span></span>
<span id="cb129-1920"><a href="#cb129-1920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1921"><a href="#cb129-1921" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb129-1922"><a href="#cb129-1922" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM))<span class="sc">+</span></span>
<span id="cb129-1923"><a href="#cb129-1923" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_density( aes(color = "Combined"))+</span></span>
<span id="cb129-1924"><a href="#cb129-1924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> ISLAND))<span class="sc">+</span></span>
<span id="cb129-1925"><a href="#cb129-1925" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = regcols, labels = c("Combined", srcounts$n_labels))+</span></span>
<span id="cb129-1926"><a href="#cb129-1926" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels=</span>srcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1927"><a href="#cb129-1927" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Island"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(srcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1928"><a href="#cb129-1928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb129-1929"><a href="#cb129-1929" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1930"><a href="#cb129-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1931"><a href="#cb129-1931" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1932"><a href="#cb129-1932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1933"><a href="#cb129-1933" aria-hidden="true" tabindex="-1"></a><span class="fu">## Management periods\*</span></span>
<span id="cb129-1934"><a href="#cb129-1934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1935"><a href="#cb129-1935" aria-hidden="true" tabindex="-1"></a>**This section is optional and may be empty if there are not significant changes**</span>
<span id="cb129-1936"><a href="#cb129-1936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1937"><a href="#cb129-1937" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mgt_period_pdf_plot_reg, eval=!is.na(break_year)}</span></span>
<span id="cb129-1938"><a href="#cb129-1938" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1939"><a href="#cb129-1939" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1940"><a href="#cb129-1940" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1941"><a href="#cb129-1941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1942"><a href="#cb129-1942" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb129-1943"><a href="#cb129-1943" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1944"><a href="#cb129-1944" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> ISLAND))<span class="sc">+</span></span>
<span id="cb129-1945"><a href="#cb129-1945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()<span class="sc">+</span></span>
<span id="cb129-1946"><a href="#cb129-1946" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_manual(values = regcols, labels = srcounts$n_labels)+</span></span>
<span id="cb129-1947"><a href="#cb129-1947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> srcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1948"><a href="#cb129-1948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Island"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(srcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1949"><a href="#cb129-1949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>mgt_period) <span class="sc">+</span></span>
<span id="cb129-1950"><a href="#cb129-1950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb129-1951"><a href="#cb129-1951" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1952"><a href="#cb129-1952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1953"><a href="#cb129-1953" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1954"><a href="#cb129-1954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1955"><a href="#cb129-1955" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annual Density plots</span></span>
<span id="cb129-1956"><a href="#cb129-1956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1957"><a href="#cb129-1957" aria-hidden="true" tabindex="-1"></a><span class="in">```{r annual_pdf_plot_reg, fig.height=9, fig.width=9}</span></span>
<span id="cb129-1958"><a href="#cb129-1958" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1959"><a href="#cb129-1959" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1960"><a href="#cb129-1960" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1961"><a href="#cb129-1961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1962"><a href="#cb129-1962" aria-hidden="true" tabindex="-1"></a> length_data_final <span class="sc">%&gt;%</span> </span>
<span id="cb129-1963"><a href="#cb129-1963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb129-1964"><a href="#cb129-1964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_labs =</span> <span class="fu">paste0</span>(YEAR, <span class="st">"</span><span class="sc">\n</span><span class="st"> n = "</span>, <span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb129-1965"><a href="#cb129-1965" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1966"><a href="#cb129-1966" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(FL_CM, <span class="at">color =</span> ISLAND))<span class="sc">+</span></span>
<span id="cb129-1967"><a href="#cb129-1967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()<span class="sc">+</span></span>
<span id="cb129-1968"><a href="#cb129-1968" aria-hidden="true" tabindex="-1"></a><span class="co">#  scale_color_manual(values = regcols, labels = srcounts$n_labels)+</span></span>
<span id="cb129-1969"><a href="#cb129-1969" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> srcounts<span class="sc">$</span>n_labels)<span class="sc">+</span></span>
<span id="cb129-1970"><a href="#cb129-1970" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Subregion"</span>, <span class="at">x =</span> <span class="st">"Fork Length (cm)"</span>, <span class="at">title =</span> <span class="fu">paste0</span>(county,  <span class="st">"</span><span class="sc">\n</span><span class="st"> (N = "</span>, <span class="fu">sum</span>(srcounts<span class="sc">$</span>n), <span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb129-1971"><a href="#cb129-1971" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>year_labs)<span class="sc">+</span></span>
<span id="cb129-1972"><a href="#cb129-1972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb129-1973"><a href="#cb129-1973" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb129-1974"><a href="#cb129-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1975"><a href="#cb129-1975" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1976"><a href="#cb129-1976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1977"><a href="#cb129-1977" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb129-1978"><a href="#cb129-1978" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1979"><a href="#cb129-1979" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-1980"><a href="#cb129-1980" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page </span></span>
<span id="cb129-1981"><a href="#cb129-1981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1982"><a href="#cb129-1982" aria-hidden="true" tabindex="-1"></a>final_gears <span class="ot">&lt;-</span> <span class="fu">unique</span>(length_data_final<span class="sc">$</span>gear_short)  <span class="do">##++this is where final length comps are generated ; could be aggregated above (e.g. via lookup table) &amp; should be 1 here </span></span>
<span id="cb129-1983"><a href="#cb129-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1984"><a href="#cb129-1984" aria-hidden="true" tabindex="-1"></a>comps <span class="ot">&lt;-</span> <span class="fu">list</span>()  <span class="do">##++this creates an empty list for for loop</span></span>
<span id="cb129-1985"><a href="#cb129-1985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1986"><a href="#cb129-1986" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop generates binned length comps for each of the final gears. Stored in list. RUN:  View(comps[[1]]) to see in R</span></span>
<span id="cb129-1987"><a href="#cb129-1987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1988"><a href="#cb129-1988" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(final_gears)){</span>
<span id="cb129-1989"><a href="#cb129-1989" aria-hidden="true" tabindex="-1"></a> comps[[i]] <span class="ot">&lt;-</span>  length_data_final <span class="sc">%&gt;%</span></span>
<span id="cb129-1990"><a href="#cb129-1990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gear_short <span class="sc">==</span> final_gears[i]) <span class="sc">%&gt;%</span></span>
<span id="cb129-1991"><a href="#cb129-1991" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb129-1992"><a href="#cb129-1992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ln_fish =</span> <span class="fu">n</span>(),</span>
<span id="cb129-1993"><a href="#cb129-1993" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_trips =</span> <span class="fu">length</span>(<span class="fu">unique</span>(ID)),</span>
<span id="cb129-1994"><a href="#cb129-1994" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_dealers=</span><span class="fu">length</span>(<span class="fu">unique</span>(DEALER_CODE)),</span>
<span id="cb129-1995"><a href="#cb129-1995" aria-hidden="true" tabindex="-1"></a>            <span class="at">ln_vessels=</span><span class="fu">length</span>(<span class="fu">unique</span>(VESSEL_ID))) <span class="sc">%&gt;%</span></span>
<span id="cb129-1996"><a href="#cb129-1996" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-1997"><a href="#cb129-1997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels, lbin)<span class="sc">%&gt;%</span></span>
<span id="cb129-1998"><a href="#cb129-1998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">unique</span>(ln_fish)) <span class="sc">%&gt;%</span></span>
<span id="cb129-1999"><a href="#cb129-1999" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-2000"><a href="#cb129-2000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(YEAR, ln_fish, ln_trips, ln_dealers, ln_vessels), </span>
<span id="cb129-2001"><a href="#cb129-2001" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> lbin, </span>
<span id="cb129-2002"><a href="#cb129-2002" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> freq, </span>
<span id="cb129-2003"><a href="#cb129-2003" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">freq =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb129-2004"><a href="#cb129-2004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(full_set) <span class="sc">%&gt;%</span></span>
<span id="cb129-2005"><a href="#cb129-2005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comp_names)<span class="sc">%&gt;%</span></span>
<span id="cb129-2006"><a href="#cb129-2006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-2007"><a href="#cb129-2007" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">flag_n  =</span> <span class="fu">ifelse</span>(ln_fish <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">0</span>, </span>
<span id="cb129-2008"><a href="#cb129-2008" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(ln_fish <span class="sc">&lt;</span> <span class="dv">15</span>, <span class="dv">2</span>, <span class="dv">1</span>)))</span>
<span id="cb129-2009"><a href="#cb129-2009" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-2010"><a href="#cb129-2010" aria-hidden="true" tabindex="-1"></a> <span class="fu">names</span>(comps)[[i]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(final_gears[i], <span class="st">"_"</span>, bin_size, <span class="st">"cm"</span>) <span class="do">##++tabs are named here ; could add _nom here if desired (instead of _lfd and _lfdw in main file)</span></span>
<span id="cb129-2011"><a href="#cb129-2011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-2012"><a href="#cb129-2012" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-2013"><a href="#cb129-2013" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb129-2014"><a href="#cb129-2014" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb129-2015"><a href="#cb129-2015" aria-hidden="true" tabindex="-1"></a><span class="co"># write.xlsx(comps, file = paste0("./outputs/", sp, "_com_lfd_", sprintf('%02d', min_year %% 100), sprintf('%02d', max_year %% 100), "_", gsub("-", "", Sys.Date()), ".xlsx"))</span></span>
<span id="cb129-2016"><a href="#cb129-2016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-2017"><a href="#cb129-2017" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>